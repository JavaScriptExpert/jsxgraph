/*
    Copyright 2008,2009
        Matthias Ehmann,
        Michael Gerhaeuser,
        Carsten Miller,
        Bianca Valentin,
        Alfred Wassermann,
        Peter Wilfahrt

    This file is part of JSXGraph.

    JSXGraph is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    JSXGraph is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with JSXGraph.  If not, see <http://www.gnu.org/licenses/>.
*/
    var JXG={};(function(){var a,b;JXG.countDrawings=0;JXG.countTime=0;JXG.require=function(d){};JXG.rendererFiles=[];JXG.rendererFiles.svg="SVGRenderer";JXG.rendererFiles.vml="VMLRenderer";JXG.baseFiles=null;JXG.requirePath="";for(a=0;a<document.getElementsByTagName("script").length;a++){b=document.getElementsByTagName("script")[a];if(b.src&&b.src.match(/loadjsxgraphInOneFile\.js(\?.*)?$/)){JXG.requirePath=b.src.replace(/loadjsxgraphInOneFile\.js(\?.*)?$/,"")}}JXG.serverBase=JXG.requirePath+"server/"})();JXG.Math=new Object();JXG.Math.eps=0.000001;JXG.Math.Vector=function(b){var a;this.length=0;if((typeof b!=undefined)&&(b!=null)){for(a=0;a<b.length;a++){this.push(b[a])}}};JXG.Math.Vector.prototype=new Array();JXG.Math.Vector.prototype.n=function(){return this.length};JXG.Math.Vector.prototype.exchange=function(d,b){var a=this[d];this[d]=this[b];this[b]=a};JXG.Math.Matrix=function(h){var f=0,g=false,e,d,a,b;this.length=0;if((typeof h!=undefined)&&(h!=null)){a=h.length;for(e=0;e<a;e++){b=h[e].length;this.push(new Array());if(g){if(f!=b){this.length=0;throw new JXG.DimensionMismatchException("Your array contains arrays with different lengths.")}}for(d=0;d<b;d++){this[e].push(h[e][d])}f=b;g=true}}};JXG.Math.Matrix.prototype=new Array();JXG.Math.Matrix.prototype.m=function(){return this.length};JXG.Math.Matrix.prototype.n=function(){if(this.length>0){return this[0].length}else{return 0}};JXG.Math.Matrix.prototype.exchangeRows=function(d,b){var a=this[d];this[d]=this[b];this[b]=a};JXG.DimensionMismatchException=function(a){if((typeof a!=undefined)&&(a!=null)){this.message=a}else{this.message=null}};JXG.DimensionMismatchException.prototype.what=function(){var a="Matrix has incorrect dimensions";if(this.message!=null){return a+": "+this.message+"."}else{return a+"."}};JXG.SingularMatrixException=function(a){if((typeof a!=undefined)&&(a!=null)){this.message=a}else{this.message=null}};JXG.SingularMatrixException.prototype.what=function(){var a="Matrix is singular";if(this.message!=null){return a+": "+this.message+"."}else{return a+"."}};JXG.Math.matVecMult=function(h,f){var a=h.length,o=f.length,e=[],d,g,b;for(d=0;d<a;d++){g=0;for(b=0;b<o;b++){g+=h[d][b]*f[b]}e[d]=g}return e};JXG.Math.matMatMult=function(b,a){var e=b.length,d=a[0].length,q=a.length,o=[],h,g,u,f;for(h=0;h<e;h++){o[h]=[]}for(h=0;h<e;h++){for(g=0;g<d;g++){u=0;for(f=0;f<q;f++){u+=b[h][f]*a[f][g]}o[h][g]=u}}return o};JXG.Math.Matrix.transpose=function(g){var d=[],e,b,a,f;a=g.length;f=(g.length>0)?g[0].length:0;for(e=0;e<f;e++){d.push([]);for(b=0;b<a;b++){d[e].push(g[b][e])}}return d};JXG.memoizer=function(b){var a,d;if(b.memo){return b.memo}a={};d=Array.prototype.join;return(b.memo=function(){var e=d.call(arguments);return(typeof a[e]!="undefined")?a[e]:a[e]=b.apply(this,arguments)})};JXG.Math.factorial=JXG.memoizer(function(a){if(a<0){return NaN}if(a==0||a==1){return 1}return a*arguments.callee(a-1)});JXG.Math.binomial=JXG.memoizer(function(f,d){var a,e;if(d>f||d<0){return 0}if(d==0||d==f){return 1}a=1;for(e=0;e<d;e++){a*=(f-e);a/=(e+1)}return a});JXG.Math.round=function(a,e){var d,b;d=a-Math.ceil(a);b=d.toString();if(d<0){b=b.substr(0,e+3)}else{b=b.substr(0,e+2)}d=parseFloat(b);t=parseInt(a.toString());return t+d};JXG.Math.Numerics={};JXG.Math.Numerics.INT_TRAPEZ=1;JXG.Math.Numerics.INT_SIMPSON=2;JXG.Math.Numerics.INT_MILNE=3;JXG.Math.Numerics.number_of_nodes=28;JXG.Math.Numerics.integration_type=JXG.INT_MILNE;JXG.Math.Numerics.backwardSolve=function(h,e){var d=e,a,k,g,f;if(h.m){a=h.m();k=h.n()}else{a=h.length;k=(h.length>0)?h[0].length:0}for(g=a-1;g>=0;g--){for(f=k-1;f>g;f--){d[g]-=h[g][f]*d[f]}d[g]/=h[g][g]}return d};JXG.Math.Numerics.Gauss=function(a,q){var u=JXG.Math.eps,d,g,f,e,h,s,o;if(a.n){d=a.n()}else{d=(a.length>0)?a[0].length:0}h=new JXG.Math.Vector();for(g=0;g<d;g++){h.push(g)}for(f=0;f<d;f++){for(g=d-1;g>f;g--){if(Math.abs(a[g][f])>JXG.Math.eps){if(Math.abs(a[f][f])<JXG.Math.eps){a.exchangeRows(g,f);q.exchange(g,f);h.exchange(g,f)}else{a[g][f]/=a[f][f];q[g]-=a[g][f]*q[f];for(e=f+1;e<d;e++){a[g][e]-=a[g][f]*a[f][e]}}}if(Math.abs(a[f][f])<JXG.Math.eps){throw new SingularMatrixException()}}}return JXG.Math.Numerics.backwardSolve(a,q)};JXG.Math.Numerics.QR=function(d,a){};JXG.Math.Numerics.NewtonCotes=function(e,h){var b=0,a=(e[1]-e[0])/this.number_of_nodes,k,g,d;switch(this.integration_type){case JXG.INT_TRAPEZ:b=(h(e[0])+h(e[1]))*0.5;k=e[0];for(g=0;g<this.number_of_nodes-1;g++){k+=a;b+=h(k)}b*=a;break;case JXG.INT_SIMPSON:if(this.number_of_nodes%2>0){throw"Error: INT_SIMPSON requires JXG.Math.Numerics.number_of_nodes dividable by 2."}d=this.number_of_nodes/2;b=h(e[0])+h(e[1]);k=e[0];for(g=0;g<d-1;g++){k+=2*a;b+=2*h(k)}k=e[0]-a;for(g=0;g<d;g++){k+=2*a;b+=4*h(k)}b*=a/3;break;default:if(this.number_of_nodes%4>0){throw"Error in INT_MILNE: JXG.Math.Numerics.number_of_nodes must be a multiple of 4"}d=this.number_of_nodes*0.25;b=7*(h(e[0])+h(e[1]));k=e[0];for(g=0;g<d-1;g++){k+=4*a;b+=14*h(k)}k=e[0]-3*a;for(g=0;g<d;g++){k+=4*a;b+=32*(h(k)+h(k+2*a))}k=e[0]-2*a;for(g=0;g<d;g++){k+=4*a;b+=12*h(k)}b*=2*a/45}return b};JXG.Math.Numerics.splineDef=function(o,k){var a=o.length,d,f,g,h,b,e=new Array(),u=[],q=[],s;if(o.length!=k.length){throw"Error in JXG.Math.Numerics.splineDef: Input vector dimensions do not match."}for(f=0;f<a;f++){d={X:o[f],Y:k[f]};e.push(d)}e.sort(function(w,v){return w.X-v.X});for(f=0;f<a;f++){o[f]=e[f].X;k[f]=e[f].Y}for(f=0;f<a-1;f++){u.push(o[f+1]-o[f])}for(f=0;f<a-2;f++){q.push(6*(k[f+2]-k[f+1])/(u[f+1])-6*(k[f+1]-k[f])/(u[f]))}g=new Array();h=new Array();g.push(2*(u[0]+u[1]));h.push(q[0]);for(f=0;f<a-3;f++){b=u[f+1]/g[f];g.push(2*(u[f+1]+u[f+2])-b*u[f+1]);h.push(q[f+1]-b*h[f])}s=new Array();s[a-3]=h[a-3]/g[a-3];for(f=a-4;f>=0;f--){s[f]=(h[f]-(u[f+1]*s[f+1]))/g[f]}for(f=a-3;f>=0;f--){s[f+1]=s[f]}s[0]=0;s[a-1]=0;return s};JXG.Math.Numerics.splineEval=function(f,A,w,C){var g=A.length,k=1,h=false,B,q,o,z,v,u,s,e;if(g!=w.length){throw"Error in JXG.Math.Numerics.splineEval: Defining vector dimensions do not match."}if(JXG.isArray(f)){k=f.length;h=true}else{f=[f]}B=new Array();for(q=0;q<k;q++){if((f[q]<A[0])||(A[q]>A[g-1])){return"NaN"}o;for(o=1;o<g;o++){if(f[q]<=A[o]){break}}o--;z=w[o];v=(w[o+1]-w[o])/(A[o+1]-A[o])-(A[o+1]-A[o])/6*(C[o+1]+2*C[o]);u=C[o]/2;s=(C[o+1]-C[o])/(6*(A[o+1]-A[o]));e=f[q]-A[o];B.push(z+(v+(u+s*e)*e)*e)}if(h){return B}else{return B[0]}};JXG.Math.Numerics.generatePolynomialTerm=function(a,g,b,d){var f="",e;for(e=g;e>=0;e--){f+="("+a[e].toPrecision(d)+")";if(e>1){f+="*"+b+"<sup>"+e+"</sup> + "}else{if(e==1){f+="*"+b+" + "}}}return f};JXG.Math.Numerics.lagrangePolynomial=function(e){var a=[];var d="";var b=function(w,f){var h,g,u,v,y,o=0,q=0;u=e.length;if(!f){for(h=0;h<u;h++){a[h]=1;v=e[h].X();for(g=0;g<u;g++){if(g!=h){a[h]*=(v-e[g].X())}}a[h]=1/a[h]}M=[];for(j=0;j<u;j++){M.push([1])}}for(h=0;h<u;h++){v=e[h].X();if(w==v){return e[h].Y()}else{y=a[h]/(w-v);q+=y;o+=y*e[h].Y()}}return o/q};b.getTerm=function(){return d};return b};JXG.Math.Numerics.neville=function(e){var a=[];var d=function(w,f){var h,u,v,x,y=JXG.Math.binomial,q=e.length,g=q-1,k=0,o=0;if(!f){x=1;for(h=0;h<q;h++){a[h]=y(g,h)*x;x*=(-1)}}u=w;for(h=0;h<q;h++){if(u==0){return e[h].X()}else{x=a[h]/u;u--;k+=e[h].X()*x;o+=x}}return k/o};var b=function(w,f){var h,u,v,x,y=JXG.Math.binomial,q=e.length,g=q-1,k=0,o=0;if(!f){x=1;for(h=0;h<q;h++){a[h]=y(g,h)*x;x*=(-1)}}u=w;for(h=0;h<q;h++){if(u==0){return e[h].Y()}else{x=a[h]/u;u--;k+=e[h].Y()*x;o+=x}}return k/o};return[d,b,0,function(){return e.length-1}]};JXG.Math.Numerics.regressionPolynomial=function(f,q,o){var a=[],g=0,b,k,h,d,e="";if(JXG.isPoint(f)&&typeof f.Value=="function"){b=function(){return f.Value()}}else{if(JXG.isFunction(f)){b=f}else{if(JXG.isNumber(f)){b=function(){return f}}else{throw ("JSXGraph error: Can't create regressionPolynomial from degree of type'"+(typeof f)+"'.")}}}if(arguments.length==3&&JXG.isArray(q)&&JXG.isArray(o)){k=q;h=o;d=0}else{if(arguments.length==2&&JXG.isArray(q)&&JXG.isPoint(q[0])){d=1}else{throw ("JSXGraph error: Can't create regressionPolynomial. Wrong parameters.")}}var s=function(H,u){var z,w,E,C,G,v,F,I,D,A=q.length;D=Math.floor(b());if(!u){if(d==1){k=[];h=[];for(z=0;z<A;z++){k[z]=q[z].X();h[z]=q[z].Y()}}E=[];for(w=0;w<A;w++){E.push([1])}for(z=1;z<=D;z++){for(w=0;w<A;w++){E[w][z]=E[w][z-1]*k[w]}}G=h;C=JXG.Math.Matrix.transpose(E);v=JXG.Math.matMatMult(C,E);F=JXG.Math.matVecMult(C,G);a=JXG.Math.Numerics.Gauss(v,F);e=JXG.Math.Numerics.generatePolynomialTerm(a,D,"x",3)}I=a[D];for(z=D-1;z>=0;z--){I=(I*H+a[z])}return I};s.getTerm=function(){return e};return s};JXG.Math.Numerics.D=function(d,e){var b=0.00001,a=1/(b*2);if(arguments.length==1||(arguments.length>1&&typeof arguments[1]=="undefined")){return function(f,g){return(d(f+b,g)-d(f-b,g))*a}}else{return function(f,g){return(d.apply(e,[f+b,g])-d.apply(e,[f-b,g]))*a}}};JXG.Math.Numerics.I=function(a,b){return JXG.Math.Numerics.NewtonCotes(a,b)};JXG.Math.Numerics.newton=function(g,a,k){var b=0,d=0.000001,e=g.apply(k,[a]),o;while(b<50&&Math.abs(e)>d){o=this.D(g,k)(a);if(Math.abs(o)>d){a-=e/o}else{a+=(Math.random()*0.2-1)}e=g.apply(k,[a]);b++}return a};JXG.Math.Numerics.root=function(b,a,d){return this.newton(b,a,d)};JXG.Math.Numerics.cosh=function(a){return(Math.exp(a)+Math.exp(-a))*0.5};JXG.Math.Numerics.sinh=function(a){return(Math.exp(a)-Math.exp(-a))*0.5};JXG.Math.Numerics.riemann=function(q,g,s,d,h){var e,A,o,z,k,w,u,b,a,v;e=[];A=[];k=0;w=d;g=Math.floor(g);e[k]=w;A[k]=0;if(g>0){z=(h-d)/g;a=z*0.01;for(o=0;o<g;o++){if(s=="right"){u=q(w+z)}else{if(s=="middle"){u=q(w+z*0.5)}else{if((s=="left")||(s=="trapezodial")){u=q(w)}else{if(s=="lower"){u=q(w);for(b=w+a;b<=w+z;b+=a){v=q(b);if(v<u){u=v}}}else{u=q(w);for(b=w+a;b<=w+z;b+=a){v=q(b);if(v>u){u=v}}}}}}k++;e[k]=w;A[k]=u;k++;w+=z;if(s=="trapezodial"){u=q(w)}e[k]=w;A[k]=u;k++;e[k]=w;A[k]=0}}return[e,A]};JXG.Math.Numerics.riemannsum=function(k,e,q,d,g){var o,h,w,v,s,b,a,u;o=0;v=d;e=Math.floor(e);if(e>0){w=(g-d)/e;a=w*0.01;for(h=0;h<e;h++){if(q=="right"){s=k(v+w)}else{if(q=="middle"){s=k(v+w*0.5)}else{if(q=="trapezodial"){s=0.5*(k(v+w)+k(v))}else{if(q=="left"){s=k(v)}else{if(q=="lower"){s=k(v);for(b=v+a;b<=v+w;b+=a){u=k(b);if(u<s){s=u}}}else{s=k(v);for(b=v+a;b<=v+w;b+=a){u=k(b);if(u>s){s=u}}}}}}}o+=w*s;v+=w}}return o};JXG.Math.Numerics.Butcher=function(){this.s=0;this.A=[];this.b=[];this.c=[]};JXG.Math.Numerics.predefinedButcher={};JXG.Math.Numerics.predefinedButcher.RK4={s:4,A:[[0,0,0,0],[0.5,0,0,0],[0,0.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,0.5,0.5,1]};JXG.Math.Numerics.predefinedButcher.Heun={s:2,A:[[0,0],[1,0]],b:[0.5,0.5],c:[0,1]};JXG.Math.Numerics.predefinedButcher.Euler={s:1,A:[[0]],b:[1],c:[0]};JXG.Math.Numerics.rungeKutta=function(d,J,q,g,H){var u=[],o=[],G=(q[1]-q[0])/g,w=q[0],K,F,E,C,B,D=J.length,z=d.s,b=1000,a=g/b,v=[],A=0;for(K=0;K<D;K++){u[K]=J[K]}for(F=0;F<g;F++){v[A]=[];for(K=0;K<D;K++){v[A][K]=u[K]}A++;C=[];for(E=0;E<z;E++){for(K=0;K<D;K++){o[K]=0}for(B=0;B<E;B++){for(K=0;K<D;K++){o[K]+=(d.A[E][B])*G*C[B][K]}}for(K=0;K<D;K++){o[K]+=u[K]}C.push(H(w+d.c[E]*G,o))}for(K=0;K<D;K++){o[K]=0}for(B=0;B<z;B++){for(K=0;K<D;K++){o[K]+=d.b[B]*C[B][K]}}for(K=0;K<D;K++){u[K]=u[K]+G*o[K]}w+=G}return v};JXG.MathStatistics=function(){};JXG.MathStatistics.prototype.sum=function(b){var e,a,d=0;for(e=0,a=b.length;e<a;e++){d+=b[e]}return d};JXG.MathStatistics.prototype.prod=function(b){var e,a,d=1;for(e=0,a=b.length;e<a;e++){d*=b[e]}return d};JXG.MathStatistics.prototype.mean=function(a){if(a.length>0){return this.sum(a)/a.length}else{return 0}};JXG.MathStatistics.prototype.median=function(b){var d,a;if(b.length>0){d=b.clone();d.sort(function(f,e){return f-e});a=d.length;if(a%2==1){return d[parseInt(a*0.5)]}else{return(d[a*0.5-1]+d[a*0.5])*0.5}}else{return 0}};JXG.MathStatistics.prototype.variance=function(d){var b,f,e,a;if(d.length>1){b=this.mean(d);f=0;for(e=0,a=d.length;e<a;e++){f+=(d[e]-b)*(d[e]-b)}return f/(d.length-1)}else{return 0}};JXG.MathStatistics.prototype.sd=function(a){return Math.sqrt(this.variance(a))};JXG.MathStatistics.prototype.weightedMean=function(a,b){if(a.length!=b.length){return}if(a.length>0){return this.mean(this.multiply(a,b))}else{return 0}};JXG.MathStatistics.prototype.max=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]>e)?(b[d]):e}return e};JXG.MathStatistics.prototype.min=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]<e)?(b[d]):e}return e};JXG.MathStatistics.prototype.range=function(a){return[this.min(a),this.max(a)]};JXG.MathStatistics.prototype.diff=function(a){return a};JXG.MathStatistics.prototype.min=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]<e)?(b[d]):e}return e};JXG.MathStatistics.prototype.abs=function(b){var e,a,d=[];if(typeof JXG.isArray(arr1)){for(e=0,a=b.length;e<a;e++){d[e]=Math.abs(b[e])}}else{if(typeof b=="number"){return Math.abs(b)}else{d=null}}return d};JXG.MathStatistics.prototype.add=function(d,b){var f,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]+b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d+b[f]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]+b[f]}}else{if(typeof d=="number"&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d+b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.divide=function(d,b){var f,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]/b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d/b[f]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]/b[f]}}else{if(typeof d=="number"&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d/b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.mod=function(d,b){var f,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]%b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d%b[f]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]%b[f]}}else{if(typeof d=="number"&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d%b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.multiply=function(d,b){var f,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]*b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d*b[f]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]*b[f]}}else{if(typeof d=="number"&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d*b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.subtract=function(d,b){var f,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]-b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d-b[f]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d[f]-b[f]}}else{if(typeof d=="number"&&typeof b=="number"){for(f=0,a=Math.min(d.length,b.length);f<a;f++){e[f]=d-b}}else{e=null}}}}return e};JXG.Math.Symbolic={};JXG.Math.Symbolic.generateSymbolicCoordinatesPartial=function(q,f,e,b){function a(k){if(b=="underscore"){return""+e+"_{"+k+"}"}else{if(b=="brace"){return""+e+"["+k+"]"}else{return""+e+""+k}}}var h=f.ancestors;var g=0;var o;for(var s in h){o=0;if(JXG.isPoint(h[s])){for(var d in h[s].ancestors){o++}if(o==0){h[s].symbolic.x=f.ancestors[s].coords.usrCoords[1];h[s].symbolic.y=f.ancestors[s].coords.usrCoords[2]}else{g++;f.ancestors[s].symbolic.x=a(g);g++;f.ancestors[s].symbolic.y=a(g)}}}if(JXG.isPoint(f)){f.symbolic.x="x";f.symbolic.y="y"}return g};JXG.Math.Symbolic.clearSymbolicCoordinates=function(b){for(var a in b.objects){if(JXG.isPoint(b.objects[a])){b.objects[a].symbolic.x="";b.objects[a].symbolic.y=""}}};JXG.Math.Symbolic.generatePolynomials=function(o,e,f){if(f){this.generateSymbolicCoordinatesPartial(o,e,"u","brace")}var g=e.ancestors;g[e.id]=e;var h;var a=[];var s=[];for(var q in g){h=0;a=[];if(JXG.isPoint(g[q])){for(var b in g[q].ancestors){h++}if(h>0){a=g[q].generatePolynomial();for(var d=0;d<a.length;d++){s.push(a[d])}}}}if(f){this.clearSymbolicCoordinates(o)}return s};JXG.Math.Symbolic.geometricLocusByGroebnerBase=function(f,h,o){var g=this.generateSymbolicCoordinatesPartial(f,h,"u","brace");var a=this.generatePolynomials(f,h);var d=a.join(",");var b=new JXG.Coords(JXG.COORDS_BY_USR,[0,0],f);var e=new JXG.Coords(JXG.COORDS_BY_USR,[f.canvasWidth,f.canvasHeight],f);var k=JXG.serverBase+"jxggroebner.py?number="+g+"&polynomials="+JXG.Util.Base64.encode(d)+"&xs="+b.usrCoords[1]+"&xe="+e.usrCoords[1]+"&ys="+e.usrCoords[2]+"&ye="+b.usrCoords[2];this.cbp=function(A){var y=(new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(A))).unzip();y=y.toString().replace(/,geonext\.gxt/g,"").replace(/\s/g,"");var q=y.split("-----");y=q[0];var u=y.split(";");var w;var z=[];var x=[];for(var s=0;s<u.length;s++){w=u[s].split(",");z[s]=w[0];x[s]=w[1]}var v=f.createElement("curve",[z,x],{strokeColor:"green",strokeWidth:"2px"});this.rendNode=v.rendNode;o(q[1].split(";"))};this.cb=JXG.bind(this.cbp,this);JXG.FileReader.parseFileContent(k,this.cb,"raw");this.clearSymbolicCoordinates(f)};JXG.Complex=function(a,b){this.isComplex=true;if(typeof a=="undefined"){a=0}if(typeof b=="undefined"){b=0}if(a.isComplex){b=a.imaginary;a=a.real}this.real=a;this.imaginary=b;this.absval=0;this.angle=0};JXG.Complex.prototype.toString=function(){return""+this.real+" + "+this.imaginary+"i"};JXG.Complex.prototype.add=function(a){if(typeof a=="number"){this.real+=a}else{this.real+=a.real;this.imaginary+=a.imaginary}};JXG.Complex.prototype.sub=function(a){if(typeof a=="number"){this.real-=a}else{this.real-=a.real;this.imaginary-=a.imaginary}};JXG.Complex.prototype.mult=function(a){if(typeof a=="number"){this.real*=a;this.imaginary*=a}else{this.real=this.real*a.real-this.imaginary*a.imaginary;this.imaginary=this.real*a.imaginary+this.imaginary*a.real}};JXG.Complex.prototype.div=function(b){var a;if(typeof b=="number"){if(Math.abs(b)<Math.eps){this.real=Infinity;this.imaginary=Infinity;return}this.real/=b;this.imaginary/=b}else{if((Math.abs(b.real)<Math.eps)&&(Math.abs(b.imaginary)<Math.eps)){this.real=Infinity;this.imaginary=Infinity;return}a=b.real*b.real+b.imaginary*b.imaginary;this.real=(this.real*b.real+this.imaginary*b.imaginary)/a;this.imaginary=(this.imaginary*b.real-this.real*b.imaginary)/a}};JXG.C={};JXG.C.add=function(b,a){var d=new JXG.Complex(b);d.add(a);return d};JXG.C.sub=function(b,a){var d=new JXG.Complex(b);d.sub(a);return d};JXG.C.mult=function(b,a){var d=new JXG.Complex(b);d.mult(a);return d};JXG.C.div=function(b,a){var d=new JXG.Complex(b);d.div(a);return d};JXG.AbstractRenderer=function(){this.vOffsetText=8;this.enhancedRendering=true};JXG.AbstractRenderer.prototype.drawPoint=function(a){var b;if(a.visProp.face=="cross"){b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"path")}else{if(a.visProp.face=="circle"){b=this.createPrimitive("circle",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"circle")}else{if(a.visProp.face=="square"){b=this.createPrimitive("rect",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"rect")}else{if(a.visProp.face=="plus"){b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"path")}}}}a.rendNode=b;this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.updatePoint(a)};JXG.AbstractRenderer.prototype.updatePoint=function(b){var a=b.visProp.size;if(isNaN(b.coords.scrCoords[2])||isNaN(b.coords.scrCoords[1])){return}if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity)}else{this.setDraft(b)}}if(b.visProp.face=="cross"){this.updatePathPrimitive(b.rendNode,this.updatePathStringPoint(b,a,"x"),b.board)}else{if(b.visProp.face=="circle"){this.updateCirclePrimitive(b.rendNode,b.coords.scrCoords[1],b.coords.scrCoords[2],a+1)}else{if(b.visProp.face=="square"){this.updateRectPrimitive(b.rendNode,b.coords.scrCoords[1]-a,b.coords.scrCoords[2]-a,a*2,a*2)}else{if(b.visProp.face=="plus"){this.updatePathPrimitive(b.rendNode,this.updatePathStringPoint(b,a,"+"),b.board)}}}}this.setShadow(b)};JXG.AbstractRenderer.prototype.changePointStyle=function(a){var b=this.getElementById(a.id);if(b!=null){this.remove(b)}this.drawPoint(a);if(!a.visProp.visible){this.hide(a)}if(a.visProp.draft){this.setDraft(a)}};JXG.AbstractRenderer.prototype.drawLine=function(a){var b=this.createPrimitive("line",a.id);this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"lines");this.updateLine(a)};JXG.AbstractRenderer.prototype.updateLine=function(b){var s=new JXG.Coords(JXG.COORDS_BY_USER,b.point1.coords.usrCoords,b.board),q=new JXG.Coords(JXG.COORDS_BY_USER,b.point2.coords.usrCoords,b.board),a,u,g,f,o,e,k,h,d;this.calcStraight(b,s,q);this.updateLinePrimitive(b.rendNode,s.scrCoords[1],s.scrCoords[2],q.scrCoords[1],q.scrCoords[2]);if(b.image!=null){a=s.scrCoords[1];u=s.scrCoords[2];g=q.scrCoords[1];f=q.scrCoords[2];o;e=(g-a>0)?1:-1;if(Math.abs(g-a)>1e-7){o=Math.atan((f-u)/(g-a))+((e<0)?Math.PI:0)}else{o=((f-u>0)?0.5:-0.5)*Math.PI}k=250;h=256;d=[[1,0,0],[k*(1-Math.cos(o))+h*Math.sin(o),Math.cos(o),-Math.sin(o)],[h*(1-Math.cos(o))-k*Math.sin(o),Math.sin(o),Math.cos(o)]];b.imageTransformMatrix=d}this.makeArrows(b);if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setDashStyle(b,b.visProp);this.setShadow(b)}else{this.setDraft(b)}}};JXG.AbstractRenderer.prototype.calcStraight=function(f,w,u){var d,a,o,h,x,e,v,q,A,k,g,z,y;v=f.board.algebra;x=f.visProp.straightFirst;e=f.visProp.straightLast;if(Math.abs(w.scrCoords[0])<v.eps){x=true}if(Math.abs(u.scrCoords[0])<v.eps){e=true}if(!x&&!e){return}q=[];q[0]=f.stdform[0]-f.stdform[1]*f.board.origin.scrCoords[1]/(f.board.unitX*f.board.zoomX)+f.stdform[2]*f.board.origin.scrCoords[2]/(f.board.unitY*f.board.zoomY);q[1]=f.stdform[1]/(f.board.unitX*f.board.zoomX);q[2]=f.stdform[2]/(-f.board.unitY*f.board.zoomY);if(isNaN(q[0]+q[1]+q[2])){return}A=[];A[0]=v.crossProduct(q,[0,0,1]);A[1]=v.crossProduct(q,[0,1,0]);A[2]=v.crossProduct(q,[-f.board.canvasHeight,0,1]);A[3]=v.crossProduct(q,[-f.board.canvasWidth,1,0]);for(k=0;k<4;k++){if(Math.abs(A[k][0])>v.eps){for(g=2;g>0;g--){A[k][g]/=A[k][0]}A[k][0]=1}}d=false;a=false;if(!x&&w.scrCoords[1]>=0&&w.scrCoords[1]<=f.board.canvasWidth&&w.scrCoords[2]>=0&&w.scrCoords[2]<=f.board.canvasHeight){d=true}if(!e&&u.scrCoords[1]>=0&&u.scrCoords[1]<=f.board.canvasWidth&&u.scrCoords[2]>=0&&u.scrCoords[2]<=f.board.canvasHeight){a=true}if(Math.abs(A[1][0])<v.eps){o=A[0];h=A[2]}else{if(Math.abs(A[0][0])<v.eps){o=A[1];h=A[3]}else{if(A[1][2]<0){o=A[0];if(A[3][2]>f.board.canvasHeight){h=A[2]}else{h=A[3]}}else{if(A[1][2]>f.board.canvasHeight){o=A[2];if(A[3][2]<0){h=A[0]}else{h=A[3]}}else{o=A[1];if(A[3][2]<0){h=A[0]}else{if(A[3][2]>f.board.canvasHeight){h=A[2]}else{h=A[3]}}}}}}o=new JXG.Coords(JXG.COORDS_BY_SCREEN,o.slice(1),f.board);h=new JXG.Coords(JXG.COORDS_BY_SCREEN,h.slice(1),f.board);if(!d){if(!a){if(this.isSameDirection(w,u,o)){if(!this.isSameDirection(w,u,h)){y=o;z=h}else{if(f.board.algebra.affineDistance(u.usrCoords,o.usrCoords)<f.board.algebra.affineDistance(u.usrCoords,h.usrCoords)){z=o;y=h}else{y=o;z=h}}}else{if(this.isSameDirection(w,u,h)){z=o;y=h}else{if(f.board.algebra.affineDistance(u.usrCoords,o.usrCoords)<f.board.algebra.affineDistance(u.usrCoords,h.usrCoords)){y=o;z=h}else{z=o;y=h}}}}else{if(this.isSameDirection(u,w,o)){z=o}else{z=h}}}else{if(!a){if(this.isSameDirection(w,u,o)){y=o}else{y=h}}}if(z){w.setCoordinates(JXG.COORDS_BY_USER,z.usrCoords.slice(1))}if(y){u.setCoordinates(JXG.COORDS_BY_USER,y.usrCoords.slice(1))}};JXG.AbstractRenderer.prototype.isSameDirection=function(h,e,d){var b,a,g,f;b=e.usrCoords[1]-h.usrCoords[1];a=e.usrCoords[2]-h.usrCoords[2];g=d.usrCoords[1]-h.usrCoords[1];f=d.usrCoords[2]-h.usrCoords[2];if(Math.abs(b)<JXG.Math.eps){b=0}if(Math.abs(a)<JXG.Math.eps){a=0}if(Math.abs(g)<JXG.Math.eps){g=0}if(Math.abs(f)<JXG.Math.eps){f=0}if(b>=0&&g>=0){if((a>=0&&f>=0)||(a<=0&&f<=0)){return true}}else{if(b<=0&&g<=0){if((a>=0&&f>=0)||(a<=0&&f<=0)){return true}}}return false};JXG.AbstractRenderer.prototype.updateTicks=function(b,e,a,f,d){};JXG.AbstractRenderer.prototype.removeTicks=function(a){var b=this.getElementById(a.id+"_ticks");this.remove(b)};JXG.AbstractRenderer.prototype.drawArrow=function(a){var b=this.createPrimitive("line",a.id);this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.makeArrow(b,a);this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"lines");this.updateArrow(a)};JXG.AbstractRenderer.prototype.updateArrow=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setShadow(a);this.setDashStyle(a,a.visProp)}else{this.setDraft(a)}}this.updateLinePrimitive(a.rendNode,a.point1.coords.scrCoords[1],a.point1.coords.scrCoords[2],a.point2.coords.scrCoords[1],a.point2.coords.scrCoords[2])};JXG.AbstractRenderer.prototype.drawCurve=function(a){var b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"curves");this.appendNodesToElement(a,"path");this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.updateCurve(a)};JXG.AbstractRenderer.prototype.updateCurve=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.setShadow(a)}else{this.setDraft(a)}}this.updatePathPrimitive(a.rendNode,this.updatePathStringPrimitive(a),a.board)};JXG.AbstractRenderer.prototype.drawCircle=function(a){var b=this.createPrimitive("ellipse",a.id);this.appendChildPrimitive(b,"circles");this.appendNodesToElement(a,"ellipse");this.updateCircle(a)};JXG.AbstractRenderer.prototype.updateCircle=function(b){if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);this.setDashStyle(b,b.visProp);this.setShadow(b)}else{this.setDraft(b)}}var a=b.getRadius();if(a>0&&!isNaN(b.midpoint.coords.scrCoords[1]+b.midpoint.coords.scrCoords[2])){this.updateEllipsePrimitive(b.rendNode,b.midpoint.coords.scrCoords[1],b.midpoint.coords.scrCoords[2],(a*b.board.unitX*b.board.zoomX),(a*b.board.unitY*b.board.zoomY))}};JXG.AbstractRenderer.prototype.drawPolygon=function(a){var b=this.createPrimitive("polygon",a.id);a.visProp.fillOpacity=0.3;this.appendChildPrimitive(b,"polygone");this.appendNodesToElement(a,"polygon");this.updatePolygon(a)};JXG.AbstractRenderer.prototype.updatePolygon=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setShadow(a)}else{this.setDraft(a)}}this.updatePolygonePrimitive(a.rendNode,a)};JXG.AbstractRenderer.prototype.drawArc=function(a){};JXG.AbstractRenderer.prototype.updateArc=function(a){};JXG.AbstractRenderer.prototype.drawText=function(a){var b=this.container.ownerDocument.createElement("div");b.setAttribute("id",a.id);b.style.position="absolute";b.style.fontSize=a.board.fontSize+"px";b.style.color=a.visProp.strokeColor;b.className="JXGtext";b.style.zIndex="10";this.container.appendChild(b);a.rendNode=b;a.htmlStr="";this.updateText(a)};JXG.AbstractRenderer.prototype.updateText=function(a){if(a.visProp.visible==false){return}if(isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])){return}this.updateTextStyle(a);a.rendNode.style.left=(a.coords.scrCoords[1])+"px";a.rendNode.style.top=(a.coords.scrCoords[2]-this.vOffsetText)+"px";a.updateText();if(a.htmlStr!=a.plaintextStr){a.rendNode.innerHTML=a.plaintextStr;a.htmlStr=a.plaintextStr}};JXG.AbstractRenderer.prototype.updateTextStyle=function(b){var a;if(b.visProp.fontSize){if(typeof b.visProp.fontSize=="function"){a=b.visProp.fontSize();b.rendNode.style.fontSize=(a>0?a:0)}else{b.rendNode.style.fontSize=(b.visProp.fontSize)}}};JXG.AbstractRenderer.prototype.drawAngle=function(a){};JXG.AbstractRenderer.prototype.updateAngle=function(a){};JXG.AbstractRenderer.prototype.drawImage=function(a){};JXG.AbstractRenderer.prototype.updateImage=function(a){this.updateRectPrimitive(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1],a.size[0],a.size[1]);if(a.parent!=null){this.transformImageParent(a,a.parent.imageTransformMatrix)}else{this.transformImageParent(a)}this.transformImage(a,a.transformations)};JXG.AbstractRenderer.prototype.drawGrid=function(f){var A=f.gridX,y=f.gridY,w=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],f),g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[f.canvasWidth,f.canvasHeight],f),B=Math.ceil(w.usrCoords[1]),x=0,z,a,u,v,q,o,s,h,b,d,e;f.hasGrid=true;for(z=0;z<=A+1;z++){if(B-z/A<w.usrCoords[1]){x=z-1;break}}B=Math.floor(g.usrCoords[1]);a=0;for(z=0;z<=A+1;z++){if(B+z/A>g.usrCoords[1]){a=z-1;break}}B=Math.ceil(g.usrCoords[2]);v=0;for(z=0;z<=y+1;z++){if(B-z/y<g.usrCoords[2]){v=z-1;break}}B=Math.floor(w.usrCoords[2]);u=0;for(z=0;z<=y+1;z++){if(B+z/y>w.usrCoords[2]){u=z-1;break}}q=Math.round((1/A)*f.zoomX*f.unitX);o=Math.round((1/y)*f.zoomY*f.unitY);s=new JXG.Coords(JXG.COORDS_BY_USER,[Math.ceil(w.usrCoords[1])-x/A,Math.floor(w.usrCoords[2])+u/y],f);h=new JXG.Coords(JXG.COORDS_BY_USER,[Math.floor(g.usrCoords[1])+a/A,Math.ceil(g.usrCoords[2])-v/y],f);b=this.drawVerticalGrid(s,h,q,f);this.appendChildPrimitive(b,"grid");if(!f.snapToGrid){d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridx";this.setObjectStrokeColor(d,f.gridColor,f.gridOpacity)}else{d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridx";this.setObjectStrokeColor(d,"#FF8080",0.5)}this.setPropertyPrimitive(b,"stroke-width","0.4px");if(f.gridDash){this.setGridDash("gridx")}b=this.drawHorizontalGrid(s,h,o,f);this.appendChildPrimitive(b,"grid");if(!f.snapToGrid){d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridy";this.setObjectStrokeColor(d,f.gridColor,f.gridOpacity)}else{d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridy";this.setObjectStrokeColor(d,"#FF8080",0.5)}this.setPropertyPrimitive(b,"stroke-width","0.4px");if(f.gridDash){this.setGridDash("gridy")}};JXG.AbstractRenderer.prototype.removeGrid=function(a){};JXG.AbstractRenderer.prototype.hide=function(a){};JXG.AbstractRenderer.prototype.show=function(a){};JXG.AbstractRenderer.prototype.setObjectStrokeWidth=function(b,a){};JXG.AbstractRenderer.prototype.setObjectStrokeColor=function(d,a,b){};JXG.AbstractRenderer.prototype.setObjectFillColor=function(d,a,b){};JXG.AbstractRenderer.prototype.setDraft=function(b){if(!b.visProp.draft){return}var a=b.board.options.elements.draft.color,d=b.board.options.elements.draft.opacity;if(b.type==JXG.OBJECTT_TYPE_POLYGON){this.setObjectFillColor(b,a,d)}else{if(b.elementClass==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(b,a,d)}else{this.setObjectFillColor(b,"none",0)}this.setObjectStrokeColor(b,a,d);this.setObjectStrokeWidth(b,b.board.options.elements.draft.strokeWidth)}};JXG.AbstractRenderer.prototype.removeDraft=function(a){if(a.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillColorOpacity)}else{if(a.type==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillColorOpacity)}this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeColorOpacity);this.setObjectStrokeWidth(a,a.visProp.strokeWidth)}};JXG.AbstractRenderer.prototype.highlight=function(b){var a;if(b.visProp.draft==false){if(b.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity);this.setObjectFillColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity)}else{if(b.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(b,b.visProp.highlightFillColor,b.visProp.highlightFillOpacity);for(a=0;a<b.borders.length;a++){this.setObjectStrokeColor(b.borders[a],b.borders[a].visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity)}}else{this.setObjectStrokeColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity);this.setObjectFillColor(b,b.visProp.highlightFillColor,b.visProp.highlightFillOpacity)}}}};JXG.AbstractRenderer.prototype.noHighlight=function(b){var a;if(b.visProp.draft==false){if(b.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity)}else{if(b.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);for(a=0;a<b.borders.length;a++){this.setObjectStrokeColor(b.borders[a],b.borders[a].visProp.strokeColor,b.visProp.strokeOpacity)}}else{this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity)}}}};JXG.AbstractRenderer.prototype.remove=function(a){};JXG.AbstractRenderer.prototype.suspendRedraw=function(){};JXG.AbstractRenderer.prototype.unsuspendRedraw=function(){};JXG.AbstractRenderer.prototype.drawZoomBar=function(h){var o,d,g,f,b,q,k,a,e;o=this.container.ownerDocument;d=o.createElement("div");d.className="JXGtext";d.style.color="#aaaaaa";d.style.backgroundColor="#f5f5f5";d.style.padding="2px";d.style.position="absolute";d.style.fontSize="10px";d.style.cursor="pointer";d.style.zIndex="100";this.container.appendChild(d);d.style.right="5px";d.style.bottom="5px";g=o.createElement("span");d.appendChild(g);g.innerHTML="&nbsp;&ndash;&nbsp;";JXG.addEvent(g,"click",h.zoomOut,h);f=o.createElement("span");d.appendChild(f);f.innerHTML="&nbsp;o&nbsp;";JXG.addEvent(f,"click",h.zoom100,h);b=o.createElement("span");d.appendChild(b);b.innerHTML="&nbsp;+&nbsp;";JXG.addEvent(b,"click",h.zoomIn,h);q=o.createElement("span");d.appendChild(q);q.innerHTML="&nbsp;&larr;&nbsp;";JXG.addEvent(q,"click",h.clickLeftArrow,h);k=o.createElement("span");d.appendChild(k);k.innerHTML="&nbsp;&uarr;&nbsp;";JXG.addEvent(k,"click",h.clickUpArrow,h);a=o.createElement("span");d.appendChild(a);a.innerHTML="&nbsp;&darr;&nbsp;";JXG.addEvent(a,"click",h.clickDownArrow,h);e=o.createElement("span");d.appendChild(e);e.innerHTML="&nbsp;&rarr;&nbsp;";JXG.addEvent(e,"click",h.clickRightArrow,h)};JXG.AbstractRenderer.prototype.getElementById=function(a){return document.getElementById(a)};JXG.AbstractRenderer.prototype.findSplit=function(A,o,h){var u=0,q=o,s,g,B,z,y,e,x,b,v,w,a;if(h-o<2){return[-1,0]}B=A[o].scrCoords;z=A[h].scrCoords;if(isNaN(B[1]+B[2]+z[1]+z[2])){return[NaN,h]}for(g=o+1;g<h;g++){y=A[g].scrCoords;e=y[1]-B[1];x=y[2]-B[2];b=z[1]-B[1];v=z[2]-B[2];w=b*b+v*v;if(w>=JXG.Math.eps){a=(e*b+x*v)/w;s=e*e+x*x-a*(e*b+x*v)}else{a=0;s=e*e+x*x}if(a<0){s=e*e+x*x}else{if(a>1){e=y[1]-z[1];x=y[2]-z[2];s=e*e+x*x}}if(s>u){u=s;q=g}}return[Math.sqrt(u),q]};JXG.AbstractRenderer.prototype.RDP=function(g,f,e,b,d){var a=this.findSplit(g,f,e);if(a[0]>b){this.RDP(g,f,a[1],b,d);this.RDP(g,a[1],e,b,d)}else{d.push(g[e])}};JXG.AbstractRenderer.prototype.RamenDouglasPeuker=function(g,b){var e=[],f,d,a;a=g.length;f=0;while(f<a&&isNaN(g[f].scrCoords[1]+g[f].scrCoords[2])){f++}d=a-1;while(d>f&&isNaN(g[d].scrCoords[1]+g[d].scrCoords[2])){d--}if(f>d||f==a){return[]}e[0]=g[f];this.RDP(g,f,d,b,e);return e};JXG.AbstractRenderer.prototype.setShadow=function(a){};JXG.AbstractRenderer.prototype.updatePathStringPoint=function(d,a,b){};JXG.FileReader=new function(){this.parseFileContent=function(a,b,f){this.request=false;var d;try{this.request=new XMLHttpRequest();if(f.toLowerCase()=="raw"){this.request.overrideMimeType("text/plain; charset=iso-8859-1")}else{this.request.overrideMimeType("text/xml; charset=iso-8859-1")}}catch(d){try{this.request=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{this.request=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){this.request=false}}}if(!this.request){alert("AJAX not activated!");return}this.request.open("GET",a,true);if(f.toLowerCase()=="raw"){this.cbp=function(){var e=this.request;if(e.readyState==4){b(e.responseText)}}}else{this.cbp=function(){var e=this.request;if(e.readyState==4){this.parseString(e.responseText,b,f,a)}}}this.cb=JXG.bind(this.cbp,this);this.request.onreadystatechange=this.cb;this.request.send(null)};this.cleanWhitespace=function(a){var b=a.firstChild;while(b!=null){if(b.nodeType==3&&!/\S/.test(b.nodeValue)){a.removeChild(b)}else{if(b.nodeType==1){this.cleanWhitespace(b)}}b=b.nextSibling}};this.stringToXMLTree=function(b){if(typeof DOMParser=="undefined"){DOMParser=function(){};DOMParser.prototype.parseFromString=function(f,g){if(typeof ActiveXObject!="undefined"){var e=new ActiveXObject("MSXML.DomDocument");e.loadXML(f);return e}}}var d=new DOMParser();var a=d.parseFromString(b,"text/xml");this.cleanWhitespace(a);return a};this.parseString=function(e,d,f,b){if(f.toLowerCase()=="geonext"){e=JXG.GeonextReader.prepareString(e)}if(f.toLowerCase()=="geogebra"){e=JXG.GeogebraReader.prepareString(e)}if(f.toLowerCase()=="intergeo"){e=JXG.IntergeoReader.prepareString(e)}d.xmlString=e;var a=this.stringToXMLTree(e);this.readElements(a,d,f)};this.readElements=function(a,b,d){if(d.toLowerCase()=="geonext"){b.suspendUpdate();if(a.getElementsByTagName("GEONEXT").length!=0){JXG.GeonextReader.readGeonext(a,b)}b.unsuspendUpdate()}else{if(a.getElementsByTagName("geogebra").length!=0){JXG.GeogebraReader.readGeogebra(a,b)}else{if(d.toLowerCase()=="intergeo"){JXG.IntergeoReader.readIntergeo(a,b)}}}b.afterLoad()}};JXG.GeonextReader=new function(){this.changeOriginIds=function(a,b){if((b=="gOOe0")||(b=="gXOe0")||(b=="gYOe0")||(b=="gXLe0")||(b=="gYLe0")){return a.id+b}else{return b}};this.colorProperties=function(b,a){b.colorStroke=a.getElementsByTagName("color")[0].getElementsByTagName("stroke")[0].firstChild.data;b.highlightStrokeColor=a.getElementsByTagName("color")[0].getElementsByTagName("lighting")[0].firstChild.data;b.colorFill=a.getElementsByTagName("color")[0].getElementsByTagName("fill")[0].firstChild.data;b.colorLabel=a.getElementsByTagName("color")[0].getElementsByTagName("label")[0].firstChild.data;b.colorDraft=a.getElementsByTagName("color")[0].getElementsByTagName("draft")[0].firstChild.data;return b};this.firstLevelProperties=function(f,d){var a=d.childNodes,e,b;for(e=0;e<a.length;e++){if(a[e].firstChild!=null&&a[e].nodeName!="data"&&a[e].nodeName!="straight"){b=a[e].nodeName;f[b]=a[e].firstChild.data}}return f};this.boardProperties=function(b,a){return b};this.defProperties=function(b,a){if(a.nodeType==3||a.nodeType==8){return null}b.ident=a.nodeName;if(b.ident=="text"||b.ident=="intersection"||b.ident=="composition"){b.name=""}else{b.name=a.getElementsByTagName("name")[0].firstChild.data}b.id=a.getElementsByTagName("id")[0].firstChild.data;return b};this.visualProperties=function(b,a){b.visible=a.getElementsByTagName("visible")[0].firstChild.data;b.trace=a.getElementsByTagName("trace")[0].firstChild.data;return b};this.readNodes=function(h,e,b,f){var a=e.getElementsByTagName(b)[0].childNodes,d,g;for(g=0;g<a.length;g++){if(a[g].firstChild!=null){if(f!=null){d=f+JXG.capitalize(a[g].nodeName)}else{d=a[g].nodeName}h[d]=a[g].firstChild.data}}return h};this.subtreeToString=function(a){try{return(new XMLSerializer()).serializeToString(a)}catch(b){return a.xml}return null};this.readImage=function(d){var b="",a=d;if(a!=null){b=a.data;while(a.nextSibling!=null){a=a.nextSibling;b+=a.data}}return b};this.parseImage=function(o,k,a,u,s,v,g,e){var B,A,z,d,q,f,b;if(k==null){return null}if(k.getElementsByTagName("src")[0]!=null){B="src"}else{if(k.getElementsByTagName("image")[0]!=null){B="image"}else{return null}}b=this.readImage(k.getElementsByTagName(B)[0].firstChild);if(b!=""){if(B=="src"){u=k.getElementsByTagName("x")[0].firstChild.data;s=k.getElementsByTagName("y")[0].firstChild.data;v=k.getElementsByTagName("width")[0].firstChild.data;g=k.getElementsByTagName("height")[0].firstChild.data}else{f=document.createElement("img");f.setAttribute("id","tmpimg");f.style.display="none";document.getElementsByTagName("body")[0].appendChild(f);f.setAttribute("src","data:image/png;base64,"+b);A=f.width;z=f.height;A=(A==0)?3:A;z=(z==0)?3:z;s-=z*v/A*0.5;g=z*v/A;document.getElementsByTagName("body")[0].removeChild(f)}if(e!=null){d=e.id+"_image"}else{d=false}q=new JXG.Image(o,b,[u,s],[v,g],a,d,false,e);return q}};this.readConditions=function(g,f){var b,d,h,a;f.conditions="";if(g!=null){for(b=0;b<g.getElementsByTagName("data").length;b++){d;h;a=g.getElementsByTagName("data")[b];d=JXG.GeonextReader.subtreeToString(a);f.conditions+=d}}};this.printDebugMessage=function(a,e,d,b){};this.readGeonext=function(w,q){var v={},x,A,z,o,B,y,b,g,e,d,a,h,f,u,k;boardData=w.getElementsByTagName("board")[0];v.ident="board";v.id=boardData.getElementsByTagName("id")[0].firstChild.data;v.width=boardData.getElementsByTagName("width")[0].firstChild.data;v.height=boardData.getElementsByTagName("height")[0].firstChild.data;g=boardData.getElementsByTagName("fontsize")[0];v.fontSize=(g!=null)?document.body.style.fontSize=g.firstChild.data:document.body.style.fontSize;v.modus=boardData.getElementsByTagName("modus")[0].firstChild.data;g=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("origin")[0];v.originX=g.getElementsByTagName("x")[0].firstChild.data;v.originY=g.getElementsByTagName("y")[0].firstChild.data;g=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("zoom")[0];v.zoomX=g.getElementsByTagName("x")[0].firstChild.data;v.zoomY=g.getElementsByTagName("y")[0].firstChild.data;g=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("unit")[0];v.unitX=g.getElementsByTagName("x")[0].firstChild.data;v.unitY=g.getElementsByTagName("y")[0].firstChild.data;g=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("viewport")[0];v.viewportTop=g.getElementsByTagName("top")[0].firstChild.data;v.viewportLeft=g.getElementsByTagName("left")[0].firstChild.data;v.viewportBottom=g.getElementsByTagName("bottom")[0].firstChild.data;v.viewportRight=g.getElementsByTagName("right")[0].firstChild.data;this.readConditions(boardData.getElementsByTagName("conditions")[0],v);q.origin={};q.origin.usrCoords=[1,0,0];q.origin.scrCoords=[1,1*v.originX,1*v.originY];q.zoomX=1*v.zoomX;q.zoomY=1*v.zoomY;q.unitX=1*v.unitX;q.unitY=1*v.unitY;if(1*v.fontSize!=0){q.fontSize=1*v.fontSize}else{q.fontSize=12}q.geonextCompatibilityMode=true;delete (JXG.JSXGraph.boards[q.id]);q.id=v.id;JXG.JSXGraph.boards[q.id]=q;q.initGeonextBoard();q.renderer.enhancedRendering=true;JXG.GeonextReader.parseImage(q,boardData.getElementsByTagName("file")[0],"images");x=(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("snap")[0].firstChild.data=="true")?q.snapToGrid=true:null;A=(boardData.getElementsByTagName("grid")[1].getElementsByTagName("x")[0].firstChild.data)?q.gridX=boardData.getElementsByTagName("grid")[1].getElementsByTagName("x")[0].firstChild.data*1:null;z=(boardData.getElementsByTagName("grid")[1].getElementsByTagName("y")[0].firstChild.data)?q.gridY=boardData.getElementsByTagName("grid")[1].getElementsByTagName("y")[0].firstChild.data*1:null;q.calculateSnapSizes();o=boardData.getElementsByTagName("grid")[1].getElementsByTagName("dash")[0].firstChild.data;q.gridDash=q.algebra.str2Bool(o);B=boardData.getElementsByTagName("grid")[1].getElementsByTagName("color")[0].firstChild.data;if(B.length=="9"&&B.substr(0,1)=="#"){y=B.substr(7,2);y=parseInt(y.toUpperCase(),16)/255;B=B.substr(0,7)}else{y="1"}q.gridColor=B;q.gridOpacity=y;b=(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("grid")[0].firstChild.data=="true")?q.renderer.drawGrid(q):null;if(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("coord")[0].firstChild.data=="true"){e=q.createElement("axis",[[0,0],[1,0]]);e.setProperty("strokeColor:"+e.visProp.strokeColor,"strokeWidth:"+e.visProp.strokeWidth,"fillColor:none","highlightStrokeColor:"+e.visProp.highlightStrokeColor,"highlightFillColor:none","visible:true");d=q.createElement("axis",[[0,0],[0,1]]);d.setProperty("strokeColor:"+d.visProp.strokeColor,"strokeWidth:"+d.visProp.strokeWidth,"fillColor:none","highlightStrokeColor:"+d.visProp.highlightStrokeColor,"highlightFillColor:none","visible:true")}a=boardData.getElementsByTagName("background")[0].getElementsByTagName("color")[0].firstChild.data;h=1;if(a.length=="9"&&a.substr(0,1)=="#"){h=a.substr(7,2);a=a.substr(0,7)}q.containerObj.style.backgroundColor=a;f=w.getElementsByTagName("elements")[0].childNodes;for(u=0;u<f.length;u++){(function(V){var ac,ae={},Z,R,P,T,ad,ai,H,F,aj,L=[],ak=[],af=[],ah=[],G=[],D=[],ab=[],aa=[],Q=[],U=[],O=[],C,J,S,E,Y,W,K,I,N,X;k=f[V];ae=JXG.GeonextReader.defProperties(ae,k);if(ae==null){return}switch(k.nodeName.toLowerCase()){case"point":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae.fixed=k.getElementsByTagName("fix")[0].firstChild.data;JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"points");try{X=new JXG.Point(q,[1*ae.x,1*ae.y],ae.id,ae.name,true);X.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorStroke,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.highlightStrokeColor,"labelColor:"+ae.colorLabel,"visible:"+ae.visible,"fixed:"+ae.fixed,"draft:"+ae.draft);X.setStyle(1*ae.style);X.traced=(ae.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK")}catch(ag){alert(ag)}break;case"line":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae=JXG.GeonextReader.readNodes(ae,k,"straight","straight");ae.first=JXG.GeonextReader.changeOriginIds(q,ae.first);ae.last=JXG.GeonextReader.changeOriginIds(q,ae.last);Z=new JXG.Line(q,ae.first,ae.last,ae.id,ae.name);R=Z.point1.coords.usrCoords[1];P=Z.point1.coords.usrCoords[2];T=Z.point1.coords.distance(JXG.COORDS_BY_USER,Z.point2.coords);ad=0;Z.image=JXG.GeonextReader.parseImage(q,k,"lines",R,P,T,ad,Z);ae.straightFirst=(ae.straightFirst=="false")?false:true;ae.straightLast=(ae.straightLast=="false")?false:true;Z.setStraight(ae.straightFirst,ae.straightLast);Z.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"labelColor:"+ae.colorLabel,"visible:"+ae.visible,"dash:"+ae.dash,"draft:"+ae.draft);Z.traced=(ae.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"circle":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.midpoint=k.getElementsByTagName("data")[0].getElementsByTagName("midpoint")[0].firstChild.data;JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"circles");if(k.getElementsByTagName("data")[0].getElementsByTagName("radius").length>0){ae.radiuspoint=k.getElementsByTagName("data")[0].getElementsByTagName("radius")[0].firstChild.data;ae.radius=null;ae.method="twoPoints"}else{if(k.getElementsByTagName("data")[0].getElementsByTagName("radiusvalue").length>0){ae.radiuspoint=null;ae.radius=k.getElementsByTagName("data")[0].getElementsByTagName("radiusvalue")[0].firstChild.data;ae.radiusnum=k.getElementsByTagName("data")[0].getElementsByTagName("radiusnum")[0].firstChild.data;ae.method="pointRadius"}}if(ae.method=="twoPoints"){if(q.objects[ae.radiuspoint].type==JXG.OBJECT_TYPE_LINE){ae.method="pointLine";ae.radiuspoint=JXG.GeonextReader.changeOriginIds(q,ae.radiuspoint)}else{if(q.objects[ae.radiuspoint].type==JXG.OBJECT_TYPE_CIRCLE){ae.method="pointCircle"}}}if(ae.method=="pointRadius"){ae.midpoint=JXG.GeonextReader.changeOriginIds(q,ae.midpoint);ai=new JXG.Circle(q,ae.method,ae.midpoint,ae.radius,ae.id,ae.name)}else{ae.midpoint=JXG.GeonextReader.changeOriginIds(q,ae.midpoint);ai=new JXG.Circle(q,ae.method,ae.midpoint,ae.radiuspoint,ae.id,ae.name)}ai.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"visible:"+ae.visible,"labelColor:"+ae.colorLabel,"dash:"+ae.dash,"draft:"+ae.draft);ai.traced=(ae.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"slider":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae.fixed=k.getElementsByTagName("fix")[0].firstChild.data;ae=JXG.GeonextReader.readNodes(ae,k,"animate","animate");JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"points");try{X=new JXG.Point(q,[1*ae.x,1*ae.y],ae.id,ae.name,true);ae.parent=JXG.GeonextReader.changeOriginIds(q,ae.parent);X.makeGlider(ae.parent);X.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorStroke,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.highlightStrokeColor,"visible:"+ae.visible,"fixed:"+ae.fixed,"labelColor:"+ae.colorLabel,"draft:"+ae.draft);X.onPolygon=q.algebra.str2Bool(ae.onpolygon);X.traced=(ae.trace=="false")?false:true;X.setStyle(1*ae.style);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK")}catch(ag){}break;case"cas":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.fixed=k.getElementsByTagName("fix")[0].firstChild.data;ae=JXG.GeonextReader.readNodes(ae,k,"data");JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"points");X=new JXG.Point(q,[1*ae.xval,1*ae.yval],ae.id,ae.name,true);X.addConstraint([ae.x,ae.y]);X.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorStroke,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.highlightStrokeColor,"visible:"+ae.visible,"fixed:"+ae.fixed,"labelColor:"+ae.colorLabel,"draft:"+ae.draft);X.traced=(ae.trace=="false")?false:true;X.setStyle(1*ae.style);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"intersection":ae=JXG.GeonextReader.readNodes(ae,k,"data");g=k.getElementsByTagName("first")[1];ae.outputFirstId=g.getElementsByTagName("id")[0].firstChild.data;ae.outputFirstName=g.getElementsByTagName("name")[0].firstChild.data;ae.outputFirstVisible=g.getElementsByTagName("visible")[0].firstChild.data;ae.outputFirstTrace=g.getElementsByTagName("trace")[0].firstChild.data;ae.outputFirstFixed=g.getElementsByTagName("fix")[0].firstChild.data;ae.outputFirstStyle=g.getElementsByTagName("style")[0].firstChild.data;ae.outputFirstStrokewidth=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("first")[1].getElementsByTagName("color")[0];ae.outputFirstColorStroke=g.getElementsByTagName("stroke")[0].firstChild.data;ae.outputFirstHighlightStrokeColor=g.getElementsByTagName("lighting")[0].firstChild.data;ae.outputFirstColorFill=g.getElementsByTagName("fill")[0].firstChild.data;ae.outputFirstColorLabel=g.getElementsByTagName("label")[0].firstChild.data;ae.outputFirstColorDraft=g.getElementsByTagName("draft")[0].firstChild.data;ae.first=JXG.GeonextReader.changeOriginIds(q,ae.first);ae.last=JXG.GeonextReader.changeOriginIds(q,ae.last);if((((q.objects[ae.first]).type==(q.objects[ae.last]).type)&&((q.objects[ae.first]).type==JXG.OBJECT_TYPE_LINE||(q.objects[ae.first]).type==JXG.OBJECT_TYPE_ARROW))||(((q.objects[ae.first]).type==JXG.OBJECT_TYPE_LINE)&&((q.objects[ae.last]).type==JXG.OBJECT_TYPE_ARROW))||(((q.objects[ae.last]).type==JXG.OBJECT_TYPE_LINE)&&((q.objects[ae.first]).type==JXG.OBJECT_TYPE_ARROW))){inter=new JXG.Intersection(q,ae.id,q.objects[ae.first],q.objects[ae.last],ae.outputFirstId,"",ae.outputFirstName,"");if(ae.outputFirstVisible=="false"){inter.hideElement()}inter.p.setProperty("strokeColor:"+ae.outputFirstColorStroke,"strokeWidth:"+ae.outputFirstStrokewidth,"fillColor:"+ae.outputFirstColorStroke,"highlightStrokeColor:"+ae.outputFirstHighlightStrokeColor,"highlightFillColor:"+ae.outputFirstHighlightStrokeColor,"visible:"+ae.outputFirstVisible,"labelColor:"+ae.outputFirstColorLabel,"draft:"+ae.draft);inter.p.setStyle(1*ae.outputFirstStyle);inter.p.traced=(ae.outputFirstTrace=="false")?false:true}else{g=k.getElementsByTagName("last")[1];ae.outputLastId=g.getElementsByTagName("id")[0].firstChild.data;ae.outputLastName=g.getElementsByTagName("name")[0].firstChild.data;ae.outputLastVisible=g.getElementsByTagName("visible")[0].firstChild.data;ae.outputLastTrace=g.getElementsByTagName("trace")[0].firstChild.data;ae.outputLastFixed=g.getElementsByTagName("fix")[0].firstChild.data;ae.outputLastStyle=g.getElementsByTagName("style")[0].firstChild.data;ae.outputLastStrokewidth=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("last")[1].getElementsByTagName("color")[0];ae.outputLastColorStroke=g.getElementsByTagName("stroke")[0].firstChild.data;ae.outputLastHighlightStrokeColor=g.getElementsByTagName("lighting")[0].firstChild.data;ae.outputLastColorFill=g.getElementsByTagName("fill")[0].firstChild.data;ae.outputLastColorLabel=g.getElementsByTagName("label")[0].firstChild.data;ae.outputLastColorDraft=g.getElementsByTagName("draft")[0].firstChild.data;inter=new JXG.Intersection(q,ae.id,q.objects[ae.first],q.objects[ae.last],ae.outputFirstId,ae.outputLastId,ae.outputFirstName,ae.outputLastName);inter.p1.setProperty("strokeColor:"+ae.outputFirstColorStroke,"strokeWidth:"+ae.outputFirstStrokewidth,"fillColor:"+ae.outputFirstColorStroke,"highlightStrokeColor:"+ae.outputFirstHighlightStrokeColor,"highlightFillColor:"+ae.outputFirstHighlightStrokeColor,"visible:"+ae.outputFirstVisible,"labelColor:"+ae.outputFirstColorLabel,"draft:"+ae.draft);inter.p1.setStyle(1*ae.outputFirstStyle);inter.p1.traced=(ae.outputFirstTrace=="false")?false:true;inter.p2.setProperty("strokeColor:"+ae.outputLastColorStroke,"strokeWidth:"+ae.outputLastStrokewidth,"fillColor:"+ae.outputLastColorStroke,"highlightStrokeColor:"+ae.outputLastHighlightStrokeColor,"highlightFillColor:"+ae.outputLastHighlightStrokeColor,"visible:"+ae.outputLastVisible,"labelColor:"+ae.outputLastColorLabel,"draft:"+ae.draft);inter.p2.setStyle(1*ae.outputLastStyle);inter.p2.traced=(ae.outputLastTrace=="false")?false:true;if(ae.outputFirstVisible=="false"){if(ae.outputLastVisible=="false"){inter.hideElement()}else{inter.p1.hideElement()}}else{if(ae.outputLastVisible=="false"){inter.p2.hideElement()}}}JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"composition":ae=JXG.GeonextReader.readNodes(ae,k,"data");ae=JXG.GeonextReader.firstLevelProperties(ae,k);switch(ae.type){case"210070":ae.typeName="ARROW_PARALLEL";break;case"210080":ae.typeName="BISECTOR";break;case"210090":ae.typeName="CIRCUMCIRCLE";break;case"210100":ae.typeName="CIRCUMCIRCLE_CENTER";break;case"210110":ae.typeName="MIDPOINT";break;case"210120":ae.typeName="MIRROR_LINE";break;case"210125":ae.typeName="MIRROR_POINT";break;case"210130":ae.typeName="NORMAL";break;case"210140":ae.typeName="PARALLEL";break;case"210150":ae.typeName="PARALLELOGRAM_POINT";break;case"210160":ae.typeName="PERPENDICULAR";break;case"210170":ae.typeName="PERPENDICULAR_POINT";break;case"210180":ae.typeName="ROTATION";break;case"210190":ae.typeName="SECTOR";break}ae.defEl=[];H=0;g=k.getElementsByTagName("data")[0].getElementsByTagName("input");for(ac=0;ac<g.length;ac++){ae.defEl[ac]=g[ac].firstChild.data;H=ac+1}g=k.getElementsByTagName("output")[0];ae.outputId=g.getElementsByTagName("id")[0].firstChild.data;ae.outputName=g.getElementsByTagName("name")[0].firstChild.data;ae.outputVisible=g.getElementsByTagName("visible")[0].firstChild.data;ae.outputTrace=g.getElementsByTagName("trace")[0].firstChild.data;ae=JXG.GeonextReader.readNodes(ae,k,"output","output");ae.outputName=g.getElementsByTagName("name")[0].firstChild.data;ae.outputDash=g.getElementsByTagName("dash")[0].firstChild.data;ae.outputDraft=g.getElementsByTagName("draft")[0].firstChild.data;ae.outputStrokewidth=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("output")[0].getElementsByTagName("color")[0];ae.outputColorStroke=g.getElementsByTagName("stroke")[0].firstChild.data;ae.outputHighlightStrokeColor=g.getElementsByTagName("lighting")[0].firstChild.data;ae.outputColorFill=g.getElementsByTagName("fill")[0].firstChild.data;ae.outputColorLabel=g.getElementsByTagName("label")[0].firstChild.data;ae.outputColorDraft=g.getElementsByTagName("draft")[0].firstChild.data;ae.defEl[0]=JXG.GeonextReader.changeOriginIds(q,ae.defEl[0]);ae.defEl[1]=JXG.GeonextReader.changeOriginIds(q,ae.defEl[1]);ae.defEl[2]=JXG.GeonextReader.changeOriginIds(q,ae.defEl[2]);if(ae.typeName=="MIDPOINT"){if(H==2){q.addMidpoint(ae.defEl[0],ae.defEl[1],ae.outputId,ae.outputName)}else{if(H==1){q.addMidpoint(q.objects[ae.defEl[0]].point1.id,q.objects[ae.defEl[0]].point2.id,ae.outputId,ae.outputName)}}}else{if(ae.typeName=="NORMAL"){q.addNormal(ae.defEl[1],ae.defEl[0],ae.outputId,ae.outputName)}else{if(ae.typeName=="PARALLEL"){q.addParallel(ae.defEl[1],ae.defEl[0],ae.outputId,ae.outputName)}else{if(ae.typeName=="CIRCUMCIRCLE"){F=k.getElementsByTagName("output")[1].getElementsByTagName("id")[0].firstChild.data;aj=k.getElementsByTagName("output")[1].getElementsByTagName("name")[0].firstChild.data;q.addCircumcenter(ae.defEl[0],ae.defEl[1],ae.defEl[2],ae.outputId,ae.outputName,F,aj)}else{if(ae.typeName=="CIRCUMCIRCLE_CENTER"){q.addCircumcenterMidpoint(ae.defEl[0],ae.defEl[1],ae.defEl[2],ae.outputId,ae.outputName)}else{if(ae.typeName=="BISECTOR"){q.addAngleBisector(ae.defEl[0],ae.defEl[1],ae.defEl[2],ae.outputId,ae.outputName)}else{if(ae.typeName=="MIRROR_LINE"){q.addReflection(ae.defEl[1],ae.defEl[0],ae.outputId,ae.outputName)}else{if(ae.typeName=="MIRROR_POINT"){q.addRotation(ae.defEl[0],ae.defEl[1],Math.PI,ae.outputId,ae.outputName)}else{if(ae.typeName=="PARALLELOGRAM_POINT"){if(ae.defEl.length==2){q.addParallelPoint(JXG.getReference(ae.defEl[0]).point1,JXG.getReference(ae.defEl[0]).point2,ae.defEl[1],ae.outputId,ae.outputName)}else{q.addParallelPoint(ae.defEl[0],ae.defEl[1],ae.defEl[2],ae.outputId,ae.outputName)}}else{if(ae.typeName=="SECTOR"){JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"sectors");for(ac=0;ac<k.getElementsByTagName("output").length;ac++){g=k.getElementsByTagName("output")[ac];L[ac]=g.getElementsByTagName("id")[0].firstChild.data;L[ac]=JXG.GeonextReader.changeOriginIds(q,L[ac]);ak[ac]=g.getElementsByTagName("name")[0];af[ac]=g.getElementsByTagName("visible")[0].firstChild.data;ah[ac]=g.getElementsByTagName("trace")[0].firstChild.data;G[ac]=g.getElementsByTagName("dash")[0].firstChild.data;D[ac]=g.getElementsByTagName("draft")[0].firstChild.data;ab[ac]=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("output")[ac].getElementsByTagName("color")[0];aa[ac]=g.getElementsByTagName("stroke")[0].firstChild.data;Q[ac]=g.getElementsByTagName("lighting")[0].firstChild.data;U[ac]=g.getElementsByTagName("fill")[0].firstChild.data;O[ac]=g.getElementsByTagName("label")[0].firstChild.data}C=new JXG.Sector(q,ae.defEl[0],ae.defEl[1],ae.defEl[2],[L[0],L[1],L[2],L[3]],[ak[0].firstChild.data,ak[1].firstChild.data,ak[2].firstChild.data,ak[3].firstChild.data],ae.id);J=L[0];q.objects[J].setProperty("strokeColor:"+aa[0],"strokeWidth:"+ab[0],"fillColor:"+U[0],"highlightStrokeColor:"+Q[0],"highlightFillColor:"+U[0],"visible:"+af[0],"dash:"+G[0],"draft:"+D[0]);q.objects[J].traced=(ah[0]=="false")?false:true;ae.firstArrow=k.getElementsByTagName("output")[0].getElementsByTagName("firstarrow")[0].firstChild.data;ae.lastArrow=k.getElementsByTagName("output")[0].getElementsByTagName("lastarrow")[0].firstChild.data;ae.firstArrow=(ae.firstArrow=="false")?false:true;ae.lastArrow=(ae.lastArrow=="false")?false:true;q.objects[J].setArrow(ae.firstArrow,ae.lastArrow);S=L[1];ae.fixed=k.getElementsByTagName("output")[1].getElementsByTagName("fix")[0].firstChild.data;q.objects[S].setProperty("strokeColor:"+aa[1],"strokeWidth:"+ab[1],"fillColor:"+aa[1],"highlightStrokeColor:"+Q[1],"highlightFillColor:"+Q[1],"visible:"+af[1],"fixed:"+ae.fixed,"labelColor:"+O[1],"draft:"+D[1]);ae.style=k.getElementsByTagName("output")[1].getElementsByTagName("style")[0].firstChild.data;q.objects[S].setStyle(1*ae.style);q.objects[S].traced=(ah[1]=="false")?false:true;E=L[2];g=k.getElementsByTagName("output")[2].getElementsByTagName("straight")[0];ae.straightFirst=g.getElementsByTagName("first")[0].firstChild.data;ae.straightLast=g.getElementsByTagName("last")[0].firstChild.data;ae.straightFirst=(ae.straightFirst=="false")?false:true;ae.straightLast=(ae.straightLast=="false")?false:true;q.objects[E].setStraight(ae.straightFirst,ae.straightLast);q.objects[E].setProperty("strokeColor:"+aa[2],"strokeWidth:"+ab[2],"fillColor:"+U[2],"highlightStrokeColor:"+Q[2],"highlightFillColor:"+U[2],"visible:"+af[2],"dash:"+G[2],"draft:"+D[2]);q.objects[E].traced=(ah[2]=="false")?false:true;Y=L[3];g=k.getElementsByTagName("output")[3].getElementsByTagName("straight")[0];ae.straightFirst=g.getElementsByTagName("first")[0].firstChild.data;ae.straightLast=g.getElementsByTagName("last")[0].firstChild.data;ae.straightFirst=(ae.straightFirst=="false")?false:true;ae.straightLast=(ae.straightLast=="false")?false:true;q.objects[Y].setStraight(ae.straightFirst,ae.straightLast);q.objects[Y].setProperty("strokeColor:"+aa[3],"strokeWidth:"+ab[3],"fillColor:"+U[3],"highlightStrokeColor:"+Q[3],"highlightFillColor:"+U[3],"visible:"+af[3],"dash:"+G[3],"draft:"+D[3]);q.objects[Y].traced=(ah[3]=="false")?false:true}else{if(ae.typeName=="PERPENDICULAR"){for(ac=0;ac<k.getElementsByTagName("output").length;ac++){g=k.getElementsByTagName("output")[ac];L[ac]=g.getElementsByTagName("id")[0].firstChild.data;L[ac]=JXG.GeonextReader.changeOriginIds(q,L[ac]);ak[ac]=g.getElementsByTagName("name")[0];af[ac]=g.getElementsByTagName("visible")[0].firstChild.data;ah[ac]=g.getElementsByTagName("trace")[0].firstChild.data;G[ac]=g.getElementsByTagName("dash")[0].firstChild.data;D[ac]=g.getElementsByTagName("draft")[0].firstChild.data;ab[ac]=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("output")[ac].getElementsByTagName("color")[0];aa[ac]=g.getElementsByTagName("stroke")[0].firstChild.data;Q[ac]=g.getElementsByTagName("lighting")[0].firstChild.data;U[ac]=g.getElementsByTagName("fill")[0].firstChild.data;O[ac]=g.getElementsByTagName("label")[0].firstChild.data}ae.outputFixed=k.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ae.outputStyle=k.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;q.createElement("perpendicular",[ae.defEl[1],ae.defEl[0]],{name:[ak[1].firstChild.data,ak[0].firstChild.data],id:[L[1],L[0]]});W=L[0];q.objects[W].setProperty("strokeColor:"+aa[0],"strokeWidth:"+ab[0],"fillColor:"+aa[0],"highlightStrokeColor:"+Q[0],"highlightFillColor:"+Q[0],"visible:"+af[0],"fixed:"+ae.outputFixed,"labelColor:"+O[0],"draft:"+D[0]);q.objects[W].setStyle(1*ae.outputStyle);q.objects[W].traced=(ah[0]=="false")?false:true;K=L[1];q.objects[K].setProperty("strokeColor:"+aa[1],"strokeWidth:"+ab[1],"fillColor:"+U[1],"highlightStrokeColor:"+Q[1],"highlightFillColor:"+U[1],"visible:"+af[1],"dash:"+G[1],"draft:"+D[1]);q.objects[K].traced=(ah[1]=="false")?false:true}else{if(ae.typeName=="ARROW_PARALLEL"){for(ac=0;ac<k.getElementsByTagName("output").length;ac++){g=k.getElementsByTagName("output")[ac];L[ac]=g.getElementsByTagName("id")[0].firstChild.data;L[ac]=JXG.GeonextReader.changeOriginIds(q,L[ac]);ak[ac]=g.getElementsByTagName("name")[0];af[ac]=g.getElementsByTagName("visible")[0].firstChild.data;ah[ac]=g.getElementsByTagName("trace")[0].firstChild.data;G[ac]=g.getElementsByTagName("dash")[0].firstChild.data;D[ac]=g.getElementsByTagName("draft")[0].firstChild.data;ab[ac]=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("output")[ac].getElementsByTagName("color")[0];aa[ac]=g.getElementsByTagName("stroke")[0].firstChild.data;Q[ac]=g.getElementsByTagName("lighting")[0].firstChild.data;U[ac]=g.getElementsByTagName("fill")[0].firstChild.data;O[ac]=g.getElementsByTagName("label")[0].firstChild.data}ae.outputFixed=k.getElementsByTagName("output")[1].getElementsByTagName("fix")[0].firstChild.data;ae.outputStyle=k.getElementsByTagName("output")[1].getElementsByTagName("style")[0].firstChild.data;q.addArrowParallel(ae.defEl[1],ae.defEl[0],L[0],L[1],ak[0].firstChild.data,ak[1].firstChild.data);I=L[0];q.objects[I].setProperty("strokeColor:"+aa[0],"strokeWidth:"+ab[0],"fillColor:"+U[0],"highlightStrokeColor:"+Q[0],"highlightFillColor:"+U[0],"visible:"+af[0],"dash:"+G[0],"draft:"+D[0]);q.objects[I].traced=(ah[0]=="false")?false:true;W=L[1];q.objects[W].setProperty("strokeColor:"+aa[1],"strokeWidth:"+ab[1],"fillColor:"+aa[1],"highlightStrokeColor:"+Q[1],"highlightFillColor:"+Q[1],"visible:"+af[1],"fixed:"+ae.outputFixed,"labelColor:"+O[1],"draft:"+D[1]);q.objects[W].setStyle(1*ae.outputStyle);q.objects[W].traced=(ah[1]=="false")?false:true}else{if(ae.typeName=="PERPENDICULAR_POINT"){q.addPerpendicularPoint(ae.defEl[1],ae.defEl[0],ae.outputId,ae.outputName)}else{throw ("GEONExT-Element "+ae.typeName+" not yet implemented")}}}}}}}}}}}}}if(ae.typeName=="MIDPOINT"||ae.typeName=="MIRROR_LINE"||ae.typeName=="CIRCUMCIRCLE_CENTER"||ae.typeName=="PERPENDICULAR_POINT"||ae.typeName=="MIRROR_POINT"||ae.typeName=="PARALLELOGRAM_POINT"){ae.outputFixed=k.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ae.outputStyle=k.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;q.objects[ae.outputId].setProperty("strokeColor:"+ae.outputColorStroke,"strokeWidth:"+ae.outputStrokewidth,"fillColor:"+ae.outputColorStroke,"highlightStrokeColor:"+ae.outputHighlightStrokeColor,"highlightFillColor:"+ae.outputHighlightStrokeColor,"visible:"+ae.outputVisible,"fixed:"+ae.outputFixed,"labelColor:"+ae.outputColorLabel,"draft:"+ae.outputDraft);q.objects[ae.outputId].setStyle(1*ae.outputStyle);q.objects[ae.outputId].traced=(ae.outputTrace=="false")?false:true}else{if(ae.typeName=="BISECTOR"||ae.typeName=="NORMAL"||ae.typeName=="PARALLEL"){g=k.getElementsByTagName("output")[0].getElementsByTagName("straight")[0];ae.straightFirst=g.getElementsByTagName("first")[0].firstChild.data;ae.straightLast=g.getElementsByTagName("last")[0].firstChild.data;ae.straightFirst=(ae.straightFirst=="false")?false:true;ae.straightLast=(ae.straightLast=="false")?false:true;q.objects[ae.outputId].setStraight(ae.straightFirst,ae.straightLast);q.objects[ae.outputId].setProperty("strokeColor:"+ae.outputColorStroke,"strokeWidth:"+ae.outputStrokewidth,"fillColor:"+ae.outputColorFill,"highlightStrokeColor:"+ae.outputHighlightStrokeColor,"highlightFillColor:"+ae.outputColorFill,"visible:"+ae.outputVisible,"dash:"+ae.outputDash,"draft:"+ae.outputDraft);q.objects[ae.outputId].traced=(ae.outputTrace=="false")?false:true}else{if(ae.typeName=="CIRCUMCIRCLE"){for(ac=0;ac<k.getElementsByTagName("output").length;ac++){g=k.getElementsByTagName("output")[ac];L[ac]=g.getElementsByTagName("id")[0].firstChild.data;L[ac]=JXG.GeonextReader.changeOriginIds(q,L[ac]);ak[ac]=g.getElementsByTagName("name")[0];af[ac]=g.getElementsByTagName("visible")[0].firstChild.data;ah[ac]=g.getElementsByTagName("trace")[0].firstChild.data;G[ac]=g.getElementsByTagName("dash")[0].firstChild.data;D[ac]=g.getElementsByTagName("draft")[0].firstChild.data;ab[ac]=g.getElementsByTagName("strokewidth")[0].firstChild.data;g=k.getElementsByTagName("output")[ac].getElementsByTagName("color")[0];aa[ac]=g.getElementsByTagName("stroke")[0].firstChild.data;Q[ac]=g.getElementsByTagName("lighting")[0].firstChild.data;U[ac]=g.getElementsByTagName("fill")[0].firstChild.data;O[ac]=g.getElementsByTagName("label")[0].firstChild.data}ae.outputFixed=k.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ae.outputStyle=k.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;W=L[0];q.objects[W].setProperty("strokeColor:"+aa[0],"strokeWidth:"+ab[0],"fillColor:"+aa[0],"highlightStrokeColor:"+Q[0],"highlightFillColor:"+Q[0],"visible:"+af[0],"fixed:"+ae.outputFixed,"labelColor:"+O[0],"draft:"+D[0]);q.objects[W].setStyle(1*ae.outputStyle);q.objects[W].traced=(ah[0]=="false")?false:true;N=L[1];q.objects[N].setProperty("strokeColor:"+aa[1],"strokeWidth:"+ab[1],"fillColor:"+U[1],"highlightStrokeColor:"+Q[1],"highlightFillColor:"+U[1],"visible:"+af[1],"dash:"+G[1],"draft:"+D[1]);q.objects[N].traced=(ah[1]=="false")?false:true}}}JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"polygon":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.dataVertex=[];for(ac=0;ac<k.getElementsByTagName("data")[0].getElementsByTagName("vertex").length;ac++){ae.dataVertex[ac]=k.getElementsByTagName("data")[0].getElementsByTagName("vertex")[ac].firstChild.data;ae.dataVertex[ac]=JXG.GeonextReader.changeOriginIds(q,ae.dataVertex[ac])}ae.border=[];for(ac=0;ac<k.getElementsByTagName("border").length;ac++){ae.border[ac]={};g=k.getElementsByTagName("border")[ac];ae.border[ac].id=g.getElementsByTagName("id")[0].firstChild.data;ae.border[ac].name=g.getElementsByTagName("name")[0].firstChild.data;ae.border[ac].straightFirst=g.getElementsByTagName("straight")[0].getElementsByTagName("first")[0].firstChild.data;ae.border[ac].straightLast=g.getElementsByTagName("straight")[0].getElementsByTagName("last")[0].firstChild.data;ae.border[ac].straightFirst=(ae.border[ac].straightFirst=="false")?false:true;ae.border[ac].straightLast=(ae.border[ac].straightLast=="false")?false:true;ae.border[ac].strokewidth=g.getElementsByTagName("strokewidth")[0].firstChild.data;ae.border[ac].dash=g.getElementsByTagName("dash")[0].firstChild.data;ae.border[ac].visible=g.getElementsByTagName("visible")[0].firstChild.data;ae.border[ac].draft=g.getElementsByTagName("draft")[0].firstChild.data;ae.border[ac].trace=g.getElementsByTagName("trace")[0].firstChild.data;g=k.getElementsByTagName("border")[ac].getElementsByTagName("color")[0];ae.border[ac].colorStroke=g.getElementsByTagName("stroke")[0].firstChild.data;ae.border[ac].highlightStrokeColor=g.getElementsByTagName("lighting")[0].firstChild.data;ae.border[ac].colorFill=g.getElementsByTagName("fill")[0].firstChild.data;ae.border[ac].colorLabel=g.getElementsByTagName("label")[0].firstChild.data;ae.border[ac].colorDraft=g.getElementsByTagName("draft")[0].firstChild.data}JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"polygone");X=new JXG.Polygon(q,ae.dataVertex,ae.border,ae.id,ae.name,true,true,true);X.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"labelColor:"+ae.colorLabel,"draft:"+ae.draft,"trace:"+ae.trace,"visible:true");if(!ae.visible){X.setProperty("fillColor:none","highlightFillColor:none")}for(ac=0;ac<X.borders.length;ac++){X.borders[ac].setStraight(ae.border[ac].straightFirst,ae.border[ac].straightLast);X.borders[ac].setProperty("strokeColor:"+ae.border[ac].colorStroke,"strokeWidth:"+ae.border[ac].strokewidth,"fillColor:"+ae.border[ac].colorFill,"highlightStrokeColor:"+ae.border[ac].highlightStrokeColor,"highlightFillColor:"+ae.border[ac].colorFill,"visible:"+ae.border[ac].visible,"dash:"+ae.border[ac].dash,"labelColor:"+ae.border[ac].colorLabel,"draft:"+ae.border[ac].draft,"trace:"+ae.border[ac].trace)}JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"graph":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.funct=k.getElementsByTagName("data")[0].getElementsByTagName("function")[0].firstChild.data;JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"graphs");ai=new JXG.Curve(q,["x","x",ae.funct],ae.id,ae.name);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");ai.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:none","highlightStrokeColor:"+ae.highlightStrokeColor);break;case"arrow":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae=JXG.GeonextReader.readNodes(ae,k,"straight","straight");ae=JXG.GeonextReader.visualProperties(ae,k);ae.first=JXG.GeonextReader.changeOriginIds(q,ae.first);ae.last=JXG.GeonextReader.changeOriginIds(q,ae.last);Z=new JXG.Line(q,ae.first,ae.last,ae.id,ae.name);Z.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"labelColor:"+ae.colorLabel,"visible:"+ae.visible,"dash:"+ae.dash,"draft:"+ae.draft);Z.setStraight(false,false);Z.setArrow(false,true);Z.traced=(ae.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",Z,k.nodeName,"OK");break;case"arc":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae.firstArrow=k.getElementsByTagName("firstarrow")[0].firstChild.data;ae.lastArrow=k.getElementsByTagName("lastarrow")[0].firstChild.data;JXG.GeonextReader.parseImage(q,k.getElementsByTagName("image")[0],"arcs");ae.midpoint=JXG.GeonextReader.changeOriginIds(q,ae.midpoint);ae.angle=JXG.GeonextReader.changeOriginIds(q,ae.angle);ae.radius=JXG.GeonextReader.changeOriginIds(q,ae.radius);ai=new JXG.Arc(q,ae.midpoint,ae.radius,ae.angle,ae.id,ae.name);ai.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"labelColor:"+ae.colorLabel,"visible:"+ae.visible,"dash:"+ae.dash,"draft:"+ae.draft);ai.traced=(ae.trace=="false")?false:true;ae.firstArrow=(ae.firstArrow=="false")?false:true;ae.lastArrow=(ae.lastArrow=="false")?false:true;ai.setArrow(ae.firstArrow,ae.lastArrow);JXG.GeonextReader.printDebugMessage("debug",ai,k.nodeName,"OK");break;case"angle":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae.txt=k.getElementsByTagName("text")[0].firstChild.data;ai=new JXG.Angle(q,ae.first,ae.middle,ae.last,ae.radius,ae.txt,ae.id,ae.name);ai.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:"+ae.colorFill,"highlightStrokeColor:"+ae.highlightStrokeColor,"highlightFillColor:"+ae.colorFill,"labelColor:"+ae.colorLabel,"visible:"+ae.visible,"dash:"+ae.dash);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"text":if(ae.id.match(/oldVersion/)){break}ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.visualProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae=JXG.GeonextReader.readNodes(ae,k,"data");ae.mpStr=JXG.GeonextReader.subtreeToString(k.getElementsByTagName("data")[0].getElementsByTagName("mp")[0]);ae.mpStr=ae.mpStr.replace(/<\/?mp>/g,"");try{if(k.getElementsByTagName("data")[0].getElementsByTagName("parent")[0].firstChild){ae.parent=k.getElementsByTagName("data")[0].getElementsByTagName("parent")[0].firstChild.data}}catch(ag){}ae.condition=k.getElementsByTagName("condition")[0].firstChild.data;ae.content=k.getElementsByTagName("content")[0].firstChild.data;ae.fix=k.getElementsByTagName("fix")[0].firstChild.data;ae.autodigits=k.getElementsByTagName("digits")[0].firstChild.data;ae.parent=JXG.GeonextReader.changeOriginIds(q,ae.parent);ai=new JXG.Text(q,ae.mpStr,ae.parent,[ae.x,ae.y],ae.id,ae.name,ae.autodigits,false);ai.setProperty("labelColor:"+ae.colorLabel,"visible:"+ae.visible);break;case"parametercurve":ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.functionx=k.getElementsByTagName("functionx")[0].firstChild.data;ae.functiony=k.getElementsByTagName("functiony")[0].firstChild.data;ae.min=k.getElementsByTagName("min")[0].firstChild.data;ae.max=k.getElementsByTagName("max")[0].firstChild.data;ai=new JXG.Curve(q,["t",ae.functionx,ae.functiony,ae.min,ae.max],ae.id,ae.name);ai.setProperty("strokeColor:"+ae.colorStroke,"strokeWidth:"+ae.strokewidth,"fillColor:none","highlightStrokeColor:"+ae.highlightStrokeColor);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;case"tracecurve":ae.tracepoint=k.getElementsByTagName("tracepoint")[0].firstChild.data;ae.traceslider=k.getElementsByTagName("traceslider")[0].firstChild.data;JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"<b>ERR</b>");break;case"group":ae=JXG.GeonextReader.boardProperties(ae,k);ae=JXG.GeonextReader.colorProperties(ae,k);ae=JXG.GeonextReader.firstLevelProperties(ae,k);ae.members=[];for(ac=0;ac<k.getElementsByTagName("data")[0].getElementsByTagName("member").length;ac++){ae.members[ac]=k.getElementsByTagName("data")[0].getElementsByTagName("member")[ac].firstChild.data;ae.members[ac]=JXG.GeonextReader.changeOriginIds(q,ae.members[ac])}ai=new JXG.Group(q,ae.id,ae.name,ae.members);JXG.GeonextReader.printDebugMessage("debug",ae,k.nodeName,"OK");break;default:if(k.nodeName!="#text"){}}delete (ae)})(u)}q.addConditions(v.conditions)};this.decodeString=function(b){var a;if(b.indexOf("<GEONEXT>")<0){a=(new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(b))).unzip();if(a==""){return b}else{return a}}else{return b}};this.prepareString=function(a){if(a.indexOf("GEONEXT")<0){a=(JXG.GeonextReader.decodeString(a))[0][0]}a=JXG.GeonextReader.fixXML(a);return a};this.fixXML=function(f){var a=["active","angle","animate","animated","arc","area","arrow","author","autodigits","axis","back","background","board","border","bottom","buttonsize","cas","circle","color","comment","composition","condition","conditions","content","continuous","control","coord","coordinates","cross","cs","dash","data","description","digits","direction","draft","editable","elements","event","file","fill","first","firstarrow","fix","fontsize","free","full","function","functionx","functiony","GEONEXT","graph","grid","group","height","id","image","info","information","input","intersection","item","jsf","label","last","lastarrow","left","lefttoolbar","lighting","line","loop","max","maximized","member","middle","midpoint","min","modifier","modus","mp","mpx","multi","name","onpolygon","order","origin","output","overline","parametercurve","parent","point","pointsnap","polygon","position","radius","radiusnum","radiusvalue","right","section","selectedlefttoolbar","showconstruction","showcoord","showinfo","showunit","showx","showy","size","slider","snap","speed","src","start","stop","straight","stroke","strokewidth","style","term","text","top","trace","tracecurve","type","unit","value","VERSION","vertex","viewport","visible","width","wot","x","xooy","xval","y","yval","zoom"],d=a.join("|"),b="&lt;(/?("+d+"))&gt;",e=new RegExp(b,"g");f=JXG.escapeHTML(f);f=f.replace(e,"<$1>");f=f.replace(/(<content>.*)<arc>(.*<\/content>)/g,"$1&lt;arc&gt;$2");f=f.replace(/(<mp>.*)<arc>(.*<\/mpx>)/g,"$1&lt;arc&gt;$2");f=f.replace(/(<mpx>.*)<arc>(.*<\/mpx>)/g,"$1&lt;arc&gt;$2");return f}};JXG.GeogebraReader=new function(){this.ggbParse=function(s,z,u,o,h){JXG.GeogebraReader.debug("Zu aktualisierendes Element: "+u[o].name+"("+u[o].id+")");var e=JXG.getReference(s,u[o].id);var q=false;var f=new String();function y(A){f+=A+"\n"}function b(E){var D=0;var B=-1;var C=0;var G=0;var F=E.offset+1;do{F--;D=0;B=-2;G=F;if(E.src.length<=G){return 17}do{switch(D){case 0:if(E.src.charCodeAt(F)==9||E.src.charCodeAt(F)==32){D=1}else{if(E.src.charCodeAt(F)==40){D=2}else{if(E.src.charCodeAt(F)==41){D=3}else{if(E.src.charCodeAt(F)==42){D=4}else{if(E.src.charCodeAt(F)==43){D=5}else{if(E.src.charCodeAt(F)==44){D=6}else{if(E.src.charCodeAt(F)==45){D=7}else{if(E.src.charCodeAt(F)==47){D=8}else{if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)){D=9}else{if((E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=10}else{if(E.src.charCodeAt(F)==94){D=11}else{if(E.src.charCodeAt(F)==34){D=15}else{if(E.src.charCodeAt(F)==38){D=16}else{if(E.src.charCodeAt(F)==46){D=17}else{D=-1}}}}}}}}}}}}}}break;case 1:D=-1;B=1;C=F;break;case 2:D=-1;B=2;C=F;break;case 3:D=-1;B=3;C=F;break;case 4:D=-1;B=12;C=F;break;case 5:D=-1;B=9;C=F;break;case 6:D=-1;B=10;C=F;break;case 7:D=-1;B=11;C=F;break;case 8:D=-1;B=13;C=F;break;case 9:if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)){D=9}else{if(E.src.charCodeAt(F)==46){D=13}else{D=-1}}B=4;C=F;break;case 10:if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)||(E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=10}else{if(E.src.charCodeAt(F)==95){D=19}else{D=-1}}B=7;C=F;break;case 11:D=-1;B=14;C=F;break;case 12:D=-1;B=8;C=F;break;case 13:if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)){D=13}else{D=-1}B=5;C=F;break;case 14:D=-1;B=6;C=F;break;case 15:if(E.src.charCodeAt(F)==34){D=12}else{if(E.src.charCodeAt(F)==32||E.src.charCodeAt(F)==46||(E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)||(E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=15}else{D=-1}}break;case 16:if((E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=18}else{D=-1}break;case 17:if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)){D=13}else{D=-1}break;case 18:if(E.src.charCodeAt(F)==59){D=14}else{if((E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=18}else{D=-1}}break;case 19:if((E.src.charCodeAt(F)>=48&&E.src.charCodeAt(F)<=57)||(E.src.charCodeAt(F)>=65&&E.src.charCodeAt(F)<=90)||(E.src.charCodeAt(F)>=97&&E.src.charCodeAt(F)<=122)){D=10}else{if(E.src.charCodeAt(F)==95){D=19}else{D=-1}}break}F++}while(D>-1)}while(1>-1&&B==1);if(B>-1){E.att=E.src.substr(G,C-G);E.offset=C;switch(B){case 4:E.att=parseInt(E.att);break;case 5:E.att=parseFloat(E.att);break;case 6:E.att=String(E.att);break;case 7:JXG.GeogebraReader.debug("Geparstes Element/Variable: "+E.att);if(typeof u[E.att]=="undefined"||u[E.att]==""){var A=JXG.GeogebraReader.getElement(z,E.att);u[E.att]=JXG.GeogebraReader.writeElement(z,s,A);JXG.GeogebraReader.debug("regged: "+E.att+" (id: "+u[E.att].id+")")}break;case 8:E.att=String(E.att);break}}else{E.att=new String();B=-1}return B}function x(E,U,V){var F=new Array();var Q=new Array();var I=0;var T;var J;var K;var X;var L=new Function("","var offset; var src; var att;");var R=new L();var O=new Array(new Array(0,1),new Array(16,1),new Array(15,3),new Array(15,3),new Array(15,3),new Array(15,3),new Array(15,3),new Array(15,3),new Array(15,2),new Array(15,3),new Array(15,3),new Array(15,1),new Array(15,1),new Array(15,1),new Array(15,1),new Array(15,1));var H=new Array(new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(17,0),new Array(14,10,13,11,12,12,10,13,11,14,9,15,17,-1),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(9,18,17,-15,11,-15,10,-15,12,-15,13,-15,14,-15,3,-15),new Array(17,-11,9,-11,11,-11,10,-11,12,-11,13,-11,14,-11,3,-11),new Array(17,-12,9,-12,11,-12,10,-12,12,-12,13,-12,14,-12,3,-12),new Array(17,-13,9,-13,11,-13,10,-13,12,-13,13,-13,14,-13,3,-13),new Array(17,-14,9,-14,11,-14,10,-14,12,-14,13,-14,14,-14,3,-14),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(14,10,13,-8,12,-8,10,-8,11,-8,9,-8,17,-8,3,-8),new Array(14,10,13,11,12,12,10,13,11,14,9,15,3,25),new Array(11,3,2,4,8,5,4,6,5,7,6,8,7,9),new Array(14,-7,13,-7,12,-7,10,-7,11,-7,9,-7,17,-7,3,-7),new Array(14,10,13,-6,12,-6,10,-6,11,-6,9,-6,17,-6,3,-6),new Array(14,10,13,-5,12,-5,10,-5,11,-5,9,-5,17,-5,3,-5),new Array(14,10,13,11,12,12,10,-4,11,-4,9,-4,17,-4,3,-4),new Array(14,10,13,11,12,12,10,-3,11,-3,9,-3,17,-3,3,-3),new Array(14,10,13,11,12,12,10,-2,11,-2,9,-2,17,-2,3,-2),new Array(17,-9,9,-9,11,-9,10,-9,12,-9,13,-9,14,-9,3,-9),new Array(14,10,13,11,12,12,10,-10,11,-10,9,-10,17,-10,3,-10));var N=new Array(new Array(16,1,15,2),new Array(),new Array(),new Array(15,16),new Array(15,17),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(15,19),new Array(15,20),new Array(15,21),new Array(15,22),new Array(15,23),new Array(15,24),new Array(),new Array(),new Array(15,26),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array());var S=new Array("p'","WHITESPACE","(",")","INT","FLOAT","HTML","VAR","STRING","+",",","-","*","/","^","e","p","$");R.offset=0;R.src=E;R.att=new String();if(!U){U=new Array()}if(!V){V=new Array()}F.push(0);Q.push(0);K=b(R);while(true){T=28;for(var P=0;P<H[F[F.length-1]].length;P+=2){if(H[F[F.length-1]][P]==K){T=H[F[F.length-1]][P+1];break}}if(q&&F.length>0){y("\nState "+F[F.length-1]+"\n\tLookahead: "+S[K]+' ("'+R.att+'")\n\tAction: '+T+'\n\tSource: "'+R.src.substr(R.offset,30)+((R.offset+30<R.src.length)?"...":"")+'"\n\tStack: '+F.join()+"\n\tValue stack: "+Q.join()+"\n")}if(T==28){if(q){y("Error detected: There is no reduce or shift on the symbol "+S[K])}I++;U.push(R.offset-R.att.length);V.push(new Array());for(var P=0;P<H[F[F.length-1]].length;P+=2){V[V.length-1].push(S[H[F[F.length-1]][P]])}var G=new Array();var W=new Array();for(var P=0;P<F.length;P++){G[P]=F[P];W[P]=Q[P]}while(T==28&&K!=17){if(q){y("\tError recovery\nCurrent lookahead: "+S[K]+" ("+R.att+")\nAction: "+T+"\n\n")}if(K==-1){R.offset++}while(T==28&&F.length>0){F.pop();Q.pop();if(F.length==0){break}T=28;for(var P=0;P<H[F[F.length-1]].length;P+=2){if(H[F[F.length-1]][P]==K){T=H[F[F.length-1]][P+1];break}}}if(T!=28){break}for(var P=0;P<G.length;P++){F.push(G[P]);Q.push(W[P])}K=b(R)}if(T==28){if(q){y("\tError recovery failed, terminating parse process...")}break}if(q){y("\tError recovery succeeded, continuing")}}if(T>0){if(q){y("Shifting symbol: "+S[K]+" ("+R.att+")")}F.push(T);Q.push(R.att);K=b(R);if(q){y("\tNew lookahead symbol: "+S[K]+" ("+R.att+")")}}else{T*=-1;if(q){y("Reducing by producution: "+T)}X=void (0);if(q){y("\tPerforming semantic action...")}switch(T){case 0:X=Q[Q.length-1];break;case 1:JXG.GeogebraReader.debug(Q[Q.length-1]);break;case 2:X=Q[Q.length-3]+Q[Q.length-1];break;case 3:X=Q[Q.length-3]-Q[Q.length-1];break;case 4:var B=JXG.getReference(s,u[Q[Q.length-1]].id);var A=JXG.getReference(s,u[Q[Q.length-3]].id);(function(Y,Z){fx=function(){return Y.Value()};fy=function(){return Z.Value()};e.addConstraint([fx,fy])})(B,A);X="x: "+typeof Q[Q.length-3]+" ("+Q[Q.length-3]+"), y: "+typeof Q[Q.length-1]+"("+Q[Q.length-1]+")";break;case 5:X=Q[Q.length-3]*Q[Q.length-1];break;case 6:X=Q[Q.length-3]/Q[Q.length-1];break;case 7:if(typeof Q[Q.length-3]=="string"){var C=JXG.getReference(s,u[Q[Q.length-3]].id).Value()}else{var C=Q[Q.length-3]}if(typeof Q[Q.length-1]=="string"){var D=JXG.getReference(s,u[Q[Q.length-1]].id).Value()}else{var D=Q[Q.length-1]}X=function(Y,Z){return Math.pow(Y,Z)}(C,D);break;case 8:X=Q[Q.length-1]*-1;break;case 9:X=Q[Q.length-2];break;case 10:X=Q[Q.length-3];break;case 11:X=Q[Q.length-1];break;case 12:X=Q[Q.length-1];break;case 13:X=Q[Q.length-1];break;case 14:X=Q[Q.length-1];break;case 15:X=Q[Q.length-1];break}if(q){y("\tPopping "+O[T][1]+" off the stack...")}for(var P=0;P<O[T][1];P++){F.pop();Q.pop()}J=-1;for(var P=0;P<N[F[F.length-1]].length;P+=2){if(N[F[F.length-1]][P]==O[T][0]){J=N[F[F.length-1]][P+1];break}}if(T==0){break}if(q){y("\tPushing non-terminal "+S[O[T][0]])}F.push(J);Q.push(X)}if(q){JXG.GeogebraReader.debug(f);f=new String()}}if(q){y("\nParse complete.");JXG.GeogebraReader.debug(f)}return I}var w=new Array();var d=new Array();var g=0;var v=h;if((g=x(v,w,d))>0){var a=new String();for(var k=0;k<g;k++){a+="Parse error in line "+(v.substr(0,w[k]).match(/\n/g)?v.substr(0,w[k]).match(/\n/g).length:1)+' near "'+v.substr(w[k])+'", expecting "'+d[k].join()+'"\n'}JXG.GeogebraReader.debug(a)}};this.debug=function(a){$("debug").innerHTML+=a+"<br/>"};this.colorProperties=function(h,e){var f=(h.getElementsByTagName("objColor")[0].attributes.alpha)?1*h.getElementsByTagName("objColor")[0].attributes.alpha.value:0;var o=(h.getElementsByTagName("objColor")[0].attributes.r)?(1*h.getElementsByTagName("objColor")[0].attributes.r.value).toString(16):0;var k=(h.getElementsByTagName("objColor")[0].attributes.g)?(1*h.getElementsByTagName("objColor")[0].attributes.g.value).toString(16):0;var d=(h.getElementsByTagName("objColor")[0].attributes.b)?(1*h.getElementsByTagName("objColor")[0].attributes.b.value).toString(16):0;if(o.length==1){o="0"+o}if(k.length==1){k="0"+k}if(d.length==1){d="0"+d}e.fillColor="#"+o+k+d;e.strokeColor=e.fillColor;if(f!=0){e.strokeOpacity=e.fillOpacity;e.fillOpacity=f}return e};this.boardProperties=function(d,b,a){return a};this.coordinates=function(b,a){b.x=(a.getElementsByTagName("coords")[0])?parseFloat(a.getElementsByTagName("coords")[0].attributes.x.value):(a.getElementsByTagName("startPoint")[0])?parseFloat(a.getElementsByTagName("startPoint")[0].attributes.x.value):false;b.y=(a.getElementsByTagName("coords")[0])?parseFloat(a.getElementsByTagName("coords")[0].attributes.y.value):(a.getElementsByTagName("startPoint")[0])?parseFloat(a.getElementsByTagName("startPoint")[0].attributes.y.value):false;b.z=(a.getElementsByTagName("coords")[0])?parseFloat(a.getElementsByTagName("coords")[0].attributes.z.value):(a.getElementsByTagName("startPoint")[0])?parseFloat(a.getElementsByTagName("startPoint")[0].attributes.z.value):false;return b};this.visualProperties=function(b,a){(b.getElementsByTagName("show")[0].attributes.object)?a.visible=b.getElementsByTagName("show")[0].attributes.object.value:false;(b.getElementsByTagName("show")[0].attributes.label)?a.visibleLabel=b.getElementsByTagName("show")[0].attributes.label.value:false;(b.getElementsByTagName("pointSize")[0])?a.style=b.getElementsByTagName("pointSize")[0].attributes.val.value:false;(b.getElementsByTagName("labelOffset")[0])?a.labelX=1*b.getElementsByTagName("labelOffset")[0].attributes.x.value:false;(b.getElementsByTagName("labelOffset")[0])?a.labelY=1*b.getElementsByTagName("labelOffset")[0].attributes.y.value:false;(b.getElementsByTagName("trace")[0])?a.trace=b.getElementsByTagName("trace")[0].attributes.val.value:false;(b.getElementsByTagName("fix")[0])?a.fixed=b.getElementsByTagName("fix")[0].attributes.val.value:false;return a};this.getElement=function(a,d){for(var f=0;f<a.getElementsByTagName("construction").length;f++){for(var b=0;b<a.getElementsByTagName("construction")[f].getElementsByTagName("element").length;b++){var e=a.getElementsByTagName("construction")[f].getElementsByTagName("element")[b];if(d==e.attributes.label.value){return e}}}};this.writeBoard=function(b,f,e){var g=b.getElementsByTagName("euclidianView")[0];f.origin={};f.origin.usrCoords=[1,0,0];f.origin.scrCoords=[1,1*g.getElementsByTagName("coordSystem")[0].attributes.xZero.value,1*g.getElementsByTagName("coordSystem")[0].attributes.yZero.value];f.unitX=(g.getElementsByTagName("coordSystem")[0].attributes.scale)?1*g.getElementsByTagName("coordSystem")[0].attributes.scale.value:1;f.unitY=(g.getElementsByTagName("coordSystem")[0].attributes.yscale)?1*g.getElementsByTagName("coordSystem")[0].attributes.yscale.value:1;f.fontSize=1*b.getElementsByTagName("gui")[0].getElementsByTagName("font")[0].attributes.size.value;JXG.JSXGraph.boards[f.id]=f;f.renderer.enhancedRendering=true;var a=(g.getElementsByTagName("evSettings")[0].attributes.pointCapturing.value=="true")?f.snapToGrid=true:null;var d=(g.getElementsByTagName("evSettings")[0].attributes.grid.value=="true")?f.renderer.drawGrid(f):null;if(g.getElementsByTagName("evSettings")[0].attributes.axes&&g.getElementsByTagName("evSettings")[0].attributes.axes.value=="true"){e.xAxis=f.createElement("axis",[[0,0],[1,0]],{strokeColor:"black"});e.yAxis=f.createElement("axis",[[0,0],[0,1]],{strokeColor:"black"})}return e};this.writeElement=function(k,d,f,h,u){if(typeof f=="object"&&typeof f.attributes=="undefined"){element=f[0]}else{element=f}var y={};y.type=element.attributes.type.value.toLowerCase();y.label=element.attributes.label.value;var s={};s.name=y.label;if(typeof u!="undefined"&&(y.type!=u)){y.type=u}JXG.GeogebraReader.debug("<br><b>Konstruiere</b> "+y.label+"("+y.type+"):");switch(y.type){case"point":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{p=d.createElement("point",[y.x,y.y],s);$("debug").innerHTML+="* <b>Point ("+p.id+"):</b> "+s.name+"("+y.x+", "+y.y+")<br>\n";return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Point "+s.name+"<br>\n";return false}break;case"segment":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Segment:</b> ("+s.name+") First: "+h[0].name+", Last: "+h[1].name+"<br>\n";s.straightFirst=false;s.straightLast=false;l=d.createElement("line",h,s);return l}catch(C){$("debug").innerHTML+="* <b>Err:</b> Segment "+s.name+" First: "+h[0].name+", Last: "+h[1].name+"<br>\n";return false}break;case"line":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);for(var g in s){$("debug").innerHTML+=g+":"+s[g]+" "}$("debug").innerHTML+="<br>";if(JXG.getReference(d,h[1].id).type==1330925652){var a="line"}else{if(JXG.getReference(d,h[1].id).type==1330924622){var a="parallel"}}try{$("debug").innerHTML+="* <b>Line:</b> ("+s.name+") First: "+h[0].id+", Last: "+h[1].id+"<br>\n";l=d.createElement(a,h,s);return l}catch(C){$("debug").innerHTML+="* <b>Err:</b> Line "+s.label+"<br>\n";return false}break;case"orthogonalline":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Orthogonalline:</b> First: "+h[0].id+", Last: "+h[1].id+"<br>\n";l=d.createElement("normal",[h[0],h[1]],s);return l}catch(C){$("debug").innerHTML+="* <b>Err:</b> Orthogonalline "+s.label+"<br>\n";return false}break;case"polygon":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Polygon:</b> First: "+h[0].name+", Second: "+h[1].name+", Third: "+h[2].name+"<br>\n";var b=[];for(var v=1;v<f.length;v++){b[v-1]={};b[v-1].id="";b[v-1].name=f[v].attributes.label.value}s.borders=b;l=d.createElement("polygon",h,s);return l}catch(C){$("debug").innerHTML+="* <b>Err:</b> Polygon "+s.name+"<br>\n";return false}break;case"intersect":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Intersection:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";l=d.createElement("intersection",[h[0],h[1],0],s);return l}catch(C){$("debug").innerHTML+="* <b>Err:</b> Intersection "+s.name+"<br>\n";return false}break;case"distance":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Distance:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";m=d.createElement("midpoint",h,{visible:"false"});t=d.createElement("text",[function(){return m.X()},function(){return m.Y()},function(){return"<span style='text-decoration: overline'>"+h[0].name+h[1].name+"</span> = "+JXG.getReference(d,h[0].id).Dist(JXG.getReference(d,h[1].id))}]);return t}catch(C){$("debug").innerHTML+="* <b>Err:</b> Intersection "+s.name+"<br>\n";return false}break;case"rotate":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Rotate:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";s.type="rotate";r=d.createElement("transform",[[parseInt(h[1]),h[2]],h[0]],s);return r}catch(C){$("debug").innerHTML+="* <b>Err:</b> Rotate "+s.name+"<br>\n";return false}break;case"mirror":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);if(JXG.getReference(d,h[1].id).type==1330925652){var a="mirrorpoint"}else{if(JXG.getReference(d,h[1].id).type==1330924622){var a="reflection"}}try{$("debug").innerHTML+="* <b>Mirror:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";m=d.createElement(a,[h[1],h[0]],s);return m}catch(C){$("debug").innerHTML+="* <b>Err:</b> Mirror "+s.name+"<br>\n";return false}break;case"circle":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Circle:</b> First: "+h[0].name+", Second: "+h[1]+"<br>\n";c=d.createElement("circle",h,s);return c}catch(C){$("debug").innerHTML+="* <b>Err:</b> Circle "+s.name+"<br>\n";return false}break;case"circlearc":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>CircleArc:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";c=d.createElement("arc",h,s);return c}catch(C){$("debug").innerHTML+="* <b>Err:</b> CircleArc "+s.name+"<br>\n";return false}break;case"circlesector":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>CircleSector:</b> First: "+h[0].name+", Second: "+h[1].name+"<br>\n";c=d.createElement("sector",h,s);return c}catch(C){$("debug").innerHTML+="* <b>Err:</b> CircleSector "+s.name+"<br>\n";return false}break;case"linebisector":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>LineBiSector (Mittelsenkrechte):</b> First: "+h[0].name+"<br>\n";s.straightFirst=true;s.straightLast=true;m=d.createElement("midpoint",h,{visible:"false"});p=d.createElement("perpendicular",[m,h[0]],s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> LineBiSector (Mittelsenkrechte) "+s.name+"<br>\n";return false}break;case"ray":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Strahl:</b> First: "+h[0].name+"<br>\n";s.straightFirst=true;s.straightLast=false;p=d.createElement("line",[h[1],h[0]],s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Strahl "+s.name+"<br>\n";return false}break;case"tangent":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Tangente:</b> First: "+h[0].name+"<br>\n";p=d.createElement("tangent",h[1],s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Tangente "+s.name+"<br>\n";return false}break;case"circumcirclearc":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>CircumcircleArc:</b> First: "+h[0].name+"<br>\n";p=d.createElement("circumcircle",h,s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> CircumcircleArc "+s.name+"<br>\n";return false}break;case"angle":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Angle:</b> First: "+h[0].name+"<br>\n";p=d.createElement("angle",h,s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Angle "+s.name+"<br>\n";return false}break;case"angularbisector":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{$("debug").innerHTML+="* <b>Angularbisector:</b> First: "+h[0].name+"<br>\n";p=d.createElement("bisector",h,s);return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Angularbisector "+s.name+"<br>\n";return false}break;case"numeric":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);s=JXG.GeogebraReader.visualProperties(element,s);if(element.getElementsByTagName("slider").length==1){var q=parseFloat(element.getElementsByTagName("slider")[0].attributes.x.value);var o=parseFloat(element.getElementsByTagName("slider")[0].attributes.y.value);var E=new JXG.Coords(JXG.COORDS_BY_SCREEN,[q,o],d);q=E.usrCoords[1];o=E.usrCoords[2];if(element.getElementsByTagName("slider")[0].attributes.horizontal.value=="true"){var w=parseFloat(element.getElementsByTagName("slider")[0].attributes.width.value)/(d.unitX*d.zoomX);var B=q+w;var z=o}else{var w=parseFloat(element.getElementsByTagName("slider")[0].attributes.width.value)/(d.unitX*d.zoomX);var B=q;var z=o+w}var F=parseFloat(element.getElementsByTagName("value")[0].attributes.val.value);var A=parseFloat(element.getElementsByTagName("slider")[0].attributes.min.value);var D=parseFloat(element.getElementsByTagName("slider")[0].attributes.max.value);(element.getElementsByTagName("animation")[0])?s.snapWidth=parseFloat(element.getElementsByTagName("animation")[0].attributes.step.value):false;try{$("debug").innerHTML+="* <b>Numeric:</b> First: "+s.name+"<br>\n";n=d.createElement("slider",[[q,o],[B,z],[A,F,D]],s);return n}catch(C){$("debug").innerHTML+="* <b>Err:</b> Numeric "+s.name+"<br>\n";return false}}break;case"midpoint":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{p=d.createElement("midpoint",h,s);$("debug").innerHTML+="* <b>Midpoint ("+p.id+"):</b> "+s.name+"("+y.x+", "+y.y+")<br>\n";return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Midpoint "+s.name+"<br>\n";return false}break;case"center":s=JXG.GeogebraReader.boardProperties(y,element,s);s=JXG.GeogebraReader.colorProperties(element,s);y=JXG.GeogebraReader.coordinates(y,element);s=JXG.GeogebraReader.visualProperties(element,s);try{p=d.createElement("point",[function(){return JXG.getReference(d,h[0].id).midpoint.X()},function(){return JXG.getReference(d,h[0].id).midpoint.Y()}],s);$("debug").innerHTML+="* <b>Center ("+p.id+"):</b> "+s.name+"("+y.x+", "+y.y+")<br>\n";return p}catch(C){$("debug").innerHTML+="* <b>Err:</b> Center "+s.name+"<br>\n";return false}break;default:return false;break}};this.readGeogebra=function(y,h){var C=[];var a,g,D;var f=[];C=JXG.GeogebraReader.writeBoard(y,h,C);var d=y.getElementsByTagName("construction");for(var w=0;w<d.length;w++){var A=d[w].getElementsByTagName("command");for(var x=0;x<A.length;x++){g=A[x];var v=[];for(D=0;D<g.getElementsByTagName("input")[0].attributes.length;D++){a=g.getElementsByTagName("input")[0].attributes[D].value;if(!a.match(/°/)&&!isNaN(a)){v[D]=a}else{if(typeof C[a]=="undefined"||C[a]==""){elnode=JXG.GeogebraReader.getElement(y,a);C[a]=JXG.GeogebraReader.writeElement(y,h,elnode);$("debug").innerHTML+="regged: "+C[a].id+"<br/>"}v[D]=C[a]}}var u=[];for(D=0;D<g.getElementsByTagName("output")[0].attributes.length;D++){a=g.getElementsByTagName("output")[0].attributes[D].value;u[D]=JXG.GeogebraReader.getElement(y,a)}if(typeof C[a]=="undefined"||C[a]==""){C[a]=JXG.GeogebraReader.writeElement(y,h,u,v,g.attributes.name.value.toLowerCase());$("debug").innerHTML+="regged: "+C[a].id+"<br/>";for(var D=1;D<u.length;D++){C[C[a].borders[D-1].name]=C[a].borders[D-1];$("debug").innerHTML+=D+") regged: "+u[D].attributes.label.value+"("+C[u[D].attributes.label.value].id+")<br/>"}}}var b=d[w].getElementsByTagName("expression");for(var x=0;x<b.length;x++){var q=b[x].attributes.label.value;var k=b[x].attributes.exp.value;var e=(b[x].attributes.type)?b[x].attributes.type.value:false;JXG.GeogebraReader.debug("Expression: label: "+q+", exp: "+k+", type: "+e);if(typeof C[q]=="undefined"||C[q]==""){var v=JXG.GeogebraReader.getElement(y,q);C[q]=JXG.GeogebraReader.writeElement(y,h,v,null,e);JXG.GeogebraReader.debug("regged: "+C[q].id)}var x=k.split(" ");var z="";for(var D=0;D<x.length;D++){if(x.length!=D+1){if(x[D].search(/\)$/)>-1||x[D].search(/[0-9]+$/)>-1||x[D].search(/[a-zA-Z]+(\_*[a-zA-Z0-9]+)*$/)>-1){if(x[D+1].search(/^\(/)>-1||x[D].search(/^[0-9]+/)>-1||x[D+1].search(/^[a-zA-Z]+(\_*[a-zA-Z0-9]+)*/)>-1){x[D]=x[D]+"*"}}}z+=x[D]}var B=JXG.GeogebraReader.ggbParse(h,y,C,q,k)}}h.fullUpdate()};this.prepareString=function(a){if(a.indexOf("<")!=0){bA=[];for(i=0;i<a.length;i++){bA[i]=JXG.Util.asciiCharCodeAt(a,i)}a=(new JXG.Util.Unzip(bA)).unzipFile("geogebra.xml")}return a}};JXG.IntergeoReader=new function(){this.board=null;this.objects={};this.readIntergeo=function(a,b){this.board=b;this.board.origin={};this.board.origin.usrCoords=[1,0,0];this.board.origin.scrCoords=[1,400,300];this.board.unitX=30;this.board.unitY=30;this.readElements(a.getElementsByTagName("elements"));this.board.fullUpdate();this.readConstraints(a.getElementsByTagName("constraints"));this.board.fullUpdate()};this.readElements=function(a){var b;for(var b=0;b<a[0].childNodes.length;b++){(function(d){var e;e=a[0].childNodes[d];if(e.nodeType>1){return}if(e.nodeName=="point"){JXG.IntergeoReader.addPoint(e)}else{if(e.nodeName=="line"){JXG.IntergeoReader.storeLine(e)}else{if(e.nodeName=="line_segment"){JXG.IntergeoReader.storeLine(e)}else{if(e.nodeName=="circle"){JXG.IntergeoReader.storeCircle(e)}else{document.getElementById("debug").innerHTML+="Not implemented: "+e.nodeName+" "+e.getAttribute("id")+"<br>"}}}}})(b)}};this.addPoint=function(f){var d=0,b=0,a=0,e,g=f.childNodes[d],h;while(g.nodeType>1){d++;g=f.childNodes[d]}if(g.nodeName=="homogeneous_coordinates"){h=[];for(b=0;b<g.childNodes.length;b++){if(g.childNodes[b].nodeType==1){if(g.childNodes[b].nodeName=="double"){h.push(g.childNodes[b].firstChild.data)}else{if(g.childNodes[b].nodeName=="complex"){for(a=0;a<g.childNodes[b].childNodes.length;a++){if(g.childNodes[b].childNodes[a].nodeName=="double"){h.push(g.childNodes[b].childNodes[a].firstChild.data)}}}else{document.getElementById("debug").innerHTML+="Not implemented: "+g.childNodes[b].nodeName+"<br>"}}}}for(b=0;b<h.length;b++){h[b]=parseFloat(h[b])}if(h.length==3){e=this.board.createElement("point",[h[2],h[0],h[1]],{name:f.getAttribute("id"),withLabel:true})}else{if(h.length==6&&Math.abs(h[1])<1e-10&&Math.abs(h[3])<1e-10&&Math.abs(h[5])<1e-10){e=this.board.createElement("point",[h[4],h[0],h[2]],{name:f.getAttribute("id"),withLabel:true})}else{document.getElementById("debug").innerHTML+="type not supported, yet <br>"}}}else{if(g.nodeName=="euclidean_coordinates"){h=[];for(b=0;b<g.childNodes.length;b++){if(g.childNodes[b].nodeType==1){h.push(g.childNodes[b].firstChild.data)}}for(b=0;b<h.length;b++){h[b]=parseFloat(h[b])}e=this.board.createElement("point",[h[0],h[1]],{name:f.getAttribute("id"),withLabel:true})}else{if(g.nodeName=="polar_coordinates"){h=[];for(b=0;b<g.childNodes.length;b++){if(g.childNodes[b].nodeType==1){h.push(g.childNodes[b].firstChild.data)}}for(b=0;b<h.length;b++){h[b]=parseFloat(h[b])}e=this.board.createElement("point",[h[0]*Math.cos(h[1]),h[0]*Math.sin(h[1])],{name:f.getAttribute("id"),withLabel:true})}else{document.getElementById("debug").innerHTML+="This coordinate type is not yet implemented: "+g.nodeName+"<br>";return}}}this.objects[f.getAttribute("id")]=e};this.storeLine=function(d){var b,e,f,a;this.objects[d.getAttribute("id")]={id:d.getAttribute("id"),coords:null};b=0;e=d.childNodes[b];while(e.nodeType>1){b++;e=d.childNodes[b]}if(e.nodeName=="homogeneous_coordinates"){f=[];for(a=0;a<e.childNodes.length;a++){if(e.childNodes[a].nodeType==1){if(e.childNodes[a].nodeName=="double"){f.push(parseFloat(e.childNodes[a].firstChild.data))}else{}}}this.objects[d.getAttribute("id")].coords=f}};this.addLine=function(e){var a,d=this.objects[e].coords,b;for(a=0;a<d.length;a++){d[a]=parseFloat(d[a])}b=this.board.createElement("line",[d[2],d[0],d[1]],{name:e,strokeColor:"black",withLabel:true});this.objects[e]=b};this.storeCircle=function(d){var b,a,e,f;this.objects[d.getAttribute("id")]={id:d.getAttribute("id"),coords:null};b=0;e=d.childNodes[b];while(e.nodeType>1){b++;e=d.childNodes[b]}if(e.nodeName=="matrix"){f=[];for(a=0;a<e.childNodes.length;a++){if(e.childNodes[a].nodeType==1){if(e.childNodes[a].nodeName=="double"){f.push(parseFloat(e.childNodes[a].firstChild.data))}else{}}}this.objects[d.getAttribute("id")].coords=f}};this.readConstraints=function(a){var b,d;for(b=0;b<a[0].childNodes.length;b++){(function(e){var f;f=a[0].childNodes[e];if(f.nodeType>1){return}if(f.nodeName=="line_through_two_points"){JXG.IntergeoReader.addLineThroughTwoPoints(f)}else{if(f.nodeName=="line_through_point"){JXG.IntergeoReader.addLineThroughPoint(f)}else{if(f.nodeName=="line_parallel_to_line_through_point"){JXG.IntergeoReader.addLineParallelToLineThroughPoint(f)}else{if(f.nodeName=="line_perpendicular_to_line_through_point"){JXG.IntergeoReader.addLinePerpendicularToLineThroughPoint(f)}else{if(f.nodeName=="line_segment_by_points"){JXG.IntergeoReader.addLineSegmentByTwoPoints(f)}else{if(f.nodeName=="endpoints_of_line_segment"){JXG.IntergeoReader.addEndpointsOfLineSegment(f)}else{if(f.nodeName=="free_point"){}else{if(f.nodeName=="free_line"){JXG.IntergeoReader.addFreeLine(f)}else{if(f.nodeName=="point_on_line"){JXG.IntergeoReader.addPointOnLine(f)}else{if(f.nodeName=="point_on_line_segment"){JXG.IntergeoReader.addPointOnLine(f)}else{if(f.nodeName=="point_on_circle"){JXG.IntergeoReader.addPointOnCircle(f)}else{if(f.nodeName=="angular_bisector_of_three_points"){JXG.IntergeoReader.addAngularBisectorOfThreePoints(f)}else{if(f.nodeName=="angular_bisectors_of_two_lines"){JXG.IntergeoReader.addAngularBisectorsOfTwoLines(f)}else{if(f.nodeName=="midpoint_of_two_points"){JXG.IntergeoReader.addMidpointOfTwoPoints(f)}else{if(f.nodeName=="midpoint"){JXG.IntergeoReader.addMidpointOfTwoPoints(f)}else{if(f.nodeName=="midpoint_line_segment"){JXG.IntergeoReader.addMidpointLineSegment(f)}else{if(f.nodeName=="point_intersection_of_two_lines"){JXG.IntergeoReader.addPointIntersectionOfTwoLines(f)}else{if(f.nodeName=="locus_defined_by_point"){JXG.IntergeoReader.addLocusDefinedByPoint(f)}else{if(f.nodeName=="locus_defined_by_point_on_line"){JXG.IntergeoReader.addLocusDefinedByPointOnLine(f)}else{if(f.nodeName=="locus_defined_by_point_on_line_segment"){JXG.IntergeoReader.addLocusDefinedByPointOnLine(f)}else{if(f.nodeName=="locus_defined_by_line_through_point"){JXG.IntergeoReader.addLocusDefinedByLineThroughPoint(f)}else{if(f.nodeName=="locus_defined_by_point_on_circle"){JXG.IntergeoReader.addLocusDefinedByPointOnCircle(f)}else{if(f.nodeName=="circle_by_three_points"){JXG.IntergeoReader.addCircleByThreePoints(f)}else{if(f.nodeName=="circle_by_center_and_point"){JXG.IntergeoReader.addCircleByCenterAndPoint(f)}else{if(f.nodeName=="center_of_circle"){JXG.IntergeoReader.addCenterOfCircle(f)}else{if(f.nodeName=="intersection_points_of_two_circles"){JXG.IntergeoReader.addIntersectionPointsOfTwoCircles(f)}else{if(f.nodeName=="intersection_points_of_circle_and_line"){JXG.IntergeoReader.addIntersectionPointsOfCircleAndLine(f)}else{d=JXG.IntergeoReader.readParams(f);$("debug").innerHTML+="readConstraints: not implemented: "+f.nodeName+": "+d[0]+"<br>"}}}}}}}}}}}}}}}}}}}}}}}}}}}})(b)}};this.readParams=function(b){var d=[],a;for(a=0;a<b.childNodes.length;a++){if(b.childNodes[a].nodeType==1){d.push(b.childNodes[a].firstChild.data)}}return d};this.addLineThroughTwoPoints=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.board.createElement("line",[this.objects[d[1]],this.objects[d[2]]],{name:d[0],withLabel:true});this.objects[d[0]]=a};this.addLineThroughPoint=function(d){var f=JXG.IntergeoReader.readParams(d),a,g=this.objects[f[0]].coords,e=this.objects[f[1]],b;for(a=0;a<g.length;a++){g[a]=parseFloat(g[a])}b=this.board.createElement("line",[function(){return g[2]-g[0]*e.X()-g[1]*e.Y()-g[2]*e.Z()},g[0],g[1]],{name:f[0],strokeColor:"black",withLabel:true});this.objects[f[0]]=b};this.addLineParallelToLineThroughPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.board.createElement("parallel",[this.objects[d[1]].id,this.objects[d[2]].id],{name:d[0],withLabel:true});this.objects[d[0]]=a};this.addLinePerpendicularToLineThroughPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.board.createElement("perpendicular",[this.objects[d[1]].id,this.objects[d[2]].id],{name:d[0],withLabel:true});a[0].setProperty("straightFirst:true","straightLast:true");a[1].setProperty("visible:false");this.objects[d[0]]=a[0]};this.addLineSegmentByTwoPoints=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.board.createElement("line",[this.objects[d[1]],this.objects[d[2]]],{name:d[0],straightFirst:false,straightLast:false,strokeColor:"black",withLabel:true});this.objects[d[0]]=a};this.addEndpointsOfLineSegment=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.objects[d[2]];this.objects[d[0]].addConstraint([function(){return a.point1.Z()},function(){return a.point1.X()},function(){return a.point1.Y()}]);this.objects[d[1]].addConstraint([function(){return a.point2.Z()},function(){return a.point2.X()},function(){return a.point2.Y()}])};this.addPointIntersectionOfTwoLines=function(a){var b=JXG.IntergeoReader.readParams(a);this.objects[b[0]].addConstraint([this.board.intersectionFunc(this.objects[b[1]],this.objects[b[2]],0)])};this.addFreeLine=function(f){var g=JXG.IntergeoReader.readParams(f),e=this.objects[g[0]].coords[0],d=this.objects[g[0]].coords[1],h=this.objects[g[0]].coords[2];el=this.board.createElement("line",[h,e,d],{name:g[0],id:g[0],withLabel:true});this.objects[g[0]]=el};this.addPointOnLine=function(b){var e=JXG.IntergeoReader.readParams(b),d=JXG.getReference(this.board,e[0]),a=JXG.getReference(this.board,e[1]);d.makeGlider(a)};this.addPointOnCircle=function(a){var d=JXG.IntergeoReader.readParams(a),b=JXG.getReference(this.board,d[0]),e=JXG.getReference(this.board,d[1]);b.makeGlider(e)};this.addAngularBisectorOfThreePoints=function(b){var d=JXG.IntergeoReader.readParams(b),a=this.board.createElement("bisector",[d[1],d[2],d[3]],{name:d[0],id:d[0],withLabel:true});a.setProperty({straightFirst:false,straightLast:true,strokeColor:"#000000"});this.objects[d[0]]=a};this.addMidpointOfTwoPoints=function(a){var e=JXG.IntergeoReader.readParams(a),f=JXG.getReference(this.board,e[0]),d=JXG.getReference(this.board,e[1]),b=JXG.getReference(this.board,e[2]);f.addConstraint([function(){return 0.5*(d.Z()+b.Z())},function(){return 0.5*(d.X()+b.X())},function(){return 0.5*(d.Y()+b.Y())},])};this.addMidpointLineSegment=function(b){var d=JXG.IntergeoReader.readParams(b),e=JXG.getReference(this.board,d[0]),a=JXG.getReference(this.board,d[1]);e.addConstraint([function(){return 0.5*(a.point1.Z()+a.point2.Z())},function(){return 0.5*(a.point1.X()+a.point2.X())},function(){return 0.5*(a.point1.Y()+a.point2.Y())},])};this.addAngularBisectorsOfTwoLines=function(d){var e=JXG.IntergeoReader.readParams(d),b=this.objects[e[2]],a=this.objects[e[3]];this.board.createElement("bisectorlines",[b,a],{name:[e[0],e[1]],id:[e[0],e[1]],straightFirst:true,straightLast:true,strokeColor:"#ff0000",withLabel:true})};this.addLocusDefinedByPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a};this.addLocusDefinedByPointOnLine=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a};this.addLocusDefinedByLineThroughPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a};this.addLocusDefinedByPointOnCircle=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a};this.addCircleByThreePoints=function(d){var f=JXG.IntergeoReader.readParams(d),e=[],b,a;for(b=0;b<3;b++){e[b]=JXG.getReference(this.board,f[b+1])}a=this.board.createElement("circumcircle",e,{name:["",f[0]],id:["",f[0]],withLabel:true});a[0].setProperty({visible:false});a[1].setProperty({withLabel:true})};this.addCircleByCenterAndPoint=function(a){var b=JXG.IntergeoReader.readParams(a);this.board.createElement("circle",[this.objects[b[1]],this.objects[b[2]]],{name:b[0],id:b[0],withLabel:true})};this.addCenterOfCircle=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[0]),e=JXG.getReference(this.board,d[1]);a.addConstraint([function(){return e.midpoint.X()},function(){return e.midpoint.Y()}])};this.addIntersectionPointsOfTwoCircles=function(d){var g=JXG.IntergeoReader.readParams(d),b=JXG.getReference(this.board,g[2]),a=JXG.getReference(this.board,g[3]),f=this.objects[g[0]],e=this.objects[g[1]];f.addConstraint([this.board.intersection(b,a,0)]);e.addConstraint([this.board.intersection(b,a,1)])};this.addIntersectionPointsOfCircleAndLine=function(d){var g=JXG.IntergeoReader.readParams(d),b=JXG.getReference(this.board,g[2]),a=JXG.getReference(this.board,g[3]),f=this.objects[g[0]],e=this.objects[g[1]];f.addConstraint([this.board.intersection(b,a,0)]);e.addConstraint([this.board.intersection(b,a,1)])};this.prepareString=function(b){var d=[],a;if(b.indexOf("<")!=0){for(a=0;a<b.length;a++){d[a]=JXG.Util.asciiCharCodeAt(b,a)}b=(new JXG.Util.Unzip(d)).unzipFile("construction/intergeo.xml")}return b}};JXG.JSXGraph=new function(f){var g,b,e,a;this.licenseText="JSXGraph v0.76 Copyright (C) see http://jsxgraph.org";this.rendererType="";this.boards={};this.elements={};if((f=="undefined")||(f==null)||(f=="")){g=navigator.appVersion.match(/MSIE (\d\.\d)/);b=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);if((!g)||(b)){this.rendererType="svg"}else{this.rendererType="vml";function d(h){document.body.scrollLeft;document.body.scrollTop}document.onmousemove=d}}else{this.rendererType=f}a=JXG.rendererFiles[this.rendererType].split(",");for(e=0;e<a.length;e++){(function(h){JXG.require(JXG.requirePath+h+".js")})(a[e])}this.initBoard=function(s,o){var y,H,G,B,z,D,q,k,F,E,C,A,x,u,v;k=JXG.getDimensions(s);if(typeof o=="undefined"){o={}}if(typeof o.boundingbox!="undefined"){F=o.boundingbox;D=parseInt(k.width);q=parseInt(k.height);if(o.keepaspectratio){B=D/(F[2]-F[0]);z=q/(-F[3]+F[1]);if(B>z){z=B}else{B=z}}else{B=D/(F[2]-F[0]);z=q/(-F[3]+F[1])}H=-B*F[0];G=z*F[1]}else{H=((typeof o.originX)=="undefined"?150:o.originX);G=((typeof o.originY)=="undefined"?150:o.originY);B=((typeof o.unitX)=="undefined"?50:o.unitX);z=((typeof o.unitY)=="undefined"?50:o.unitY)}E=((typeof o.zoom)=="undefined"?1:o.zoom);C=E*((typeof o.zoomX)=="undefined"?1:o.zoomX);A=E*((typeof o.zoomY)=="undefined"?1:o.zoomY);if(typeof o.showcopyright!="undefined"){o.showCopyright=o.showcopyright}x=((typeof o.showCopyright)=="undefined"?true:o.showCopyright);if(this.rendererType=="svg"){y=new JXG.SVGRenderer(document.getElementById(s))}else{if(this.rendererType=="vml"){y=new JXG.VMLRenderer(document.getElementById(s))}else{y=new JXG.SilverlightRenderer(document.getElementById(s),k.width,k.height)}}v=new JXG.Board(s,y,"",[H,G],1,1,B,z,k.width,k.height,x);this.boards[v.id]=v;v.initInfobox();if((typeof o.axis!="undefined")&&o.axis){v.createElement("axis",[[0,0],[1,0]],{});v.createElement("axis",[[0,0],[0,1]],{})}if((typeof o.grid!="undefined")&&o.grid){v.renderer.drawGrid(v)}if(typeof o.shownavigation!="undefined"){o.showNavigation=o.shownavigation}u=((typeof o.showNavigation)=="undefined"?v.options.showNavigation:o.showNavigation);if(u){v.renderer.drawZoomBar(v)}return v};this.loadBoardFromFile=function(q,h,u){var s,k,o;if(this.rendererType=="svg"){s=new JXG.SVGRenderer(document.getElementById(q))}else{s=new JXG.VMLRenderer(document.getElementById(q))}o=JXG.getDimensions(q);k=new JXG.Board(q,s,"",[150,150],1,1,50,50,o.width,o.height);k.initInfobox();k.beforeLoad();JXG.FileReader.parseFileContent(h,k,u);if(k.options.showNavigation){k.renderer.drawZoomBar(k)}this.boards[k.id]=k;return k};this.loadBoardFromString=function(q,h,u){var s,o,k;if(this.rendererType=="svg"){s=new JXG.SVGRenderer(document.getElementById(q))}else{s=new JXG.VMLRenderer(document.getElementById(q))}o=JXG.getDimensions(q);k=new JXG.Board(q,s,"",[150,150],1,1,50,50,o.width,o.height);k.initInfobox();k.beforeLoad();JXG.FileReader.parseString(h,k,u);if(k.options.showNavigation){k.renderer.drawZoomBar(k)}this.boards[k.id]=k;return k};this.freeBoard=function(k){var h;if(typeof(k)=="string"){k=this.boards[k]}JXG.removeEvent(document,"mousedown",k.mouseDownListener,k);JXG.removeEvent(document,"mouseup",k.mouseUpListener,k);JXG.removeEvent(k.containerObj,"mousemove",k.mouseMoveListener,k);for(h in k.objects){k.removeObject(k.objects[h])}k.containerObj.innerHTML="";for(h in k.objects){delete (k.objects[h])}delete (k.renderer);delete (k.algebra);delete (this.boards[k.id])};this.registerElement=function(h,k){h=h.toLowerCase();this.elements[h]=k};this.unregisterElement=function(h){delete (this.elements[h])}};JXG.getReference=function(b,a){if(typeof(a)=="string"){if(b.objects[a]!=null){a=b.objects[a]}else{if(b.elementsByName[a]!=null){a=b.elementsByName[a]}}}return a};JXG.isString=function(a){return typeof a=="string"};JXG.isNumber=function(a){return typeof a=="number"};JXG.isFunction=function(a){return typeof a=="function"};JXG.isArray=function(a){return a!=null&&typeof a=="object"&&"splice" in a&&"join" in a};JXG.isPoint=function(a){if(typeof a=="object"){return(a.elementClass==JXG.OBJECT_CLASS_POINT)}return false};JXG.createEvalFunction=function(b,g,h){var d=[],a,e;for(a=0;a<h;a++){if(typeof g[a]=="string"){e=b.algebra.geonext2JS(g[a]);e=e.replace(/this\.board\./g,"board.");d[a]=new Function("","return "+(e)+";")}}return function(o){var f=g[o];if(typeof f=="string"){return d[o]()}else{if(typeof f=="function"){return f()}else{if(typeof f=="number"){return f}}}return 0}};JXG.createFunction=function(b,d,e,f){var a;if((f==null||f==true)&&JXG.isString(b)){a=d.algebra.geonext2JS(b);return new Function(e,"return "+a+";")}else{if(JXG.isFunction(b)){return b}else{if(JXG.isNumber(b)){return function(){return b}}else{if(JXG.isString(b)){return function(){return b}}}}}return null};JXG.getDimensions=function(g){var f,k,d,o,h,b,a,e;f=document.getElementById(g);if(f==null){throw ("\nJSXGraph error: HTML container element '"+(g)+"' not found.")}k=f.style.display;if(k!="none"&&k!=null){return{width:f.offsetWidth,height:f.offsetHeight}}d=f.style;o=d.visibility;h=d.position;b=d.display;d.visibility="hidden";d.position="absolute";d.display="block";a=f.clientWidth;e=f.clientHeight;d.display=b;d.position=h;d.visibility=o;return{width:a,height:e}};JXG.addEvent=function(e,d,b,a){if(typeof Prototype!="undefined"&&typeof Prototype.Browser!="undefined"){a["x_internal"+d]=b.bindAsEventListener(a);Event.observe(e,d,a["x_internal"+d])}else{a["x_internal"+d]=function(){return b.apply(a,arguments)};$(e).bind(d,a["x_internal"+d])}};JXG.bind=function(b,a){return function(){return b.apply(a,arguments)}};JXG.removeEvent=function(e,d,b,a){if(typeof Prototype!="undefined"&&typeof Prototype.Browser!="undefined"){Event.stopObserving(e,d,a["x_internal"+d])}else{$(e).unbind(d,a["x_internal"+d])}};JXG.getPosition=function(b){var a=0,d=0,b;if(!b){b=window.event}if(b.pageX||b.pageY){a=b.pageX;d=b.pageY}else{if(b.clientX||b.clientY){a=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;d=b.clientY+document.body.scrollTop+document.documentElement.scrollTop}}return[a,d]};JXG.getOffset=function(a){var b;if(typeof Prototype!="undefined"&&typeof Prototype.Browser!="undefined"){return Element.cumulativeOffset(a)}else{b=$(a).offset();return[b.left,b.top]}};JXG.getStyle=function(b,a){if(typeof Prototype!="undefined"&&typeof Prototype.Browser!="undefined"){return $(b).getStyle(a)}else{if(typeof $(b).attr(a)!="undefined"){return $(b).attr(a)}else{return $(b).css(a)}}};JXG.keys=function(a){var b=[],d;for(d in a){b.push(d)}return b};JXG.escapeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};JXG.unescapeHTML=function(a){return a.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")};JXG.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()};JXG.isSilverlightInstalled=function(){var d=false,a,g,b;try{a=null;g=false;if(window.ActiveXObject){try{a=new ActiveXObject("AgControl.AgControl");d=true;a=null}catch(f){g=true}}else{g=true}if(g){b=navigator.plugins["Silverlight Plug-In"];if(b){d=true}}}catch(f){d=false}return d};JXG.OBJECT_TYPE_ARC=1330921795;JXG.OBJECT_TYPE_ARROW=1330921815;JXG.OBJECT_TYPE_AXIS=1330921816;JXG.OBJECT_TYPE_TICKS=1330926680;JXG.OBJECT_TYPE_CIRCLE=1330922316;JXG.OBJECT_TYPE_CURVE=1330923344;JXG.OBJECT_TYPE_GLIDER=1330923340;JXG.OBJECT_TYPE_IMAGE=1330926157;JXG.OBJECT_TYPE_LINE=1330924622;JXG.OBJECT_TYPE_POINT=1330925652;JXG.OBJECT_TYPE_SLIDER=1330926404;JXG.OBJECT_TYPE_CAS=1330922320;JXG.OBJECT_TYPE_POLYGON=1330925657;JXG.OBJECT_TYPE_SECTOR=1330926403;JXG.OBJECT_TYPE_TEXT=1330926661;JXG.OBJECT_TYPE_ANGLE=1330921799;JXG.OBJECT_TYPE_INTERSECTION=1330926158;JXG.OBJECT_TYPE_TURTLE=5198933;JXG.OBJECT_CLASS_POINT=1;JXG.OBJECT_CLASS_LINE=2;JXG.OBJECT_CLASS_CIRCLE=3;JXG.OBJECT_CLASS_CURVE=4;JXG.OBJECT_CLASS_AREA=5;JXG.OBJECT_CLASS_OTHER=6;JXG.GeometryElement=function(){this.board=null;this.id="";this.needsUpdate=true;this.name="";this.visProp={};this.isReal=true;this.visProp.dash=0;this.childElements={};this.hasLabel=false;this.notExistingParents={};this.traced=false;this.traces={};this.numTraces=0;this.transformations=[];this.baseElement=null;this.descendants={};this.ancestors={};this.symbolic={};this.stdform=[1,0,0,0,1,1,0,0];this.afterFirstUpdate=false;this.needsRegularUpdate=true};JXG.GeometryElement.prototype.init=function(b,d,a){if(typeof(b)=="string"){b=JXG.JSXGraph.boards[b]}this.board=b;this.id=d;if((a!=null)&&(typeof a!="undefined")){a=a}else{a=this.board.generateName(this)}this.board.elementsByName[a]=this;this.name=a;this.visProp.strokeColor=this.board.options.elements.color.strokeColor;this.visProp.highlightStrokeColor=this.board.options.elements.color.highlightStrokeColor;this.visProp.fillColor=this.board.options.elements.color.fillColor;this.visProp.highlightFillColor=this.board.options.elements.color.highlightFillColor;this.visProp.strokeWidth=this.board.options.elements.strokeWidth;this.visProp.strokeOpacity=this.board.options.elements.color.strokeOpacity;this.visProp.highlightStrokeOpacity=this.board.options.elements.color.highlightStrokeOpacity;this.visProp.fillOpacity=this.board.options.elements.color.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.elements.color.highlightFillOpacity;this.visProp.draft=this.board.options.elements.draft.draft;this.visProp.visible=true;this.visProp.shadow=false;this.visProp.gradient="none";this.visProp.gradientSecondColor="black";this.visProp.gradientAngle="270";this.visProp.gradientSecondOpacity=this.visProp.fillOpacity;this.visProp.gradientPositonX=0.5;this.visProp.gradientPositonY=0.5};JXG.GeometryElement.prototype.addChild=function(d){var b,a;this.childElements[d.id]=d;this.addDescendants(d);d.ancestors[this.id]=this;for(b in this.descendants){this.descendants[b].ancestors[this.id]=this;for(a in this.ancestors){this.descendants[b].ancestors[this.ancestors[a].id]=this.ancestors[a]}}for(b in this.ancestors){for(a in this.descendants){this.ancestors[b].descendants[this.descendants[a].id]=this.descendants[a]}}};JXG.GeometryElement.prototype.addDescendants=function(b){var a;this.descendants[b.id]=b;for(a in b.childElements){this.addDescendants(b.childElements[a])}};JXG.GeometryElement.prototype.generatePolynomial=function(){return[]};JXG.GeometryElement.prototype.update=function(){if(this.traced){this.cloneToBackground(true)}};JXG.GeometryElement.prototype.updateRenderer=function(){};JXG.GeometryElement.prototype.hideElement=function(){this.visProp.visible=false;this.board.renderer.hide(this);if(this.label!=null&&this.hasLabel){this.label.hiddenByParent=true;if(this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}};JXG.GeometryElement.prototype.showElement=function(){this.visProp.visible=true;this.board.renderer.show(this);if(this.label!=null&&this.hasLabel&&this.label.hiddenByParent){this.label.hiddenByParent=false;if(this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}};JXG.GeometryElement.prototype.setProperty=function(){var d;var e;var h;for(var g=0;g<arguments.length;g++){var b=arguments[g];if(typeof b=="string"){h=b.split(":")}else{if(!JXG.isArray(b)){for(var f in b){this.setProperty([f,b[f]])}return}else{h=b}}switch(h[0].replace(/\s+/g).toLowerCase()){case"strokewidth":this.visProp.strokeWidth=h[1];this.board.renderer.setObjectStrokeWidth(this,this.visProp.strokeWidth);break;case"strokecolor":d=h[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.strokeColor=d;this.visProp.strokeOpacity=parseInt(e.toUpperCase(),16)/255;this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,this.visProp.strokeOpacity);break;case"fillcolor":d=h[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.fillColor=d;this.visProp.fillOpacity=parseInt(e.toUpperCase(),16)/255;this.board.renderer.setObjectFillColor(this,this.visProp.fillColor,this.visProp.fillOpacity);break;case"highlightstrokecolor":d=h[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.highlightStrokeColor=d;this.visProp.highlightStrokeOpacity=parseInt(e.toUpperCase(),16)/255;break;case"highlightfillcolor":d=h[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.highlightFillColor=d;this.visProp.highlightFillOpacity=parseInt(e.toUpperCase(),16)/255;break;case"fillopacity":this.visProp.fillOpacity=h[1];this.board.renderer.setObjectFillColor(this,this.visProp.fillColor,this.visProp.fillOpacity);break;case"strokeopacity":this.visProp.strokeOpacity=h[1];this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,this.visProp.strokeOpacity);break;case"highlightfillopacity":this.visProp.highlightFillOpacity=h[1];break;case"highlightstrokeopacity":this.visProp.highlightStrokeOpacity=h[1];break;case"labelcolor":d=h[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}if(e=="00"){if(this.label!=null&&this.hasLabel){this.label.content.hideElement()}}if(this.label!=null&&this.hasLabel){this.label.color=d;this.board.renderer.setObjectStrokeColor(this.label.content,d,e)}if(this.type==JXG.OBJECT_TYPE_TEXT){this.visProp.strokeColor=d;this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,1)}break;case"showinfobox":if(h[1]=="false"||h[1]==false){this.showInfobox=false}else{if(h[1]=="true"||h[1]==true){this.showInfobox=true}}break;case"visible":if(h[1]=="false"||h[1]==false){this.visProp.visible=false;this.hideElement()}else{if(h[1]=="true"||h[1]==true){this.visProp.visible=true;this.showElement()}}break;case"dash":this.setDash(h[1]);break;case"trace":if(h[1]=="false"||h[1]==false){this.traced=false}else{if(h[1]=="true"||h[1]==true){this.traced=true}}break;case"style":this.setStyle(1*h[1]);break;case"face":this.setFace(h[1]);break;case"size":this.visProp.size=1*h[1];this.board.renderer.updatePoint(this);break;case"fixed":this.fixed=(h[1]=="false")?false:true;break;case"shadow":if(h[1]=="false"||h[1]==false){this.visProp.shadow=false}else{if(h[1]=="true"||h[1]==true){this.visProp.shadow=true}}this.board.renderer.setShadow(this);break;case"gradient":this.visProp.gradient=h[1];this.board.renderer.setGradient(this);break;case"draft":if(h[1]=="false"||h[1]==false){if(this.visProp.draft==true){this.visProp.draft=false;this.board.renderer.removeDraft(this)}}else{if(h[1]=="true"||h[1]==true){this.visProp.draft=true;this.board.renderer.setDraft(this)}}break;case"straightfirst":if(h[1]=="false"||h[1]==false){this.visProp.straightFirst=false}else{if(h[1]=="true"||h[1]==true){this.visProp.straightFirst=true}}this.setStraight(this.visProp.straightFirst,this.visProp.straightLast);break;case"straightlast":if(h[1]=="false"||h[1]==false){this.visProp.straightLast=false}else{if(h[1]=="true"||h[1]==true){this.visProp.straightLast=true}}this.setStraight(this.visProp.straightFirst,this.visProp.straightLast);break;case"firstarrow":if(h[1]=="false"||h[1]==false){this.visProp.firstArrow=false}else{if(h[1]=="true"||h[1]==true){this.visProp.firstArrow=true}}this.setArrow(this.visProp.firstArrow,this.visProp.lastArrow);break;case"lastarrow":if(h[1]=="false"||h[1]==false){this.visProp.lastArrow=false}else{if(h[1]=="true"||h[1]==true){this.visProp.lastArrow=true}}this.setArrow(this.visProp.firstArrow,this.visProp.lastArrow);break;case"curvetype":this.curveType=h[1];break;case"fontsize":this.visProp.fontSize=h[1];break;case"insertticks":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.insertTicks;this.insertTicks=true;if(h[1]=="false"||h[1]==false){this.insertTicks=false}if(a!=this.insertTicks){this.calculateTicksCoordinates()}}break;case"drawlabels":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.drawLabels;this.drawLabels=true;if(h[1]=="false"||h[1]==false){this.drawLabels=false}if(a!=this.drawLabels){this.calculateTicksCoordinates()}}break;case"drawzero":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.drawZero;this.drawZero=true;if(h[1]=="false"||h[1]==false){this.drawZero=false}if(a!=this.drawZero){this.calculateTicksCoordinates()}}break;case"minorticks":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.minorTicks;if((h[1]!=null)&&(h[1]>0)){this.minorTicks=h[1]}if(a!=this.minorTicks){this.calculateTicksCoordinates()}}break;case"majortickheight":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.majorHeight;if((h[1]!=null)&&(h[1]>0)){this.majorHeight=h[1]}if(a!=this.majorHeight){this.calculateTicksCoordinates()}}break;case"minortickheight":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.minorHeight;if((h[1]!=null)&&(h[1]>0)){this.minorHeight=h[1]}if(a!=this.minorHeight){this.calculateTicksCoordinates()}}break;case"snapwidth":if(this.type==JXG.OBJECT_TYPE_GLIDER){this.snapWidth=h[1]}}}};JXG.GeometryElement.prototype.setDash=function(a){this.visProp.dash=a;this.board.renderer.setDashStyle(this,this.visProp)};JXG.GeometryElement.prototype.prepareUpdate=function(){this.needsUpdate=true;return;for(var a in this.childElements){if(this.board.objects[a]!=undefined){this.childElements[a].prepareUpdate()}else{delete (this.childElements[a])}}};JXG.GeometryElement.prototype.remove=function(){this.board.renderer.remove(document.getElementById(this.id));if(this.hasLabel){this.board.renderer.remove(document.getElementById(this.label.content.id))}};JXG.GeometryElement.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)};JXG.GeometryElement.prototype.getLabelAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)};JXG.GeometryElement.prototype.setStyle=function(a){};JXG.GeometryElement.prototype.setStraight=function(a,b){};JXG.GeometryElement.prototype.setArrow=function(b,a){};JXG.GeometryElement.prototype.createLabel=function(b,d){if(typeof d=="undefined"||d==null){d=[10,10]}var a=false;this.nameHTML=this.board.algebra.replaceSup(this.board.algebra.replaceSub(this.name));this.label={};if(typeof b=="undefined"||b==true){if(this.board.objects[this.id]==null){this.board.objects[this.id]=this;a=true}this.label.relativeCoords=d;this.label.content=new JXG.Text(this.board,this.nameHTML,this.id,[this.label.relativeCoords[0]/(this.board.unitX*this.board.zoomX),this.label.relativeCoords[1]/(this.board.unitY*this.board.zoomY)],this.id+"Label","",null,true);if(a){delete (this.board.objects[this.id])}this.label.color="#000000";if(!this.visProp.visible){this.label.hiddenByParent=true;this.label.content.visProp.visible=false}this.hasLabel=true}};JXG.GeometryElement.prototype.addLabelToElement=function(){this.createLabel(true);this.label.content.id=this.id+"Label";this.board.addText(this.label.content);this.board.renderer.drawText(this.label.content);if(!this.label.content.visProp.visible){board.renderer.hide(this.label.content)}};JXG.GeometryElement.prototype.highlight=function(){this.board.renderer.highlight(this)};JXG.GeometryElement.prototype.noHighlight=function(){this.board.renderer.noHighlight(this)};JXG.GeometryElement.prototype.clearTrace=function(){for(var a in this.traces){this.board.renderer.remove(this.traces[a])}this.numTraces=0};JXG.GeometryElement.prototype.cloneToBackground=function(a){return};JXG.GeometryElement.prototype.normalize=function(){this.stdform=this.board.algebra.normalize(this.stdform)};JXG.GeometryElement.prototype.toJSON=function(){var b='{"name":'+this.name;b+=', "id":'+this.id;var d=[];for(var a in this.visProp){if(this.visProp[a]!=null){d.push('"'+a+'":'+this.visProp[a])}}b+=', "visProp":{'+d.toString()+"}";b+="}";return b};JXG.COORDS_BY_USER=1;JXG.COORDS_BY_SCREEN=2;JXG.Coords=function(d,b,a){this.board=a;this.usrCoords=[1,0,0];this.scrCoords=[1,0,0];if(d==JXG.COORDS_BY_USER){if(b.length<=2){this.usrCoords[1]=b[0];this.usrCoords[2]=b[1]}else{this.usrCoords[0]=b[0];this.usrCoords[1]=b[1];this.usrCoords[2]=b[2];this.normalizeUsrCoords()}this.usr2screen()}else{this.scrCoords[1]=b[0];this.scrCoords[2]=b[1];this.screen2usr()}};JXG.Coords.prototype.normalizeUsrCoords=function(){var a=0.000001;if(Math.abs(this.usrCoords[0])>a){this.usrCoords[1]/=this.usrCoords[0];this.usrCoords[2]/=this.usrCoords[0];this.usrCoords[0]=1}};JXG.Coords.prototype.usr2screen=function(a){if(a==null||a){this.scrCoords[0]=Math.round(this.usrCoords[0]);this.scrCoords[1]=Math.round(this.usrCoords[0]*this.board.origin.scrCoords[1]+this.usrCoords[1]*this.board.unitX*this.board.zoomX);this.scrCoords[2]=Math.round(this.usrCoords[0]*this.board.origin.scrCoords[2]-this.usrCoords[2]*this.board.unitY*this.board.zoomY)}else{this.scrCoords[0]=this.usrCoords[0];this.scrCoords[1]=this.usrCoords[0]*this.board.origin.scrCoords[1]+this.usrCoords[1]*this.board.unitX*this.board.zoomX;this.scrCoords[2]=this.usrCoords[0]*this.board.origin.scrCoords[2]-this.usrCoords[2]*this.board.unitY*this.board.zoomY}};JXG.Coords.prototype.screen2usr=function(){var d=this.board.origin.scrCoords,a=this.board;this.usrCoords[0]=1;this.usrCoords[1]=(this.scrCoords[1]-d[1])/(a.unitX*a.zoomX);this.usrCoords[2]=(d[2]-this.scrCoords[2])/(a.unitY*a.zoomY)};JXG.Coords.prototype.distance=function(g,e){var b=0,a,d;if(g==JXG.COORDS_BY_USER){for(a=0;a<=this.board.dimension;a++){d=this.usrCoords[a]-e.usrCoords[a];b+=d*d}}else{for(a=0;a<=this.board.dimension;a++){d=this.scrCoords[a]-e.scrCoords[a];b+=d*d}}return Math.sqrt(b)};JXG.Coords.prototype.setCoordinates=function(d,b,a){if(d==JXG.COORDS_BY_USER){if(b.length==2){this.usrCoords[0]=1;this.usrCoords[1]=b[0];this.usrCoords[2]=b[1]}else{this.usrCoords[0]=b[0];this.usrCoords[1]=b[1];this.usrCoords[2]=b[2];this.normalizeUsrCoords()}this.usr2screen(a)}else{this.scrCoords[1]=b[0];this.scrCoords[2]=b[1];this.screen2usr()}};JXG.POINT_STYLE_X_SMALL=0;JXG.POINT_STYLE_X=1;JXG.POINT_STYLE_X_BIG=2;JXG.POINT_STYLE_CIRCLE_TINY=3;JXG.POINT_STYLE_CIRCLE_SMALL=4;JXG.POINT_STYLE_CIRCLE=5;JXG.POINT_STYLE_CIRCLE_BIG=6;JXG.POINT_STYLE_SQUARE_SMALL=7;JXG.POINT_STYLE_SQUARE=8;JXG.POINT_STYLE_SQUARE_BIG=9;JXG.POINT_STYLE_PLUS_SMALL=10;JXG.POINT_STYLE_PLUS=11;JXG.POINT_STYLE_PLUS_BIG=12;JXG.Point=function(e,f,g,b,a,d){this.constructor();this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;this.init(e,g,b);if(f==null){f=[0,0]}this.coords=new JXG.Coords(JXG.COORDS_BY_USER,f,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,f,this.board);this.showInfobox=true;this.label={};this.label.relativeCoords=[10,10];this.nameHTML=this.board.algebra.replaceSup(this.board.algebra.replaceSub(this.name));if(typeof d=="undefined"||d==true){this.board.objects[this.id]=this;this.label.content=new JXG.Text(this.board,this.nameHTML,this.id,[this.label.relativeCoords[0]/(this.board.unitX*this.board.zoomX),this.label.relativeCoords[1]/(this.board.unitY*this.board.zoomY)],this.id+"Label","",null,true);delete (this.board.objects[this.id]);this.label.color="#000000";if(!a){this.label.hiddenByParent=true;this.label.content.visProp.visible=false}this.hasLabel=true}else{this.showInfobox=false}this.fixed=false;this.position=null;this.onPolygon=false;this.visProp.style=this.board.options.point.style;this.visProp.face="circle";this.visProp.size=3;this.r=this.board.options.precision.hasPoint;this.visProp.fillColor=this.board.options.point.fillColor;this.visProp.highlightFillColor=this.board.options.point.highlightFillColor;this.visProp.strokeColor=this.board.options.point.strokeColor;this.visProp.highlightStrokeColor=this.board.options.point.highlightStrokeColor;this.visProp.visible=a;this.slideObject=null;this.group=[];this.id=this.board.addPoint(this)};JXG.Point.prototype=new JXG.GeometryElement();JXG.Point.prototype.hasPoint=function(b,d){var a=this.coords.scrCoords;return((Math.abs(a[1]-b)<this.r+2)&&(Math.abs(a[2]-d))<this.r+2)};JXG.Point.prototype.updateConstraint=function(){};JXG.Point.prototype.update=function(f){if(!this.needsUpdate){return}if(typeof f=="undefined"){f=false}if(this.traced){this.cloneToBackground(true)}if(this.type==JXG.OBJECT_TYPE_GLIDER){if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){if(f){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.X()+Math.cos(this.position),this.slideObject.midpoint.Y()+Math.sin(this.position)]);this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject)}else{this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject);this.position=this.board.algebra.rad([this.slideObject.midpoint.X()+1,this.slideObject.midpoint.Y()],this.slideObject.midpoint,this)}}else{if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){this.coords=this.board.algebra.projectPointToLine(this,this.slideObject);var e=this.slideObject.point1.coords;var k=this.slideObject.point2.coords;if(f){if(Math.abs(e.usrCoords[0])>=JXG.Math.eps&&Math.abs(k.usrCoords[0])>=JXG.Math.eps){this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.usrCoords[1]+this.position*(k.usrCoords[1]-e.usrCoords[1]),e.usrCoords[2]+this.position*(k.usrCoords[2]-e.usrCoords[2])])}}else{var o=1;var w=e.distance(JXG.COORDS_BY_USER,this.coords);var b=e.distance(JXG.COORDS_BY_USER,k);var h=k.distance(JXG.COORDS_BY_USER,this.coords);if(((w>b)||(h>b))&&(w<h)){o=-1}this.position=o*w/b;if(this.snapWidth!=null&&Math.abs(this._smax-this._smin)>=JXG.Math.eps){var x=Math.round(this.Value()/this.snapWidth)*this.snapWidth;this.position=o*(x-this._smin)/(this._smax-this._smin);this.update(true)}}var d=this.slideObject.point1.coords.scrCoords;var u=this.slideObject.point2.coords.scrCoords;var g;if(this.slideObject.getSlope()==0){g=1}else{g=2}var q=this.coords.scrCoords[g];if(!this.slideObject.visProp.straightFirst){if(d[g]<u[g]){if(q<d[g]){this.coords=this.slideObject.point1.coords;this.position=0}}else{if(d[g]>u[g]){if(q>d[g]){this.coords=this.slideObject.point1.coords;this.position=0}}}}if(!this.slideObject.visProp.straightLast){if(d[g]<u[g]){if(q>u[g]){this.coords=this.slideObject.point2.coords;this.position=1}}else{if(d[g]>u[g]){if(q<u[g]){this.coords=this.slideObject.point2.coords;this.position=1}}}}if(this.onPolygon){var z=this.slideObject.point1.coords;var s=this.slideObject.point2.coords;if(Math.abs(this.coords.scrCoords[1]-z.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-z.scrCoords[2])<this.r){var a=this.slideObject.parentPolygon;for(var g=0;g<a.borders.length;g++){if(this.slideObject==a.borders[g]){this.slideObject=a.borders[(g-1+a.borders.length)%a.borders.length];break}}}else{if(Math.abs(this.coords.scrCoords[1]-s.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-s.scrCoords[2])<this.r){var a=this.slideObject.parentPolygon;for(var g=0;g<a.borders.length;g++){if(this.slideObject==a.borders[g]){this.slideObject=a.borders[(g+1+a.borders.length)%a.borders.length];break}}}}}}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){this.updateConstraint();this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject)}else{if(this.slideObject.type==JXG.OBJECT_TYPE_TURTLE){this.updateConstraint();this.coords=this.board.algebra.projectPointToTurtle(this,this.slideObject)}}}}}if(this.type==JXG.OBJECT_TYPE_CAS){this.updateConstraint()}this.updateTransform();this.needsUpdate=false};JXG.Point.prototype.updateRenderer=function(){if(this.visProp.visible){var a=this.isReal;this.isReal=(isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]))?false:true;this.isReal=(Math.abs(this.coords.usrCoords[0])>this.board.algebra.eps)?this.isReal:false;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updatePoint(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Point.prototype.X=function(){return this.coords.usrCoords[1]};JXG.Point.prototype.Y=function(){return this.coords.usrCoords[2]};JXG.Point.prototype.Z=function(){return this.coords.usrCoords[0]};JXG.Point.prototype.XEval=function(){return this.coords.usrCoords[1]};JXG.Point.prototype.YEval=function(){return this.coords.usrCoords[2]};JXG.Point.prototype.ZEval=function(){return this.coords.usrCoords[0]};JXG.Point.prototype.Dist=function(a){return this.coords.distance(JXG.COORDS_BY_USER,a.coords)};JXG.Point.prototype.setPositionDirectly=function(e,a,d){var b=this.coords;this.coords=new JXG.Coords(e,[a,d],this.board);if(this.group.length!=0){this.group[this.group.length-1].dX=this.coords.scrCoords[1]-b.scrCoords[1];this.group[this.group.length-1].dY=this.coords.scrCoords[2]-b.scrCoords[2];this.group[this.group.length-1].update(this)}else{this.update()}};JXG.Point.prototype.setPositionByTransform=function(f,a,e){var d=this.coords;var b=this.board.createElement("transform",[a,e],{type:"translate"});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(b)}else{this.addTransform(this,b)}if(this.group.length!=0){}else{this.update()}};JXG.Point.prototype.setPosition=function(d,a,b){this.setPositionByTransform(d,a,b)};JXG.Point.prototype.makeGlider=function(a){this.slideObject=JXG.getReference(this.board,a);this.type=JXG.OBJECT_TYPE_GLIDER;this.snapWidth=null;this.slideObject.addChild(this);if(this.slideObject.elementClass==JXG.OBJECT_CLASS_LINE){this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)}}else{if(this.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE){this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)}}}this.needsUpdate=true;this.update()};JXG.Point.prototype.addConstraint=function(f){this.type=JXG.OBJECT_TYPE_CAS;var g=this.board.elementsByName;var h=[];var a;for(var e=0;e<f.length;e++){var b=f[e];if(typeof b=="string"){var d=this.board.algebra.geonext2JS(b);h[e]=new Function("","return "+d+";")}else{if(typeof b=="function"){h[e]=b}else{if(typeof b=="number"){h[e]=function(k){return function(){return k}}(b)}else{if(typeof b=="object"&&typeof b.Value=="function"){h[e]=(function(k){return function(){return k.Value()}})(b)}}}}}if(f.length==1){this.updateConstraint=function(){this.coords=h[0]()};if(!this.board.isSuspendedUpdate){this.update()}return}else{if(f.length==2){this.XEval=h[0];this.YEval=h[1];a="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.XEval(),this.YEval()]);";this.updateConstraint=new Function("",a)}else{this.ZEval=h[0];this.XEval=h[1];this.YEval=h[2];a="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]);";this.updateConstraint=new Function("",a)}}if(!this.board.isSuspendedUpdate){this.update()}return};JXG.Point.prototype.updateTransform=function(){if(this.transformations.length==0||this.baseElement==null){return}if(this===this.baseElement){var b=this.transformations[0].apply(this.baseElement,"self")}else{var b=this.transformations[0].apply(this.baseElement)}this.coords.setCoordinates(JXG.COORDS_BY_USER,[b[1],b[2]]);for(var a=1;a<this.transformations.length;a++){b=this.transformations[a].apply(this);this.coords.setCoordinates(JXG.COORDS_BY_USER,[b[1],b[2]])}};JXG.Point.prototype.addTransform=function(d,a){if(this.transformations.length==0){this.baseElement=d}var e;if(JXG.isArray(a)){e=a}else{e=[a]}for(var b=0;b<e.length;b++){this.transformations.push(e[b])}};JXG.Point.prototype.startAnimation=function(a,b){if((this.type==JXG.OBJECT_TYPE_GLIDER)&&(typeof this.intervalCode=="undefined")){this.intervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].objects['"+this.id+"'].animate("+a+", "+b+")",250);if(typeof this.intervalCount=="undefined"){this.intervalCount=0}}};JXG.Point.prototype.stopAnimation=function(){if(typeof this.intervalCode!="undefined"){window.clearInterval(this.intervalCode);delete (this.intervalCode)}};JXG.Point.prototype.animate=function(s,g){this.intervalCount++;if(this.intervalCount>g){this.intervalCount=0}if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){var b=this.slideObject.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.slideObject.point2.coords);var o=this.slideObject.getSlope();var h;var f;if(o!="INF"){var e=Math.atan(o);h=Math.round((this.intervalCount/g)*b*Math.cos(e));f=Math.round((this.intervalCount/g)*b*Math.sin(e))}else{h=0;f=Math.round((this.intervalCount/g)*b)}var d;var q=1;if(s<0){d=this.slideObject.point2;if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0){q=-1}else{if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0){if(this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0){q=-1}}}}else{d=this.slideObject.point1;if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0){q=-1}else{if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0){if(this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0){q=-1}}}}this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+q*h,d.coords.scrCoords[2]+q*f])}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){var a;if(s>0){a=Math.round(this.intervalCount/g*this.board.canvasWidth)}else{a=Math.round((g-this.intervalCount)/g*this.board.canvasWidth)}this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[a,0]);this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject)}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){var e;if(s<0){e=this.intervalCount/g*2*Math.PI}else{e=(g-this.intervalCount)/g*2*Math.PI}var k=this.slideObject.getRadius();this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.coords.usrCoords[1]+k*Math.cos(e),this.slideObject.midpoint.coords.usrCoords[2]+k*Math.sin(e)])}}}this.board.update(this)};JXG.Point.prototype.setStyle=function(a){if(a==0||a==1||a==2){this.visProp.face="cross";if(a==0){this.visProp.size=2}else{if(a==1){this.visProp.size=3}else{this.visProp.size=4}}}else{if(a==3||a==4||a==5||a==6){this.visProp.face="circle";if(a==3){this.visProp.size=1}else{if(a==4){this.visProp.size=2}else{if(a==5){this.visProp.size=3}else{this.visProp.size=4}}}}else{if(a==7||a==8||a==9){this.visProp.face="square";if(a==7){this.visProp.size=2}else{if(a==8){this.visProp.size=3}else{this.visProp.size=4}}}else{if(a==10||a==11||a==12){this.visProp.face="plus";if(a==10){this.visProp.size=2}else{if(a==11){this.visProp.size=3}else{this.visProp.size=4}}}}}}this.board.renderer.changePointStyle(this)};JXG.Point.prototype.setFace=function(a){if(a=="cross"||a=="plus"||a=="circle"||a=="square"){this.visProp.face=a}else{this.visProp.face="circle"}this.board.renderer.changePointStyle(this)};JXG.Point.prototype.remove=function(){if(this.hasLabel){this.board.renderer.remove(document.getElementById(this.label.content.id))}this.board.renderer.remove(document.getElementById(this.id))};JXG.Point.prototype.getTextAnchor=function(){return this.coords};JXG.Point.prototype.getLabelAnchor=function(){return this.coords};JXG.Point.prototype.cloneToBackground=function(a){var b={};b.id=this.id+"T"+this.numTraces;this.numTraces++;b.coords=this.coords;b.visProp=this.visProp;b.elementClass=JXG.OBJECT_CLASS_POINT;this.board.renderer.drawPoint(b);this.traces[b.id]=document.getElementById(b.id);delete b};JXG.createPoint=function(f,b,g){var e;if(g==null){g={}}if(typeof g.withLabel=="undefined"){g.withLabel=true}var a=false;for(var d=0;d<b.length;d++){if(typeof b[d]=="function"||typeof b[d]=="string"){a=true}}if(!a){if((JXG.isNumber(b[0]))&&(JXG.isNumber(b[1]))){e=new JXG.Point(f,b,g.id,g.name,(g.visible==undefined)||f.algebra.str2Bool(g.visible),g.withLabel);if(g.slideObject!=null){e.makeGlider(g.slideObject)}else{e.baseElement=e}}else{if((typeof b[0]=="object")&&(typeof b[1]=="object")){e=new JXG.Point(f,[0,0],g.id,g.name,(g.visible==undefined)||f.algebra.str2Bool(g.visible),g.withLabel);e.addTransform(b[0],b[1])}else{throw ("JSXGraph error: Can't create point with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}}}else{e=new JXG.Point(f,[0,0],g.id,g.name,(g.visible==undefined)||f.algebra.str2Bool(g.visible),g.withLabel);e.addConstraint(b)}return e};JXG.createGlider=function(d,a,e){var b;if(e==null){e={}}if(typeof e.withLabel=="undefined"){e.withLabel=true}if(a.length==1){b=new JXG.Point(d,[0,0],e.id,e.name,(e.visible==undefined)||d.algebra.str2Bool(e.visible),e.withLabel)}else{b=d.createElement("point",a.slice(0,-1),e)}b.makeGlider(a[a.length-1]);return b};JXG.createIntersectionPoint=function(e,b,a){var d;if(b.length>=3){if(b.length==3){b.push(null)}d=e.createElement("point",[e.intersection(b[0],b[1],b[2],b[3])],a)}b[0].addChild(d);b[1].addChild(d);d.generatePolynomial=function(){var f=b[0].generatePolynomial(d);var g=b[1].generatePolynomial(d);if((f.length==0)||(g.length==0)){return[]}else{return[f[0],g[0]]}};return d};JXG.JSXGraph.registerElement("point",JXG.createPoint);JXG.JSXGraph.registerElement("glider",JXG.createGlider);JXG.JSXGraph.registerElement("intersection",JXG.createIntersectionPoint);JXG.Line=function(d,f,e,g,a,b){this.constructor();this.type=JXG.OBJECT_TYPE_LINE;this.elementClass=JXG.OBJECT_CLASS_LINE;this.init(d,g,a);this.point1=JXG.getReference(this.board,f);this.point2=JXG.getReference(this.board,e);this.image=null;this.imageTransformMatrix=[[1,0,0],[0,1,0],[0,0,1]];this.r=this.board.options.precision.hasPoint;this.visProp.fillColor=this.board.options.line.fillColor;this.visProp.highlightFillColor=this.board.options.line.highlightFillColor;this.visProp.strokeColor=this.board.options.line.strokeColor;this.visProp.highlightStrokeColor=this.board.options.line.highlightStrokeColor;this.visProp.straightFirst=this.board.options.line.straightFirst;this.visProp.straightLast=this.board.options.line.straightLast;this.visProp.visible=true;this.visProp.firstArrow=this.board.options.line.firstArrow;this.visProp.lastArrow=this.board.options.line.lastArrow;this.ticks=[];this.defaultTicks=null;this.parentPolygon=null;this.createLabel(b);this.id=this.board.addLine(this);this.point1.addChild(this);this.point2.addChild(this);this.update()};JXG.Line.prototype=new JXG.GeometryElement;JXG.Line.prototype.hasPoint=function(k,g){var f=[],s=[1,k,g],o=[],w,d,h,b,q,u,e,a;f[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/(this.board.unitX*this.board.zoomX)+this.stdform[2]*this.board.origin.scrCoords[2]/(this.board.unitY*this.board.zoomY);f[1]=this.stdform[1]/(this.board.unitX*this.board.zoomX);f[2]=this.stdform[2]/(-this.board.unitY*this.board.zoomY);w=this.board.algebra.innerProduct(s,f,3)/this.board.algebra.innerProduct(f,f,3);for(d=0;d<3;d++){o[d]=s[d]-w*f[d]}o[1]/=o[0];o[2]/=o[0];o[0]=1;if(this.board.algebra.distance(s,o)>this.r){return false}if(this.visProp.straightFirst&&this.visProp.straightLast){return true}else{h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[o[1],o[2]],this.board);b=this.point1.coords.scrCoords;q=this.point2.coords.scrCoords;u=h.distance(JXG.COORDS_BY_SCREEN,this.point1.coords);e=h.distance(JXG.COORDS_BY_SCREEN,this.point2.coords);a=this.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.point2.coords);if((u>a)||(e>a)){if(u<e){if(!this.visProp.straightFirst){return false}}else{if(!this.visProp.straightLast){return false}}}return true}};JXG.Line.prototype.update=function(){var a,b;if(this.constrained){if(typeof this.funps!="undefined"){b=this.funps();this.point1=b[0];this.point2=b[1]}else{this.point1=this.funp1();this.point2=this.funp2()}}if(this.needsUpdate){if(true||!this.board.geonextCompatibilityMode){this.updateStdform()}for(a=0;a<this.ticks.length;a++){if(typeof this.ticks[a]!="undefined"){this.ticks[a].calculateTicksCoordinates()}}}if(this.traced){this.cloneToBackground(true)}};JXG.Line.prototype.updateStdform=function(){var a=this.board.algebra.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=a[0];this.stdform[1]=a[1];this.stdform[2]=a[2];this.stdform[3]=0;this.normalize()};JXG.Line.prototype.updateRenderer=function(){var a;if(this.needsUpdate&&this.visProp.visible){a=this.isReal;this.isReal=(isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2]))?false:true;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updateLine(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Line.prototype.generatePolynomial=function(f){var e=this.point1.symbolic.x,d=this.point1.symbolic.y,h=this.point2.symbolic.x,g=this.point2.symbolic.y,b=f.symbolic.x,a=f.symbolic.y;return[[d,"*",b,"-",d,"*",h,"+",a,"*",h,"-",e,"*",a,"+",e,"*",g,"-",b,"*",g].join("")]};JXG.Line.prototype.getRise=function(){if(Math.abs(this.stdform[2])>=JXG.Math.eps){return -this.stdform[0]/this.stdform[2]}else{return Infinity}};JXG.Line.prototype.getSlope=function(){if(Math.abs(this.stdform[2])>=JXG.Math.eps){return -this.stdform[1]/this.stdform[2]}else{return Infinity}};JXG.Line.prototype.setStraight=function(a,b){this.visProp.straightFirst=a;this.visProp.straightLast=b;this.board.renderer.updateLine(this)};JXG.Line.prototype.setArrow=function(b,a){this.visProp.firstArrow=b;this.visProp.lastArrow=a;this.board.renderer.updateLine(this)};JXG.Line.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0.5*(this.point2.X()-this.point1.X()),0.5*(this.point2.Y()-this.point1.Y())],this.board)};JXG.Line.prototype.getLabelAnchor=function(){var f,d,b,e,a;if(!this.visProp.straightFirst&&!this.visProp.straightLast){return new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X()-0.5*(this.point2.X()-this.point1.X()),this.point2.Y()-0.5*(this.point2.Y()-this.point1.Y())],this.board)}else{d=new JXG.Coords(JXG.COORDS_BY_USER,this.point1.coords.usrCoords,this.board);b=new JXG.Coords(JXG.COORDS_BY_USER,this.point2.coords.usrCoords,this.board);this.board.renderer.calcStraight(this,d,b);if(this.visProp.straightFirst){f=d}else{f=b}if(this.label.content!=null){e=[0,0];a=this.getSlope();if(f.scrCoords[2]==0){if(a==Infinity){e=[10,-10]}else{if(a>=0){e=[10,-10]}else{e=[-10,-10]}}}else{if(f.scrCoords[2]==this.board.canvasHeight){if(a==Infinity){e=[10,10]}else{if(a>=0){e=[-10,10]}else{e=[10,10]}}}}if(f.scrCoords[1]==0){if(a==Infinity){e=[10,10]}else{if(a>=0){e=[10,-10]}else{e=[10,10]}}}else{if(f.scrCoords[1]==this.board.canvasWidth){if(a==Infinity){e=[-10,10]}else{if(a>=0){e=[-10,10]}else{e=[-10,-10]}}}}this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[e[0]/(this.board.unitX*this.board.zoomX),e[1]/(this.board.unitY*this.board.zoomY)],this.board)}return f}};JXG.Line.prototype.cloneToBackground=function(b){var e={},d,a;e.id=this.id+"T"+this.numTraces;this.numTraces++;e.point1=this.point1;e.point2=this.point2;e.stdform=this.stdform;e.board={};e.board.unitX=this.board.unitX;e.board.unitY=this.board.unitY;e.board.zoomX=this.board.zoomX;e.board.zoomY=this.board.zoomY;e.board.origin=this.board.origin;e.board.canvasHeight=this.board.canvasHeight;e.board.canvasWidth=this.board.canvasWidth;e.board.dimension=this.board.dimension;e.board.algebra=this.board.algebra;e.visProp=this.visProp;a=this.getSlope();d=this.getRise();e.getSlope=function(){return a};e.getRise=function(){return d};this.board.renderer.enhancedRendering=true;this.board.renderer.drawLine(e);this.board.renderer.enhancedRendering=false;this.traces[e.id]=document.getElementById(e.id);delete e};JXG.Line.prototype.addTransform=function(a){var d,b;if(JXG.isArray(a)){d=a}else{d=[a]}for(b=0;b<d.length;b++){this.point1.transformations.push(d[b]);this.point2.transformations.push(d[b])}};JXG.Line.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});if(this.point1.transformations.length>0&&this.point1.transformations[this.point1.transformations.length-1].isNumericMatrix){this.point1.transformations[this.point1.transformations.length-1].melt(b)}else{this.point1.addTransform(this.point1,b)}if(this.point2.transformations.length>0&&this.point2.transformations[this.point2.transformations.length-1].isNumericMatrix){this.point2.transformations[this.point2.transformations.length-1].melt(b)}else{this.point2.addTransform(this.point2,b)}};JXG.Line.prototype.X=function(k){var s=this.stdform[1],q=this.stdform[2],o=this.stdform[0],g,f,d,e,h;k*=Math.PI;g=s*Math.cos(k)+q*Math.sin(k);f=o;d=Math.sqrt(g*g+f*f);e=-f/d;h=g/d;if(Math.abs(h)<this.board.algebra.eps){h=1}return e*Math.cos(k)/h};JXG.Line.prototype.Y=function(k){var s=this.stdform[1],q=this.stdform[2],o=this.stdform[0],g,f,d,e,h;k*=Math.PI;g=s*Math.cos(k)+q*Math.sin(k);f=o;d=Math.sqrt(g*g+f*f);e=-f/d;h=g/d;if(Math.abs(h)<this.board.algebra.eps){h=1}return e*Math.sin(k)/h};JXG.Line.prototype.Z=function(h){var f=this.stdform[1],e=this.stdform[2],q=this.stdform[0],d,o,g,k;h*=Math.PI;d=f*Math.cos(h)+e*Math.sin(h);o=q;g=Math.sqrt(d*d+o*o);k=d/g;if(Math.abs(k)>=this.board.algebra.eps){return 1}else{return 0}};JXG.Line.prototype.minX=function(){return 0};JXG.Line.prototype.maxX=function(){return 1};JXG.Line.prototype.addTicks=function(a){if(a.id==""||typeof a.id=="undefined"){a.id=this.id+"_ticks_"+(this.ticks.length+1)}this.board.renderer.drawTicks(a);this.ticks.push(a);this.ticks[this.ticks.length-1].updateRenderer();return a.id};JXG.Line.prototype.removeAllTicks=function(){var a;for(a=this.ticks.length;a>0;a--){this.board.renderer.remove(this.ticks[a-1].rendNode)}this.ticks=new Array()};JXG.Line.prototype.removeTicks=function(d){var b,a;if(this.defaultTicks!=null&&this.defaultTicks==d){this.defaultTicks=null}for(b=this.ticks.length;b>0;b--){if(this.ticks[b-1]==d){this.board.renderer.remove(this.ticks[b-1].rendNode);for(a=0;a<this.ticks[b-1].ticks.length;a++){if(this.ticks[b-1].labels[a]!=null){if(this.ticks[b-1].labels[a].show){this.board.renderer.remove(this.ticks[b-1].labels[a].rendNode)}}}delete (this.ticks[b-1])}}};JXG.createLine=function(g,k,f){var b,q,o,e,h=[];if(f==null){f={}}if(f.withLabel==null||typeof f.withLabel=="undefined"){f.withLabel=false}var d=false;if(k.length==2){if(k[0].length>1){q=g.createElement("point",k[0],{visible:false,fixed:true})}else{if(k[0].elementClass==JXG.OBJECT_CLASS_POINT){q=JXG.getReference(g,k[0])}else{if((typeof k[0]=="function")&&(k[0]().elementClass==JXG.OBJECT_CLASS_POINT)){q=k[0]();d=true}else{throw ("Can't create line with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}}}if(k[1].length>1){o=g.createElement("point",k[1],{visible:false,fixed:true})}else{if(k[1].elementClass==JXG.OBJECT_CLASS_POINT){o=JXG.getReference(g,k[1])}else{if((typeof k[1]=="function")&&(k[1]().elementClass==JXG.OBJECT_CLASS_POINT)){o=k[1]();d=true}else{throw ("Can't create line with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}}}b=new JXG.Line(g,q.id,o.id,f.id,f.name,f.withLabel);if(d){b.constrained=true;b.funp1=k[0];b.funp2=k[1]}}else{if(k.length==3){for(e=0;e<3;e++){if(typeof k[e]=="number"){h[e]=function(s){return function(){return s}}(k[e])}else{if(typeof k[e]=="function"){h[e]=k[e]}else{throw ("Can't create line with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"' and '"+(typeof k[2])+"'.");return}}}q=g.createElement("point",[function(){return 0},function(){return h[2]()},function(){return -h[1]()}],{visible:false,name:" "});o=g.createElement("point",[function(){return h[2]()*h[2]()+h[1]()*h[1]()},function(){return -h[1]()*h[0]()+h[2]()},function(){return -h[2]()*h[0]()-h[1]()}],{visible:false,name:" "});b=new JXG.Line(g,q.id,o.id,f.id,f.name,f.withLabel)}else{if((k.length==1)&&(typeof k[0]=="function")&&(k[0]().length==2)&&(k[0]()[0].elementClass==JXG.OBJECT_CLASS_POINT)&&(k[0]()[1].elementClass==JXG.OBJECT_CLASS_POINT)){var a=k[0]();b=new JXG.Line(g,a[0].id,a[1].id,f.id,f.name,f.withLabel);b.constrained=true;b.funps=k[0]}else{throw ("Can't create line with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}}}return b};JXG.JSXGraph.registerElement("line",JXG.createLine);JXG.createSegment=function(d,a,e){var b;if(e==null){e=new Object()}if(e.withLabel==null||typeof e.withLabel=="undefined"){e.withLabel=false}e.straightFirst=false;e.straightLast=false;b=d.createElement("line",a,e);return b};JXG.JSXGraph.registerElement("segment",JXG.createSegment);JXG.createArrow=function(e,b,a){var d;if(a==null){a={}}if(a.withLabel==null||typeof a.withLabel=="undefined"){a.withLabel=false}d=e.createElement("line",b,a);d.setStraight(false,false);d.setArrow(false,true);return d};JXG.JSXGraph.registerElement("arrow",JXG.createArrow);JXG.createAxis=function(f,q,b){var k,h,s,g,d,a,e,o;if((JXG.isArray(q[0])||JXG.isPoint(q[0]))&&(JXG.isArray(q[1])||JXG.isPoint(q[1]))){if(JXG.isPoint(q[0])){k=q[0]}else{k=new JXG.Point(f,q[0],"","",false)}if(JXG.isPoint(q[1])){h=q[1]}else{h=new JXG.Point(f,q[1],"","",false)}k.fixed=true;h.fixed=true;if(b==null){b=new Object()}b.lastArrow=true;b.straightFirst=true;b.straightLast=true;if(b.strokeWidth==null){b.strokeWidth=1}if(b.withLabel==null){b.withLabel=false}s=f.createElement("line",[k,h],b);s.needsRegularUpdate=false;if(b.minorTicks=="undefined"||b.minorTicks==null){b.minorTicks=4}if((b.insertTicks=="undefined")||(b.insertTicks==null)){b.insertTicks="true"}if(b.ticksDistance!="undefined"&&b.ticksDistance!=null){g=b.ticksDistance}else{d=new JXG.Coords(JXG.COORDS_BY_USER,[s.point1.coords.usrCoords.slice(1)],f);a=new JXG.Coords(JXG.COORDS_BY_USER,[s.point2.coords.usrCoords.slice(1)],f);f.renderer.calcStraight(s,d,a);e=d.distance(JXG.COORDS_BY_USER,a);g=1}o=f.createElement("ticks",[s,g],b);o.needsRegularUpdate=false;s.defaultTicks=o}else{throw ("Can't create point with parent types '"+(typeof q[0])+"' and '"+(typeof q[1])+"'.")}return s};JXG.JSXGraph.registerElement("axis",JXG.createAxis);JXG.createTangent=function(q,u,e){var a=u[0],s=a.slideObject,k,o,h,d,b,v,w;if(e==null){e={}}if(e.withLabel==null){e.withLabel=false}if(s.elementClass==JXG.OBJECT_CLASS_LINE){return q.createElement("line",[s.point1,s.point2],e)}else{if(s.elementClass==JXG.OBJECT_CLASS_CURVE){if(s.curveType!="plot"){k=s.X;o=s.Y;return q.createElement("line",[function(){return -a.X()*q.D(o)(a.position)+a.Y()*q.D(k)(a.position)},function(){return q.D(o)(a.position)},function(){return -q.D(k)(a.position)}],e)}else{return q.createElement("line",[function(){h=Math.floor(a.position);if(h==s.numberPoints-1){h--}if(h<0){return 1}return s.Y(h)*s.X(h+1)-s.X(h)*s.Y(h+1)},function(){h=Math.floor(a.position);if(h==s.numberPoints-1){h--}if(h<0){return 0}return s.Y(h+1)-s.Y(h)},function(){h=Math.floor(a.position);if(h==s.numberPoints-1){h--}if(h<0){return 0}return s.X(h)-s.X(h+1)}],e)}}else{if(s.type==JXG.OBJECT_TYPE_TURTLE){return q.createElement("line",[function(){h=Math.floor(a.position);for(d=0;d<s.objects.length;d++){b=s.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 1}return b.Y(h)*b.X(h+1)-b.X(h)*b.Y(h+1)},function(){h=Math.floor(a.position);for(d=0;d<s.objects.length;d++){b=s.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 0}return b.Y(h+1)-b.Y(h)},function(){h=Math.floor(a.position);for(d=0;d<s.objects.length;d++){b=s.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 0}return b.X(h)-b.X(h+1)}],e)}else{if(s.elementClass==JXG.OBJECT_CLASS_CIRCLE){v=function(f){return -s.getRadius()*Math.sin(f)};w=function(f){return s.getRadius()*Math.cos(f)};return q.createElement("line",[function(){return -a.X()*w(a.position)+a.Y()*v(a.position)},function(){return w(a.position)},function(){return -v(a.position)}],e)}}}}};JXG.JSXGraph.registerElement("tangent",JXG.createTangent);JXG.Group=function(f,k,a){var g,e,b,h,d;this.board=f;this.objects={};g=this.board.numObjects;this.board.numObjects++;if((k=="")||(k==null)||(typeof k=="undefined")){this.id=this.board.id+"Group"+g}else{this.id=k}this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;if((a=="")||(a==null)||(typeof a=="undefined")){this.name="group_"+this.board.generateName(this)}else{this.name=a}delete (this.type);if((arguments.length==4)&&(JXG.isArray(arguments[3]))){e=arguments[3]}else{e=[];for(b=3;b<arguments.length;b++){e.push(arguments[b])}}for(b=0;b<e.length;b++){h=JXG.getReference(this.board,e[b]);if((!h.fixed)&&((h.type==JXG.OBJECT_TYPE_POINT)||(h.type==JXG.OBJECT_TYPE_GLIDER))){if(h.group.length!=0){this.addGroup(h.group[h.group.length-1])}else{this.addPoint(h)}}}for(d in this.objects){this.objects[d].group.push(this)}this.dX=0;this.dY=0};JXG.Group.prototype.ungroup=function(){var a;for(a in this.objects){if(this.objects[a].group[this.objects[a].group.length-1]==this){this.objects[a].group.pop()}delete (this.objects[a])}};JXG.Group.prototype.update=function(a){var d=null,b;for(b in this.objects){d=this.objects[b];if(d.id!=a.id){d.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+this.dX,d.coords.scrCoords[2]+this.dY],d.board)}}for(b in this.objects){if(this.board.objects[b]!=undefined){this.objects[b].update(false)}else{delete (this.objects[b])}}};JXG.Group.prototype.addPoint=function(a){this.objects[a.id]=a};JXG.Group.prototype.addPoints=function(a){var b;for(b in a){this.objects[b.id]=b}};JXG.Group.prototype.addGroup=function(b){var a;for(a in b.objects){this.addPoint(b.objects[a])}};JXG.createGroup=function(d,b,a){return new JXG.Group(d,a.id,a.name,b)};JXG.JSXGraph.registerElement("group",JXG.createGroup);JXG.Circle=function(f,h,e,b,g,a,d){this.constructor();this.type=JXG.OBJECT_TYPE_CIRCLE;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.init(f,g,a);this.method=h;this.midpoint=JXG.getReference(this.board,e);this.midpoint.addChild(this);this.visProp.visible=true;this.visProp.fillColor=this.board.options.circle.fillColor;this.visProp.highlightFillColor=this.board.options.circle.highlightFillColor;this.visProp.strokeColor=this.board.options.circle.strokeColor;this.visProp.highlightStrokeColor=this.board.options.circle.highlightStrokeColor;this.point2=null;this.radius=0;this.line=null;this.circle=null;if(h=="twoPoints"){this.point2=JXG.getReference(f,b);this.point2.addChild(this);this.radius=this.getRadius()}else{if(h=="pointRadius"){this.generateTerm(b);this.updateRadius()}else{if(h=="pointLine"){this.line=JXG.getReference(f,b);this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)}else{if(h=="pointCircle"){this.circle=JXG.getReference(f,b);this.radius=this.circle.getRadius()}}}}if(d!=null){this.createLabel(d)}if(h=="twoPoints"){this.id=this.board.addCircle(this)}else{if(h=="pointRadius"){this.id=this.board.addCircle(this);this.notifyParents(b)}else{if(h=="pointLine"){this.line.addChild(this);this.id=this.board.addCircle(this)}else{if(h=="pointCircle"){this.circle.addChild(this);this.id=this.board.addCircle(this)}}}}};JXG.Circle.prototype=new JXG.GeometryElement;JXG.Circle.prototype.hasPoint=function(a,g){var f=this.board.options.precision.hasPoint;f=f/(this.board.unitX*this.board.zoomX);var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,g],this.board);var b=this.getRadius();var d=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-e.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-e.usrCoords[2],2));return(Math.abs(d-b)<f)};JXG.Circle.prototype.generatePolynomial=function(h){var f=this.midpoint.symbolic.x;var e=this.midpoint.symbolic.y;var d=h.symbolic.x;var b=h.symbolic.y;var a=this.generateRadiusSquared();if(a==""){return[]}var g="("+d+"-"+f+")^2 + ("+b+"-"+e+")^2 - ("+a+")";return[g]};JXG.Circle.prototype.generateRadiusSquared=function(){var b="";if(this.method=="twoPoints"){var e=this.midpoint.symbolic.x;var d=this.midpoint.symbolic.y;var g=this.point2.symbolic.x;var f=this.point2.symbolic.y;b="("+g+"-"+e+")^2 + ("+f+"-"+d+")^2"}else{if(this.method=="pointRadius"){if(typeof(this.radius)=="number"){b=""+this.radius*this.radius}}else{if(this.method=="pointLine"){var g=this.line.point1.symbolic.x;var f=this.line.point1.symbolic.y;var a=this.line.point2.symbolic.x;var h=this.line.point2.symbolic.y;b="("+g+"-"+a+")^2 + ("+f+"-"+h+")^2"}else{if(this.method=="pointCircle"){b=this.circle.getRadius()}}}}return b};JXG.Circle.prototype.update=function(){if(this.traced){this.cloneToBackground(true)}if(this.needsUpdate){if(this.method=="pointLine"){this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)}else{if(this.method=="pointCircle"){this.radius=this.circle.getRadius()}else{if(this.method=="pointRadius"){this.radius=this.updateRadius()}}}if(!this.board.geonextCompatibilityMode){this.updateStdform()}}};JXG.Circle.prototype.updateStdform=function(){this.stdform[3]=0.5;this.stdform[4]=this.getRadius();this.stdform[1]=-this.midpoint.coords.usrCoords[1];this.stdform[2]=-this.midpoint.coords.usrCoords[2];this.normalize()};JXG.Circle.prototype.updateRenderer=function(){if(this.needsUpdate&&this.visProp.visible){var a=this.isReal;this.isReal=(isNaN(this.midpoint.coords.usrCoords[1]+this.midpoint.coords.usrCoords[2]+this.getRadius()))?false:true;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updateCircle(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Circle.prototype.generateTerm=function(b){if(typeof b=="string"){var d=this.board.elementsByName;var a=this.board.algebra.geonext2JS(b+"");this.updateRadius=new Function("return "+a+";")}else{if(typeof b=="number"){this.updateRadius=function(){return b}}else{this.updateRadius=b}}};JXG.Circle.prototype.notifyParents=function(b){var a=null;var d=this.board.elementsByName;if(typeof b=="string"){this.board.algebra.findDependencies(this,b+"")}};JXG.Circle.prototype.getRadius=function(){if(this.method=="twoPoints"){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))}else{if(this.method=="pointLine"||this.method=="pointCircle"){return this.radius}else{if(this.method=="pointRadius"){return this.updateRadius()}}}};JXG.Circle.prototype.getTextAnchor=function(){return this.midpoint.coords};JXG.Circle.prototype.getLabelAnchor=function(){if(this.method=="twoPoints"){var b=this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1];var a=this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2];return new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+b,this.midpoint.coords.usrCoords[2]+a],this.board)}else{if(this.method=="pointLine"||this.method=="pointCircle"||this.method=="pointRadius"){return new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]-this.getRadius(),this.midpoint.coords.usrCoords[2]],this.board)}}};JXG.Circle.prototype.cloneToBackground=function(a){var d={};d.id=this.id+"T"+this.numTraces;this.numTraces++;d.midpoint={};d.midpoint.coords=this.midpoint.coords;var b=this.getRadius();d.getRadius=function(){return b};d.board={};d.board.unitX=this.board.unitX;d.board.unitY=this.board.unitY;d.board.zoomX=this.board.zoomX;d.board.zoomY=this.board.zoomY;d.visProp=this.visProp;this.board.renderer.drawCircle(d);this.traces[d.id]=document.getElementById(d.id);delete d};JXG.Circle.prototype.addTransform=function(a){var d;if(JXG.isArray(a)){d=a}else{d=[a]}for(var b=0;b<d.length;b++){this.midpoint.transformations.push(d[b]);if(this.method=="twoPoints"){this.point2.transformations.push(d[b])}}};JXG.Circle.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});this.addTransform(b)};JXG.Circle.prototype.X=function(a){a*=2*Math.PI;return this.getRadius()*Math.cos(a)+this.midpoint.coords.usrCoords[1]};JXG.Circle.prototype.Y=function(a){a*=2*Math.PI;return this.getRadius()*Math.sin(a)+this.midpoint.coords.usrCoords[2]};JXG.Circle.prototype.minX=function(){return 0};JXG.Circle.prototype.maxX=function(){return 1};JXG.createCircle=function(e,h,g){var d,f,b;if(g==null){g={}}if(typeof g.withLabel=="undefined"){g.withLabel=false}f=[];for(b=0;b<h.length;b++){if(JXG.isPoint(h[b])){f[b]=h[b]}else{if(h[b].length>1){f[b]=e.createElement("point",h[b],{visible:false,fixed:true})}else{f[b]=h[b]}}}if(h.length==2&&JXG.isPoint(f[0])&&JXG.isPoint(f[1])){d=new JXG.Circle(e,"twoPoints",f[0],f[1],g.id,g.name,g.withLabel)}else{if((JXG.isNumber(f[0])||JXG.isFunction(f[0])||JXG.isString(f[0]))&&JXG.isPoint(f[1])){d=new JXG.Circle(e,"pointRadius",f[1],f[0],g.id,g.name,g.withLabel)}else{if((JXG.isNumber(f[1])||JXG.isFunction(f[1])||JXG.isString(f[1]))&&JXG.isPoint(f[0])){d=new JXG.Circle(e,"pointRadius",f[0],f[1],g.id,g.name,g.withLabel)}else{if((f[0].type==JXG.OBJECT_TYPE_CIRCLE)&&JXG.isPoint(f[1])){d=new JXG.Circle(e,"pointCircle",f[1],f[0],g.id,g.name,g.withLabel)}else{if((f[1].type==JXG.OBJECT_TYPE_CIRCLE)&&JXG.isPoint(f[0])){d=new JXG.Circle(e,"pointCircle",f[0],f[1],g.id,g.name,g.withLabel)}else{if((f[0].type==JXG.OBJECT_TYPE_LINE)&&JXG.isPoint(f[1])){d=new JXG.Circle(e,"pointLine",f[1],f[0],g.id,g.name,g.withLabel)}else{if((f[1].type==JXG.OBJECT_TYPE_LINE)&&JXG.isPoint(f[0])){d=new JXG.Circle(e,"pointLine",f[0],f[1],g.id,g.name,g.withLabel)}else{if(h.length==3&&JXG.isPoint(f[0])&&JXG.isPoint(f[1])&&JXG.isPoint(f[2])){var a=JXG.createCircumcircle(e,f,g);a[0].setProperty({visible:false});return a[1]}else{throw ("Can't create circle with parent types '"+(typeof h[0])+"' and '"+(typeof h[1])+"'.")}}}}}}}}return d};JXG.JSXGraph.registerElement("circle",JXG.createCircle);JXG.Polygon=function(o,q,s,d,b,e,a,h){this.constructor();this.type=JXG.OBJECT_TYPE_POLYGON;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(o,d,b);if((typeof e=="undefined")||(e==null)){e=true}if((typeof h=="undefined")||(h==null)){h=false}this.withLines=e;this.vertices=[];for(var g=0;g<q.length;g++){var k=JXG.getReference(this.board,q[g]);this.vertices[g]=k}if((typeof s=="undefined")||(s==null)){s=[];for(var g=0;g<q.length-1;g++){s[g]={}}}if(this.vertices[this.vertices.length-1]!=this.vertices[0]){this.vertices.push(this.vertices[0]);s.push({})}this.visProp.fillColor=this.board.options.polygon.fillColor;this.visProp.highlightFillColor=this.board.options.polygon.highlightFillColor;this.visProp.fillOpacity=this.board.options.polygon.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.polygon.highlightFillOpacity;var f;this.borders=[];if(e){for(var g=0;g<this.vertices.length-1;g++){f=new JXG.Line(o,this.vertices[g],this.vertices[g+1],s[g].id,s[g].name,h);f.setStraight(false,false);this.borders[g]=f;f.parentPolygon=this}}for(var g=0;g<this.vertices.length-1;g++){var k=JXG.getReference(this.board,this.vertices[g]);k.addChild(this)}this.createLabel(a,[0,0]);this.id=this.board.addPolygon(this)};JXG.Polygon.prototype=new JXG.GeometryElement;JXG.Polygon.prototype.hasPoint=function(a,b){return false};JXG.Polygon.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updatePolygon(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Polygon.prototype.getTextAnchor=function(){var f=0;var e=0;var d=0;var h=0;f=d=this.vertices[0].X();e=h=this.vertices[0].Y();for(var g=0;g<this.vertices.length;g++){if(this.vertices[g].X()<f){f=this.vertices[g].X()}if(this.vertices[g].X()>d){d=this.vertices[g].X()}if(this.vertices[g].Y()>e){e=this.vertices[g].Y()}if(this.vertices[g].Y()<h){h=this.vertices[g].Y()}}return new JXG.Coords(JXG.COORDS_BY_USER,[(f+d)*0.5,(e+h)*0.5],this.board)};JXG.Polygon.prototype.getLabelAnchor=function(){var f=0;var e=0;var d=0;var h=0;f=d=this.vertices[0].X();e=h=this.vertices[0].Y();for(var g=0;g<this.vertices.length;g++){if(this.vertices[g].X()<f){f=this.vertices[g].X()}if(this.vertices[g].X()>d){d=this.vertices[g].X()}if(this.vertices[g].Y()>e){e=this.vertices[g].Y()}if(this.vertices[g].Y()<h){h=this.vertices[g].Y()}}return new JXG.Coords(JXG.COORDS_BY_USER,[(f+d)*0.5,(e+h)*0.5],this.board)};JXG.Polygon.prototype.cloneToBackground=function(a){var b={};b.id=this.id+"T"+this.numTraces;this.numTraces++;b.vertices=this.vertices;b.visProp=this.visProp;this.board.renderer.drawPolygon(b);this.traces[b.id]=$(b.id);delete b};JXG.createPolygon=function(e,a,f){var d;if(typeof f.withLabel=="undefined"){f.withLabel=false}for(var b=0;b<a.length;b++){a[b]=JXG.getReference(e,a[b]);if(!JXG.isPoint(a[b])){throw ("Can't create polygon with parent types other than 'point'.")}}d=new JXG.Polygon(e,a,f.borders,f.id,f.name,f.withLines,f.withLabel,f.lineLabels);return d};JXG.JSXGraph.registerElement("polygon",JXG.createPolygon);JXG.Polygon.prototype.hideElement=function(){this.visProp.visible=false;this.board.renderer.hide(this);if(this.withLines){for(var a=0;a<this.borders.length;a++){this.borders[a].hideElement()}}if(this.hasLabel&&this.label!=null){this.label.hiddenByParent=true;if(this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}};JXG.Polygon.prototype.showElement=function(){this.visProp.visible=true;this.board.renderer.show(this);if(this.withLines){for(var a=0;a<this.borders.length;a++){this.borders[a].showElement()}}};JXG.Curve=function(e,b,f,a,d){this.constructor();this.points=[];this.type=JXG.OBJECT_TYPE_CURVE;this.elementClass=JXG.OBJECT_CLASS_CURVE;this.init(e,f,a);this.numberPointsHigh=this.board.options.curve.numberPointsHigh;this.numberPointsLow=this.board.options.curve.numberPointsLow;this.numberPoints=this.numberPointsHigh;this.visProp.strokeWidth=this.board.options.curve.strokeWidth;this.visProp.visible=true;this.dataX=null;this.dataY=null;this.r=this.board.options.precision.hasPoint;this.curveType=null;if(b[0]!=null){this.varname=b[0]}else{this.varname="x"}this.xterm=b[1];this.yterm=b[2];this.generateTerm(this.varname,this.xterm,this.yterm,b[3],b[4]);this.updateCurve();this.createLabel(d);this.id=this.board.addCurve(this);if(typeof this.xterm=="string"){this.notifyParents(this.xterm)}if(typeof this.yterm=="string"){this.notifyParents(this.yterm)}};JXG.Curve.prototype=new JXG.GeometryElement;JXG.Curve.prototype.minX=function(){if(this.curveType=="polar"){return 0}else{var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board);return a.usrCoords[1]}};JXG.Curve.prototype.maxX=function(){var a;if(this.curveType=="polar"){return 2*Math.PI}else{a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board);return a.usrCoords[1]}};JXG.Curve.prototype.hasPoint=function(s,q){var u,z=10000,H,h,B,A,w,v,k,F,g,E,e,o,D=400,G=(this.maxX()-this.minX())/D,a=this.r/(this.board.unitX*this.board.zoomX),b,C,f=true;b=new JXG.Coords(JXG.COORDS_BY_SCREEN,[s,q],this.board);s=b.usrCoords[1];q=b.usrCoords[2];if(this.curveType=="parameter"||this.curveType=="polar"||this.curveType=="functiongraph"){C=this.transformations.length;for(B=0,u=this.minX();B<D;B++){w=this.X(u,f);v=this.Y(u,f);for(A=0;A<C;A++){h=this.transformations[A];h.update();H=JXG.Math.matVecMult(h.matrix,[1,w,v]);w=H[1];v=H[2]}z=Math.sqrt((s-w)*(s-w)+(q-v)*(q-v));if(z<a){return true}u+=G}}else{if(this.curveType=="plot"){C=this.numberPoints;for(B=0;B<C-1;B++){E=this.X(B+1)-this.X(B);e=this.Y(B+1)-this.Y(B);F=s-this.X(B);g=q-this.Y(B);o=E*E+e*e;if(o>=JXG.Math.eps){k=(F*E+g*e)/o;z=Math.sqrt(F*F+g*g-k*(F*E+g*e))}else{k=0;z=Math.sqrt(F*F+g*g)}if(k>=0&&k<=1&&z<a){return true}}return false}}return(z<a)};JXG.Curve.prototype.allocatePoints=function(){var b,a;a=this.numberPoints;if(this.points.length<this.numberPoints){for(b=this.points.length;b<a;b++){this.points[b]=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)}}};JXG.Curve.prototype.update=function(){if(this.needsUpdate){this.updateCurve()}};JXG.Curve.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateCurve(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Curve.prototype.updateDataArray=function(){};JXG.Curve.prototype.updateCurve=function(){var d,e,k,b,h,f,a,g=false;this.updateDataArray();if(this.curveType=="plot"&&this.dataX!=null){this.numberPoints=this.dataX.length}else{if(this.board.updateQuality==this.board.BOARD_QUALITY_HIGH){this.numberPoints=this.numberPointsHigh}else{this.numberPoints=this.numberPointsLow}}d=this.numberPoints;this.allocatePoints();e=this.minX();k=this.maxX();a=(k-e)/d;for(f=0;f<d;f++){if(this.dataX!=null){b=f;if(this.dataY!=null){h=f}else{h=this.X(b)}}else{b=e+f*a;h=b}this.points[f].setCoordinates(JXG.COORDS_BY_USER,[this.X(b),this.Y(h,g)],false);this.updateTransform(this.points[f]);g=true}this.getLabelAnchor()};JXG.Curve.prototype.updateTransform=function(e){var d,f,b,a=this.transformations.length;if(a==0){return e}for(b=0;b<a;b++){d=this.transformations[b];d.update();f=JXG.Math.matVecMult(d.matrix,e.usrCoords);e.setCoordinates(JXG.COORDS_BY_USER,[f[1],f[2]])}return e};JXG.Curve.prototype.addTransform=function(b){var e,d,a;if(JXG.isArray(b)){e=b}else{e=[b]}a=e.length;for(d=0;d<a;d++){this.transformations.push(e[d])}};JXG.Curve.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(b)}else{this.addTransform(b)}};JXG.Curve.prototype.generateTerm=function(b,g,d,a,h){var f,e;if(JXG.isArray(g)){this.dataX=g;this.X=function(k){return this.dataX[k]};this.curveType="plot";this.numberPoints=this.dataX.length}else{this.X=JXG.createFunction(g,this.board,b);if(JXG.isString(g)){this.curveType="functiongraph"}else{if(JXG.isFunction(g)||JXG.isNumber(g)){this.curveType="parameter"}}}if(JXG.isArray(d)){this.dataY=d;this.Y=function(k){return this.dataY[k]}}else{this.Y=JXG.createFunction(d,this.board,b)}if(JXG.isFunction(g)&&JXG.isArray(d)){f=JXG.createFunction(d[0],this.board,"");e=JXG.createFunction(d[1],this.board,"");this.X=function(k){return(g)(k)*Math.cos(k)+f()};this.Y=function(k){return(g)(k)*Math.sin(k)+e()};this.curveType="polar"}if(a!=null){this.minX=JXG.createFunction(a,this.board,"")}if(h!=null){this.maxX=JXG.createFunction(h,this.board,"")}};JXG.Curve.prototype.notifyParents=function(a){this.board.algebra.findDependencies(this,a)};JXG.Curve.prototype.getLabelAnchor=function(){var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,this.board.canvasHeight*0.5],this.board);a=this.board.algebra.projectCoordsToCurve(a.usrCoords[1],a.usrCoords[2],0,this)[0];return a};JXG.createCurve=function(d,b,a){if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}return new JXG.Curve(d,["x"].concat(b),a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("curve",JXG.createCurve);JXG.createFunctiongraph=function(e,b,a){var d=["x","x"].concat(b);if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}a.curveType="functiongraph";return new JXG.Curve(e,d,a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("functiongraph",JXG.createFunctiongraph);JXG.createSpline=function(d,b,a){var e;if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}e=function(h){var f=new Array(),o=new Array(),g,k;for(g=0;g<b.length;g++){if(!JXG.isPoint(b[g])){throw"JXG.createSpline: Parents has to be an array of JXG.Point."}f.push(b[g].X());o.push(b[g].Y())}k=JXG.Math.Numerics.splineDef(f,o);return JXG.Math.Numerics.splineEval(h,f,o,k)};return new JXG.Curve(d,["x","x",e],a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("spline",JXG.createSpline);JXG.createRiemannsum=function(g,b,a){var o,e,h,d,k;if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}a.fillOpacity=a.fillOpacity||0.3;a.fillColor=a.fillColor||"#ffff00";a.curveType="plot";h=b[0];o=JXG.createFunction(b[1],g,"");if(o==null){throw"JXG.createRiemannsum: argument '2' n has to be number or function."}e=JXG.createFunction(b[2],g,"",false);if(e==null){throw"JXG.createRiemannsum: argument 3 'type' has to be string or function."}d=["x",[0],[0]].concat(b.slice(3));k=new JXG.Curve(g,d,a.id,a.name,a.withLabel);k.updateDataArray=function(){var f=JXG.Math.Numerics.riemann(h,o(),e(),this.minX(),this.maxX());this.dataX=f[0];this.dataY=f[1]};return k};JXG.JSXGraph.registerElement("riemannsum",JXG.createRiemannsum);JXG.Arc=function(d,g,f,e,h,a,b){this.constructor();this.type=JXG.OBJECT_TYPE_ARC;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.init(d,h,a);this.midpoint=JXG.getReference(this.board,g);this.point2=JXG.getReference(this.board,f);this.point3=JXG.getReference(this.board,e);this.r=this.board.options.precision.hasPoint;this.visProp.visible=true;this.visProp.firstArrow=this.board.options.arc.firstArrow;this.visProp.lastArrow=this.board.options.arc.lastArrow;this.visProp.fillColor=this.board.options.arc.fillColor;this.visProp.highlightFillColor=this.board.options.arc.highlightFillColor;this.visProp.strokeColor=this.board.options.arc.strokeColor;this.visProp.highlightStrokeColor=this.board.options.arc.highlightStrokeColor;this.createLabel(b,[0,0]);this.id=this.board.addArc(this);this.midpoint.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Arc.prototype=new JXG.GeometryElement;JXG.Arc.prototype.hasPoint=function(o,k){var s=this.r/(this.board.unitX*this.board.zoomX);var g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[o,k],this.board);var a=this.getRadius();var h=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-g.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-g.usrCoords[2],2));var q=(Math.abs(h-a)<s);if(q){var b={};b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1],this.board.origin.usrCoords[2]/(this.board.unitY*this.board.zoomY)],this.board);var f=this.board.algebra.trueAngle(this.point2,this.midpoint,b);var e=this.board.algebra.trueAngle(this.point3,this.midpoint,b);var u={};u.coords=g;var d=this.board.algebra.trueAngle(u,this.midpoint,b);if(f>=e){if(f<d||d<e){q=false}}else{if(d>f){if(d<e){q=false}}}}return q};JXG.Arc.prototype.hasPointSector=function(o,k){var s=this.r/(this.board.unitX*this.board.zoomX);var g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[o,k],this.board);var a=this.getRadius();var h=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-g.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-g.usrCoords[2],2));var q=(h<a);if(q){var b={};b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1],this.board.origin.usrCoords[2]/(this.board.unitY*this.board.zoomY)],this.board);var f=this.board.algebra.trueAngle(this.point2,this.midpoint,b);var e=this.board.algebra.trueAngle(this.point3,this.midpoint,b);var u={};u.coords=g;var d=this.board.algebra.trueAngle(u,this.midpoint,b);if(f>=e){if(f<d||d<e){q=false}}else{if(d>f){if(d<e){q=false}}}}return q};JXG.Arc.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))};JXG.Arc.prototype.getTextAnchor=function(){return this.midpoint.coords};JXG.Arc.prototype.getLabelAnchor=function(){var d=this.board.algebra.trueAngle(this.point2,this.midpoint,this.point3);var q=10/(this.board.unitX*this.board.zoomX);var k=10/(this.board.unitY*this.board.zoomY);var b=this.point2.coords.usrCoords[1]-this.midpoint.coords.usrCoords[1];var o=this.point2.coords.usrCoords[2]-this.midpoint.coords.usrCoords[2];if(this.label.content!=null){this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[0/(this.board.unitX*this.board.zoomX),0/(this.board.unitY*this.board.zoomY)],this.board)}var g=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+Math.cos(d*Math.PI/(2*180))*b-Math.sin(d*Math.PI/(2*180))*o,this.midpoint.coords.usrCoords[2]+Math.sin(d*Math.PI/(2*180))*b+Math.cos(d*Math.PI/(2*180))*o],this.board);var f=g.usrCoords[1]-this.midpoint.coords.usrCoords[1];var e=g.usrCoords[2]-this.midpoint.coords.usrCoords[2];var a=Math.sqrt(f*f+e*e);f=f*(a+q)/a;e=e*(a+k)/a;var h=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+f,this.midpoint.coords.usrCoords[2]+e],this.board);return h};JXG.Arc.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateArc(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Arc.prototype.setArrow=function(b,a){this.visProp.firstArrow=b;this.visProp.lastArrow=a;this.board.renderer.updateArc(this);if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.createArc=function(e,b,a){var d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){d=new JXG.Arc(e,b[0],b[1],b[2],a.id,a.name,a.withLabel)}else{throw ("Can't create Arc with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("arc",JXG.createArc);JXG.createSemicircle=function(e,b,a){var d,g,f;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){f=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))){g=e.createElement("midpoint",[b[0],b[1]],{id:f,withLabel:false,visible:false});d=new JXG.Arc(e,g,b[1],b[0],a.id,a.name,a.withLabel)}else{throw ("Can't create Semicircle with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}return d};JXG.JSXGraph.registerElement("semicircle",JXG.createSemicircle);JXG.createCircumcircleArc=function(f,b,a){var e,h,g,d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){g=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){h=f.createElement("circumcirclemidpoint",[b[0],b[1],b[2]],{id:g,withLabel:false,visible:false});d=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(d<0){e=new JXG.Arc(f,h,b[0],b[2],a.id,a.name,a.withLabel)}else{e=new JXG.Arc(f,h,b[2],b[0],a.id,a.name,a.withLabel)}e.update=function(){var k;if(this.traced){this.cloneToBackground(true)}k=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(k<0){this.point2=b[0];this.point3=b[2]}else{this.point2=b[2];this.point3=b[0]}}}else{throw ("Can't create Circumcircle Arc with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return e};JXG.JSXGraph.registerElement("circumcirclearc",JXG.createCircumcircleArc);JXG.Sector=function(o,x,w,v,b,q,f){this.constructor();this.type=JXG.OBJECT_TYPE_SECTOR;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(o,f,"");if(!JXG.isArray(b)){b=[null,null,null,null]}if(!JXG.isArray(q)){q=[null,null,null,null]}this.point1=JXG.getReference(this.board,x);this.point2=JXG.getReference(this.board,w);this.point3=JXG.getReference(this.board,v);this.r=this.board.options.precision.hasPoint;this.visProp.visible=true;var d={};d.midpoint=this.point1;var k=this.getRadius();d.getRadius=function(){return k};var u=this.board.algebra.projectPointToCircle(this.point3,d);var e=new JXG.Point(o,[u.usrCoords[1],u.usrCoords[2]],b[1],q[1],true);e.fixed=true;this.addChild(e);e.update=function(){var y={};y.midpoint=JXG.getReference(this.board,x);var a=(Math.sqrt(Math.pow(JXG.getReference(this.board,x).coords.usrCoords[1]-JXG.getReference(this.board,w).coords.usrCoords[1],2)+Math.pow(JXG.getReference(this.board,x).coords.usrCoords[2]-JXG.getReference(this.board,w).coords.usrCoords[2],2)));y.getRadius=function(){return a};u=this.board.algebra.projectPointToCircle(JXG.getReference(this.board,v),y);this.coords=u;this.board.renderer.updatePoint(this);if(this.label.content.visProp.visible){this.label.content.update()}};var h=new JXG.Line(o,x,w,b[2],q[2]);var g=new JXG.Line(o,x,e.id,b[3],q[3]);h.setStraight(false,false);g.setStraight(false,false);var s=new JXG.Arc(o,x,w,v,b[0],q[0]);s.visProp.fillColor=this.board.options.sector.fillColor;s.visProp.highlightFillColor=this.board.options.sector.highlightFillColor;s.visProp.fillOpacity=this.board.options.sector.fillOpacity;s.visProp.highlightFillOpacity=this.board.options.sector.highlightFillOpacity;this.point4=e;this.lines=[h,g];this.arc=s;this.id=this.board.addSector(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Sector.prototype=new JXG.GeometryElement;JXG.Sector.prototype.hasPoint=function(a,b){return false};JXG.Sector.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.point1.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.point1.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))};JXG.Sector.prototype.updateRenderer=function(){};JXG.createSector=function(b,e,d){var a;if((JXG.isPoint(e[0]))&&(JXG.isPoint(e[1]))&&(JXG.isPoint(e[2]))){a=new JXG.Sector(b,e[0],e[1],e[2],d.ids,d.names,d.id)}else{throw ("Can't create sector with parent types '"+(typeof e[0])+"' and '"+(typeof e[1])+"' and '"+(typeof e[2])+"'.")}return a};JXG.JSXGraph.registerElement("sector",JXG.createSector);JXG.createCircumcircleSector=function(f,b,a){var e,h,g,d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){g=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){h=f.createElement("circumcirclemidpoint",[b[0],b[1],b[2]],{id:g,withLabel:false,visible:false});d=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(d<0){e=new JXG.Sector(f,h,b[0],b[2],a.id,a.name,a.withLabel)}else{e=new JXG.Sector(f,h,b[2],b[0],a.id,a.name,a.withLabel)}e.arc.update=function(){var k;if(this.traced){this.cloneToBackground(true)}k=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(k<0){this.point2=b[0];this.point3=b[2]}else{this.point2=b[2];this.point3=b[0]}};e.point4.setProperty({visible:false})}else{throw ("Can't create circumcircle sector with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return e};JXG.JSXGraph.registerElement("circumcirclesector",JXG.createCircumcircleSector);JXG.Angle=function(k,e,d,a,h,s,v,B,b){this.constructor();this.type=JXG.OBJECT_TYPE_ANGLE;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(k,v,B);this.point1=JXG.getReference(this.board,e);this.point2=JXG.getReference(this.board,d);this.point3=JXG.getReference(this.board,a);this.radius=this.board.options.angle.radius;if(h!=undefined&&h!=null){this.radius=h}this.visProp.fillColor=this.board.options.angle.fillColor;this.visProp.highlightFillColor=this.board.options.angle.highlightFillColor;this.visProp.fillOpacity=this.board.options.angle.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.angle.highlightFillOpacity;this.visProp.strokeColor=this.board.options.angle.strokeColor;if(s==""){var g=["&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"],z=0,w,o,f,u,y,q;while(z<g.length){w=z;o=g[z];for(f in k.objects){if(k.objects[f].type==JXG.OBJECT_TYPE_ANGLE){if(k.objects[f].text==o){z++;break}}}if(z==w){s=o;z=g.length+1}}if(z==g.length){u="&alpha;_{";y="}";q=false;w=0;while(!q){for(f in k.objects){if(k.objects[f].type==JXG.OBJECT_TYPE_ANGLE){if(k.objects[f].text==(u+w+y)){q=true;break}}}if(q){q=false}else{q=true;s=(u+w+y)}}}}this.text=s;var A=this.name;this.name=this.text;this.createLabel(b);this.name=A;this.id=this.board.addAngle(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Angle.prototype=new JXG.GeometryElement;JXG.Angle.prototype.hasPoint=function(a,b){return false};JXG.Angle.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateAngle(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Angle.prototype.getLabelAnchor=function(){var e=this.board.algebra.trueAngle(this.point1,this.point2,this.point3);var d=this.point1.coords.distance(JXG.COORDS_BY_USER,this.point2.coords);var b=(this.point1.coords.usrCoords[1]-this.point2.coords.usrCoords[1])*(this.radius/2)/d;var a=(this.point1.coords.usrCoords[2]-this.point2.coords.usrCoords[2])*(this.radius/2)/d;var f=new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.coords.usrCoords[1]+Math.cos(e*Math.PI/(2*160))*b-Math.sin(e*Math.PI/(2*160))*a,this.point2.coords.usrCoords[2]+Math.sin(e*Math.PI/(2*160))*b+Math.cos(e*Math.PI/(2*160))*a],this.board);if(this.label.content!=null){this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[0/(this.board.unitX*this.board.zoomX),0/(this.board.unitY*this.board.zoomY)],this.board)}return f};JXG.createAngle=function(e,b,a){var d;if(a.withLabel==null||typeof a.withLabel=="undefined"){a.withLabel=true}if(a.text==null||typeof a.text=="text"){a.text=""}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){d=new JXG.Angle(e,b[0],b[1],b[2],a.radius,a.text,a.id,a.name,a.withLabel)}else{throw ("Can't create angle with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("angle",JXG.createAngle);JXG.Algebra=function(a){this.board=a;this.eps=JXG.Math.eps};JXG.Algebra.prototype.angle=function(f,e,d){var k=[],h=[],g=[],q,o,x,w;if(f.coords==null){k[0]=f[0];k[1]=f[1]}else{k[0]=f.coords.usrCoords[1];k[1]=f.coords.usrCoords[2]}if(e.coords==null){h[0]=e[0];h[1]=e[1]}else{h[0]=e.coords.usrCoords[1];h[1]=e.coords.usrCoords[2]}if(d.coords==null){g[0]=d[0];g[1]=d[1]}else{g[0]=d.coords.usrCoords[1];g[1]=d.coords.usrCoords[2]}q=k[0]-h[0];o=k[1]-h[1];x=g[0]-h[0];w=g[1]-h[1];return Math.atan((q*w-o*x)/(q*x+o*w))};JXG.Algebra.prototype.trueAngle=function(g,f,d){var a,y,w,u,q,o,v,k,h,b,x,e,s=0;if(g.coords==null){a=g[0];y=g[1]}else{a=g.coords.usrCoords[1];y=g.coords.usrCoords[2]}if(f.coords==null){w=f[0];u=f[1]}else{w=f.coords.usrCoords[1];u=f.coords.usrCoords[2]}if(d.coords==null){q=d[0];o=d[1]}else{q=d.coords.usrCoords[1];o=d.coords.usrCoords[2]}e=(q-w)*(a-w)+(o-u)*(y-u);v=(a-w)*(o-u)-(y-u)*(q-w);k=Math.sqrt((a-w)*(a-w)+(y-u)*(y-u));h=Math.sqrt((q-w)*(q-w)+(o-u)*(o-u));b=e/(k*h);if(b>1){b=1}else{if(b<-1){b=-1}}x=Math.acos(b);if((Math.sin(x)*v)<0){s=2*Math.PI-x}else{s=x}s=(s/Math.PI)*180;return s};JXG.Algebra.prototype.rad=function(a,d,b){return this.trueAngle(a,d,b)*Math.PI/180};JXG.Algebra.prototype.angleBisector=function(g,f,b){var e=g.coords.usrCoords,q=f.coords.usrCoords,h=b.coords.usrCoords,u=e[1]-q[1],s=e[2]-q[2],o=Math.sqrt(u*u+s*s),a,v,k;u/=o;s/=o;a=Math.acos(u);if(s<0){a*=-1}if(a<0){a+=2*Math.PI}u=h[1]-q[1];s=h[2]-q[2];o=Math.sqrt(u*u+s*s);u/=o;s/=o;v=Math.acos(u);if(s<0){v*=-1}if(v<0){v+=2*Math.PI}k=(a+v)*0.5;if(a>v){k+=Math.PI}u=Math.cos(k)+q[1];s=Math.sin(k)+q[2];return new JXG.Coords(JXG.COORDS_BY_USER,[u,s],this.board)};JXG.Algebra.prototype.midpoint=function(a,b){return new JXG.Coords(JXG.COORDS_BY_USER,[(a.coords.usrCoords[1]+b.coords.usrCoords[1])/2,(a.coords.usrCoords[2]+b.coords.usrCoords[2])/2],this.board)};JXG.Algebra.prototype.parallel=function(f,b,k){var d=1,g=k.coords.usrCoords,o=f.coords.usrCoords,a=b.coords.usrCoords,h=g[1]+d*(a[1]-o[1]),e=g[2]+d*(a[2]-o[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[h,e],this.board)};JXG.Algebra.prototype.reflection=function(s,k){var e=k.coords.usrCoords,u=s.point1.coords.usrCoords,d=s.point2.coords.usrCoords,b,h,a,f,o,g,q;o=d[1]-u[1];g=d[2]-u[2];b=e[1]-u[1];h=e[2]-u[2];q=(o*h-g*b)/(o*o+g*g);a=e[1]+2*q*g;f=e[2]-2*q*o;return new JXG.Coords(JXG.COORDS_BY_USER,[a,f],this.board)};JXG.Algebra.prototype.rotation=function(a,q,f){var h=q.coords.usrCoords,b=a.coords.usrCoords,e,o,g,u,d,k;e=h[1]-b[1];o=h[2]-b[2];g=Math.cos(f);u=Math.sin(f);d=e*g-o*u+b[1];k=e*u+o*g+b[2];return new JXG.Coords(JXG.COORDS_BY_USER,[d,k],this.board)};JXG.Algebra.prototype.perpendicular=function(v,s){var f=v.point1.coords.usrCoords,e=v.point2.coords.usrCoords,b=s.coords.usrCoords,o,h,k,u,g,d,a,q;if(s==v.point1){o=f[1]+e[2]-f[2];h=f[2]-e[1]+f[1];k=true}else{if(s==v.point2){o=e[1]+f[2]-e[2];h=e[2]-f[1]+e[1];k=false}else{if(((Math.abs(f[1]-e[1])>this.eps)&&(Math.abs(b[2]-(f[2]-e[2])*(b[1]-f[1])/(f[1]-e[1])-f[2])<this.eps))||((Math.abs(f[1]-e[1])<=this.eps)&&(Math.abs(f[1]-b[1])<this.eps))){o=b[1]+e[2]-b[2];h=b[2]-e[1]+b[1];k=true;if(Math.abs(o-b[1])<this.eps&&Math.abs(h-b[2])<this.eps){o=b[1]+f[2]-b[2];h=b[2]-f[1]+b[1];k=false}}else{u=f[2]-e[2];g=f[1]-e[1];d=e[1]*u-e[2]*g;a=b[1]*g+b[2]*u;q=u*u+g*g;if(Math.abs(q)<this.eps){q=this.eps}o=(d*u+a*g)/q;h=(a*u-d*g)/q;k=true}}}return[new JXG.Coords(JXG.COORDS_BY_USER,[o,h],this.board),k]};JXG.Algebra.prototype.circumcenterMidpoint=function(h,f,e){var d=h.coords.usrCoords,b=f.coords.usrCoords,a=e.coords.usrCoords,s,q,o,k,g;s=((d[1]-b[1])*(d[1]+b[1])+(d[2]-b[2])*(d[2]+b[2]))*0.5;q=((b[1]-a[1])*(b[1]+a[1])+(b[2]-a[2])*(b[2]+a[2]))*0.5;o=(d[1]-b[1])*(b[2]-a[2])-(b[1]-a[1])*(d[2]-b[2]);if(Math.abs(o)<this.eps){o=this.eps}k=(s*(b[2]-a[2])-q*(d[2]-b[2]))/o;g=(q*(d[1]-b[1])-s*(b[1]-a[1]))/o;return new JXG.Coords(JXG.COORDS_BY_USER,[k,g],this.board)};JXG.Algebra.prototype.intersectLineLine=function(s,q){var g=s.point1.coords.usrCoords,e=s.point2.coords.usrCoords,b=q.point1.coords.usrCoords,a=q.point2.coords.usrCoords,f,d,o,k,h;f=g[1]*e[2]-g[2]*e[1];d=b[1]*a[2]-b[2]*a[1];o=(e[2]-g[2])*(b[1]-a[1])-(g[1]-e[1])*(a[2]-b[2]);if(Math.abs(o)<this.eps){o=this.eps}k=(f*(b[1]-a[1])-d*(g[1]-e[1]))/o;h=(d*(e[2]-g[2])-f*(a[2]-b[2]))/o;return new JXG.Coords(JXG.COORDS_BY_USER,[k,h],this.board)};JXG.Algebra.prototype.intersectCircleLine=function(o,B){var O=B.point1.coords.usrCoords,L=B.point2.coords.usrCoords,f=o.midpoint.coords.usrCoords,F,a,N,K,D,I,G,q,E,C,k,g,H,z,u,e,A,v,J;F=B.point1.Dist(B.point2);if(F>0){a=o.midpoint.Dist(B.point1);N=o.midpoint.Dist(B.point2);K=((a*a)+(F*F)-(N*N))/(2*F);D=(a*a)-(K*K);D=(D<0)?0:D;I=Math.sqrt(D);G=o.getRadius();q=Math.sqrt((G*G)-I*I);E=L[1]-O[1];C=L[2]-O[2];k=f[1]+(I/F)*C;g=f[2]-(I/F)*E;a=(L[1]*C)-(L[2]*E);N=(k*E)+(g*C);H=(C*C)+(E*E);if(Math.abs(H)<this.eps){H=this.eps}z=((a*C)+(N*E))/H;u=((N*C)-(a*E))/H;e=q/F;A=new JXG.Coords(JXG.COORDS_BY_USER,[z+e*E,u+e*C],this.board);v=new JXG.Coords(JXG.COORDS_BY_USER,[z-e*E,u-e*C],this.board);J=o.midpoint.coords.distance(JXG.COORDS_BY_USER,A);if((G<(J-1))||isNaN(J)){return[0]}else{return[2,A,v]}}};JXG.Algebra.prototype.intersectCircleCircle=function(q,o){var d={},g=q.getRadius(),f=o.getRadius(),e=q.midpoint.coords.usrCoords,b=o.midpoint.coords.usrCoords,w,k,z,y,x,v,u;w=g+f;k=Math.abs(g-f);z=q.midpoint.coords.distance(JXG.COORDS_BY_USER,o.midpoint.coords);if(z>w){return[0]}else{if(z<k){return[0]}else{if(z!=0){d[0]=1;y=b[1]-e[1];x=b[2]-e[2];v=(z*z-f*f+g*g)/(2*z);u=Math.sqrt(g*g-v*v);d[1]=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+(v/z)*y+(u/z)*x,e[2]+(v/z)*x-(u/z)*y],this.board);d[2]=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+(v/z)*y-(u/z)*x,e[2]+(v/z)*x+(u/z)*y],this.board)}else{return[0]}return d}}};JXG.Algebra.prototype.projectPointToCircle=function(b,f){var g=b.coords.distance(JXG.COORDS_BY_USER,f.midpoint.coords),e=b.coords.usrCoords,k=f.midpoint.coords.usrCoords,a,h,d;if(Math.abs(g)<this.eps){g=this.eps}d=f.getRadius()/g;a=k[1]+d*(e[1]-k[1]);h=k[2]+d*(e[2]-k[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[a,h],this.board)};JXG.Algebra.prototype.projectPointToLine=function(a,d){var b=this.innerProduct(a.coords.usrCoords,d.stdform,3)/this.innerProduct(d.stdform,d.stdform,3),f,e=[];for(f=0;f<3;f++){e[f]=a.coords.usrCoords[f]-b*d.stdform[f]}return new JXG.Coords(JXG.COORDS_BY_USER,e,this.board)};JXG.Algebra.prototype.projectPointToCurve=function(d,f){var b=d.X(),g=d.Y(),e=d.position||0,a=this.projectCoordsToCurve(b,g,e,f);d.position=a[1];return a[0]};JXG.Algebra.prototype.projectCoordsToCurve=function(s,o,z,e){var w,d,v,b,q,u,f,g,h,a,k=1000000;if(e.curveType=="parameter"||e.curveType=="polar"){z=JXG.Math.Numerics.root(JXG.Math.Numerics.D(function(x){return(s-e.X(x))*(s-e.X(x))+(o-e.Y(x))*(o-e.Y(x))}),z);if(z<e.minX()){z=e.minX()}if(z>e.maxX()){z=e.maxX()}w=new JXG.Coords(JXG.COORDS_BY_USER,[e.X(z),e.Y(z)],this.board)}else{if(e.curveType=="plot"){g=k;for(f=0;f<e.numberPoints;f++){d=s-e.X(f);v=o-e.Y(f);h=Math.sqrt(d*d+v*v);if(h<g){g=h;z=f}if(f==e.numberPoints-1){continue}b=e.X(f+1)-e.X(f);q=e.Y(f+1)-e.Y(f);u=b*b+q*q;if(u>=JXG.Math.eps){a=(d*b+v*q)/u;h=Math.sqrt(d*d+v*v-a*(d*b+v*q))}else{a=0;h=Math.sqrt(d*d+v*v)}if(a>=0&&a<=1&&h<g){z=f+a;g=h}}f=Math.floor(z);a=z-f;if(f<e.numberPoints-1){s=a*e.X(f+1)+(1-a)*e.X(f);o=a*e.Y(f+1)+(1-a)*e.Y(f)}else{s=e.X(f);o=e.Y(f)}w=new JXG.Coords(JXG.COORDS_BY_USER,[s,o],this.board)}else{z=s;s=z;o=e.Y(z);w=new JXG.Coords(JXG.COORDS_BY_USER,[s,o],this.board)}}return[e.updateTransform(w),z]};JXG.Algebra.prototype.projectPointToTurtle=function(q,v){var u,w,o,k,d,s=0,g=0,e=1000000,h,a,b,f=v.objects.length;for(d=0;d<f;d++){a=v.objects[d];if(a.type==JXG.OBJECT_TYPE_CURVE){u=this.projectPointToCurve(q,a);h=this.distance(u.usrCoords,q.coords.usrCoords);if(h<e){o=u.usrCoords[1];k=u.usrCoords[2];w=q.position;e=h;b=a;g=s}s+=a.numberPoints}}u=new JXG.Coords(JXG.COORDS_BY_USER,[o,k],this.board);q.position=w+g;return b.updateTransform(u)};JXG.Algebra.prototype.replacePow=function(d){var h,q,k,g,o,e,a,b,f,u,s;f=d.indexOf("^");while(f>=0){b=d.slice(0,f);if(b.charAt(b.length-1)==")"){h=1;q=b.length-2;while(q>=0&&h>0){k=b.charAt(q);if(k==")"){h++}else{if(k=="("){h--}}q--}if(h==0){g="";e=b.substring(0,q+1);a=q;while(a>=0&&e.substr(a,1).match(/(\w+)/)){g=RegExp.$1+g;a--}g+=b.substring(q+1,b.length);g=g.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}}else{g="\\w+"}u=d.slice(f+1);if(u.match(/^([\w\.]*\()/)){h=1;q=RegExp.$1.length;while(q<u.length&&h>0){k=u.charAt(q);if(k==")"){h--}else{if(k=="("){h++}}q++}if(h==0){o=u.substring(0,q);o=o.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}}else{o="[\\w\\.]+"}s=new RegExp("("+g+")\\^("+o+")");d=d.replace(s,"this.board.algebra.pow($1,$2)");f=d.indexOf("^")}return d};JXG.Algebra.prototype.replaceIf=function(b){var x="",d,w,f=null,a=null,k=null,e,v,g,o,h,q,u;e=b.indexOf("If(");if(e<0){return b}b=b.replace(/""/g,"0");while(e>=0){d=b.slice(0,e);w=b.slice(e+3);g=1;v=0;o=-1;h=-1;while(v<w.length&&g>0){q=w.charAt(v);if(q==")"){g--}else{if(q=="("){g++}else{if(q==","&&g==1){if(o<0){o=v}else{h=v}}}}v++}u=w.slice(0,v-1);w=w.slice(v);if(o<0){return""}if(h<0){return""}f=u.slice(0,o);a=u.slice(o+1,h);k=u.slice(h+1);f=this.replaceIf(f);a=this.replaceIf(a);k=this.replaceIf(k);x+=d+"(("+f+")?("+a+"):("+k+"))";b=w;f=null;a=null;e=b.indexOf("If(")}x+=w;return x};JXG.Algebra.prototype.replaceSub=function(d){var b=d.indexOf("_{"),a;while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/_\{/,"<sub>");a=d.substr(b).indexOf("}");if(a>=0){d=d.substr(0,a)+d.substr(a).replace(/\}/,"</sub>")}b=d.indexOf("_{")}b=d.indexOf("_");while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/_(.?)/,"<sub>$1</sub>");b=d.indexOf("_")}return d};JXG.Algebra.prototype.replaceSup=function(d){var b=d.indexOf("^{"),a;while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/\^\{/,"<sup>");a=d.substr(b).indexOf("}");if(a>=0){d=d.substr(0,a)+d.substr(a).replace(/\}/,"</sup>")}b=d.indexOf("^{")}b=d.indexOf("^");while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/\^(.?)/,"<sup>$1</sup>");b=d.indexOf("^")}return d};JXG.Algebra.prototype.replaceNameById=function(b){var f=0,a,e,d;f=b.indexOf("X(");while(f>=0){if(f>=0){a=b.indexOf(")",f+2);if(a>=0){e=b.slice(f+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+2)+d.id+b.slice(a)}}a=b.indexOf(")",f+2);f=b.indexOf("X(",a)}f=b.indexOf("Y(");while(f>=0){if(f>=0){a=b.indexOf(")",f+2);if(a>=0){e=b.slice(f+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+2)+d.id+b.slice(a)}}a=b.indexOf(")",f+2);f=b.indexOf("Y(",a)}f=b.indexOf("L(");while(f>=0){if(f>=0){a=b.indexOf(")",f+2);if(a>=0){e=b.slice(f+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+2)+d.id+b.slice(a)}}a=b.indexOf(")",f+2);f=b.indexOf("L(",a)}f=b.indexOf("Dist(");while(f>=0){if(f>=0){a=b.indexOf(",",f+5);if(a>=0){e=b.slice(f+5,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+5)+d.id+b.slice(a)}}a=b.indexOf(",",f+5);f=b.indexOf(",",a);a=b.indexOf(")",f+1);if(a>=0){e=b.slice(f+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+1)+d.id+b.slice(a)}a=b.indexOf(")",f+1);f=b.indexOf("Dist(",a)}f=b.indexOf("Deg(");while(f>=0){if(f>=0){a=b.indexOf(",",f+4);if(a>=0){e=b.slice(f+4,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+4)+d.id+b.slice(a)}}a=b.indexOf(",",f+4);f=b.indexOf(",",a);a=b.indexOf(",",f+1);if(a>=0){e=b.slice(f+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+1)+d.id+b.slice(a)}a=b.indexOf(",",f+1);f=b.indexOf(",",a);a=b.indexOf(")",f+1);if(a>=0){e=b.slice(f+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+1)+d.id+b.slice(a)}a=b.indexOf(")",f+1);f=b.indexOf("Deg(",a)}f=b.indexOf("Rad(");while(f>=0){if(f>=0){a=b.indexOf(",",f+4);if(a>=0){e=b.slice(f+4,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+4)+d.id+b.slice(a)}}a=b.indexOf(",",f+4);f=b.indexOf(",",a);a=b.indexOf(",",f+1);if(a>=0){e=b.slice(f+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+1)+d.id+b.slice(a)}a=b.indexOf(",",f+1);f=b.indexOf(",",a);a=b.indexOf(")",f+1);if(a>=0){e=b.slice(f+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,f+1)+d.id+b.slice(a)}a=b.indexOf(")",f+1);f=b.indexOf("Rad(",a)}return b};JXG.Algebra.prototype.replaceIdByObj=function(a){var b=/(X|Y|L)\(([\w_]+)\)/g;a=a.replace(b,'this.board.objects["$2"].$1()');b=/(Dist)\(([\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.objects["$2"].Dist(this.board.objects["$3"])');b=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.algebra.trueAngle(this.board.objects["$2"],this.board.objects["$3"],this.board.objects["$4"])');b=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.algebra.rad(this.board.objects["$1"],this.board.objects["$2"],this.board.objects["$3"])');return a};JXG.Algebra.prototype.geonext2JS=function(b){var e,d,a,g=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Floor","Log","Max","Min","Pow","Random","Round","Sin","Sqrt","Tan","Trunc"],f=["Math.abs","Math.acos","Math.asin","Math.atan","Math.ceil","Math.cos","Math.exp","Math.floor","Math.log","Math.max","Math.min","Math.pow","Math.random","this.board.round","Math.sin","Math.sqrt","Math.tan","Math.ceil"];b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&amp;/g,"&");d=b;d=this.replaceNameById(d);d=this.replaceIf(d);d=this.replacePow(d);d=this.replaceIdByObj(d);for(a=0;a<g.length;a++){e=new RegExp(g[a],"g");d=d.replace(e,f[a])}d=d.replace(/True/g,"true");d=d.replace(/False/g,"false");d=d.replace(/fasle/g,"false");d=d.replace(/Pi/g,"Math.PI");return d};JXG.Algebra.prototype.findDependencies=function(e,b){var f=this.board.elementsByName,d,g,a;for(d in f){if(d!=e.name){if(f[d].type==JXG.OBJECT_TYPE_TEXT){if(!f[d].isLabel){a=d.replace(/\[/g,"\\[");a=a.replace(/\]/g,"\\]");g=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+a+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(b.search(g)>=0){f[d].addChild(e)}}}else{a=d.replace(/\[/g,"\\[");a=a.replace(/\]/g,"\\]");g=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+a+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(b.search(g)>=0){f[d].addChild(e)}}}}};JXG.Algebra.prototype.distance=function(f,e){var d=0,b,a;if(f.length!=e.length){return}a=f.length;for(b=0;b<a;b++){d+=(f[b]-e[b])*(f[b]-e[b])}return Math.sqrt(d)};JXG.Algebra.prototype.affineDistance=function(b,a){var e;if(b.length!=a.length){return}e=this.distance(b,a);if(e>this.eps&&(Math.abs(b[0])<this.eps||Math.abs(a[0])<this.eps)){return Infinity}else{return e}};JXG.Algebra.prototype.str2Bool=function(a){if(a==undefined||a==null){return true}if(typeof a=="boolean"){return a}if(a.toLowerCase()!="true"){return false}else{return true}};JXG.Algebra.prototype.pow=function(e,d){if(e==0||d==0){return 1}if(Math.floor(d)==d){return Math.pow(e,d)}else{if(e>0){return Math.exp(d*Math.log(Math.abs(e)))}else{return NaN}}};JXG.Algebra.prototype.crossProduct=function(b,a){return[b[1]*a[2]-b[2]*a[1],b[2]*a[0]-b[0]*a[2],b[0]*a[1]-b[1]*a[0]]};JXG.Algebra.prototype.innerProduct=function(e,d,h){var f,g=0;if(typeof h=="undefined"){h=e.length}for(f=0;f<h;f++){g+=e[f]*d[f]}return g};JXG.Algebra.prototype.meet=function(e,b,d){var a=this.eps;if(Math.abs(e[3])<a&&Math.abs(b[3])<a){return this.meetLineLine(e,b,d)}else{if(Math.abs(e[3])>=a&&Math.abs(b[3])<a){return this.meetLineCircle(b,e,d)}else{if(Math.abs(e[3])<a&&Math.abs(b[3])>=a){return this.meetLineCircle(e,b,d)}else{return this.meetCircleCircle(e,b,d)}}}};JXG.Algebra.prototype.meetLineLine=function(b,a,d){var e=this.crossProduct(b,a);if(Math.abs(e[0])>this.eps){e[1]/=e[0];e[2]/=e[0];e[0]=1}return new JXG.Coords(JXG.COORDS_BY_USER,e,this.board)};JXG.Algebra.prototype.meetLineCircle=function(o,e,u){var y,x,w,v,q,h,g,f,s,z;if(e[4]<this.eps){return new JXG.Coords(JXG.COORDS_BY_USER,e.slice(1,3),this.board)}w=e[0];x=e.slice(1,3);y=e[3];v=o[0];q=o.slice(1,3);h=y;g=(x[0]*q[1]-x[1]*q[0]);f=y*v*v-(x[0]*q[0]+x[1]*q[1])*v+w;s=g*g-4*h*f;if(s>=0){s=Math.sqrt(s);z=[(-g+s)/(2*h),(-g-s)/(2*h)];return((u==0)?new JXG.Coords(JXG.COORDS_BY_USER,[-z[0]*(-q[1])-v*q[0],-z[0]*q[0]-v*q[1]],this.board):new JXG.Coords(JXG.COORDS_BY_USER,[-z[1]*(-q[1])-v*q[0],-z[1]*q[0]-v*q[1]],this.board))}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}};JXG.Algebra.prototype.meetCircleCircle=function(d,a,b){var e;if(d[4]<this.eps){if(this.distance(d.slice(1,3),a.slice(1,3))==a[4]){return new JXG.Coords(JXG.COORDS_BY_USER,d.slice(1,3),this.board)}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}}if(a[4]<this.eps){if(this.distance(a.slice(1,3),d.slice(1,3))==d[4]){return new JXG.Coords(JXG.COORDS_BY_USER,a.slice(1,3),this.board)}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}}e=[a[3]*d[0]-d[3]*a[0],a[3]*d[1]-d[3]*a[1],a[3]*d[2]-d[3]*a[2],0,1,Infinity,Infinity,Infinity];e=this.normalize(e);return this.meetLineCircle(e,d,b)};JXG.Algebra.prototype.normalize=function(d){var a=2*d[3],e=d[4]/(a),f,b;d[5]=e;d[6]=-d[1]/a;d[7]=-d[2]/a;if(e==Infinity||isNaN(e)){f=Math.sqrt(d[1]*d[1]+d[2]*d[2]);d[0]/=f;d[1]/=f;d[2]/=f;d[3]=0;d[4]=1}else{if(Math.abs(e)>=1){d[0]=(d[6]*d[6]+d[7]*d[7]-e*e)/(2*e);d[1]=-d[6]/e;d[2]=-d[7]/e;d[3]=1/(2*e);d[4]=1}else{b=(e<=0)?(-1):(1);d[0]=b*(d[6]*d[6]+d[7]*d[7]-e*e)*0.5;d[1]=-b*d[6];d[2]=-b*d[7];d[3]=b/2;d[4]=b*e}}return d};JXG.Algebra.prototype.meetCurveCurve=function(y,x,h,q){var s=0,v,u,H,E,C,B,g,A,z,w,G,D,o,k;if(arguments.callee.t1memo){v=arguments.callee.t1memo;u=arguments.callee.t2memo}else{v=h;u=q}if(v>y.maxX()){v=y.maxX()}if(v<y.minX()){v=y.minX()}if(u>x.maxX()){u=x.maxX()}if(u<x.minX()){u=x.minX()}A=y.X(v)-x.X(u);z=y.Y(v)-x.Y(u);w=A*A+z*z;G=y.board.D(y.X,y);D=x.board.D(x.X,x);o=y.board.D(y.Y,y);k=x.board.D(x.Y,x);while(w>JXG.Math.eps&&s<10){H=G(v);E=-D(u);C=o(v);B=-k(u);g=H*B-E*C;v-=(B*A-E*z)/g;u-=(H*z-C*A)/g;A=y.X(v)-x.X(u);z=y.Y(v)-x.Y(u);w=A*A+z*z;s++}arguments.callee.t1memo=v;arguments.callee.t2memo=u;if(Math.abs(v)<Math.abs(u)){return(new JXG.Coords(JXG.COORDS_BY_USER,[y.X(v),y.Y(v)],this.board))}else{return(new JXG.Coords(JXG.COORDS_BY_USER,[x.X(u),x.Y(u)],this.board))}};JXG.Intersection=function(f,b,e,d,h,g,s,q){this.constructor();this.board=f;this.id=b;this.name=this.id;this.visProp={};this.visProp.visible=true;this.show=true;this.real=true;this.notExistingParents={};this.intersect1=JXG.getReference(this.board,e);this.intersect2=JXG.getReference(this.board,d);this.type=JXG.OBJECT_TYPE_INTERSECTION;if(((this.intersect1=="")||(this.intersect1==undefined))&&((this.intersect2=="")||(this.intersect2==undefined))){return}if(((this.intersect1.type==this.intersect2.type)&&(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect1.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect2.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect2.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect1.type==JXG.OBJECT_TYPE_ARROW))){var k=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2).usrCoords.slice(1);this.p=new JXG.Point(this.board,k,h,s,true);this.p.fixed=true;this.addChild(this.p);this.real=true;this.update=function(){if(this.needsUpdate){this.p.coords=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2);this.needsUpdate=false}};this.hideElement=function(){this.visProp.visible=false;this.p.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p.showElement()};this.hideChild=function(v){this.notExistingParents[v]=this.board.objects[v];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[v]=this.board.objects[v]}};this.showChild=function(v){for(var u in this.board.objects){delete (this.board.objects[u].notExistingParents[v]);if(this.board.objects[u].visProp.visible&&JXG.keys(this.board.objects[u].notExistingParents).length==0){if(this.board.objects[u].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[u].showElement()}}}}}else{if(((e.type==d.type)&&(e.type==JXG.OBJECT_TYPE_CIRCLE||e.type==JXG.OBJECT_TYPE_ARC))||(e.type==JXG.OBJECT_TYPE_CIRCLE&&d.type==JXG.OBJECT_TYPE_ARC)||(d.type==JXG.OBJECT_TYPE_CIRCLE&&e.type==JXG.OBJECT_TYPE_ARC)){this.p1=new JXG.Point(this.board,[0,0],h,s,false);this.p1.fixed=true;this.p1.label.content.visProp.visible=true;this.p2=new JXG.Point(this.board,[0,0],g,q,false);this.p2.fixed=true;this.p2.label.content.visProp.visible=true;this.addChild(this.p1);this.addChild(this.p2);var o=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);if(o[0]==1){this.p1.coords=o[1];this.p1.showElement();this.p1.updateRenderer();this.p2.coords=o[2];this.p2.showElement();this.p2.updateRenderer();this.real=true}else{this.real=false}this.update=function(){if(!this.needsUpdate){return}var w=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);var v=this.p1.visProp.visible;var u=this.p2.visProp.visible;if(w[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp.visible=v;this.p2.visProp.visible=u;this.real=false}}else{this.p1.coords=w[1];this.p2.coords=w[2];if(!this.real){this.showChild(this.id);this.real=true}}this.needsUpdate=false};this.hideElement=function(){this.visProp.visible=false;this.p1.hideElement();this.p2.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p1.showElement();this.p2.showElement()};this.hideChild=function(v){this.notExistingParents[v]=this.board.objects[v];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[v]=this.board.objects[v]}};this.showChild=function(u){for(el in this.board.objects){delete (this.board.objects[el].notExistingParents[u]);if(this.board.objects[el].visProp.visible&&JXG.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement()}}}}}else{this.p1=new JXG.Point(this.board,[0,0],h,s,false);this.p1.fixed=true;this.p1.label.content.visProp.visible=true;this.p2=new JXG.Point(this.board,[0,0],g,q,false);this.p2.fixed=true;this.p2.label.content.visProp.visible=true;this.addChild(this.p1);this.addChild(this.p2);if(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW){var a=this.intersect1;this.intersect1=this.intersect2;this.intersect2=a}var o=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);if(o[0]==1){this.p1.coords=o[1];this.p1.showElement();this.p1.update()}else{if(o[0]==2){this.p1.coords=o[1];this.p1.showElement();this.p2.coords=o[2];this.p2.showElement();this.p1.updateRenderer();this.p2.updateRenderer();this.real=true}else{this.real=false}}this.update=function(){if(!this.needsUpdate){return}var w=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);var v=this.p1.visProp.visible;var u=this.p2.visProp.visible;if(w[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp.visible=v;this.p2.visProp.visible=u;this.real=false}}else{if(w[0]==2){this.p1.coords=w[1];this.p2.coords=w[2];if(!this.real){this.showChild(this.id);this.real=true}}}this.needsUpdate=false};this.hideElement=function(){this.visProp.visible=false;this.p1.hideElement();this.p2.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p1.showElement();this.p2.showElement()};this.hideChild=function(v){this.notExistingParents[v]=this.board.objects[v];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[v]=this.board.objects[v]}};this.showChild=function(u){for(el in this.board.objects){delete (this.board.objects[el].notExistingParents[u]);if(this.board.objects[el].visProp.visible&&JXG.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement()}}}}}}this.id=this.board.addIntersection(this)};JXG.Intersection.prototype=new JXG.GeometryElement();JXG.Intersection.prototype.update=function(){return};JXG.Intersection.prototype.hasPoint=function(a,b){return false};JXG.Intersection.prototype.hideChild=function(a){};JXG.Intersection.prototype.showChild=function(a){};JXG.Intersection.prototype.remove=function(){if(this.p!=undefined){this.board.removeObject(this.p)}if(this.p1!=undefined){this.board.removeObject(this.p1)}if(this.p2!=undefined){this.board.removeObject(this.p2)}return};JXG.Intersection.prototype.updateRenderer=function(){};JXG.createPerpendicular=function(h,f,g){var e,a,d,o;f[0]=JXG.getReference(h,f[0]);f[1]=JXG.getReference(h,f[1]);if(JXG.isPoint(f[0])&&f[1].elementClass==JXG.OBJECT_CLASS_LINE){d=f[1];a=f[0]}else{if(JXG.isPoint(f[1])&&f[0].elementClass==JXG.OBJECT_CLASS_LINE){d=f[0];a=f[1]}else{throw ("Can't create perpendicular with parent types '"+(typeof f[0])+"' and '"+(typeof f[1])+"'.")}}if(!JXG.isArray(g.id)){g.id=["",""]}if(!JXG.isArray(g.name)){g.name=["",""]}var k=h.createElement("point",[function(){return h.algebra.perpendicular(d,a)[0]}],{fixed:true,name:g.name[1],id:g.id[1]});a.addChild(k);d.addChild(k);var b=h.createElement("segment",[function(){return(h.algebra.perpendicular(d,a)[1]?[k,a]:[a,k])}],{name:g.name[0],id:g.id[0]});e=[b,k];o=e[1];o.generatePolynomial=function(){var s=d.point1.symbolic.x;var q=d.point1.symbolic.y;var z=d.point2.symbolic.x;var y=d.point2.symbolic.y;var B=a.symbolic.x;var A=a.symbolic.y;var w=o.symbolic.x;var u=o.symbolic.y;var x=""+q+"*"+w+"-"+q+"*"+z+"+"+u+"*"+z+"-"+s+"*"+u+"+"+s+"*"+y+"-"+w+"*"+y;var v=""+A+"*"+q+"-"+A+"*"+y+"-"+u+"*"+q+"+"+u+"*"+y+"+"+B+"*"+s+"-"+B+"*"+z+"-"+w+"*"+s+"+"+w+"*"+z;return[x,v]};return e};JXG.createMidpoint=function(g,k,h){var e,d,f;if(k.length==2&&JXG.isPoint(k[0])&&JXG.isPoint(k[1])){e=k[0];d=k[1];f=g.addMidpoint(k[0],k[1],h.id,h.name)}else{if(k.length==1&&k[0].type==JXG.OBJECT_TYPE_LINE){e=k[0].point1;d=k[0].point2;f=g.addMidpoint(k[0].point1,k[0].point2,h.id,h.name)}else{throw ("Can't create midpoint.")}}f.generatePolynomial=function(){var o=e.symbolic.x;var b=e.symbolic.y;var s=d.symbolic.x;var q=d.symbolic.y;var v=f.symbolic.x;var u=f.symbolic.y;var a=""+b+"*"+v+"-"+b+"*"+s+"+"+u+"*"+s+"-"+o+"*"+u+"+"+o+"*"+q+"-"+v+"*"+q;var w=""+o+"^2 - 2*"+o+"*"+v+"+"+b+"^2-2*"+b+"*"+u+"-"+s+"^2+2*"+s+"*"+v+"-"+q+"^2+2*"+q+"*"+u;return[a,w]};return f};JXG.createParallel=function(a,d,b){if(JXG.isPoint(d[0])&&d[1].type==JXG.OBJECT_TYPE_LINE){return a.addParallel(d[1],d[0],b.id,b.name)}else{if(JXG.isPoint(d[1])&&d[0].type==JXG.OBJECT_TYPE_LINE){return a.addParallel(d[0],d[1],b.id,b.name)}else{throw ("Can't create parallel with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}}};JXG.createNormal=function(h,o,b){var a;var k;if(o.length==1){a=o[0];k=a.slideObject}else{if(o.length==2){if(JXG.isPoint(o[0])){a=o[0];k=o[1]}else{if(JXG.isPoint(o[1])){k=o[0];a=o[1]}else{throw ("Can't create normal with parent types '"+(typeof o[0])+"' and '"+(typeof o[1])+"'.")}}}else{throw ("Can't create normal with parent types '"+(typeof o[0])+"' and '"+(typeof o[1])+"'.")}}if(k.elementClass==JXG.OBJECT_CLASS_LINE){return h.createElement("line",[function(){return k.stdform[1]*a.Y()-k.stdform[2]*a.X()},function(){return k.stdform[2]*a.Z()},function(){return -k.stdform[1]*a.Z()}],b)}else{if(k.elementClass==JXG.OBJECT_CLASS_CIRCLE){var q=function(f){return -k.getRadius()*Math.sin(f)};var s=function(f){return k.getRadius()*Math.cos(f)};return h.createElement("line",[function(){return -a.X()*q(a.position)-a.Y()*s(a.position)},function(){return q(a.position)},function(){return s(a.position)}],b)}else{if(k.elementClass==JXG.OBJECT_CLASS_CURVE){if(k.curveType!="plot"){var d=k.X;var e=k.Y;return h.createElement("line",[function(){return -a.X()*h.D(d)(a.position)-a.Y()*h.D(e)(a.position)},function(){return h.D(d)(a.position)},function(){return h.D(e)(a.position)}],b)}else{return h.createElement("line",[function(){var g=Math.floor(a.position);var f=a.position-g;if(g==k.numberPoints-1){g--;f=1}if(g<0){return 1}return(k.Y(g)+f*(k.Y(g+1)-k.Y(g)))*(k.Y(g)-k.Y(g+1))-(k.X(g)+f*(k.X(g+1)-k.X(g)))*(k.X(g+1)-k.X(g))},function(){var f=Math.floor(a.position);if(f==k.numberPoints-1){f--}if(f<0){return 0}return k.X(f+1)-k.X(f)},function(){var f=Math.floor(a.position);if(f==k.numberPoints-1){f--}if(f<0){return 0}return k.Y(f+1)-k.Y(f)}],b)}}else{if(k.type==JXG.OBJECT_TYPE_TURTLE){return h.createElement("line",[function(){var u=Math.floor(a.position);var f=a.position-u;var v,g;for(g=0;g<k.objects.length;g++){v=k.objects[g];if(v.type==JXG.OBJECT_TYPE_CURVE){if(u<v.numberPoints){break}u-=v.numberPoints}}if(u==v.numberPoints-1){u--;f=1}if(u<0){return 1}return(v.Y(u)+f*(v.Y(u+1)-v.Y(u)))*(v.Y(u)-v.Y(u+1))-(v.X(u)+f*(v.X(u+1)-v.X(u)))*(v.X(u+1)-v.X(u))},function(){var g=Math.floor(a.position);var u,f;for(f=0;f<k.objects.length;f++){u=k.objects[f];if(u.type==JXG.OBJECT_TYPE_CURVE){if(g<u.numberPoints){break}g-=u.numberPoints}}if(g==u.numberPoints-1){g--}if(g<0){return 0}return u.X(g+1)-u.X(g)},function(){var g=Math.floor(a.position);var u,f;for(f=0;f<k.objects.length;f++){u=k.objects[f];if(u.type==JXG.OBJECT_TYPE_CURVE){if(g<u.numberPoints){break}g-=u.numberPoints}}if(g==u.numberPoints-1){g--}if(g<0){return 0}return u.Y(g+1)-u.Y(g)}],b)}else{throw ("Can't create normal with parent types '"+(typeof o[0])+"' and '"+(typeof o[1])+"'.")}}}}};JXG.createBisector=function(a,d,b){if(JXG.isPoint(d[0])&&JXG.isPoint(d[1])&&JXG.isPoint(d[2])){return a.addAngleBisector(d[0],d[1],d[2],b.id,b.name)}else{throw ("Can't create angle bisector with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}};JXG.createAngularBisectorsOfTwoLines=function(g,k,e){var d=JXG.getReference(g,k[0]);var b=JXG.getReference(g,k[1]);var q="";var o="";var h="";var f="";if(e==null){e={}}if(e.id!=null){if(JXG.isArray(e.id)){q=e.id[0];o=e.id[1]}else{q=e.id;o=e.id}}if(e.name!=null){if(JXG.isArray(e.name)){h=e.name[0];f=e.name[1]}else{h=e.name;f=e.name}}e.id=q;e.name=h;var a=g.createElement("line",[function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[0]/v-b.stdform[0]/u},function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[1]/v-b.stdform[1]/u},function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[2]/v-b.stdform[2]/u},],e);e.id=o;e.name=f;var s=g.createElement("line",[function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[0]/v+b.stdform[0]/u},function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[1]/v+b.stdform[1]/u},function(){var v=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[2]/v+b.stdform[2]/u},],e);return[a,s]};JXG.createArrowParallel=function(a,d,b){if(JXG.isPoint(d[0])&&d[1].type==JXG.OBJECT_TYPE_ARROW){if(!JXG.isArray(b.id)){b.id=["",""]}if(!JXG.isArray(b.name)){b.name=["",""]}return a.addArrowParallel(d[1],d[0],b.id[0],b.name[0],b.id[1],b.name[1])}else{if(JXG.isPoint(d[1])&&d[0].type==JXG.OBJECT_TYPE_ARROW){if(!JXG.isArray(b.id)){b.id=["",""]}if(!JXG.isArray(b.name)){b.name=["",""]}return a.addArrowParallel(d[0],d[1],b.id[0],b.name[0],b.id[1],b.name[1])}else{throw ("Can't create parallel arrow with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}}};JXG.createCircumcircle=function(a,d,b){if(JXG.isPoint(d[0])&&JXG.isPoint(d[1])&&JXG.isPoint(d[2])){if(!JXG.isArray(b.id)){b.id=["",""]}if(!JXG.isArray(b.name)){b.name=["",""]}return a.addCircumcenter(d[0],d[1],d[2],b.id[0],b.name[0],b.id[1],b.name[1])}else{throw ("Can't create circumcircle with parent types '"+(typeof d[0])+"', '"+(typeof d[1])+"' and '"+(typeof d[2])+"'.")}};JXG.createCircumcircleMidpoint=function(a,d,b){if(JXG.isPoint(d[0])&&JXG.isPoint(d[1])&&JXG.isPoint(d[2])){return a.addCircumcenterMidpoint(d[0],d[1],d[2],b.id,b.name)}else{throw ("Can't create circumcircle midpoint with parent types '"+(typeof d[0])+"', '"+(typeof d[1])+"' and '"+(typeof d[2])+"'.")}};JXG.createParallelPoint=function(a,d,b){if(JXG.isPoint(d[0])&&JXG.isPoint(d[1])&&JXG.isPoint(d[2])){return a.addParallelPoint(d[0],d[1],d[2],b.id,b.name)}else{throw ("Can't create parallel point with parent types '"+(typeof d[0])+"', '"+(typeof d[1])+"' and '"+(typeof d[2])+"'.")}};JXG.createReflection=function(a,d,b){if(JXG.isPoint(d[0])&&d[1].type==JXG.OBJECT_TYPE_LINE){return a.addReflection(d[1],d[0],b.id,b.name)}else{if(JXG.isPoint(d[1])&&d[0].type==JXG.OBJECT_TYPE_LINE){return a.addReflection(d[0],d[1],b.id,b.name)}else{throw ("Can't create reflection point with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}}};JXG.createPerpendicularPoint=function(d,g,f){var a,e,b;if(JXG.isPoint(g[0])&&g[1].type==JXG.OBJECT_TYPE_LINE){e=g[0];a=g[1];b=d.addPerpendicularPoint(g[1],g[0],f.id,f.name)}else{if(JXG.isPoint(g[1])&&g[0].type==JXG.OBJECT_TYPE_LINE){e=g[1];a=g[0];b=d.addPerpendicularPoint(g[0],g[1],f.id,f.name)}else{throw ("Can't create perpendicular point with parent types '"+(typeof g[0])+"' and '"+(typeof g[1])+"'.")}}b.generatePolynomial=function(){var k=a.point1.symbolic.x;var h=a.point1.symbolic.y;var w=a.point2.symbolic.x;var v=a.point2.symbolic.y;var y=e.symbolic.x;var x=e.symbolic.y;var s=b.symbolic.x;var o=b.symbolic.y;var u=""+h+"*"+s+"-"+h+"*"+w+"+"+o+"*"+w+"-"+k+"*"+o+"+"+k+"*"+v+"-"+s+"*"+v;var q=""+x+"*"+h+"-"+x+"*"+v+"-"+o+"*"+h+"+"+o+"*"+v+"+"+y+"*"+k+"-"+y+"*"+w+"-"+s+"*"+k+"+"+s+"*"+w;return[u,q]};return b};JXG.createMirrorPoint=function(a,d,b){if(JXG.isPoint(d[0])&&JXG.isPoint(d[1])){return a.addRotation(d[0],d[1],Math.PI,b.id,b.name)}else{throw ("Can't create mirror point with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}};JXG.createIntegral=function(a,d,b){if(!JXG.isArray(b.id)||(b.id.length!=5)){b.id=["","","","",""]}if(!JXG.isArray(b.name)||(b.name.length!=5)){b.name=["","","","",""]}if(JXG.isArray(d[0])&&d[1].type==JXG.OBJECT_TYPE_CURVE){return a.addIntegral(d[0],d[1],b.id,b.name,b)}else{if(JXG.isArray(d[1])&&d[0].type==JXG.OBJECT_TYPE_CURVE){return a.addIntegral(d[1],d[0],b.id,b.name,b)}else{throw ("Can't create integral with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}}};JXG.JSXGraph.registerElement("arrowparallel",JXG.createArrowParallel);JXG.JSXGraph.registerElement("bisector",JXG.createBisector);JXG.JSXGraph.registerElement("bisectorlines",JXG.createAngularBisectorsOfTwoLines);JXG.JSXGraph.registerElement("circumcircle",JXG.createCircumcircle);JXG.JSXGraph.registerElement("circumcirclemidpoint",JXG.createCircumcircleMidpoint);JXG.JSXGraph.registerElement("integral",JXG.createIntegral);JXG.JSXGraph.registerElement("midpoint",JXG.createMidpoint);JXG.JSXGraph.registerElement("mirrorpoint",JXG.createMirrorPoint);JXG.JSXGraph.registerElement("normal",JXG.createNormal);JXG.JSXGraph.registerElement("parallel",JXG.createParallel);JXG.JSXGraph.registerElement("parallelpoint",JXG.createParallelPoint);JXG.JSXGraph.registerElement("perpendicular",JXG.createPerpendicular);JXG.JSXGraph.registerElement("perpendicularpoint",JXG.createPerpendicularPoint);JXG.JSXGraph.registerElement("reflection",JXG.createReflection);JXG.Text=function(k,s,g,q,d,a,e,o){this.constructor();this.type=JXG.OBJECT_TYPE_TEXT;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.init(k,d,a);this.contentStr=s;this.plaintextStr="";if((typeof o!="undefined")&&(o!=null)){this.isLabel=o}else{this.isLabel=false}this.visProp.strokeColor=this.board.options.text.strokeColor;this.visProp.visible=true;if(e!=null){this.digits=e}else{this.digits=2}if((this.element=this.board.objects[g])){var f;this.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[parseFloat(q[0]),parseFloat(q[1])],this.board);if(!this.isLabel){f=this.element.getTextAnchor()}else{f=this.element.getLabelAnchor()}this.element.addChild(this);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+f.usrCoords[1],this.relativeCoords.usrCoords[2]+f.usrCoords[2]],this.board)}else{this.X=JXG.createFunction(q[0],this.board,"");this.Y=JXG.createFunction(q[1],this.board,"");this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board);var h="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()]);";this.updateCoords=new Function("",h)}if(typeof this.contentStr=="function"){this.updateText=function(){this.plaintextStr=this.contentStr()}}else{var b;if(typeof this.contentStr=="number"){b=(this.contentStr).toFixed(this.digits)}else{b=this.generateTerm(this.contentStr)}this.updateText=new Function("this.plaintextStr = "+b+";")}if(!this.isLabel){this.id=this.board.addText(this)}if(typeof this.contentStr=="string"){this.notifyParents(this.contentStr)}};JXG.Text.prototype=new JXG.GeometryElement();JXG.Text.prototype.hasPoint=function(a,b){return false};JXG.Text.prototype.setText=function(b){var a;if(typeof b=="number"){a=(b).toFixed(this.digits)}else{a=this.generateTerm(b)}this.updateText=new Function("this.plaintextStr = "+a+";");this.updateText();return this};JXG.Text.prototype.setCoords=function(a,b){this.X=function(){return a};this.Y=function(){return b};this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[a,b],this.board);return this};JXG.Text.prototype.update=function(){if(this.needsUpdate){if(this.relativeCoords){var a;if(!this.isLabel){a=this.element.getTextAnchor()}else{a=this.element.getLabelAnchor()}this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+a.usrCoords[1],this.relativeCoords.usrCoords[2]+a.usrCoords[2]])}else{this.updateCoords()}this.updateText()}return this};JXG.Text.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateText(this);this.needsUpdate=false}return this};JXG.Text.prototype.generateTerm=function(f){var e=null;var h=this.board.elementsByName;var g='""';f=f.replace(/\r/g,"");f=f.replace(/\n/g,"");f=f.replace(/\"/g,'\\"');f=f.replace(/\'/g,"\\'");f=f.replace(/&amp;arc;/g,"&ang;");f=f.replace(/<arc\s*\/>/g,"&ang;");f=f.replace(/<sqrt\s*\/>/g,"&radic;");var d;d=f.indexOf("<value>");var a=f.indexOf("</value>");if(d>=0){while(d>=0){g+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(f.slice(0,d)))+'"';var b=f.slice(d+7,a);var e=this.board.algebra.geonext2JS(b);e=e.replace(/\\"/g,'"');e=e.replace(/\\'/g,"'");if(e.indexOf("toFixed")<0){g+="+("+e+").toFixed("+(this.digits)+")"}else{g+="+("+e+")"}f=f.slice(a+8);d=f.indexOf("<value>");a=f.indexOf("</value>")}}g+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(f))+'"';g=g.replace(/<overline>/g,"<span style=text-decoration:overline>");g=g.replace(/<\/overline>/g,"</span>");g=g.replace(/<arrow>/g,"<span style=text-decoration:overline>");g=g.replace(/<\/arrow>/g,"</span>");g=g.replace(/&amp;/g,"&");return g};JXG.Text.prototype.notifyParents=function(d){var b=null;var e=this.board.elementsByName;do{var a=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;b=a.exec(d);if(b!=null){this.board.algebra.findDependencies(this,b[1]);d=d.substr(b.index);d=d.replace(a,"")}}while(b!=null);return this};JXG.createText=function(a,d,b){return new JXG.Text(a,d[d.length-1],null,d,b.id,b.name,b.digits,false)};JXG.JSXGraph.registerElement("text",JXG.createText);JXG.Image=function(f,e,h,b,g,k,a,d){this.type=JXG.OBJECT_TYPE_IMAGE;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.transformations=[];this.init(f,k,a);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,h,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,h,this.board);this.size=[b[0]*f.zoomX*f.unitX,b[1]*f.zoomY*f.unitY];this.imageBase64String=e;this.displayLevel=g;this.parent=d;this.visProp.visible=true;this.id=this.board.addImage(this)};JXG.Image.prototype=new JXG.GeometryElement;JXG.Image.prototype.hasPoint=function(a,b){return false};JXG.Image.prototype.updateRenderer=function(){this.updateTransform();this.board.renderer.updateImage(this)};JXG.Image.prototype.updateTransform=function(){if(this.transformations.length==0){return}for(var a=0;a<this.transformations.length;a++){this.transformations[a].update()}};JXG.Image.prototype.addTransform=function(a){if(JXG.isArray(a)){for(var b=0;b<a.length;b++){this.transformations.push(a[b])}}else{this.transformations.push(a)}};JXG.createImage=function(a,d,b){return new JXG.Image(a,b.imageString,d[0],d[1],"images",false,false,undefined)};JXG.JSXGraph.registerElement("image",JXG.createImage);JXG.createSlider=function(q,z,w){var h,g,A,k,B,d,b,y,C,o,f,e,a,x,v,s,u;h=z[0];g=z[1];A=z[2][0];k=z[2][1];B=z[2][2];if(w==null){w={}}if(w.strokeColor==null||typeof w.strokeColor=="undefined"){w.strokeColor="#0080c0"}if(w.fillColor==null||typeof w.fillColor=="undefined"){w.fillColor="#0080c0"}d=q.createElement("point",h,{visible:false,fixed:true,name:"",withLabel:false});b=q.createElement("point",g,{visible:false,fixed:true,name:"",withLabel:false});y=q.createElement("line",[d,b],{straightFirst:false,straightLast:false,strokewidth:1,name:"",withLabel:false,strokeColor:w.strokeColor});C=1;o=q.createElement("ticks",[y,b.Dist(d)/C],{insertTicks:true,drawLabels:false,drawZero:true});d.needsRegularUpdate=false;b.needsRegularUpdate=false;y.needsRegularUpdate=false;f=h[0]+(g[0]-h[0])*(k-A)/(B-A);e=h[1]+(g[1]-h[1])*(k-A)/(B-A);if(w.snapWidth!=null){u=w.snapWidth}if(w.snapwidth!=null){u=w.snapwidth}a=q.createElement("glider",[f,e,y],{style:6,strokeColor:w.strokeColor,fillColor:w.fillColor,showInfobox:false,name:"",snapWidth:u});x=q.createElement("line",[d,a],{straightFirst:false,straightLast:false,strokewidth:3,strokeColor:w.strokeColor,name:"",withLabel:false});a.Value=function(){return this.Dist(d)/b.Dist(d)*(B-A)+A};a._smax=B;a._smin=A;if(w.name&&w.name!=""){v=w.name+" = "}else{v=""}s=q.createElement("text",[((g[0]-h[0])*0.05+g[0]),((g[1]-h[1])*0.05+g[1]),function(){return v+(a.Value()).toFixed(2)}],{name:""});return a};JXG.JSXGraph.registerElement("slider",JXG.createSlider);JXG.Chart=function(h,q,e){this.constructor();if(q.length==0){return}this.elements=[];var d=e.id||"";var b=e.name||"";this.init(h,d,b);var s,o,f;if(q.length>0&&(typeof q[0]=="number")){o=q;s=[];for(f=0;f<o.length;f++){s[f]=f+1}}else{if(q.length==1){o=q[0];s=[];var g;if(typeof o=="function"){g=o().length}else{g=o.length}for(f=0;f<g;f++){s[f]=f+1}}if(q.length==2){s=q[0];o=q[1]}}if(e==undefined){e={}}var a=e.chartStyle||"line";a=a.replace(/ /g,"");a=a.split(",");var k;for(f=0;f<a.length;f++){switch(a[f]){case"bar":k=this.drawBar(h,[s,o],e);break;case"line":k=this.drawLine(h,[s,o],e);break;case"spline":k=this.drawSpline(h,[s,o],e);break;case"pie":k=this.drawPie(h,[o],e);break;case"point":k=this.drawPoints(h,[s,o],e);break}this.elements.push(k)}this.id=this.board.addChart(this);return this.elements};JXG.Chart.prototype=new JXG.GeometryElement;JXG.Chart.prototype.drawLine=function(d,b,a){var e=d.createElement("curve",b,a);this.rendNode=e.rendNode;return e};JXG.Chart.prototype.drawSpline=function(d,h,a){var k=h[0];var f=h[1];var s=JXG.Math.Numerics.splineDef(k,f);var o=new Array();var b=0;var q=(k[k.length-1]-k[0])/d.canvasWidth*1;while(k[0]+b*q<k[k.length-1]){o[b]=k[0]+b*q;b++}var g=JXG.Math.Numerics.splineEval(o,k,f,s);var e=d.createElement("curve",[o,g],a);this.rendNode=e.rendNode;return e};JXG.Chart.prototype.drawBar=function(k,q,g){var h;var f=[];if(g.fillOpacity==undefined){g.fillOpacity=0.6}var s=q[0];var o=q[1];var u;if(g&&g.width){u=g.width}else{if(s.length<=1){u=1}else{u=s[1]-s[0];for(h=1;h<s.length-1;h++){u=(s[h+1]-s[h]<u)?(s[h+1]-s[h]):u}}u*=0.8}for(h=0;h<s.length;h++){var d,z,v,b,a;if(typeof s[h]=="function"){d=function(){return s[h]()-u*0.5};z=function(){return s[h]()};v=function(){return s[h]()+u*0.5}}else{d=s[h]-u*0.5;z=s[h];v=s[h]+u*0.5}if(typeof o[h]=="function"){a=b}else{a=o[h]+0.2}b=o[h];var e=[];if(g.dir=="horizontal"){e[0]=k.createElement("point",[0,d],{name:"",fixed:true,visible:false});e[1]=k.createElement("point",[b,d],{name:"",fixed:true,visible:false});e[2]=k.createElement("point",[b,v],{name:"",fixed:true,visible:false});e[3]=k.createElement("point",[0,v],{name:"",fixed:true,visible:false});if(g.labels&&g.labels[h]){k.createElement("text",[b,v,g.labels[h]],g)}}else{e[0]=k.createElement("point",[d,0],{name:"",fixed:true,visible:false});e[1]=k.createElement("point",[d,b],{name:"",fixed:true,visible:false});e[2]=k.createElement("point",[v,b],{name:"",fixed:true,visible:false});e[3]=k.createElement("point",[v,0],{name:"",fixed:true,visible:false});if(g.labels&&g.labels[h]){k.createElement("text",[v,b,g.labels[h]],g)}}g.withLines=false;f[h]=k.createElement("polygon",e,g)}this.rendNode=f[0].rendNode;return f};JXG.Chart.prototype.drawPoints=function(g,d,b){var e;var f=[];b.fixed=true;b.name="";var a=d[0];var h=d[1];for(e=0;e<a.length;e++){f[e]=g.createElement("point",[a[e],h[e]],b)}this.rendNode=f[0].rendNode;return f};JXG.Chart.prototype.drawPie=function(e,C,g){var h=C[0];if(h.length<=0){return}if(typeof h[0]=="function"){return}var B;var x=[];var o=[];var f=[];var q=e.mathStatistics.sum(h);var d=g.colorArray||["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"];var F=g.highlightColorArray||["#FF7400"];var z=new Array(h.length);for(B=0;B<h.length;B++){z[B]=""}var u=g.labelArray||z;var b=g.radius||4;var E={};if(typeof g.highlightOnSector=="undefined"){g.highlightOnSector=false}E.name=g.name;E.id=g.id;E.strokeWidth=g.strokeWidth||1;E.strokeColor=g.strokeColor||"none";E.straightFirst=false;E.straightLast=false;E.fillColor=g.fillColor||"#FFFF88";E.fillOpacity=g.fillOpacity||0.6;E.highlightFillColor=g.highlightFillColor||"#FF7400";E.highlightStrokeColor=g.highlightStrokeColor||"#FFFFFF";E.gradient=g.gradient||"none";var w=g.center||[0,0];var A=w[0];var a=w[1];var D=e.createElement("point",[A,a],{name:"",fixed:true,visible:false});x[0]=e.createElement("point",[b+A,0+a],{name:"",fixed:true,visible:false});var G=0;for(B=0;B<h.length;B++){G+=(q!=0)?(2*Math.PI*h[B]/q):0;var k=b*Math.cos(G)+A;var v=b*Math.sin(G)+a;x[B+1]=e.createElement("point",[k,v],{name:"",fixed:true,visible:false,withLabel:false});o[B]=e.createElement("line",[D,x[B]],{strokeColor:E.strokeColor,straightFirst:false,straightLast:false,strokeWidth:E.strokeWidth,strokeOpacity:1,withLabel:false,highlightStrokeColor:E.highlightStrokeColor});E.fillColor=d[B%d.length];E.name=u[B];if(E.name!=""){E.withLabel=true}else{E.withLabel=false}E.labelColor=d[B%d.length];E.highlightfillColor=F[B%F.length];f[B]=e.createElement("arc",[D,x[B],x[B+1]],E);if(g.highlightOnSector){f[B].hasPoint=f[B].hasPointSector}f[B].highlight=function(){this.board.renderer.highlight(this);if(this.label.content!=null){this.label.content.rendNode.style.fontSize=(2*this.board.fontSize)+"px"}};f[B].noHighlight=function(){this.board.renderer.noHighlight(this);if(this.label.content!=null){this.label.content.rendNode.style.fontSize=(this.board.fontSize)+"px"}}}this.rendNode=f[0].rendNode;return f};JXG.Chart.prototype.updateRenderer=function(){};JXG.Chart.prototype.update=function(){if(this.needsUpdate){this.updateDataArray()}};JXG.Chart.prototype.updateDataArray=function(){};JXG.createChart=function(d,b,a){return new JXG.Chart(d,b,a)};JXG.JSXGraph.registerElement("chart",JXG.createChart);JXG.Transformation=function(b,a,d){this.elementClass=JXG.OBJECT_CLASS_OTHER;this.matrix=[[1,0,0],[0,1,0],[0,0,1]];this.board=b;this.isNumericMatrix=false;this.setMatrix(b,a,d)};JXG.Transformation.prototype={};JXG.Transformation.prototype.update=function(){};JXG.Transformation.prototype.setMatrix=function(d,b,e){var a;this.isNumericMatrix=true;for(a=0;a<e.length;a++){if(typeof e[a]!="number"){this.isNumericMatrix=false;break}}if(b=="translate"){this.evalParam=JXG.createEvalFunction(d,e,2);this.update=function(){this.matrix[1][0]=this.evalParam(0);this.matrix[2][0]=this.evalParam(1)}}else{if(b=="scale"){this.evalParam=JXG.createEvalFunction(d,e,2);this.update=function(){this.matrix[1][1]=this.evalParam(0);this.matrix[2][2]=this.evalParam(1)}}else{if(b=="reflect"){if(e.length<4){e[0]=JXG.getReference(d,e[0])}if(e.length==2){e[1]=JXG.getReference(d,e[1])}if(e.length==4){this.evalParam=JXG.createEvalFunction(d,e,4)}this.update=function(){var f,o,g,k,h;if(e.length==1){f=e[0].point2.X()-e[0].point1.X();o=e[0].point2.Y()-e[0].point1.Y();g=e[0].point1.X();k=e[0].point1.Y()}else{if(e.length==2){f=e[1].X()-e[0].X();o=e[1].Y()-e[0].Y();g=e[0].X();k=e[0].Y()}else{if(e.length==4){f=this.evalParam(2)-this.evalParam(0);o=this.evalParam(3)-this.evalParam(1);g=this.evalParam(0);k=this.evalParam(1)}}}h=f*f+o*o;this.matrix[1][1]=(f*f-o*o)/h;this.matrix[1][2]=2*f*o/h;this.matrix[2][1]=2*f*o/h;this.matrix[2][2]=(-f*f+o*o)/h;this.matrix[1][0]=g*(1-this.matrix[1][1])-k*this.matrix[1][2];this.matrix[2][0]=k*(1-this.matrix[2][2])-g*this.matrix[2][1]}}else{if(b=="rotate"){if(e.length==3){this.evalParam=JXG.createEvalFunction(d,e,3)}else{if(e.length<=2){this.evalParam=JXG.createEvalFunction(d,e,1);if(e.length==2){e[1]=JXG.getReference(d,e[1])}}}this.update=function(){var g=this.evalParam(0),f,h;this.matrix[1][1]=Math.cos(g);this.matrix[1][2]=-Math.sin(g);this.matrix[2][1]=Math.sin(g);this.matrix[2][2]=Math.cos(g);if(e.length>1){if(e.length==3){f=this.evalParam(1);h=this.evalParam(2)}else{f=e[1].X();h=e[1].Y()}this.matrix[1][0]=f*(1-Math.cos(g))+h*Math.sin(g);this.matrix[2][0]=h*(1-Math.cos(g))-f*Math.sin(g)}}}else{if(b=="shear"){this.evalParam=JXG.createEvalFunction(d,e,1);this.update=function(){var f=this.evalParam(0);this.matrix[1][1]=Math.tan(f)}}else{if(b=="generic"){this.evalParam=JXG.createEvalFunction(d,e,9);this.update=function(){this.matrix[0][0]=this.evalParam(0);this.matrix[0][1]=this.evalParam(1);this.matrix[0][2]=this.evalParam(2);this.matrix[1][0]=this.evalParam(3);this.matrix[1][1]=this.evalParam(4);this.matrix[1][2]=this.evalParam(5);this.matrix[2][0]=this.evalParam(6);this.matrix[2][1]=this.evalParam(7);this.matrix[2][2]=this.evalParam(8)}}}}}}}};JXG.Transformation.prototype.apply=function(a){this.update();if(arguments[1]!=null){return JXG.Math.matVecMult(this.matrix,a.initialCoords.usrCoords)}else{return JXG.Math.matVecMult(this.matrix,a.coords.usrCoords)}};JXG.Transformation.prototype.applyOnce=function(d){var e,a,b;if(!JXG.isArray(d)){this.update();e=JXG.Math.matVecMult(this.matrix,d.coords.usrCoords);d.coords.setCoordinates(JXG.COORDS_BY_USER,[e[1],e[2]])}else{a=d.length;for(b=0;b<a;b++){this.update();e=JXG.Math.matVecMult(this.matrix,d[b].coords.usrCoords);d[b].coords.setCoordinates(JXG.COORDS_BY_USER,[e[1],e[2]])}}};JXG.Transformation.prototype.bindTo=function(d){var b,a;if(JXG.isArray(d)){a=d.length;for(b=0;b<a;b++){d[b].transformations.push(this)}}else{d.transformations.push(this)}};JXG.Transformation.prototype.setProperty=function(a){};JXG.Transformation.prototype.melt=function(h){var g=[],f,a,e,b,o,d;a=h.matrix.length;e=this.matrix[0].length;for(f=0;f<a;f++){g[f]=[]}this.update();h.update();for(f=0;f<a;f++){for(d=0;d<e;d++){o=0;for(b=0;b<a;b++){o+=h.matrix[f][b]*this.matrix[b][d]}g[f][d]=o}}this.update=function(){var k=this.matrix.length,q=this.matrix[0].length;for(f=0;f<k;f++){for(d=0;d<q;d++){this.matrix[f][d]=g[f][d]}}};return true};JXG.createTransform=function(a,d,b){return new JXG.Transformation(a,b.type,d)};JXG.JSXGraph.registerElement("transform",JXG.createTransform);JXG.Turtle=function(f,e,b){var a,g,d;this.type=JXG.OBJECT_TYPE_TURTLE;this.turtleIsHidden=false;this.board=f;if(b==null){this.attributes={}}else{this.attributes=b}this.attributes.straightFirst=false;this.attributes.straightLast=false;this.attributes.withLabel=false;a=0;g=0;d=90;if(e.length!=0){if(e.length==3){a=e[0];g=e[1];d=e[2]}else{if(e.length==2){if(JXG.isArray(e[0])){a=e[0][0];g=e[0][1];d=e[1]}else{a=e[0];g=e[1]}}else{a=e[0][0];g=e[0][1]}}}this.init(a,g,d);return this};JXG.Turtle.prototype=new JXG.GeometryElement;JXG.Turtle.prototype.init=function(a,e,d){this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY);this.pos=[a,e];this.isPenDown=true;this.dir=90;this.stack=[];this.objects=[];this.attributes.curveType="plot";this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.turtle=this.board.createElement("point",this.pos,{fixed:true,name:" ",visible:false,withLabel:false});this.objects.push(this.turtle);this.turtle2=this.board.createElement("point",[this.pos[0],this.pos[1]+this.arrowLen],{fixed:true,name:" ",visible:false,withLabel:false});this.objects.push(this.turtle2);var b=this.attributes.strokeWidth||this.attributes.strokewidth||2;this.arrow=this.board.createElement("line",[this.turtle,this.turtle2],{lastArrow:true,strokeColor:"#ff0000",straightFirst:false,straightLast:false,strokeWidth:b,withLabel:false});this.objects.push(this.arrow);this.right(90-d);this.board.update()};JXG.Turtle.prototype.forward=function(a){if(a==0){return}var d=a*Math.cos(this.dir*Math.PI/180);var b=a*Math.sin(this.dir*Math.PI/180);if(!this.turtleIsHidden){var e=this.board.createElement("transform",[d,b],{type:"translate"});e.applyOnce(this.turtle);e.applyOnce(this.turtle2)}if(this.isPenDown){if(this.curve.dataX.length>=8192){this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve)}}this.pos[0]+=d;this.pos[1]+=b;if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update();return this};JXG.Turtle.prototype.back=function(a){return this.forward(-a)};JXG.Turtle.prototype.right=function(b){this.dir-=b;this.dir%=360;if(!this.turtleIsHidden){var a=this.board.createElement("transform",[-b*Math.PI/180,this.turtle],{type:"rotate"});a.applyOnce(this.turtle2)}this.board.update();return this};JXG.Turtle.prototype.left=function(a){return this.right(-a)};JXG.Turtle.prototype.penUp=function(){this.isPenDown=false;return this};JXG.Turtle.prototype.penDown=function(){this.isPenDown=true;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.clean=function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];if(b.type==JXG.OBJECT_TYPE_CURVE){this.board.removeObject(b.id);this.objects.splice(a,1)}}this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.board.update();return this};JXG.Turtle.prototype.clearScreen=function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];this.board.removeObject(b.id)}this.init(0,0,90);return this};JXG.Turtle.prototype.setPos=function(a,d){if(JXG.isArray(a)){this.pos=a}else{this.pos=[a,d]}if(!this.turtleIsHidden){this.turtle.setPositionDirectly(JXG.COORDS_BY_USER,a,d);this.turtle2.setPositionDirectly(JXG.COORDS_BY_USER,a,d+this.arrowLen);var b=this.board.createElement("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"});b.applyOnce(this.turtle2)}this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.board.update();return this};JXG.Turtle.prototype.setPenSize=function(a){this.attributes.strokeWidth=a;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.setPenColor=function(a){this.attributes.strokeColor=a;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.setProperty=function(){var f;var a;var d,e;var b;for(d=0;d<arguments.length;d++){a=arguments[d];if(typeof a=="string"){f=a.split(":")}else{if(!JXG.isArray(a)){for(var b in a){this.setProperty([b,a[b]])}return this}else{f=a}}this.attributes[f[0]]=f[1]}for(d=0;d<this.objects.length;d++){e=this.objects[d];if(e.type==JXG.OBJECT_TYPE_CURVE){e.setProperty(this.attributes)}}return this};JXG.Turtle.prototype.showTurtle=function(){this.turtleIsHidden=false;this.arrow.setProperty("visible:true");this.setPos(this.pos[0],this.pos[1]);this.board.update();return this};JXG.Turtle.prototype.hideTurtle=function(){this.turtleIsHidden=true;this.arrow.setProperty("visible:false");this.setPos(this.pos[0],this.pos[1]);this.board.update();return this};JXG.Turtle.prototype.home=function(){this.pos=[0,0];this.setPos(this.pos[0],this.pos[1]);return this};JXG.Turtle.prototype.pushTurtle=function(){this.stack.push([this.pos[0],this.pos[1],this.dir]);return this};JXG.Turtle.prototype.popTurtle=function(){var a=this.stack.pop();this.pos[0]=a[0];this.pos[1]=a[1];this.dir=a[2];this.setPos(this.pos[0],this.pos[1]);return this};JXG.Turtle.prototype.lookTo=function(f){if(JXG.isArray(f)){var b=this.pos[0];var a=this.pos[1];var h=f[0];var e=f[1];var d;var g=(h-b>0)?1:-1;if(Math.abs(h-b)>1e-7){d=Math.atan((e-a)/(h-b))+((g<0)?Math.PI:0)}else{d=((e-a>0)?0.5:-0.5)*Math.PI}this.right(this.dir-(d*180/Math.PI))}else{if(JXG.isNumber(f)){this.right(this.dir-(f))}}return this};JXG.Turtle.prototype.moveTo=function(e){if(JXG.isArray(e)){var b=e[0]-this.pos[0];var a=e[1]-this.pos[1];if(!this.turtleIsHidden){var d=this.board.createElement("transform",[b,a],{type:"translate"});d.applyOnce(this.turtle);d.applyOnce(this.turtle2)}if(this.isPenDown){if(this.curve.dataX.length>=8192){this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve)}}this.pos[0]=e[0];this.pos[1]=e[1];if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update()}return this};JXG.Turtle.prototype.fd=function(a){return this.forward(a)};JXG.Turtle.prototype.bk=function(a){return this.back(a)};JXG.Turtle.prototype.lt=function(a){return this.left(a)};JXG.Turtle.prototype.rt=function(a){return this.right(a)};JXG.Turtle.prototype.pu=function(){return this.penUp()};JXG.Turtle.prototype.pd=function(){return this.penDown()};JXG.Turtle.prototype.ht=function(){return this.hideTurtle()};JXG.Turtle.prototype.st=function(){return this.showTurtle()};JXG.Turtle.prototype.cs=function(){return this.clearScreen()};JXG.Turtle.prototype.push=function(){return this.pushTurtle()};JXG.Turtle.prototype.pop=function(){return this.popTurtle()};JXG.Turtle.prototype.X=function(a){return this.pos[0]};JXG.Turtle.prototype.Y=function(a){return this.pos[1]};JXG.Turtle.prototype.hasPoint=function(a,e){var b,d;for(b=0;b<this.objects.length;b++){d=this.objects[b];if(d.type==JXG.OBJECT_TYPE_CURVE){if(d.hasPoint(a,e)){return true}}}return false};JXG.createTurtle=function(d,b,a){if(b==null){var b=[]}return new JXG.Turtle(d,b,a)};JXG.JSXGraph.registerElement("turtle",JXG.createTurtle);JXG.RGBColor=function(h){this.ok=false;if(h.charAt(0)=="#"){h=h.substr(1,6)}h=h.replace(/ /g,"");h=h.toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var d in a){if(h==d){h=a[d]}}var k=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}];for(var b=0;b<k.length;b++){var f=k[b].re;var e=k[b].process;var g=f.exec(h);if(g){channels=e(g);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b)};JXG.RGBColor.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};JXG.RGBColor.prototype.toHex=function(){var e=this.r.toString(16);var d=this.g.toString(16);var a=this.b.toString(16);if(e.length==1){e="0"+e}if(d.length==1){d="0"+d}if(a.length==1){a="0"+a}return"#"+e+d+a};JXG.hsv2rgb=function(u,h,g){var k,v,d,s,o,e,b,a,w;u=((u%360)+360)%360;if(h==0){if(isNaN(u)){k=g;v=g;d=g}else{return"#000000"}}else{if(u>=360){e=0}else{e=u}e=e/60;o=Math.floor(e);s=e-o;b=g*(1-h);a=g*(1-(h*s));w=g*(1-(h*(1-s)));switch(o){case 0:k=g;v=w;d=b;break;case 1:k=a;v=g;d=b;break;case 2:k=b;v=g;d=w;break;case 3:k=b;v=a;d=g;break;case 4:k=w;v=b;d=g;break;case 5:k=g;v=b;d=a;break}}k=Math.round(k*255).toString(16);k=(k.length==0)?"00":((k.length==1)?"0"+k:k);v=Math.round(v*255).toString(16);v=(v.length==0)?"00":((v.length==1)?"0"+v:v);d=Math.round(d*255).toString(16);d=(d.length==0)?"00":((d.length==1)?"0"+d:d);return"#"+k+v+d};JXG.Board=function(a,g,b,s,q,o,k,h,d,e,f){this.BOARD_MODE_NONE=0;this.BOARD_MODE_DRAG=1;this.BOARD_MODE_CONSTRUCT=16;this.BOARD_MODE_MOVE_ORIGIN=2;this.BOARD_QUALITY_LOW=1;this.BOARD_QUALITY_HIGH=2;this.CONSTRUCTION_TYPE_POINT=1129599060;this.CONSTRUCTION_TYPE_CIRCLE=1129595724;this.CONSTRUCTION_TYPE_LINE=1129598030;this.CONSTRUCTION_TYPE_GLIDER=1129596740;this.CONSTRUCTION_TYPE_MIDPOINT=1129598288;this.CONSTRUCTION_TYPE_PERPENDICULAR=1129599044;this.CONSTRUCTION_TYPE_PARALLEL=1129599052;this.CONSTRUCTION_TYPE_INTERSECTION=1129597267;this.container=a;this.containerObj=document.getElementById(this.container);if(this.containerObj==null){throw ("\nJSXGraph error: HTML container element '"+(box)+"' not found.")}this.renderer=g;this.options=new JXG.Options();this.dimension=2;this.origin={};this.origin.usrCoords=[1,0,0];this.origin.scrCoords=[1,s[0],s[1]];this.zoomX=q;this.zoomY=o;this.unitX=k;this.unitY=h;this.canvasWidth=d;this.canvasHeight=e;this.fontSize=this.options.fontSize;this.algebra=new JXG.Algebra(this);this.mathStatistics=new JXG.MathStatistics();if((b!="")&&(b!=null)&&(typeof document.getElementById(b)!="undefined")){this.id=b}else{this.id=this.generateId()}this.hooks=[];this.dependentBoards=[];this.objects={};this.highlightedObjects={};this.numObjects=0;this.elementsByName={};this.mode=this.BOARD_MODE_NONE;this.updateQuality=this.BOARD_QUALITY_HIGH;this.isSuspendedRedraw=false;this.snapToGrid=this.options.grid.snapToGrid;this.gridX=this.options.grid.gridX;this.gridY=this.options.grid.gridY;this.gridColor=this.options.grid.gridColor;this.gridOpacity=this.options.grid.gridOpacity;this.gridDash=this.options.grid.gridDash;this.snapSizeX=this.options.grid.snapSizeX;this.snapSizeY=this.options.grid.snapSizeY;this.calculateSnapSizes();this.hasGrid=this.options.grid.hasGrid;this.drag_dx=0;this.drag_dy=0;this.drag_obj=null;this.xmlString="";if((f!=null&&f)||(f==null&&this.options.showCopyright)){this.renderer.displayCopyright(JXG.JSXGraph.licenseText,this.options.fontSize)}this.needsFullUpdate=false;this.reducedUpdate=false;this.geonextCompatibilityMode=false;JXG.addEvent(document,"mousedown",this.mouseDownListener,this);JXG.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this)};JXG.Board.prototype.generateName=function(d){if(d.type==JXG.OBJECT_TYPE_TICKS){return}var k;if(d.elementClass==JXG.OBJECT_CLASS_POINT){k=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}else{k=["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]}var f=3;var b="";var q="";var o="";if(d.elementClass==JXG.OBJECT_CLASS_POINT||d.elementClass==JXG.OBJECT_CLASS_LINE){}else{if(d.type==JXG.OBJECT_TYPE_POLYGON){b="P_{";o="}"}else{if(d.type==JXG.OBJECT_TYPE_CIRCLE){b="k_{";o="}"}else{if(d.type==JXG.OBJECT_TYPE_ANGLE){b="W_{";o="}"}else{b="s_{";o="}"}}}}var s=[];var a="";var h="";var g=0;var e=0;for(g=0;g<f;g++){s[g]=0}while(s[f-1]<k.length){for(s[0]=1;s[0]<k.length;s[0]++){a=b;for(g=f;g>0;g--){a+=k[s[g-1]]}if(this.elementsByName[a+o]==null){return a+o}}s[0]=k.length;for(g=1;g<f;g++){if(s[g-1]==k.length){s[g-1]=1;s[g]++}}}return""};JXG.Board.prototype.generateId=function(){var a=1;while(JXG.JSXGraph.boards["gxtBoard"+a]!=null){a=Math.round(Math.random()*33)}return("gxtBoard"+a)};JXG.Board.prototype.getRelativeMouseCoordinates=function(b){var d=this.containerObj;var a=JXG.getOffset(d);a[0]+=parseInt(JXG.getStyle(d,"borderLeftWidth"));a[1]+=parseInt(JXG.getStyle(d,"borderTopWidth"));a[0]+=parseInt(JXG.getStyle(d,"paddingLeft"));a[1]+=parseInt(JXG.getStyle(d,"paddingTop"));return a};JXG.Board.prototype.clickLeftArrow=function(a){this.origin.scrCoords[1]+=this.canvasWidth*0.1;this.moveOrigin()};JXG.Board.prototype.clickRightArrow=function(a){this.origin.scrCoords[1]-=this.canvasWidth*0.1;this.moveOrigin()};JXG.Board.prototype.clickUpArrow=function(a){this.origin.scrCoords[2]+=this.canvasHeight*0.1;this.moveOrigin()};JXG.Board.prototype.clickDownArrow=function(a){this.origin.scrCoords[2]-=this.canvasHeight*0.1;this.moveOrigin()};JXG.Board.prototype.mouseUpListener=function(a){this.updateQuality=this.BOARD_QUALITY_HIGH;JXG.removeEvent(document,"mouseup",this.mouseUpListener,this);if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.moveOrigin()}else{var b=this.reducedUpdate;this.reducedUpdate=false;this.fullUpdate();this.reducedUpdate=b}this.mode=this.BOARD_MODE_NONE;this.drag_obj=null};JXG.Board.prototype.mouseDownListener=function(g){var e;var f=this.getRelativeMouseCoordinates(g);var a=JXG.getPosition(g);var d=a[0]-f[0];var b=a[1]-f[1];if(g.shiftKey){this.drag_dx=d-this.origin.scrCoords[1];this.drag_dy=b-this.origin.scrCoords[2];this.mode=this.BOARD_MODE_MOVE_ORIGIN;JXG.addEvent(document,"mouseup",this.mouseUpListener,this);return}if(this.mode==this.BOARD_MODE_CONSTRUCT){return}this.mode=this.BOARD_MODE_DRAG;if(this.mode==this.BOARD_MODE_DRAG){for(e in this.objects){if((this.objects[e].hasPoint!=undefined)&&(this.objects[e].hasPoint(d,b))&&((this.objects[e].type==JXG.OBJECT_TYPE_POINT)||(this.objects[e].type==JXG.OBJECT_TYPE_GLIDER))&&(this.objects[e].visProp.visible)&&(!this.objects[e].fixed)){this.drag_obj=this.objects[e];if((this.objects[e].type==JXG.OBJECT_TYPE_POINT)||(this.objects[e].type==JXG.OBJECT_TYPE_GLIDER)){break}}}}if(this.drag_obj==null){this.mode=this.BOARD_MODE_NONE;return}this.dragObjCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[d,b],this);JXG.addEvent(document,"mouseup",this.mouseUpListener,this)};JXG.Board.prototype.mouseMoveListener=function(d){var f;var h=this.getRelativeMouseCoordinates(d);var b=JXG.getPosition(d);var a=b[0]-h[0];var k=b[1]-h[1];this.updateQuality=this.BOARD_QUALITY_LOW;this.dehighlightAll();if(this.mode!=this.BOARD_MODE_DRAG){this.renderer.hide(this.infobox)}if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.origin.scrCoords[1]=a-this.drag_dx;this.origin.scrCoords[2]=k-this.drag_dy;this.moveOrigin()}else{if(this.mode==this.BOARD_MODE_DRAG){var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(a,k),this);if(this.drag_obj.type==JXG.OBJECT_TYPE_POINT||this.drag_obj.type==JXG.OBJECT_TYPE_LINE||this.drag_obj.type==JXG.OBJECT_TYPE_CIRCLE||this.drag_obj.type==JXG.OBJECT_TYPE_CURVE){if((this.geonextCompatibilityMode&&this.drag_obj.type==JXG.OBJECT_TYPE_POINT)||this.drag_obj.group.length!=0){this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,e.usrCoords[1],e.usrCoords[2])}else{this.drag_obj.setPositionByTransform(JXG.COORDS_BY_USER,e.usrCoords[1]-this.dragObjCoords.usrCoords[1],e.usrCoords[2]-this.dragObjCoords.usrCoords[2]);this.dragObjCoords=e}this.update()}else{if(this.drag_obj.type==JXG.OBJECT_TYPE_GLIDER){var g=this.drag_obj.coords;this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,e.usrCoords[1],e.usrCoords[2]);if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){this.drag_obj.coords=this.algebra.projectPointToCircle(this.drag_obj,this.drag_obj.slideObject)}else{if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_LINE){this.drag_obj.coords=this.algebra.projectPointToLine(this.drag_obj,this.drag_obj.slideObject)}}if(this.drag_obj.group.length!=0){this.drag_obj.group[this.drag_obj.group.length-1].dX=this.drag_obj.coords.scrCoords[1]-g.scrCoords[1];this.drag_obj.group[this.drag_obj.group.length-1].dY=this.drag_obj.coords.scrCoords[2]-g.scrCoords[2];this.drag_obj.group[this.drag_obj.group.length-1].update(this)}else{this.update(this.drag_obj)}}}this.updateInfobox(this.drag_obj)}else{for(f in this.objects){if((this.objects[f].hasPoint!=undefined)&&(this.objects[f].hasPoint(a,k))&&(this.objects[f].visProp.visible==true)){this.objects[f].highlight();this.highlightedObjects[f]=this.objects[f];this.updateInfobox(this.objects[f])}}}}};JXG.Board.prototype.updateInfobox=function(b){var a,d;if((b.elementClass==JXG.OBJECT_CLASS_POINT)&&b.showInfobox){this.infobox.setCoords(b.coords.usrCoords[1]*1+this.infobox.distanceX/(this.unitX*this.zoomX),b.coords.usrCoords[2]*1+this.infobox.distanceY/(this.unitY*this.zoomY));a=Math.abs(b.coords.usrCoords[1]);if(a>0.1){a=b.coords.usrCoords[1].toFixed(2)}else{if(a>=0.01){a=b.coords.usrCoords[1].toFixed(4)}else{if(a>=0.0001){a=b.coords.usrCoords[1].toFixed(6)}else{a=b.coords.usrCoords[1]}}}d=Math.abs(b.coords.usrCoords[2]);if(d>0.1){d=b.coords.usrCoords[2].toFixed(2)}else{if(d>=0.01){d=b.coords.usrCoords[2].toFixed(4)}else{if(d>=0.0001){d=b.coords.usrCoords[2].toFixed(6)}else{d=b.coords.usrCoords[2]}}}this.infobox.setText('<span style="color:#bbbbbb;">('+a+", "+d+")</span>");this.renderer.show(this.infobox);this.renderer.updateText(this.infobox)}};JXG.Board.prototype.dehighlightAll=function(){for(var a in this.highlightedObjects){this.highlightedObjects[a].noHighlight()}this.highlightedObjects={}};JXG.Board.prototype.getScrCoordsOfMouse=function(a,d){if(this.snapToGrid){var b=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,d],this);b.setCoordinates(JXG.COORDS_BY_USER,[Math.round((b.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((b.usrCoords[2])*this.snapSizeY)/this.snapSizeY]);return[b.scrCoords[1],b.scrCoords[2]]}else{return[a,d]}};JXG.Board.prototype.getUsrCoordsOfMouse=function(f){var d=this.getRelativeMouseCoordinates(f);var b=JXG.getPosition(f);var a=b[0]-d[0];var g=b[1]-d[1];var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,g],this);if(this.snapToGrid){e.setCoordinates(JXG.COORDS_BY_USER,[Math.round((e.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((e.usrCoords[2])*this.snapSizeY)/this.snapSizeY])}return[e.usrCoords[1],e.usrCoords[2]]};JXG.Board.prototype.getAllUnderMouse=function(b){var a=this.getAllObjectsUnderMouse(b);a.push(this.getUsrCoordsOfMouse(b));return a};JXG.Board.prototype.getAllObjectsUnderMouse=function(h){var g=this.getRelativeMouseCoordinates(h);var a=JXG.getPosition(h);var d=a[0]-g[0];var b=a[1]-g[1];var e=[];for(var f in this.objects){if(this.objects[f].visProp.visible&&this.objects[f].hasPoint(d,b)){e.push(this.objects[f])}}return e};JXG.Board.prototype.setBoardMode=function(a){this.mode=a};JXG.Board.prototype.moveOrigin=function(){for(var a in this.objects){if((this.objects[a].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[a].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[a].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[a].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[a].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[a].type!=JXG.OBJECT_TYPE_AXIS)){this.objects[a].coords.usr2screen()}}}this.clearTraces();this.fullUpdate();if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this)}};JXG.Board.prototype.addPoint=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"P"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;this.elementsByName[d.name]=d;d.id=a;if(d.hasLabel){this.addText(d.label.content)}this.renderer.drawPoint(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addLine=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"L"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;d.id=a;this.renderer.drawLine(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addCircle=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"C"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;d.id=a;if(d.hasLabel){this.addText(d.label.content)}this.renderer.drawCircle(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addPolygon=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Py"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;d.id=a;if(d.hasLabel){this.addText(d.label.content)}this.renderer.drawPolygon(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addArc=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Ac"+b}d.id=a;if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;if(d.hasLabel){this.addText(d.label.content)}this.renderer.drawArc(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addSector=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Sc"+b}this.objects[a]=d;d.id=a;return a};JXG.Board.prototype.addAngle=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Ag"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;if(d.hasLabel){this.addText(d.label.content)}this.renderer.drawAngle(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addCurve=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"G"+b}if(d.hasLabel){d.label.content.id=a+"Label"}this.objects[a]=d;if(d.hasLabel){this.addText(d.label.content)}d.id=a;this.renderer.drawCurve(d);if(d.hasLabel){this.renderer.drawText(d.label.content)}if(!d.visProp.visible){this.renderer.hide(d)}if(d.hasLabel&&!d.label.content.visProp.visible){this.renderer.hide(d.label.content)}return a};JXG.Board.prototype.addChart=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Chart"+b}this.objects[a]=d;d.id=a;return a};JXG.Board.prototype.addMidpoint=function(h,g,k,b){var e=JXG.getReference(this,h);var d=JXG.getReference(this,g);var a=this.algebra.midpoint(e,d).usrCoords.slice(1);var f=new JXG.Point(this,a,k,b,true);f.fixed=true;e.addChild(f);d.addChild(f);f.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.midpoint(e,d);this.label.content.update();if(this.traced){this.cloneToBackground(true)}}};return f};JXG.Board.prototype.addReflection=function(e,d,k,g){var f=JXG.getReference(this,d);var b=JXG.getReference(this,e);var a=this.algebra.reflection(b,f).usrCoords.slice(1);var h=new JXG.Point(this,a,k,g,true);h.fixed=true;f.addChild(h);b.addChild(h);h.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.reflection(b,f);this.label.content.update();if(this.traced){this.cloneToBackground(true)}}};return h};JXG.Board.prototype.addRotation=function(a,o,k,e,b){var f=JXG.getReference(this,o);var h=JXG.getReference(this,a);var g=this.algebra.rotation(h,f,k).usrCoords.slice(1);var d=new JXG.Point(this,g,e,b,true);d.fixed=true;f.addChild(d);h.addChild(d);d.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.rotation(h,f,k);this.label.content.update();this.needsUpdate=false;if(this.traced){this.cloneToBackground(true)}}};return d};JXG.Board.prototype.addParallel=function(e,d,b,a){var o=JXG.getReference(this,d);var q=JXG.getReference(this,e);var f=this.numObjects;f++;if((b=="")||(b==null)){b=this.id+"L"+f}var h=this.algebra.parallel(q.point1,q.point2,o).usrCoords.slice(1);var k=new JXG.Point(this,h,b+"P2",a+"P2",false);k.fixed=true;o.addChild(k);var g=new JXG.Line(this,o.id,k.id,b,a);g.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.parallel(q.point1,q.point2,o);this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return g};JXG.Board.prototype.addArrowParallel=function(q,b,u,f,g,h){var v=JXG.getReference(this,b);var s=JXG.getReference(this,q);var d=this.numObjects;d++;if((u=="")||(u==null)){u=this.id+"A"+d}d++;if((f=="")||(f==null)){f=this.id+"P"+d}var k=this.algebra.parallel(s.point1,s.point2,v).usrCoords.slice(1);var o=new JXG.Point(this,k,f,h,true);o.fixed=true;v.addChild(o);s.addChild(o);var e=new JXG.Line(this,v.id,o.id,u,g);e.setStraight(false,false);e.setArrow(false,true);e.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.parallel(s.point1,s.point2,v);this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};o.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.parallel(s.point1,s.point2,v);if(this.label.content.visProp.visible){this.label.content.update()}if(this.traced){this.cloneToBackground(true)}}};return[e,o]};JXG.Board.prototype.addParallelPoint=function(h,g,f,k,a){var e=this.numObjects;e++;if((k=="")||(k==null)){k=this.id+"P"+e}h=JXG.getReference(this,h);g=JXG.getReference(this,g);f=JXG.getReference(this,f);var d=this.algebra.parallel(h,g,f).usrCoords.slice(1);var b=new JXG.Point(this,d,k,a,true);b.fixed=true;h.addChild(b);f.addChild(b);if(h.type==JXG.OBJECT_TYPE_POINT){g.addChild(b)}b.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.parallel(h,g,f);this.label.content.update();if(this.traced){this.cloneToBackground(true)}}};return b};JXG.Board.prototype.addArrow=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"A"+b}this.objects[a]=d;d.id=a;this.renderer.drawArrow(d);return a};JXG.Board.prototype.addNormal=function(f,d,b,a){var q=JXG.getReference(this,d);var s=JXG.getReference(this,f);var g=this.numObjects;g++;if((b=="")||(b==null)){b=this.id+"L"+g}var o=this.algebra.perpendicular(s,q);var h=o[0].usrCoords.slice(1);var k=new JXG.Point(this,h,b+"P2","",false);k.fixed=true;q.addChild(k);s.addChild(k);var e;if(o[1]){e=new JXG.Line(this,k.id,q.id,b,a)}else{e=new JXG.Line(this,q.id,k.id,b,a)}e.changed=o[1];e.update=function(){if(this.needsUpdate){var v=this.board.algebra.perpendicular(s,q);k.coords=v[0];if(this.changed!=v[1]){var u=this.point1;this.point1=this.point2;this.point2=u}this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return e};JXG.Board.prototype.addPerpendicular=function(e,a,q,g,h,b){var u=JXG.getReference(this,a);var v=JXG.getReference(this,e);var f=this.numObjects;f++;if((q=="")||(q==null)){q=this.id+"L"+f}f++;if((h=="")||(h==null)){h=this.id+"P"+f}var s=this.algebra.perpendicular(v,u);var k=s[0].usrCoords.slice(1);var o=new JXG.Point(this,k,h,b,true);o.fixed=true;u.addChild(o);v.addChild(o);var d;if(s[1]){d=new JXG.Line(this,o.id,u.id,q,g)}else{d=new JXG.Line(this,u.id,o.id,q,g)}d.setStraight(false,false);d.changed=s[1];d.update=function(){if(this.needsUpdate){var x=this.board.algebra.perpendicular(v,u);o.coords=x[0];if(this.changed!=x[1]){var w=this.point1;this.point1=this.point2;this.point2=w}this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return[d,o]};JXG.Board.prototype.addPerpendicularPoint=function(d,a,f,b){var k=JXG.getReference(this,a);var o=JXG.getReference(this,d);var e=this.numObjects;e++;if((f=="")||(f==null)){f=this.id+"P"+e}var g=this.algebra.perpendicular(o,k)[0].usrCoords.slice(1);var h=new JXG.Point(this,g,f,b,true);h.fixed=true;k.addChild(h);o.addChild(h);h.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.perpendicular(o,k)[0];this.label.content.update();if(this.traced){this.cloneToBackground(true)}}};return h};JXG.Board.prototype.addCircumcenter=function(k,f,e,g,h,d,a){var s=JXG.getReference(this,k);var q=JXG.getReference(this,f);var o=JXG.getReference(this,e);var b=this.algebra.circumcenterMidpoint(s,q,o);var v=new JXG.Point(this,b.usrCoords.slice(1),g,h,true);v.fixed=true;s.addChild(v);q.addChild(v);o.addChild(v);var u=new JXG.Circle(this,"pointRadius",v.id,function(){return this.midpoint.coords.distance(JXG.COORDS_BY_USER,s.coords)},d,a);s.addChild(u);q.addChild(u);o.addChild(u);v.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.circumcenterMidpoint(s,q,o);if(this.label.content.visProp.visible){this.label.content.update()}if(this.traced){this.cloneToBackground(true)}}};u.update=function(){if(this.needsUpdate){this.updateRadius();this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return[v,u]};JXG.Board.prototype.addCircumcenterMidpoint=function(g,d,b,e,f){var o=JXG.getReference(this,g);var k=JXG.getReference(this,d);var h=JXG.getReference(this,b);var a=this.algebra.circumcenterMidpoint(o,k,h).usrCoords.slice(1);var q=new JXG.Point(this,a,e,f,true);q.fixed=true;o.addChild(q);k.addChild(q);h.addChild(q);q.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.circumcenterMidpoint(o,k,h);if(this.label.content.visProp.visible){this.label.content.update()}if(this.traced){this.cloneToBackground(true)}}};return q};JXG.Board.prototype.addIntersection=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"I"+b}this.objects[a]=d;d.id=a;d.intersect1.addChild(d);d.intersect2.addChild(d);return a};JXG.Board.prototype.addAngleBisector=function(u,s,q,b,a){var k=JXG.getReference(this,u);var g=JXG.getReference(this,s);var e=JXG.getReference(this,q);var d=this.numObjects;d++;if((b=="")||(b==null)){b=this.id+"L"+d}var h=this.algebra.angleBisector(k,g,e).usrCoords.slice(1);var o=new JXG.Point(this,h,b+"P2","",false);o.fixed=true;k.addChild(o);g.addChild(o);e.addChild(o);var f=new JXG.Line(this,s,o.id,b,a);f.setStraight(false,true);f.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.angleBisector(k,g,e);this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return f};JXG.Board.prototype.addText=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"T"+b}this.objects[a]=d;d.id=a;if(!d.isLabel){this.renderer.drawText(d);if(!d.visProp.visible){this.renderer.hide(d)}}return a};JXG.Board.prototype.addConditions=function(q){var o=null;var b="var el,x,y,c;\n";var k=q.indexOf("<data>");var h=q.indexOf("</data>");if(k<0){return}while(k>=0){var g=q.slice(k+6,h);var f=g.indexOf("=");var e=g.slice(0,f);var u=g.slice(f+1);f=e.indexOf(".");var a=e.slice(0,f);var d=this.elementsByName[JXG.unescapeHTML(a)];var s=e.slice(f+1).replace(/\s+/g,"").toLowerCase();u=this.algebra.geonext2JS(u);u=u.replace(/this\.board\./g,"this.");if(typeof this.elementsByName[a]=="undefined"){alert("debug conditions: |"+a+"| undefined")}b+='el = this.objects["'+d.id+'"];\n';switch(s){case"x":b+="y=el.coords.usrCoords[2];\n";b+="el.setPositionDirectly(JXG.COORDS_BY_USER,"+(u)+",y);\n";b+="el.update();\n";break;case"y":b+="x=el.coords.usrCoords[1];\n";b+="el.coords=new JXG.Coords(JXG.COORDS_BY_USER,[x,"+(u)+"],this);\n";break;case"visible":b+="c="+(u)+";\n";b+="if (c) {el.showElement();} else {el.hideElement();}\n";break;case"position":b+="el.position = "+(u)+";\n";b+="el.update();\n";break;case"stroke":b+="el.strokeColor = "+(u)+";\n";break;case"strokewidth":b+="el.strokeWidth = "+(u)+";\n";break;case"label":break;default:alert("property '"+s+"' in conditions not implemented:"+u);break}q=q.slice(h+7);k=q.indexOf("<data>");h=q.indexOf("</data>")}b+="this.prepareUpdate();\n";b+="this.updateElements();\n";b+="return true;\n";this.updateConditions=new Function(b);this.updateConditions()};JXG.Board.prototype.updateConditions=function(){return false};JXG.Board.prototype.addImage=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Im"+b}this.objects[a]=d;this.elementsByName[d.name]=d;d.id=a;this.renderer.drawImage(d);if(!d.visProp.visible){this.renderer.hide(d)}return a};JXG.Board.prototype.addIntegral=function(f,h,a,v,u){if(!JXG.isArray(a)||(a.length!=5)){a=["","","","",""]}if(!JXG.isArray(v)||(v.length!=5)){v=["","","","",""]}var y=[];var b={};if((typeof u!="undefined")&&(u!=null)){b=u}b.name=v[0];b.id=a[0];b.slideObject=h;var e=0;if(f[0]>h.points[0].usrCoords[1]){e=f[0]}else{e=h.points[0].usrCoords[1]}var w=this.createElement("point",[e,h.yterm(e)],b);b.name=v[1];b.id=a[1];b.visible=false;b.slideObject=null;var x=this.createElement("point",[function(){return w.X()},0],b);y.push(x);y.push(w);w.addChild(x);var o;for(var q=0;q<h.numberPoints;q++){if((f[0]<=h.points[q].usrCoords[1])&&(h.points[q].usrCoords[1]<=f[1])){o={type:JXG.OBJECT_TYPE_POINT,elementClass:JXG.OBJECT_CLASS_POINT,addChild:function(A){},X:function(){},Y:function(){},coords:h.points[q]};y.push(o)}}b.name=v[2];b.id=a[2];b.slideObject=h;b.visible=true;var g=this.createElement("point",[y[y.length-1].coords.usrCoords[1],h.yterm(y[y.length-1].coords.usrCoords[1])],b);b.name=v[3];b.id=a[3];b.slideObject=null;b.visible=false;var k=this.createElement("point",[function(){return g.X()},0],b);y.push(g);y.push(k);g.addChild(k);var s=JXG.Math.Numerics.I([y[0].coords.usrCoords[1],y[y.length-1].coords.usrCoords[1]],h.yterm);var z=this.createElement("text",[function(){return g.X()+0.2},function(){return g.Y()-1},function(){var A=JXG.Math.Numerics.I([y[0].coords.usrCoords[1],y[y.length-1].coords.usrCoords[1]],h.yterm);return"&int; = "+(A).toFixed(4)}]);var b={};if((typeof u!="undefined")&&(u!=null)){b=u}b.withLines=false;b.name=v[4];b.id=a[4];b.visible=true;var d=this.createElement("polygon",y,b);d.update=function(){var B;var C=[x,w];for(var A=0;A<h.numberPoints;A++){if((x.X()<=h.points[A].usrCoords[1])&&(h.points[A].usrCoords[1]<=k.X())){B={type:JXG.OBJECT_TYPE_POINT,elementClass:JXG.OBJECT_CLASS_POINT,addChild:function(D){},X:function(){},Y:function(){},coords:h.points[A]};C.push(B)}}C.push(g);C.push(k);C.push(x);this.vertices=C};w.addChild(d);g.addChild(d);w.addChild(z);g.addChild(z);return d};JXG.Board.prototype.calculateSnapSizes=function(){var d=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this);var b=new JXG.Coords(JXG.COORDS_BY_USER,[1/this.gridX,1/this.gridY],this);var a=d.scrCoords[1]-b.scrCoords[1];var e=d.scrCoords[2]-b.scrCoords[2];this.snapSizeX=this.gridX;while(Math.abs(a)>25){this.snapSizeX*=2;a/=2}this.snapSizeY=this.gridY;while(Math.abs(e)>25){this.snapSizeY*=2;e/=2}};JXG.Board.prototype.applyZoom=function(){this.updateQuality=this.BOARD_QUALITY_HIGH;for(var a in this.objects){if((this.objects[a].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[a].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[a].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[a].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[a].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[a].type!=JXG.OBJECT_TYPE_AXIS)){this.objects[a].coords.usr2screen()}}}this.calculateSnapSizes();this.clearTraces();this.fullUpdate();if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this)}};JXG.Board.prototype.zoomIn=function(){this.zoomX*=this.options.zoom.factor;this.zoomY*=this.options.zoom.factor;this.applyZoom()};JXG.Board.prototype.zoomOut=function(){this.zoomX/=this.options.zoom.factor;this.zoomY/=this.options.zoom.factor;this.applyZoom()};JXG.Board.prototype.zoom100=function(){this.zoomX=1;this.zoomY=1;this.applyZoom()};JXG.Board.prototype.zoomAllPoints=function(){var s=this.zoomX/this.zoomY;var k=0;var e=0;var h=0;var b=0;for(var g in this.objects){if((this.objects[g].elementClass==JXG.OBJECT_CLASS_POINT)&&this.objects[g].visProp.visible){if(this.objects[g].coords.usrCoords[1]<k){k=this.objects[g].coords.usrCoords[1]}if(this.objects[g].coords.usrCoords[1]>e){e=this.objects[g].coords.usrCoords[1]}if(this.objects[g].coords.usrCoords[2]>b){b=this.objects[g].coords.usrCoords[2]}if(this.objects[g].coords.usrCoords[2]<h){h=this.objects[g].coords.usrCoords[2]}}}var o=50;var x=o/(this.unitX*this.zoomX);var w=o/(this.unitY*this.zoomY);var v=e-k+2*x;var u=b-h+2*w;var q=Math.min(this.canvasWidth/(this.unitX*v),this.canvasHeight/(this.unitY*u));var d=q;var f=q*s;var a=-(k-x)*this.unitX*f;var y=(b+w)*this.unitY*d;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,y],this);this.zoomX=f;this.zoomY=d;this.applyZoom()};JXG.Board.prototype.removeObject=function(a){a=JXG.getReference(this,a);if(a==undefined){return}try{for(var f in a.childElements){a.childElements[f].board.removeObject(a.childElements[f])}for(var b in this.objects){if(typeof this.objects[b].childElements!="undefined"){delete (this.objects[b].childElements[a.id])}}delete (this.objects[a.id]);delete (this.elementsByName[a.name]);if(a.remove!=undefined){a.remove()}}catch(d){}};JXG.Board.prototype.initGeonextBoard=function(){var f=new JXG.Point(this,[0,0],this.id+"gOOe0","Ursprung",false);f.fixed=true;var e=new JXG.Point(this,[1,0],this.id+"gXOe0","Punkt_1_0",false);e.fixed=true;var d=new JXG.Point(this,[0,1],this.id+"gYOe0","Punkt_0_1",false);d.fixed=true;var b=new JXG.Line(this,this.id+"gOOe0",this.id+"gXOe0",this.id+"gXLe0","X-Achse");b.hideElement();var a=new JXG.Line(this,this.id+"gOOe0",this.id+"gYOe0",this.id+"gYLe0","Y-Achse");a.hideElement()};JXG.Board.prototype.initInfobox=function(){this.infobox=new JXG.Text(this,"0,0","",[0,0],this.id+"__infobox",null,null,false);this.infobox.distanceX=-20;this.infobox.distanceY=25;this.renderer.hide(this.infobox)};JXG.Board.prototype.resizeContainer=function(a,b){this.canvasWidth=1*a;this.canvasHeight=1*b;this.containerObj.style.width=(this.canvasWidth)+"px";this.containerObj.style.height=(this.canvasHeight)+"px"};JXG.Board.prototype.showDependencies=function(){var d;var b="<p>\n";for(d in this.objects){var a=0;for(var g in this.objects[d].childElements){a++}if(a>=0){b+="<b>"+this.objects[d].id+":</b> "}for(var g in this.objects[d].childElements){b+=this.objects[d].childElements[g].id+"("+this.objects[d].childElements[g].name+"), "}b+="<p>\n"}b+="</p>\n";var e=window.open();e.document.open();e.document.write(b);e.document.close()};JXG.Board.prototype.showXML=function(){var a=window.open("");a.document.open();a.document.write("<pre>"+JXG.escapeHTML(this.xmlString)+"</pre>");a.document.close()};JXG.Board.prototype.prepareUpdate=function(b){for(var a in this.objects){this.objects[a].needsUpdate=true}};JXG.Board.prototype.updateElements=function(b){b=JXG.getReference(this,b);var d=-1;if(!this.reducedUpdate){d=1}for(var a in this.objects){var e=this.objects[a];if(!this.needsFullUpdate&&!e.needsRegularUpdate&&e.afterFirstUpdate){continue}if(b==null||e.id!=b.id){if(d>=0||!e.afterFirstUpdate||this.needsFullUpdate){e.update(true)}}else{e.update(false);d=5}if(this.reducedUpdate){d--}}};JXG.Board.prototype.updateRenderer=function(b){var b=JXG.getReference(this,b);var d=-1;if(!this.reducedUpdate){d=1}for(var a in this.objects){var e=this.objects[a];if(!this.needsFullUpdate&&!e.needsRegularUpdate&&e.afterFirstUpdate){continue}if(b==null||e.id!=b.id){if(d>=0||!e.afterFirstUpdate||this.needsFullUpdate){e.updateRenderer()}}else{e.updateRenderer();d=5}if(this.reducedUpdate){d--}e.afterFirstUpdate=true}};JXG.Board.prototype.addHook=function(a){this.hooks.push(a);a(this);return(this.hooks.length-1)};JXG.Board.prototype.removeHook=function(a){this.hooks[a]=null};JXG.Board.prototype.updateHooks=function(){for(var a=0;a<this.hooks.length;a++){if(this.hooks[a]!=null){this.hooks[a](this)}}};JXG.Board.prototype.addChild=function(a){this.dependentBoards.push(a);this.update()};JXG.Board.prototype.removeChild=function(b){var a;for(a=this.dependentBoards.length-1;a>=0;a--){if(this.dependentBoards[a]==b){this.dependentBoards.splice(a,1)}}};JXG.Board.prototype.update=function(d){var b,a,e;if(this.isSuspendedUpdate){return}this.prepareUpdate(d);this.updateElements(d);this.updateConditions();this.renderer.suspendRedraw();this.updateRenderer(d);this.renderer.unsuspendRedraw();this.updateHooks();a=this.dependentBoards.length;for(b=0;b<a;b++){e=this.dependentBoards[b].id;if(JXG.JSXGraph.boards[e]!=this){JXG.JSXGraph.boards[e].prepareUpdate(d);JXG.JSXGraph.boards[e].updateElements(d);JXG.JSXGraph.boards[e].updateConditions();JXG.JSXGraph.boards[e].renderer.suspendRedraw();JXG.JSXGraph.boards[e].updateRenderer(d);JXG.JSXGraph.boards[e].renderer.unsuspendRedraw();JXG.JSXGraph.boards[e].updateHooks()}}};JXG.Board.prototype.fullUpdate=function(){this.needsFullUpdate=true;this.update();this.needsFullUpdate=false};JXG.Board.prototype.createElement=function(b,d,a){if(b!="turtle"&&(d==null||d.length==0)){return null}if(d==null){d=[]}var g;b=b.toLowerCase();if(a==null){a={}}for(var e=0;e<d.length;e++){d[e]=JXG.getReference(this,d[e])}if(JXG.JSXGraph.elements[b]!=null){g=JXG.JSXGraph.elements[b](this,d,a)}else{throw"JXG.createElement: Unknown element type given: "+b}if(g==undefined){return}if(JXG.isArray(a)){a=a[0]}if(g.multipleElements){for(var f in g){if(typeof g[f].setProperty!="undefined"){g[f].setProperty(a)}}}else{if(typeof g.setProperty!="undefined"){g.setProperty(a)}}this.update();return g};JXG.Board.prototype.clearTraces=function(){for(var a in this.objects){if(this.objects[a].traced){this.objects[a].clearTrace()}}};JXG.Board.prototype.beforeLoad=function(){};JXG.Board.prototype.afterLoad=function(){};JXG.Board.prototype.suspendUpdate=function(){this.isSuspendedUpdate=true};JXG.Board.prototype.unsuspendUpdate=function(){this.isSuspendedUpdate=false;this.update()};JXG.Board.prototype.setBoundingBox=function(e,b){if(!JXG.isArray(e)){return}var d,a;a=this.canvasWidth;d=this.canvasHeight;if(b){this.unitX=a/(e[2]-e[0]);this.unitY=d/(-e[3]+e[1]);if(this.unitX>this.unitY){this.unitY=this.unitX}else{this.unitX=this.unitY}}else{this.unitX=a/(e[2]-e[0]);this.unitY=d/(-e[3]+e[1])}this.originX=-this.unitX*e[0];this.originY=this.unitY*e[1];this.moveOrigin()};JXG.Options=function(){this.fontSize=12;this.showCopyright=true;this.showNavigation=true;this.grid=new Object();this.grid.hasGrid=false;this.grid.gridX=2;this.grid.gridY=2;this.grid.gridColor="#C0C0C0";this.grid.gridOpacity="0.5";this.grid.gridDash=true;this.grid.snapToGrid=false;this.grid.snapSizeX=2;this.grid.snapSizeY=2;this.zoom=new Object();this.zoom.factor=1.25;this.elements=new Object();this.elements.color=new Object();this.elements.color.strokeOpacity=1;this.elements.color.highlightStrokeOpacity=1;this.elements.color.fillOpacity=1;this.elements.color.highlightFillOpacity=1;this.elements.color.strokeColor="#0000ff";this.elements.color.highlightStrokeColor="#C3D9FF";this.elements.color.fillColor="none";this.elements.color.highlightFillColor="none";this.elements.strokeWidth="2px";this.elements.draft=new Object();this.elements.draft.draft=false;this.elements.draft.color="#565656";this.elements.draft.opacity=0.8;this.elements.draft.strokeWidth="1px";this.point=new Object();this.point.style=5;this.point.fillColor="#ff0000";this.point.highlightFillColor="#EEEEEE";this.point.strokeColor=this.elements.color.strokeColor;this.point.highlightStrokeColor=this.elements.color.highlightStrokeColor;this.line=new Object();this.line.firstArrow=false;this.line.lastArrow=false;this.line.straightFirst=true;this.line.straightLast=true;this.line.fillColor=this.elements.color.fillColor;this.line.highlightFillColor=this.elements.color.highlightFillColor;this.line.strokeColor=this.elements.color.strokeColor;this.line.highlightStrokeColor=this.elements.color.highlightStrokeColor;this.line.ticks=new Object();this.line.ticks.drawLabels=true;this.line.ticks.drawZero=false;this.line.ticks.insertTicks=false;this.line.ticks.minTicksDistance=100;this.line.ticks.maxTicksDistance=300;this.line.ticks.minorHeight=4;this.line.ticks.majorHeight=10;this.line.ticks.minorTicks=4;this.line.ticks.defaultDistance=5;this.circle=new Object();this.circle.fillColor=this.elements.color.fillColor;this.circle.highlightFillColor=this.elements.color.highlightFillColor;this.circle.strokeColor=this.elements.color.strokeColor;this.circle.highlightStrokeColor=this.elements.color.highlightStrokeColor;this.angle=new Object();this.angle.radius=1;this.angle.fillColor="#FF7F00";this.angle.highlightFillColor="#FF7F00";this.angle.strokeColor="#FF7F00";this.angle.fillOpacity=0.3;this.angle.highlightFillOpacity=0.3;this.arc=new Object();this.arc.firstArrow=false;this.arc.lastArrow=false;this.arc.fillColor=this.elements.color.fillColor;this.arc.highlightFillColor=this.elements.color.highlightFillColor;this.arc.strokeColor=this.elements.color.strokeColor;this.arc.highlightStrokeColor=this.elements.color.highlightStrokeColor;this.polygon=new Object();this.polygon.fillColor="#00FF00";this.polygon.highlightFillColor="#00FF00";this.polygon.fillOpacity=0.3;this.polygon.highlightFillOpacity=0.3;this.sector=new Object();this.sector.fillColor="#00FF00";this.sector.highlightFillColor="#00FF00";this.sector.fillOpacity=0.3;this.sector.highlightFillOpacity=0.3;this.text=new Object();this.text.strokeColor="#000000";this.curve=new Object();this.curve.strokeWidth="1px";this.curve.strokeColor=this.elements.color.strokeColor;this.curve.RDPsmoothing=false;this.curve.numberPointsHigh=1600;this.curve.numberPointsLow=400;this.precision=new Object();this.precision.hasPoint=4;this.precision.epsilon=0.0001};JXG.Options.prototype.useStandardOptions=function(e){var d=e.hasGrid;e.hasGrid=this.grid.hasGrid;e.gridX=this.grid.gridX;e.gridY=this.grid.gridY;e.gridColor=this.grid.gridColor;e.gridOpacity=this.grid.gridOpacity;e.gridDash=this.grid.gridDash;e.snapToGrid=this.grid.snapToGrid;e.snapSizeX=this.grid.SnapSizeX;e.snapSizeY=this.grid.SnapSizeY;for(var b in e.objects){if(e.objects[b].type==JXG.OBJECT_TYPE_POINT){e.objects[b].visProp.fillColor=this.point.fillColor;e.objects[b].visProp.highlightFillColor=this.point.highlightFillColor;e.objects[b].visProp.strokeColor=this.point.strokeColor;e.objects[b].visProp.highlightStrokeColor=this.point.highlightStrokeColor}else{if(e.objects[b].type==JXG.OBJECT_TYPE_LINE){e.objects[b].visProp.fillColor=this.line.fillColor;e.objects[b].visProp.highlightFillColor=this.line.highlightFillColor;e.objects[b].visProp.strokeColor=this.line.strokeColor;e.objects[b].visProp.highlightStrokeColor=this.line.highlightStrokeColor;for(var a in e.objects[b].ticks){a.majorTicks=this.line.ticks.majorTicks;a.minTicksDistance=this.line.ticks.minTicksDistance;a.minorHeight=this.line.ticks.minorHeight;a.majorHeight=this.line.ticks.majorHeight}}else{if(e.objects[b].type==JXG.OBJECT_TYPE_CIRCLE){e.objects[b].visProp.fillColor=this.circle.fillColor;e.objects[b].visProp.highlightFillColor=this.circle.highlightFillColor;e.objects[b].visProp.strokeColor=this.circle.strokeColor;e.objects[b].visProp.highlightStrokeColor=this.circle.highlightStrokeColor}else{if(e.objects[b].type==JXG.OBJECT_TYPE_ANGLE){e.objects[b].visProp.fillColor=this.angle.fillColor;e.objects[b].visProp.highlightFillColor=this.angle.highlightFillColor;e.objects[b].visProp.strokeColor=this.angle.strokeColor}else{if(e.objects[b].type==JXG.OBJECT_TYPE_ARC){e.objects[b].visProp.fillColor=this.arc.fillColor;e.objects[b].visProp.highlightFillColor=this.arc.highlightFillColor;e.objects[b].visProp.strokeColor=this.arc.strokeColor;e.objects[b].visProp.highlightStrokeColor=this.arc.highlightStrokeColor}else{if(e.objects[b].type==JXG.OBJECT_TYPE_POLYGON){e.objects[b].visProp.fillColor=this.polygon.fillColor;e.objects[b].visProp.highlightFillColor=this.polygon.highlightFillColor;e.objects[b].visProp.fillOpacity=this.polygon.fillOpacity;e.objects[b].visProp.highlightFillOpacity=this.polygon.highlightFillOpacity}else{if(e.objects[b].type==JXG.OBJECT_TYPE_CURVE){e.objects[b].visProp.strokeColor=this.curve.strokeColor}}}}}}}}for(var b in e.objects){if(e.objects[b].type==JXG.OBJECT_TYPE_SECTOR){e.objects[b].arc.visProp.fillColor=this.sector.fillColor;e.objects[b].arc.visProp.highlightFillColor=this.sector.highlightFillColor;e.objects[b].arc.visProp.fillOpacity=this.sector.fillOpacity;e.objects[b].arc.visProp.highlightFillOpacity=this.sector.highlightFillOpacity}}e.needsFullUpdate=true;e.update();e.needsFullUpdate=false;if(d&&e.hasGrid){e.renderer.removeGrid(e);e.renderer.drawGrid(e)}else{if(d&&!e.hasGrid){e.renderer.removeGrid(e)}else{if(!d&&e.hasGrid){e.renderer.drawGrid(e)}}}};JXG.Options.prototype.useBlackWhiteOptions=function(a){this.point.fillColor=this.changeColorToBlackWhite(this.point.fillColor);this.point.highlightFillColor=this.changeColorToBlackWhite(this.point.highlightFillColor);this.point.strokeColor=this.changeColorToBlackWhite(this.point.strokeColor);this.point.highlightStrokeColor=this.changeColorToBlackWhite(this.point.highlightStrokeColor);this.line.fillColor=this.changeColorToBlackWhite(this.line.fillColor);this.line.highlightFillColor=this.changeColorToBlackWhite(this.line.highlightFillColor);this.line.strokeColor=this.changeColorToBlackWhite(this.line.strokeColor);this.line.highlightStrokeColor=this.changeColorToBlackWhite(this.line.highlightStrokeColor);this.circle.fillColor=this.changeColorToBlackWhite(this.circle.fillColor);this.circle.highlightFillColor=this.changeColorToBlackWhite(this.circle.highlightFillColor);this.circle.strokeColor=this.changeColorToBlackWhite(this.circle.strokeColor);this.circle.highlightStrokeColor=this.changeColorToBlackWhite(this.circle.highlightStrokeColor);this.arc.fillColor=this.changeColorToBlackWhite(this.arc.fillColor);this.arc.highlightFillColor=this.changeColorToBlackWhite(this.arc.highlightFillColor);this.arc.strokeColor=this.changeColorToBlackWhite(this.arc.strokeColor);this.arc.highlightStrokeColor=this.changeColorToBlackWhite(this.arc.highlightStrokeColor);this.polygon.fillColor=this.changeColorToBlackWhite(this.polygon.fillColor);this.polygon.highlightFillColor=this.changeColorToBlackWhite(this.polygon.highlightFillColor);this.sector.fillColor=this.changeColorToBlackWhite(this.sector.fillColor);this.sector.highlightFillColor=this.changeColorToBlackWhite(this.sector.highlightFillColor);this.curve.strokeColor=this.changeColorToBlackWhite(this.curve.strokeColor);this.grid.gridColor=this.changeColorToBlackWhite(this.grid.gridColor);this.useStandardOptions(a)};JXG.Options.prototype.changeColorToBlackWhite=function(e){if(e=="none"){return e}var f=new JXG.RGBColor(e);var o=f.r;var k=f.g;var d=f.b;var a=0.3*o+0.59*k+0.11*d;var q="0123456789ABCDEF";var h=q.charAt((a>>4)&15)+q.charAt(a&15);e="#"+h+""+h+""+h;return e};JXG.Options.prototype.loadFromFile=function(b,d,a){this.cbp=function(e){this.parseString(e,d,a)};this.cb=JXG.bind(this.cbp,this);JXG.FileReader.parseFileContent(b,this.cb,"raw")};JXG.Options.prototype.parseString=function(text,applyTo,board){var newOptions="";if(text!=""){newOptions=eval("("+text+")")}else{return}var maxDepth=10;var applyOption=function(base,option,depth){if(depth==10){return}depth++;for(var key in option){if((JXG.isNumber(option[key]))||(JXG.isArray(option[key]))||(JXG.isString(option[key]))||(option[key]==true)||(option[key]==false)){base[key]=option[key]}else{applyOption(base[key],option[key],depth)}}};applyOption(this,newOptions,0);if(applyTo&&typeof board!="undefined"){this.useStandardOptions(board)}};JXG.Board.prototype.angle=function(a,d,b){return this.algebra.angle(a,d,b)};JXG.Board.prototype.rad=function(a,d,b){return this.algebra.rad(a,d,b)};JXG.Board.prototype.distance=function(b,a){return this.algebra.distance(b,a)};JXG.Board.prototype.pow=function(e,d){return this.algebra.pow(e,d)};JXG.Board.prototype.round=function(a,b){return(a).toFixed(b)};JXG.Board.prototype.cosh=function(a){return JXG.Math.Numerics.cosh(a)};JXG.Board.prototype.sinh=function(a){return JXG.Math.Numerics.sinh(a)};JXG.Board.prototype.sgn=function(a){return(a==0?0:a/(Math.abs(a)))};JXG.Board.prototype.D=function(a,b){return JXG.Math.Numerics.D(a,b)};JXG.Board.prototype.I=function(a,b){return JXG.Math.Numerics.I(a,b)};JXG.Board.prototype.root=function(b,a,d){return JXG.Math.Numerics.root(b,a,d)};JXG.Board.prototype.lagrangePolynomial=function(a){return JXG.Math.Numerics.lagrangePolynomial(a)};JXG.Board.prototype.neville=function(a){return JXG.Math.Numerics.neville(a)};JXG.Board.prototype.riemannsum=function(d,g,b,e,a){return JXG.Math.Numerics.riemannsum(d,g,b,e,a)};JXG.Board.prototype.abs=Math.abs;JXG.Board.prototype.acos=Math.acos;JXG.Board.prototype.asin=Math.asin;JXG.Board.prototype.atan=Math.atan;JXG.Board.prototype.ceil=Math.ceil;JXG.Board.prototype.cos=Math.cos;JXG.Board.prototype.exp=Math.exp;JXG.Board.prototype.floor=Math.floor;JXG.Board.prototype.log=Math.log;JXG.Board.prototype.max=Math.max;JXG.Board.prototype.min=Math.min;JXG.Board.prototype.random=Math.random;JXG.Board.prototype.sin=Math.sin;JXG.Board.prototype.sqrt=Math.sqrt;JXG.Board.prototype.tan=Math.tan;JXG.Board.prototype.trunc=Math.ceil;JXG.Board.prototype.factorial=function(a){return JXG.Math.factorial(a)};JXG.Board.prototype.binomial=function(b,a){return JXG.Math.binomial(b,a)};JXG.Point.prototype.setPositionX=function(d,a){var b=(d==JXG.COORDS_BY_USER)?this.coords.usrCoords[2]:this.coords.scrCoords[2];this.setPosition(d,a,b)};JXG.Point.prototype.setPositionY=function(d,b){var a=(d==JXG.COORDS_BY_USER)?this.coords.usrCoords[1]:this.coords.scrCoords[1];this.setPosition(d,a,b)};JXG.Board.prototype.getElement=function(a){return JXG.getReference(this,a)};JXG.Board.prototype.intersectionOptions=["point",[[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_CIRCLE],[JXG.OBJECT_CLASS_CIRCLE,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.intersection=function(e,b,d,a){e=JXG.getReference(this,e);b=JXG.getReference(this,b);if(e.elementClass==JXG.OBJECT_CLASS_CURVE||b.elementClass==JXG.OBJECT_CLASS_CURVE){return function(){return e.board.algebra.meetCurveCurve(e,b,d,a)}}else{return function(){return e.board.algebra.meet(e.stdform,b.stdform,d)}}};JXG.Board.prototype.intersectionFunc=function(e,b,d,a){return this.intersection(e,b,d,a)};JXG.Board.prototype.pointFunc=function(){return[null]};JXG.Board.prototype.pointOptions=["point",[[JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.lineFunc=function(){return arguments};JXG.Board.prototype.lineOptions=["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentFunc=function(){return arguments};JXG.Board.prototype.linesegmentOptions=["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentAtts={straightFirst:false,straightLast:false};JXG.Board.prototype.arrowFunc=function(){return arguments};JXG.Board.prototype.arrowOptions=["arrow",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circleFunc=function(){return arguments};JXG.Board.prototype.circleOptions=["circle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.arrowparallelOptions=["arrowparallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.arrowparallelFunc=function(){return arguments};JXG.Board.prototype.bisectorOptions=["bisector",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.bisectorFunc=function(){return arguments};JXG.Board.prototype.circumcircleOptions=["circumcircle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcircleFunc=function(){return arguments};JXG.Board.prototype.circumcirclemidpointOptions=["circumcirclemidpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcirclemidpointFunc=function(){return arguments};JXG.Board.prototype.integralOptions=["integral",[[]]];JXG.Board.prototype.integralFunc=function(){return arguments};JXG.Board.prototype.midpointOptions=["midpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.midpointFunc=function(){return arguments};JXG.Board.prototype.mirrorpointOptions=["mirrorpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.mirrorpointFunc=function(){return arguments};JXG.Board.prototype.normalOptions=["normal",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.normalFunc=function(){return arguments};JXG.Board.prototype.parallelOptions=["parallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.parallelFunc=function(){return arguments};JXG.Board.prototype.parallelpointOptions=["parallelpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.parallelpointFunc=function(){return arguments};JXG.Board.prototype.perpendicularOptions=["perpendicular",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularFunc=function(){return arguments};JXG.Board.prototype.perpendicularpointOptions=["perpendicularpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularpointFunc=function(){return arguments};JXG.Board.prototype.reflectionOptions=["reflection",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.reflectionFunc=function(){return arguments};JXG.Board.prototype.pstricks={};JXG.Board.prototype.pstricks.givePsTricksToDiv=function(a,b){JXG.PsTricks.givePsTricksToDiv(a,b)};JXG.Ticks=function(a,f,e,g,b,h,d){this.constructor();this.type=JXG.OBJECT_TYPE_TICKS;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.line=a;this.board=this.line.board;this.ticksFunction=null;this.fixedTicks=null;this.equidistant=false;if(JXG.isFunction(f)){this.ticksFunction=f}else{if(JXG.isArray(f)){this.fixedTicks=f}else{if(Math.abs(f)<JXG.Math.eps){f=this.board.options.line.ticks.defaultDistance}this.ticksFunction=function(k){return f};this.equidistant=true}}this.minorTicks=((e==null)||(e==0)?this.board.options.line.ticks.minorTicks:e);if(this.minorTicks<0){this.minorTicks=-this.minorTicks}this.majorHeight=((g==null)||(g==0)?this.board.options.line.ticks.majorHeight:g);if(this.majorHeight<0){this.majorHeight=-this.majorHeight}this.minorHeight=((b==null)||(b==0)?this.board.options.line.ticks.minorHeight:b);if(this.minorHeight<0){this.minorHeight=-this.minorHeight}this.minTicksDistance=this.board.options.line.ticks.minTicksDistance;this.maxTicksDistance=this.board.options.line.ticks.maxTicksDistance;this.insertTicks=this.board.options.line.ticks.insertTicks;this.drawZero=this.board.options.line.ticks.drawZero;this.drawLabels=this.board.options.line.ticks.drawLabels;this.init(this.board,h,d);this.visProp.visible=true;this.visProp.fillColor=this.line.visProp.fillColor;this.visProp.highlightFillColor=this.line.visProp.highlightFillColor;this.visProp.strokeColor=this.line.visProp.strokeColor;this.visProp.highlightStrokeColor=this.line.visProp.highlightStrokeColor;this.visProp.strokeWidth=this.line.visProp.strokeWidth;this.id=this.line.addTicks(this)};JXG.Ticks.prototype=new JXG.GeometryElement;JXG.Ticks.prototype.hasPoint=function(a,b){return false};JXG.Ticks.prototype.makeTicks=function(g,d,L,I){var E=g.usrCoords[1]-d.usrCoords[1];var C=g.usrCoords[2]-d.usrCoords[2];var K=0;var h=Math.sqrt(E*E+C*C);if(h<=JXG.Math.eps){return}var B=g.usrCoords[1];var A=g.usrCoords[2];var J=L/Math.abs(L);K=Math.abs(this.ticksFunction(J));var O=(K*E)/(h);var N=(K*C)/(h);var G=0;if(this.equidistant){var b=O;var F=N;var a=K;var D=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board);var H=new JXG.Coords(JXG.COORDS_BY_USER,[O,N],this.board);G=(H.scrCoords[1]-D.scrCoords[1])*(H.scrCoords[1]-D.scrCoords[1])+(H.scrCoords[2]-D.scrCoords[2])*(H.scrCoords[2]-D.scrCoords[2]);while(G<this.minTicksDistance*this.minTicksDistance){O+=b;N+=F;K+=a;H=new JXG.Coords(JXG.COORDS_BY_USER,[O,N],this.board);G=(H.scrCoords[1]-D.scrCoords[1])*(H.scrCoords[1]-D.scrCoords[1])+(H.scrCoords[2]-D.scrCoords[2])*(H.scrCoords[2]-D.scrCoords[2])}}var P=L*K;var v=new JXG.Coords(JXG.COORDS_BY_USER,[B,A],this.board);var f=null;var e=null;var s="";var u=null;var q=true;var o=B;var k=A;while(q||(((this.board.sgn(O)*(B-I*O)>=this.board.sgn(O)*d.usrCoords[1])&&(this.board.sgn(N)*(A-I*N)>=this.board.sgn(N)*d.usrCoords[2])))){q=false;B=B-O;A=A-N;f=new JXG.Coords(JXG.COORDS_BY_USER,[B,A],this.board);if(!this.equidistant){G=(v.scrCoords[1]-f.scrCoords[1])*(v.scrCoords[1]-f.scrCoords[1])+(v.scrCoords[2]-f.scrCoords[2])*(v.scrCoords[2]-f.scrCoords[2])}if(this.insertTicks&&this.equidistant&&(G>this.maxTicksDistance*this.maxTicksDistance)){while(G>this.maxTicksDistance*this.maxTicksDistance){O=O/2;N=N/2;B=B+O;A=A+N;K=K/2;P=P-L*K;f=new JXG.Coords(JXG.COORDS_BY_USER,[B,A],this.board);G=(v.scrCoords[1]-f.scrCoords[1])*(v.scrCoords[1]-f.scrCoords[1])+(v.scrCoords[2]-f.scrCoords[2])*(v.scrCoords[2]-f.scrCoords[2])}}if(this.equidistant){for(var w=1;w<this.minorTicks+1;w++){e=new JXG.Coords(JXG.COORDS_BY_USER,[o-(O*w)/(this.minorTicks+1),k-(N*w)/(this.minorTicks+1)],this.board);e.major=false;this.ticks.push(e);this.labels.push(null)}}if(this.equidistant||(G>this.minTicksDistance*this.minTicksDistance)){f.major=true;this.ticks.push(f);s=P.toString();if(s.length>5){s=P.toPrecision(3).toString()}u=new JXG.Text(this.board,s,null,[f.usrCoords[1],f.usrCoords[2]],this.id+J+"Label",null,null,true);u.distanceX=0;u.distanceY=-10;u.setCoords(f.usrCoords[1]*1+u.distanceX/(this.board.unitX*this.board.zoomX),f.usrCoords[2]*1+u.distanceY/(this.board.unitY*this.board.zoomY));if(this.drawLabels){u.visProp.visible=true}else{u.visProp.visible=false}this.labels.push(u);o=B;k=A;v=f}J=J+L*1;if(!this.equidistant){K=Math.abs(this.ticksFunction(J))}P=P+L*K;if(!this.equidistant){O=(K*E)/(h);N=(K*C)/(h)}}};JXG.Ticks.prototype.calculateTicksCoordinates=function(){var C=1;var w=2;var x=C+w;var D=new JXG.Coords(JXG.COORDS_BY_USER,[this.line.point1.coords.usrCoords[1],this.line.point1.coords.usrCoords[2]],this.board);var B=new JXG.Coords(JXG.COORDS_BY_USER,[this.line.point2.coords.usrCoords[1],this.line.point2.coords.usrCoords[2]],this.board);this.board.renderer.calcStraight(this.line,D,B);var b=this.line.point1.coords;if(this.board.renderer.isSameDirection(b,D,B)){if(this.board.renderer.isSameDirection(b,this.line.point2.coords,D)){x=w;if(b.distance(JXG.COORDS_BY_USER,D)>b.distance(JXG.COORDS_BY_USER,B)){B=D}}else{x=C;if(b.distance(JXG.COORDS_BY_USER,D)<b.distance(JXG.COORDS_BY_USER,B)){D=B}}}else{if(this.board.renderer.isSameDirection(b,this.line.point2.coords,D)){var g=D;D=B;B=g}}if(this.ticks!=null){for(var F=0;F<this.ticks.length;F++){if(this.labels[F]!=null){if(this.labels[F].visProp.visible){this.board.renderer.remove(this.labels[F].rendNode)}}}}this.ticks=new Array();this.labels=new Array();var q=null;var k="";var f=null;if(this.ticksFunction!=null){if(this.drawZero){f=new JXG.Coords(JXG.COORDS_BY_USER,[b.usrCoords[1],b.usrCoords[2]],this.board);this.ticks.push(f);q=new JXG.Text(this.board,"0",null,[b.usrCoords[1],b.usrCoords[2]],this.id+"0Label",null,null,true);if(this.drawLabels){q.visProp.visible=true}else{q.visProp.visible=false}this.labels.push(q);this.ticks[0].major=true}if(C==(x&C)){if(this.line.visProp.straightFirst){this.makeTicks(b,D,-1,0)}}if(w==(x&w)){if(this.line.visProp.straightLast){this.makeTicks(b,B,+1,0)}else{this.makeTicks(b,this.line.point2.coords,+1,1)}}}else{if(!this.line.visProp.straightFirst){D=b}var s=b.usrCoords[1]-D.usrCoords[1];var o=b.usrCoords[2]-D.usrCoords[2];var K=Math.sqrt(s*s+o*o);if(!this.line.visProp.straightLast){B=this.line.point2.coords}var h=b.usrCoords[1]-B.usrCoords[1];var u=b.usrCoords[2]-B.usrCoords[2];var d=Math.sqrt(h*h+u*u);var I=0;var H=0;for(var G=0;G<this.fixedTicks.length;G++){if((-K<=this.fixedTicks[G])&&(this.fixedTicks[G]<=d)){if(this.fixedTicks[G]<0){I=Math.abs(s)*this.fixedTicks[G]/K;H=Math.abs(o)*this.fixedTicks[G]/K}else{I=Math.abs(h)*this.fixedTicks[G]/d;H=Math.abs(u)*this.fixedTicks[G]/d}f=new JXG.Coords(JXG.COORDS_BY_USER,[b.usrCoords[1]+I,b.usrCoords[2]+H],this.board);this.ticks.push(f);this.ticks[this.ticks.length-1].major=true;k=this.fixedTicks[G].toString();if(k.length>5){k=this.fixedTicks[G].toFixed(3).toString()}q=new JXG.Text(this.board,k,null,[b.usrCoords[1]+I,b.usrCoords[2]+H],this.id+G+"Label",null,null,true);q.distanceX=0;q.distanceY=-10;q.setCoords(f.usrCoords[1]*1+q.distanceX/(this.board.unitX*this.board.zoomX),f.usrCoords[2]*1+q.distanceY/(this.board.unitY*this.board.zoomY));if(this.drawLabels){q.visProp.visible=true}else{q.visProp.visible=false}this.labels.push(q)}}}var z=JXG.Math.eps;var v=-this.line.getSlope();var y=this.majorHeight/2;var e=this.minorHeight/2;var J=0;var a=0;var A=0;var E=0;if(Math.abs(v)<z){J=0;a=y;A=0;E=e}else{if((Math.abs(v)>1/z)||(isNaN(v))){J=y;a=0;A=e;E=0}else{J=y/Math.sqrt(1/(v*v)+1);a=-J/v;A=e/Math.sqrt(1/(v*v)+1);E=-A/v}}this.board.renderer.updateTicks(this,J,a,A,E)};JXG.Ticks.prototype.updateRenderer=function(){if(this.needsUpdate){this.calculateTicksCoordinates();this.needsUpdate=false}};JXG.createTicks=function(e,b,a){var d;if((b[0].elementClass==JXG.OBJECT_CLASS_LINE)&&(JXG.isFunction(b[1])||JXG.isArray(b[1])||JXG.isNumber(b[1]))){d=new JXG.Ticks(b[0],b[1],a.minorTicks,a.majHeight,a.minHeight,a.id,a.name)}else{throw ("Can't create Ticks with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("ticks",JXG.createTicks);JXG.Util={};JXG.Util.Unzip=function(aa){var v=[],N="",K=false,H,O=0,X=[],z,k=new Array(32768),af=0,S=false,ac,P,ae=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],ai=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=aa,b=0,h=0,aj=1,a=0,ah=256,g=[],q;function e(){var al=D.length;a+=8;if(b<al){if(K){document.write(b+": "+D[b]+"<br>")}return D[b++]}else{return -1}}function x(){aj=1}function ad(){var al;a++;al=(aj&1);aj>>=1;if(aj==0){aj=e();al=(aj&1);aj=(aj>>1)|128}return al}function ab(al){var an=0,am=al;while(am--){an=(an<<1)|ad()}if(al){an=ae[an]>>(8-al)}return an}function d(){af=0}function E(al){P++;k[af++]=al;v.push(String.fromCharCode(al));if(af==32768){af=0}}function u(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1}var f=288;var C=new Array(f);var V=new Array(32);var Q=0;var ag=null;var y=null;var U=new Array(64);var R=new Array(64);var F=0;var J=new Array(17);J[0]=0;var W;var B;function o(){while(1){if(J[F]>=B){return -1}if(W[J[F]]==F){return J[F]++}J[F]++}}function L(){var am=ag[Q];var al;if(K){document.write("<br>len:"+F+" treepos:"+Q)}if(F==17){return -1}Q++;F++;al=o();if(K){document.write("<br>IsPat "+al)}if(al>=0){am.b0=al;if(K){document.write("<br>b0 "+am.b0)}}else{am.b0=32768;if(K){document.write("<br>b0 "+am.b0)}if(L()){return -1}}al=o();if(al>=0){am.b1=al;if(K){document.write("<br>b1 "+am.b1)}am.jump=null}else{am.b1=32768;if(K){document.write("<br>b1 "+am.b1)}am.jump=ag[Q];am.jumppos=Q;if(L()){return -1}}F--;return 0}function s(ap,an,aq,am){var ao;if(K){document.write("currentTree "+ap+" numval "+an+" lengths "+aq+" show "+am)}ag=ap;Q=0;W=aq;B=an;for(ao=0;ao<17;ao++){J[ao]=0}F=0;if(L()){if(K){alert("invalid huffman tree\n")}return -1}if(K){document.write("<br>Tree: "+ag.length);for(var al=0;al<32;al++){document.write("Places["+al+"].b0="+ag[al].b0+"<br>");document.write("Places["+al+"].b1="+ag[al].b1+"<br>")}}return 0}function I(ao){var am,an,aq=0,ap=ao[aq],al;while(1){al=ad();if(K){document.write("b="+al)}if(al){if(!(ap.b1&32768)){if(K){document.write("ret1")}return ap.b1}ap=ap.jump;am=ao.length;for(an=0;an<am;an++){if(ao[an]===ap){aq=an;break}}}else{if(!(ap.b0&32768)){if(K){document.write("ret2")}return ap.b0}aq++;ap=ao[aq]}}if(K){document.write("ret3")}return -1}function ak(){var ap,aC,am,aA,aB;do{ap=ad();am=ab(2);switch(am){case 0:if(K){alert("Stored\n")}break;case 1:if(K){alert("Fixed Huffman codes\n")}break;case 2:if(K){alert("Dynamic Huffman codes\n")}break;case 3:if(K){alert("Reserved block type!!\n")}break;default:if(K){alert("Unexpected value %d!\n",am)}break}if(am==0){var ay,al;x();ay=e();ay|=(e()<<8);al=e();al|=(e()<<8);if(((ay^~al)&65535)){document.write("BlockLen checksum mismatch\n")}while(ay--){aC=e();E(aC)}}else{if(am==1){var az;while(1){az=(ae[ab(7)]>>1);if(az>23){az=(az<<1)|ad();if(az>199){az-=128;az=(az<<1)|ad()}else{az-=48;if(az>143){az=az+136}}}else{az+=256}if(az<256){E(az)}else{if(az==256){break}else{var aB,av;az-=256+1;aB=ab(Z[az])+ai[az];az=ae[ab(5)]>>3;if(G[az]>8){av=ab(8);av|=(ab(G[az]-8)<<8)}else{av=ab(G[az])}av+=T[az];for(az=0;az<aB;az++){var aC=k[(af-av)&32767];E(aC)}}}}}else{if(am==2){var az,aw,an,at,au;var ar=new Array(288+32);an=257+ab(5);at=1+ab(5);au=4+ab(4);for(az=0;az<19;az++){ar[az]=0}for(az=0;az<au;az++){ar[w[az]]=ab(3)}aB=V.length;for(aA=0;aA<aB;aA++){V[aA]=new u()}if(s(V,19,ar,0)){d();return 1}if(K){document.write("<br>distanceTree");for(var aD=0;aD<V.length;aD++){document.write("<br>"+V[aD].b0+" "+V[aD].b1+" "+V[aD].jump+" "+V[aD].jumppos)}}aw=an+at;aA=0;var ao=-1;if(K){document.write("<br>n="+aw+" bits: "+a+"<br>")}while(aA<aw){ao++;az=I(V);if(K){document.write("<br>"+ao+" i:"+aA+" decode: "+az+"    bits "+a+"<br>")}if(az<16){ar[aA++]=az}else{if(az==16){var ax;az=3+ab(2);if(aA+az>aw){d();return 1}ax=aA?ar[aA-1]:0;while(az--){ar[aA++]=ax}}else{if(az==17){az=3+ab(3)}else{az=11+ab(7)}if(aA+az>aw){d();return 1}while(az--){ar[aA++]=0}}}}aB=C.length;for(aA=0;aA<aB;aA++){C[aA]=new u()}if(s(C,an,ar,0)){d();return 1}aB=C.length;for(aA=0;aA<aB;aA++){V[aA]=new u()}var aq=new Array();for(aA=an;aA<ar.length;aA++){aq[aA-an]=ar[aA]}if(s(V,at,aq,0)){d();return 1}if(K){document.write("<br>literalTree")}while(1){az=I(C);if(az>=256){var aB,av;az-=256;if(az==0){break}az--;aB=ab(Z[az])+ai[az];az=I(V);if(G[az]>8){av=ab(8);av|=(ab(G[az]-8)<<8)}else{av=ab(G[az])}av+=T[az];while(aB--){var aC=k[(af-av)&32767];E(aC)}}else{E(az)}}}}}}while(!ap);d();x();return 0}JXG.Util.Unzip.prototype.unzipFile=function(al){this.unzip();for(var am=0;am<X.length;am++){if(X[am][1]==al){return X[am][0]}}};JXG.Util.Unzip.prototype.unzip=function(){if(K){alert(D)}A();return X};function A(){if(K){alert("NEXTFILE")}v=[];var ap=[];S=false;ap[0]=e();ap[1]=e();if(K){alert("type: "+ap[0]+" "+ap[1])}if(ap[0]==parseInt("78",16)&&ap[1]==parseInt("da",16)){if(K){alert("GEONExT-GZIP")}ak();if(K){alert(v.join(""))}X[O]=new Array(2);X[O][0]=v.join("");X[O][1]="geonext.gxt";O++}if(ap[0]==parseInt("50",16)&&ap[1]==parseInt("4b",16)){S=true;ap[2]=e();ap[3]=e();if(ap[2]==parseInt("3",16)&&ap[3]==parseInt("4",16)){ap[0]=e();ap[1]=e();if(K){alert("ZIP-Version: "+ap[1]+" "+ap[0]/10+"."+ap[0]%10)}H=e();H|=(e()<<8);if(K){alert("gpflags: "+H)}var al=e();al|=(e()<<8);if(K){alert("method: "+al)}e();e();e();e();var aq=e();aq|=(e()<<8);aq|=(e()<<16);aq|=(e()<<24);var ao=e();ao|=(e()<<8);ao|=(e()<<16);ao|=(e()<<24);var au=e();au|=(e()<<8);au|=(e()<<16);au|=(e()<<24);if(K){alert("local CRC: "+aq+"\nlocal Size: "+au+"\nlocal CompSize: "+ao)}var am=e();am|=(e()<<8);var at=e();at|=(e()<<8);if(K){alert("filelen "+am)}an=0;g=[];while(am--){var ar=e();if(ar=="/"|ar==":"){an=0}else{if(an<ah-1){g[an++]=String.fromCharCode(ar)}}}if(K){alert("nameBuf: "+g)}if(!q){q=g}var an=0;while(an<at){ar=e();an++}ac=4294967295;P=0;if(au=0&&fileOut.charAt(q.length-1)=="/"){if(K){alert("skipdir")}}if(al==8){ak();if(K){alert(v.join(""))}X[O]=new Array(2);X[O][0]=v.join("");X[O][1]=g.join("");O++}Y()}}}function Y(){var aq,an=[];if((H&8)){an[0]=e();an[1]=e();an[2]=e();an[3]=e();if(an[0]==parseInt("50",16)&&an[1]==parseInt("4b",16)&&an[2]==parseInt("07",16)&&an[3]==parseInt("08",16)){var aq=e();aq|=(e()<<8);aq|=(e()<<16);aq|=(e()<<24)}else{var aq=an[0]|(an[1]<<8)|(an[2]<<16)|(an[3]<<24)}var ao=e();ao|=(e()<<8);ao|=(e()<<16);ao|=(e()<<24);var am=e();am|=(e()<<8);am|=(e()<<16);am|=(e()<<24);if(K){alert("CRC:")}}if(S){A()}an[0]=e();if(an[0]!=8){if(K){alert("Unknown compression method!")}return 0}H=e();if(K){if((H&~(parseInt("1f",16)))){alert("Unknown flags set!")}}e();e();e();e();e();var ap=e();if((H&4)){an[0]=e();an[2]=e();F=an[0]+256*an[1];if(K){alert("Extra field size: "+F)}for(var al=0;al<F;al++){e()}}var ar;if((H&8)){var al=0;g=[];while(ar=e()){if(ar=="7"||ar==":"){al=0}if(al<ah-1){g[al++]=ar}}if(K){alert("original file name: "+g)}}if((H&16)){while(ar=e()){}}if((H&2)){reabByte();reabByte()}ak();aq=e();aq|=(e()<<8);aq|=(e()<<16);aq|=(e()<<24);am=e();am|=(e()<<8);am|=(e()<<16);am|=(e()<<24);A()}};JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(d){var a="";var q,k,g,o,h,f,e;var b=0;d=JXG.Util.Base64._utf8_encode(d);while(b<d.length){q=d.charCodeAt(b++);k=d.charCodeAt(b++);g=d.charCodeAt(b++);o=q>>2;h=((q&3)<<4)|(k>>4);f=((k&15)<<2)|(g>>6);e=g&63;if(isNaN(k)){f=e=64}else{if(isNaN(g)){e=64}}a=a+this._keyStr.charAt(o)+this._keyStr.charAt(h)+this._keyStr.charAt(f)+this._keyStr.charAt(e)}return a},decode:function(e,d){var a="";var s,o,h;var q,k,g,f;var b=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<e.length){q=this._keyStr.indexOf(e.charAt(b++));k=this._keyStr.indexOf(e.charAt(b++));g=this._keyStr.indexOf(e.charAt(b++));f=this._keyStr.indexOf(e.charAt(b++));s=(q<<2)|(k>>4);o=((k&15)<<4)|(g>>2);h=((g&3)<<6)|f;a=a+String.fromCharCode(s);if(g!=64){a=a+String.fromCharCode(o)}if(f!=64){a=a+String.fromCharCode(h)}}if(d){a=JXG.Util.Base64._utf8_decode(a)}return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var d="";var f=0;var g,e,b;g=e=b=0;while(f<a.length){g=a.charCodeAt(f);if(g<128){d+=String.fromCharCode(g);f++}else{if((g>191)&&(g<224)){e=a.charCodeAt(f+1);d+=String.fromCharCode(((g&31)<<6)|(e&63));f+=2}else{e=a.charCodeAt(f+1);b=a.charCodeAt(f+2);d+=String.fromCharCode(((g&15)<<12)|((e&63)<<6)|(b&63));f+=3}}}return d},_destrip:function(f){f.replace(/ /g,"");var b=[];var e=f.length/76;for(var d=0;d<e;d++){b[d]=f.substr(d*76,76)}if(e!=f.length/76){b[b.length]=f.substr(e*76,f.length-(e*76))}var a="";for(var d=0;d<b.length;d++){a+=b[d]+"\n"}return a},decodeAsArray:function(b){var e=this.decode(b);var a=[];for(var d=0;d<e.length;d++){a[d]=e.charCodeAt(d)}return a},decodeGEONExT:function(a){return decodeAsArray(destrip(a),false)}};JXG.Util.asciiCharCodeAt=function(b,a){var d=b.charCodeAt(a);if(d>255){switch(d){case 8364:d=128;break;case 8218:d=130;break;case 402:d=131;break;case 8222:d=132;break;case 8230:d=133;break;case 8224:d=134;break;case 8225:d=135;break;case 710:d=136;break;case 8240:d=137;break;case 352:d=138;break;case 8249:d=139;break;case 338:d=140;break;case 381:d=142;break;case 8216:d=145;break;case 8217:d=146;break;case 8220:d=147;break;case 8221:d=148;break;case 8226:d=149;break;case 8211:d=150;break;case 8212:d=151;break;case 732:d=152;break;case 8482:d=153;break;case 353:d=154;break;case 8250:d=155;break;case 339:d=156;break;case 382:d=158;break;case 376:d=159;break;default:break}}return d};JXG.PsTricks=new function(){this.psTricksString=""};JXG.PsTricks.convertBoardToPsTricks=function(b){var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b.canvasWidth,b.canvasHeight],b);var d=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],b);this.psTricksString="\\begin{pspicture*}("+d.usrCoords[1]+","+e.usrCoords[2]+")("+e.usrCoords[1]+","+d.usrCoords[2]+")\n";for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_ARC){if(f.visProp.visible){this.addSector(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_POLYGON){if(f.visProp.visible){this.addPolygon(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_ANGLE){if(f.visProp.visible){this.addAngle(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_CIRCLE){if(f.visProp.visible){this.addCircle(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_ARC){if(f.visProp.visible){this.addArc(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_LINE){if(f.visProp.visible){this.addLine(f)}}}for(var a in b.objects){var f=b.objects[a];if(f.type==JXG.OBJECT_TYPE_POINT){if(f.visProp.visible){this.addPoint(f)}}}this.psTricksString+="\\end{pspicture*}"};JXG.PsTricks.givePsTricksToDiv=function(a,b){this.convertBoardToPsTricks(b);document.getElementById(a).innerHTML=this.psTricksString};JXG.PsTricks.addPoint=function(a){this.psTricksString+="\\psdot";this.psTricksString+="[linecolor="+this.parseColor(a.visProp.strokeColor)+",";this.psTricksString+="dotstyle=";if(a.visProp.face=="cross"){this.psTricksString+="x, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}else{if(a.visProp.face=="circle"){this.psTricksString+="*, dotsize=";if(a.visProp.size==1){this.psTricksString+="2pt 2"}else{if(a.visProp.size==2){this.psTricksString+="4pt 2"}else{if(a.visProp.size==3){this.psTricksString+="6pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="6pt 3"}}}}}else{if(a.visProp.face=="square"){this.psTricksString+="square*, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}else{if(a.visProp.face=="plus"){this.psTricksString+="+, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}}}}this.psTricksString+="]";this.psTricksString+="("+a.coords.usrCoords[1]+","+a.coords.usrCoords[2]+")\n";this.psTricksString+="\\rput("+(a.coords.usrCoords[1]+15/a.board.unitY/a.board.zoomY)+","+(a.coords.usrCoords[2]+15/a.board.unitY/a.board.zoomY)+"){\\small $"+a.name+"$}\n"};JXG.PsTricks.addLine=function(d){var b=new JXG.Coords(JXG.COORDS_BY_USER,d.point1.coords.usrCoords,d.board);var a=new JXG.Coords(JXG.COORDS_BY_USER,d.point2.coords.usrCoords,d.board);if(d.visProp.straightFirst||d.visProp.straightLast){d.board.renderer.calcStraight(d,b,a)}this.psTricksString+="\\psline";this.psTricksString+="[linecolor="+this.parseColor(d.visProp.strokeColor)+", linewidth="+d.visProp.strokeWidth+"px";this.psTricksString+="]";if(d.visProp.firstArrow){if(d.visProp.lastArrow){this.psTricksString+="{<->}"}else{this.psTricksString+="{<-}"}}else{if(d.visProp.lastArrow){this.psTricksString+="{->}"}}this.psTricksString+="("+b.usrCoords[1]+","+b.usrCoords[2]+")("+a.usrCoords[1]+","+a.usrCoords[2]+")\n"};JXG.PsTricks.addCircle=function(b){var a=b.getRadius();this.psTricksString+="\\pscircle";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+=", fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)}this.psTricksString+="]";this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}\n"};JXG.PsTricks.addPolygon=function(b){this.psTricksString+="\\pspolygon";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";for(var a=0;a<b.vertices.length;a++){this.psTricksString+="("+b.vertices[a].coords.usrCoords[1]+","+b.vertices[a].coords.usrCoords[2]+")"}this.psTricksString+="\n"};JXG.PsTricks.addArc=function(b){var a=b.getRadius();var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.unitY*b.board.zoomY),b.midpoint.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point2),4);var f=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point3),4);this.psTricksString+="\\psarc";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";this.psTricksString+="]";if(b.visProp.lastArrow){if(b.visProp.firstArrow){this.psTricksString+="{<->}"}else{this.psTricksString+="{<-}"}}else{if(b.visProp.firstArrow){this.psTricksString+="{->}"}}this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+f+"}\n"};JXG.PsTricks.addSector=function(b){var a=b.getRadius();var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.unitY*b.board.zoomY),b.midpoint.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point2),4);var f=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point3),4);if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+="\\pswedge";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+f+"}\n"}};JXG.PsTricks.addAngle=function(b){var a=b.radius;var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.unitY*b.board.zoomY),b.point2.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.point2,b.point1),4);var f=JXG.Math.round(b.board.algebra.trueAngle(e,b.point2,b.point3),4);if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+="\\pswedge";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";this.psTricksString+="("+b.point2.coords.usrCoords[1]+","+b.point2.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+f+"}\n"}this.psTricksString+="\\psarc";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";this.psTricksString+="]";this.psTricksString+="("+b.point2.coords.usrCoords[1]+","+b.point2.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+f+"}\n"};JXG.PsTricks.parseColor=function(a){var b=new JXG.RGBColor(a);return"{[rgb]{"+b.r/255+","+b.g/255+","+b.b/255+"}}"};JXG.SVGRenderer=function(a){this.constructor();this.svgRoot=null;this.suspendHandle=null;this.svgNamespace="http://www.w3.org/2000/svg";this.xlinkNamespace="http://www.w3.org/1999/xlink";this.container=a;this.container.style.MozUserSelect="none";this.container.style.overflow="hidden";if(this.container.style.position==""){this.container.style.position="relative"}this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg");this.container.appendChild(this.svgRoot);this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs");this.svgRoot.appendChild(this.defs);this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter");this.filter.setAttributeNS(null,"id","f1");this.filter.setAttributeNS(null,"width","300%");this.filter.setAttributeNS(null,"height","300%");this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset");this.feOffset.setAttributeNS(null,"result","offOut");this.feOffset.setAttributeNS(null,"in","SourceAlpha");this.feOffset.setAttributeNS(null,"dx","5");this.feOffset.setAttributeNS(null,"dy","5");this.filter.appendChild(this.feOffset);this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur");this.feGaussianBlur.setAttributeNS(null,"result","blurOut");this.feGaussianBlur.setAttributeNS(null,"in","offOut");this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3");this.filter.appendChild(this.feGaussianBlur);this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend");this.feBlend.setAttributeNS(null,"in","SourceGraphic");this.feBlend.setAttributeNS(null,"in2","blurOut");this.feBlend.setAttributeNS(null,"mode","normal");this.filter.appendChild(this.feBlend);this.defs.appendChild(this.filter);this.images=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.images);this.grid=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.grid);this.angles=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.angles);this.sectors=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.sectors);this.polygone=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.polygone);this.curves=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.curves);this.circles=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.circles);this.lines=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.lines);this.arcs=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.arcs);this.points=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.points);this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]};JXG.SVGRenderer.prototype=new JXG.AbstractRenderer;JXG.SVGRenderer.prototype.setShadow=function(a){if(a.rendNode!=null){if(a.visProp.shadow){a.rendNode.setAttributeNS(null,"filter","url(#f1)")}else{a.rendNode.removeAttributeNS(null,"filter")}}};JXG.SVGRenderer.prototype.setGradient=function(e){var o=e.rendNode;if(e.type==JXG.OBJECT_TYPE_ARC||e.type==JXG.OBJECT_TYPE_ANGLE){o=e.rendNode2}if(e.visProp.gradient=="linear"){var d=this.createPrimitive("linearGradient",e.id+"_gradient");var b="0%";var a="100%";var g="0%";var f="0%";d.setAttributeNS(null,"x1",b);d.setAttributeNS(null,"x2",a);d.setAttributeNS(null,"y1",g);d.setAttributeNS(null,"y2",f);var k=this.createPrimitive("stop",e.id+"_gradient1");k.setAttributeNS(null,"offset","0%");k.setAttributeNS(null,"style","stop-color:"+e.visProp.fillColor+";stop-opacity:"+e.visProp.fillOpacity);var h=this.createPrimitive("stop",e.id+"_gradient2");h.setAttributeNS(null,"offset","100%");h.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientSecondColor+";stop-opacity:"+e.visProp.gradientSecondOpacity);d.appendChild(k);d.appendChild(h);this.defs.appendChild(d);o.setAttributeNS(null,"style","fill:url(#"+e.id+"_gradient)")}else{if(e.visProp.gradient=="radial"){var d=this.createPrimitive("radialGradient",e.id+"_gradient");d.setAttributeNS(null,"cx","50%");d.setAttributeNS(null,"cy","50%");d.setAttributeNS(null,"r","50%");d.setAttributeNS(null,"fx",e.visProp.gradientPositonX*100+"%");d.setAttributeNS(null,"fy",e.visProp.gradientPositonY*100+"%");var k=this.createPrimitive("stop",e.id+"_gradient1");k.setAttributeNS(null,"offset","0%");k.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientSecondColor+";stop-opacity:"+e.visProp.gradientSecondOpacity);var h=this.createPrimitive("stop",e.id+"_gradient2");h.setAttributeNS(null,"offset","100%");h.setAttributeNS(null,"style","stop-color:"+e.visProp.fillColor+";stop-opacity:"+e.visProp.fillOpacity);d.appendChild(k);d.appendChild(h);this.defs.appendChild(d);o.setAttributeNS(null,"style","fill:url(#"+e.id+"_gradient)")}else{o.removeAttributeNS(null,"style")}}};JXG.SVGRenderer.prototype.displayCopyright=function(d,e){var b=this.createPrimitive("text","licenseText"),a;b.setAttributeNS(null,"x","20");b.setAttributeNS(null,"y",2+e);b.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+e+"px; fill:#356AA0;  opacity:0.3;");a=document.createTextNode(d);b.appendChild(a);this.appendChildPrimitive(b,"images")};JXG.SVGRenderer.prototype.drawTicks=function(a){var b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"path")};JXG.SVGRenderer.prototype.updateTicks=function(d,e,a,g,b){var f="",h,o,q,k=d.ticks.length;for(h=0;h<k;h++){o=d.ticks[h].scrCoords;if(d.ticks[h].major){if(d.labels[h].visProp.visible){this.drawText(d.labels[h])}f+="M "+(o[1]+e)+" "+(o[2]-a)+" L "+(o[1]-e)+" "+(o[2]+a)+" "}else{f+="M "+(o[1]+g)+" "+(o[2]-b)+" L "+(o[1]-g)+" "+(o[2]+b)+" "}}q=document.getElementById(d.id);if(q==null){q=this.createPrimitive("path",d.id);this.appendChildPrimitive(q,"lines");this.appendNodesToElement(d,"path")}q.setAttributeNS(null,"stroke",d.visProp.strokeColor);q.setAttributeNS(null,"stroke-opacity",d.visProp.strokeOpacity);q.setAttributeNS(null,"stroke-width",d.visProp.strokeWidth);this.updatePathPrimitive(q,f,d.board)};JXG.SVGRenderer.prototype.drawArc=function(b){var d=this.createPrimitive("path",b.id),h,e,a,k,f,g,q,o;b.rendNode=d;h=b.getRadius();e=b.board.algebra.trueAngle(b.point2,b.midpoint,b.point3);a={};a.midpoint=b.midpoint;a.getRadius=function(){return h};k=b.board.algebra.projectPointToCircle(b.point3,a);f="M "+b.point2.coords.scrCoords[1]+" "+b.point2.coords.scrCoords[2]+" A ";f+=Math.round(h*b.board.unitX*b.board.zoomX)+" "+Math.round(h*b.board.unitY*b.board.zoomY)+" 0 ";if(e>=180){f+="1 "}else{f+="0 "}f+="0 ";f+=k.scrCoords[1]+" "+k.scrCoords[2];this.updatePathPrimitive(d,f,b.board);if(b.visProp.strokeColor!=null){d.setAttributeNS(null,"stroke",b.visProp.strokeColor)}if(b.visProp.strokeOpacity!=null){d.setAttributeNS(null,"stroke-opacity",b.visProp.strokeOpacity)}if(b.visProp.strokeWidth!=null){d.setAttributeNS(null,"stroke-width",b.visProp.strokeWidth)}d.setAttributeNS(null,"fill","none");this.setDashStyle(b,b.visProp);this.setShadow(b);if(b.visProp.firstArrow){q=this.createArrowHead(b,"Start");this.defs.appendChild(q);b.rendNodeTriangleStart=q;d.setAttributeNS(null,"marker-end","url(#"+b.id+"TriangleStart)")}if(b.visProp.lastArrow){q=this.createArrowHead(b,"End");this.defs.appendChild(q);b.rendNodeTriangleEnd=q;d.setAttributeNS(null,"marker-start","url(#"+b.id+"TriangleEnd)")}o=this.createPrimitive("path",b.id+"sector");b.rendNode2=o;g="M "+b.midpoint.coords.scrCoords[1]+" "+b.midpoint.coords.scrCoords[2];g+=" L "+b.point2.coords.scrCoords[1]+" "+b.point2.coords.scrCoords[2]+" A ";g+=Math.round(h*b.board.unitX*b.board.zoomX)+" "+Math.round(h*b.board.unitY*b.board.zoomY)+" 0 ";if(e>=180){g+="1 "}else{g+="0 "}g+="0 ";g+=k.scrCoords[1]+" "+k.scrCoords[2];g+=" L "+b.midpoint.coords.scrCoords[1]+" "+b.midpoint.coords.scrCoords[2]+" z";this.updatePathPrimitive(o,g,b.board);if(b.visProp.fillColor!=null){o.setAttributeNS(null,"fill",b.visProp.fillColor)}if(b.visProp.fillOpacity!=null){o.setAttributeNS(null,"fill-opacity",b.visProp.fillOpacity)}o.setAttributeNS(null,"stroke","none");this.setGradient(b);this.arcs.appendChild(d);this.sectors.appendChild(o);if(b.visProp.draft){this.setDraft(b)}if(!b.visProp.visible){b.hideElement()}};JXG.SVGRenderer.prototype.updateArc=function(a){var b;this.remove(a.rendNode);this.remove(a.rendNode2);b=a.rendNodeTriangleStart;if(b!=null){this.remove(b)}b=a.rendNodeTriangleEnd;if(b!=null){this.remove(b)}this.drawArc(a);return};JXG.SVGRenderer.prototype.drawAngle=function(f){var k=f.board.algebra.trueAngle(f.point1,f.point2,f.point3),h,e,b,g,a,d;h={};h.midpoint=f.point2;h.getRadius=function(){return f.radius};e=f.board.algebra.projectPointToCircle(f.point1,h);b=f.board.algebra.projectPointToCircle(f.point3,h);g=this.createPrimitive("path",f.id+"_1");d="M "+f.point2.coords.scrCoords[1]+" "+f.point2.coords.scrCoords[2];d+=" L "+e.scrCoords[1]+" "+e.scrCoords[2]+" A ";d+=Math.round(f.radius*f.board.unitX*f.board.zoomX)+" "+Math.round(f.radius*f.board.unitY*f.board.zoomY)+" 0 ";if(k>=180){d+="1 "}else{d+="0 "}d+="0 ";d+=b.scrCoords[1]+" "+b.scrCoords[2];d+=" L "+f.point2.coords.scrCoords[1]+" "+f.point2.coords.scrCoords[2]+" z";g.setAttributeNS(null,"d",d);g.setAttributeNS(null,"fill",f.visProp.fillColor);g.setAttributeNS(null,"fill-opacity",f.visProp.fillOpacity);g.setAttributeNS(null,"stroke","none");a=this.createPrimitive("path",f.id+"_2");d="M "+e.scrCoords[1]+" "+e.scrCoords[2]+" A ";d+=Math.round(f.radius*f.board.unitX*f.board.zoomX)+" "+Math.round(f.radius*f.board.unitY*f.board.zoomY)+" 0 ";if(k>=180){d+="1 "}else{d+="0 "}d+="0 ";d+=b.scrCoords[1]+" "+b.scrCoords[2];a.setAttributeNS(null,"d",d);a.setAttributeNS(null,"id",f.id+"_2");a.setAttributeNS(null,"fill","none");a.setAttributeNS(null,"stroke",f.visProp.strokeColor);a.setAttributeNS(null,"stroke-opacity",f.visProp.strokeOpacity);this.appendChildPrimitive(g,"angles");f.rendNode=g;this.setShadow(f);this.appendChildPrimitive(a,"angles");f.rendNode2=a;this.setObjectStrokeWidth(f,f.visProp.strokeWidth)};JXG.SVGRenderer.prototype.updateAngle=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawAngle(a);if(!a.visProp.visible){a.hideElement()}return};JXG.SVGRenderer.prototype.drawImage=function(b){var a="data:image/png;base64,"+b.imageBase64String,d=this.createPrimitive("image",b.id);d.setAttributeNS(this.xlinkNamespace,"xlink:href",a);this.appendChildPrimitive(d,b.displayLevel);b.rendNode=d;this.updateImage(b)};JXG.SVGRenderer.prototype.transformImage=function(b,a){var d=b.rendNode,e=d.getAttributeNS(null,"transform");e+=" "+this.joinTransforms(b,a);d.setAttributeNS(null,"transform",e)};JXG.SVGRenderer.prototype.joinTransforms=function(f,d){var g="",b,e,a=d.length;for(b=0;b<a;b++){e=d[b].matrix[1][1]+","+d[b].matrix[2][1]+","+d[b].matrix[1][2]+","+d[b].matrix[2][2]+","+d[b].matrix[1][0]+","+d[b].matrix[2][0];g+="matrix("+e+") "}return g};JXG.SVGRenderer.prototype.transformImageParent=function(d,a){var b,e;if(a!=null){b=a[1][1]+","+a[2][1]+","+a[1][2]+","+a[2][2]+","+a[1][0]+","+a[2][0];e="matrix("+b+")"}else{e=""}d.rendNode.setAttributeNS(null,"transform",e)};JXG.SVGRenderer.prototype.removeGrid=function(a){var b=this.grid;a.hasGrid=false;while(b.childNodes.length>0){b.removeChild(b.firstChild)}};JXG.SVGRenderer.prototype.setObjectStrokeColor=function(d,a,b){var g,f,e;if(b==undefined){b=1}if(typeof b=="function"){f=b()}else{f=b}f=(f>0)?f:0;if(typeof a=="function"){g=a()}else{g=a}e=d.rendNode;if(d.type==JXG.OBJECT_TYPE_TEXT){e.style.color=g}else{e.setAttributeNS(null,"stroke",g);e.setAttributeNS(null,"stroke-opacity",f)}if(d.type==JXG.OBJECT_TYPE_ARROW){d.rendNodeTriangle.setAttributeNS(null,"stroke",g);d.rendNodeTriangle.setAttributeNS(null,"stroke-opacity",f);d.rendNodeTriangle.setAttributeNS(null,"fill",g);d.rendNodeTriangle.setAttributeNS(null,"fill-opacity",f)}if(d.type==JXG.OBJECT_TYPE_ARC){if(d.visProp.firstArrow){d.rendNodeTriangleStart.setAttributeNS(null,"stroke",g);d.rendNodeTriangleStart.setAttributeNS(null,"stroke-opacity",f);d.rendNodeTriangleStart.setAttributeNS(null,"fill",g);d.rendNodeTriangleStart.setAttributeNS(null,"fill-opacity",f)}if(d.visProp.lastArrow){d.rendNodeTriangleEnd.setAttributeNS(null,"stroke",g);d.rendNodeTriangleEnd.setAttributeNS(null,"stroke-opacity",f);d.rendNodeTriangleEnd.setAttributeNS(null,"fill",g);d.rendNodeTriangleEnd.setAttributeNS(null,"fill-opacity",f)}}else{if(d.type==JXG.OBJECT_TYPE_LINE){if(d.visProp.firstArrow){d.rendNodeTriangleStart.setAttributeNS(null,"stroke",g);d.rendNodeTriangleStart.setAttributeNS(null,"stroke-opacity",f);d.rendNodeTriangleStart.setAttributeNS(null,"fill",g);d.rendNodeTriangleStart.setAttributeNS(null,"fill-opacity",f)}if(d.visProp.lastArrow){d.rendNodeTriangleEnd.setAttributeNS(null,"stroke",g);d.rendNodeTriangleEnd.setAttributeNS(null,"stroke-opacity",f);d.rendNodeTriangleEnd.setAttributeNS(null,"fill",g);d.rendNodeTriangleEnd.setAttributeNS(null,"fill-opacity",f)}}}};JXG.SVGRenderer.prototype.setObjectFillColor=function(d,a,b){var g,f,e;if(b==undefined){b=1}if(typeof b=="function"){f=b()}else{f=b}f=(f>0)?f:0;if(typeof a=="function"){g=a()}else{g=a}if(d.type==JXG.OBJECT_TYPE_ARC||d.type==JXG.OBJECT_TYPE_ANGLE){e=d.rendNode2;e.setAttributeNS(null,"fill",g);e.setAttributeNS(null,"fill-opacity",f)}else{e=d.rendNode;e.setAttributeNS(null,"fill",g);e.setAttributeNS(null,"fill-opacity",f)}};JXG.SVGRenderer.prototype.setObjectStrokeWidth=function(d,b){var a,e;if(typeof b=="function"){a=b()}else{a=b}if(d.elementClass!=JXG.OBJECT_CLASS_POINT){e;if(d.type==JXG.OBJECT_TYPE_ANGLE){e=d.rendNode2}else{e=d.rendNode}this.setPropertyPrimitive(e,"stroked","true");if(a!=null){this.setPropertyPrimitive(e,"stroke-width",a)}}else{e=d.rendNode;this.setPropertyPrimitive(e,"stroked","true");if(a!=null){this.setPropertyPrimitive(e,"stroke-width",a)}}};JXG.SVGRenderer.prototype.hide=function(a){var b;if(a==null){return}if(a.type==JXG.OBJECT_TYPE_ARC){b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden";b=a.rendNode2;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}else{if(a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden";b=a.rendNode2;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}else{b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}}};JXG.SVGRenderer.prototype.show=function(a){var b;if(a.type==JXG.OBJECT_TYPE_ARC){b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit";b=a.rendNode2;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}else{if(a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit";b=a.rendNode2;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}else{b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}}};JXG.SVGRenderer.prototype.remove=function(a){if(a!=null&&a.parentNode!=null){a.parentNode.removeChild(a)}};JXG.SVGRenderer.prototype.suspendRedraw=function(){if(true){this.suspendHandle=this.svgRoot.suspendRedraw(10000)}};JXG.SVGRenderer.prototype.unsuspendRedraw=function(){if(true){this.svgRoot.unsuspendRedraw(this.suspendHandle);this.svgRoot.forceRedraw()}};JXG.SVGRenderer.prototype.setDashStyle=function(b,a){var e=b.visProp.dash,d=b.rendNode;if(b.visProp.dash>0){d.setAttributeNS(null,"stroke-dasharray",this.dashArray[e-1])}else{if(d.hasAttributeNS(null,"stroke-dasharray")){d.removeAttributeNS(null,"stroke-dasharray")}}};JXG.SVGRenderer.prototype.setGridDash=function(b){var a=document.getElementById(b);this.setPropertyPrimitive(a,"stroke-dasharray","5, 5")};JXG.SVGRenderer.prototype.createPrimitive=function(a,d){var b=this.container.ownerDocument.createElementNS(this.svgNamespace,a);b.setAttributeNS(null,"id",d);b.style.position="absolute";return b};JXG.SVGRenderer.prototype.createArrowHead=function(d,f){var e=d.id+"Triangle",b,a;if(f!=null){e+=f}b=this.createPrimitive("marker",e);b.setAttributeNS(null,"viewBox","0 0 10 6");b.setAttributeNS(null,"refY","3");b.setAttributeNS(null,"markerUnits","strokeWidth");b.setAttributeNS(null,"markerHeight","6");b.setAttributeNS(null,"markerWidth","6");b.setAttributeNS(null,"orient","auto");b.setAttributeNS(null,"stroke",d.visProp.strokeColor);b.setAttributeNS(null,"stroke-opacity",d.visProp.strokeOpacity);b.setAttributeNS(null,"fill",d.visProp.strokeColor);b.setAttributeNS(null,"fill-opacity",d.visProp.strokeOpacity);a=this.container.ownerDocument.createElementNS(this.svgNamespace,"path");if(f=="End"){b.setAttributeNS(null,"refX","0");a.setAttributeNS(null,"d","M 0 3 L 10 6 L 10 0 z")}else{b.setAttributeNS(null,"refX","10");a.setAttributeNS(null,"d","M 0 0 L 10 3 L 0 6 z")}b.appendChild(a);return b};JXG.SVGRenderer.prototype.makeArrow=function(d,b,e){var a=this.createArrowHead(b,e);this.defs.appendChild(a);d.setAttributeNS(null,"marker-end","url(#"+b.id+"Triangle)");b.rendNodeTriangle=a};JXG.SVGRenderer.prototype.makeArrows=function(b){var a;if(b.visProp.firstArrow){a=b.rendNodeTriangleStart;if(a==null){a=this.createArrowHead(b,"End");this.defs.appendChild(a);b.rendNodeTriangleStart=a;b.rendNode.setAttributeNS(null,"marker-start","url(#"+b.id+"TriangleEnd)")}}else{a=b.rendNodeTriangleStart;if(a!=null){this.remove(a)}}if(b.visProp.lastArrow){a=b.rendNodeTriangleEnd;if(a==null){a=this.createArrowHead(b,"Start");this.defs.appendChild(a);b.rendNodeTriangleEnd=a;b.rendNode.setAttributeNS(null,"marker-end","url(#"+b.id+"TriangleStart)")}}else{a=b.rendNodeTriangleEnd;if(a!=null){this.remove(a)}}};JXG.SVGRenderer.prototype.updateLinePrimitive=function(f,b,a,e,d){f.setAttributeNS(null,"x1",b);f.setAttributeNS(null,"y1",a);f.setAttributeNS(null,"x2",e);f.setAttributeNS(null,"y2",d)};JXG.SVGRenderer.prototype.updateCirclePrimitive=function(d,a,e,b){d.setAttributeNS(null,"cx",(a));d.setAttributeNS(null,"cy",(e));d.setAttributeNS(null,"r",(b))};JXG.SVGRenderer.prototype.updateEllipsePrimitive=function(b,a,f,e,d){b.setAttributeNS(null,"cx",(a));b.setAttributeNS(null,"cy",(f));b.setAttributeNS(null,"rx",(e));b.setAttributeNS(null,"ry",(d))};JXG.SVGRenderer.prototype.updateRectPrimitive=function(e,a,f,b,d){e.setAttributeNS(null,"x",(a));e.setAttributeNS(null,"y",(f));e.setAttributeNS(null,"width",(b));e.setAttributeNS(null,"height",(d))};JXG.SVGRenderer.prototype.updatePathPrimitive=function(b,d,a){b.setAttributeNS(null,"stroke-linecap","round");b.setAttributeNS(null,"stroke-linejoin","round");b.setAttributeNS(null,"d",d)};JXG.SVGRenderer.prototype.updatePathStringPrimitive=function(a){var q=-10000,g=-10000,d=" M ",e=" L ",b=d,o="",k=3*a.board.canvasHeight,y=100*a.board.canvasWidth,f,u,s,v=(a.curveType!="plot"),x=(a.curveType=="functiongraph");if(a.numberPoints<=0){return""}if(v&&a.board.options.curve.RDPsmoothing){a.points=this.RamenDouglasPeuker(a.points,0.5)}s=Math.min(a.points.length,a.numberPoints);for(f=0;f<s;f++){u=a.points[f].scrCoords;if(isNaN(u[1])||isNaN(u[2])||Math.abs(u[1])>y||(x&&(u[2]>k||u[2]<-0.5*k))){b=d}else{o+=[b,u[1]," ",u[2]].join("");b=e}q=u[1];g=u[2]}return o};JXG.SVGRenderer.prototype.updatePathStringPoint=function(e,a,d){var b="";if(d=="x"){b="M "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2]+a)+" M "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2]+a)}else{if(d=="+"){b="M "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2])+" L "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2])+" M "+(e.coords.scrCoords[1])+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1])+" "+(e.coords.scrCoords[2]+a)}}return b};JXG.SVGRenderer.prototype.updatePolygonePrimitive=function(f,d){var g="",e,b,a=d.vertices.length;f.setAttributeNS(null,"stroke","none");for(b=0;b<a-1;b++){e=d.vertices[b].coords.scrCoords;g=g+e[1]+","+e[2];if(b<a-2){g+=" "}}f.setAttributeNS(null,"points",g)};JXG.SVGRenderer.prototype.appendChildPrimitive=function(a,b){switch(b){case"images":this.images.appendChild(a);break;case"grid":this.grid.appendChild(a);break;case"angles":this.angles.appendChild(a);break;case"sectors":this.sectors.appendChild(a);break;case"polygone":this.polygone.appendChild(a);break;case"curves":this.lines.appendChild(a);break;case"circles":this.circles.appendChild(a);break;case"lines":this.lines.appendChild(a);break;case"arcs":this.arcs.appendChild(a);break;case"points":this.points.appendChild(a);break}};JXG.SVGRenderer.prototype.setPropertyPrimitive=function(b,a,d){if(a=="stroked"){return}b.setAttributeNS(null,a,d)};JXG.SVGRenderer.prototype.drawVerticalGrid=function(e,b,g,d){var f=this.createPrimitive("path","gridx"),a="";while(e.scrCoords[1]<b.scrCoords[1]+g-1){a+=" M "+e.scrCoords[1]+" "+0+" L "+e.scrCoords[1]+" "+d.canvasHeight+" ";e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1]+g,e.scrCoords[2]])}this.updatePathPrimitive(f,a,d);return f};JXG.SVGRenderer.prototype.drawHorizontalGrid=function(e,b,g,d){var f=this.createPrimitive("path","gridy"),a="";while(e.scrCoords[2]<=b.scrCoords[2]+g-1){a+=" M "+0+" "+e.scrCoords[2]+" L "+d.canvasWidth+" "+e.scrCoords[2]+" ";e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1],e.scrCoords[2]+g])}this.updatePathPrimitive(f,a,d);return f};JXG.SVGRenderer.prototype.appendNodesToElement=function(a,b){a.rendNode=document.getElementById(a.id)};JXG.VMLRenderer=function(a){this.constructor();this.container=a;this.container.style.overflow="hidden";this.container.onselectstart=function(){return false};this.resolution=10;a.ownerDocument.namespaces.add("v","urn:schemas-microsoft-com:vml");a.ownerDocument.createStyleSheet().addRule("v\\:*","behavior: url(#default#VML);");this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]};JXG.VMLRenderer.prototype=new JXG.AbstractRenderer;JXG.VMLRenderer.prototype.setShadow=function(a){var b=a.rendNodeShadow;if(a.visProp.shadow){b.setAttribute("On","True");b.setAttribute("Offset","3pt,3pt");b.setAttribute("Opacity","60%");b.setAttribute("Color","#aaaaaa")}else{b.setAttribute("On","False")}};JXG.VMLRenderer.prototype.setGradient=function(b){var a=b.rendNodeFill;if(b.type==JXG.OBJECT_TYPE_ARC||b.type==JXG.OBJECT_TYPE_ANGLE){a=b.rendNode2Fill}if(b.visProp.gradient=="linear"){a.setAttribute("type","gradient");a.setAttribute("color2",b.visProp.gradientSecondColor);a.setAttribute("opacity2",b.visProp.gradientSecondOpacity);a.setAttribute("angle",b.visProp.gradientAngle)}else{if(b.visProp.gradient=="radial"){a.setAttribute("type","gradientradial");a.setAttribute("color2",b.visProp.gradientSecondColor);a.setAttribute("opacity2",b.visProp.gradientSecondOpacity);a.setAttribute("focusposition",b.visProp.gradientPositonX*100+"%,"+b.visProp.gradientPositonY*100+"%");a.setAttribute("focussize","0,0")}else{a.setAttribute("type","solid")}}};JXG.VMLRenderer.prototype.addShadowToGroup=function(a,d){var b,e;if(a=="lines"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_LINE){this.addShadowToElement(e)}}}else{if(a=="points"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_POINT){this.addShadowToElement(e)}}}else{if(a=="circles"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_CIRCLE){this.addShadowToElement(e)}}}}}d.fullUpdate()};JXG.VMLRenderer.prototype.displayCopyright=function(d,e){var b,a;b=this.container.ownerDocument.createElement("v:textbox");b.style.position="absolute";b.setAttribute("id","licenseText");b.style.left=20;b.style.top=(2);b.style.fontSize=(e);b.style.color="#356AA0";b.style.fontFamily="Arial,Helvetica,sans-serif";b.setAttribute("opacity","30%");b.style.filter="alpha(opacity = 30)";a=document.createTextNode(d);b.appendChild(a);this.appendChildPrimitive(b,"images")};JXG.VMLRenderer.prototype.drawTicks=function(b){var a=this.createPrimitive("path",b.id);this.appendChildPrimitive(a,"lines");this.appendNodesToElement(b,"path")};JXG.VMLRenderer.prototype.updateTicks=function(e,f,a,g,d){var b=[],h,k,o,q;k=e.ticks.length;for(h=0;h<k;h++){o=e.ticks[h];if(o.major){if(e.labels[h].visProp.visible){this.drawText(e.labels[h])}b.push(" m "+Math.round(this.resolution*(o.scrCoords[1]+f))+", "+Math.round(this.resolution*(o.scrCoords[2]-a))+" l "+Math.round(this.resolution*(o.scrCoords[1]-f))+", "+Math.round(this.resolution*(o.scrCoords[2]+a))+" ")}else{b.push(" m "+Math.round(this.resolution*(o.scrCoords[1]+g))+", "+Math.round(this.resolution*(o.scrCoords[2]-d))+" l "+Math.round(this.resolution*(o.scrCoords[1]-g))+", "+Math.round(this.resolution*(o.scrCoords[2]+d))+" ")}}q=document.getElementById(e.id);if(q==null){q=this.createPrimitive("path",e.id);this.appendChildPrimitive(q,"lines");this.appendNodesToElement(e,"path")}q.setAttribute("stroked","true");q.setAttribute("strokecolor",e.visProp.strokeColor,1);q.setAttribute("strokeweight",e.visProp.strokeWidth);this.updatePathPrimitive(q,b,e.board)};JXG.VMLRenderer.prototype.drawArcLine=function(k,a,h,g,b,e,d){var f=this.container.ownerDocument.createElement("v:arc");f.setAttribute("id",k);fillNode=this.container.ownerDocument.createElement("v:fill");fillNode.setAttribute("id",k+"_fill");strokeNode=this.container.ownerDocument.createElement("v:stroke");strokeNode.setAttribute("id",k+"_stroke");shadowNode=this.container.ownerDocument.createElement("v:shadow");shadowNode.setAttribute("id",k+"_shadow");f.appendChild(fillNode);f.appendChild(strokeNode);f.appendChild(shadowNode);d.rendNode=f;d.rendNodeFill=fillNode;d.rendNodeStroke=strokeNode;d.rendNodeShadow=shadowNode;f.style.position="absolute";f.setAttribute("filled","false");f.style.left=(b.coords.scrCoords[1]-Math.round(a*e.unitX*e.zoomX))+"px";f.style.top=(b.coords.scrCoords[2]-Math.round(a*e.unitY*e.zoomY))+"px";f.style.width=(Math.round(a*e.unitX*e.zoomX)*2)+"px";f.style.height=(Math.round(a*e.unitY*e.zoomY)*2)+"px";f.setAttribute("startangle",h);f.setAttribute("endangle",g);return f};JXG.VMLRenderer.prototype.drawArcFill=function(a,e,u,k,g,f,d){var s,q,o,h,b;a=a+"sector";fillNode=this.container.ownerDocument.createElement("v:fill");fillNode.setAttribute("id",a+"_fill");strokeNode=this.container.ownerDocument.createElement("v:stroke");strokeNode.setAttribute("id",a+"_stroke");shadowNode=this.container.ownerDocument.createElement("v:shadow");shadowNode.setAttribute("id",a+"_shadow");pathNode=this.container.ownerDocument.createElement("v:path");pathNode.setAttribute("id",a+"_path");s=this.container.ownerDocument.createElement("v:shape");s.appendChild(fillNode);s.appendChild(strokeNode);s.appendChild(shadowNode);s.appendChild(pathNode);s.setAttribute("id",a);s.style.position="absolute";d.rendNode2=s;d.rendNode2Fill=fillNode;d.rendNode2Stroke=strokeNode;d.rendNode2Shadow=shadowNode;d.rendNode2Path=pathNode;s.setAttribute("stroked","false");q=Math.round(e*f.unitX*f.zoomX);o=Math.round(e*f.unitY*f.zoomY);s.style.width=q;s.style.height=o;s.setAttribute("coordsize",q+","+o);b="m "+u.coords.scrCoords[1]+","+u.coords.scrCoords[2]+" l ";b+=k.coords.scrCoords[1]+","+k.coords.scrCoords[2]+" at ";b+=(u.coords.scrCoords[1]-q)+","+(u.coords.scrCoords[2]-o)+",";b+=(u.coords.scrCoords[1]+q)+","+(u.coords.scrCoords[2]+o);b+=" "+k.coords.scrCoords[1]+","+k.coords.scrCoords[2];b+=", "+g.coords.scrCoords[1]+","+g.coords.scrCoords[2]+" l ";b+=u.coords.scrCoords[1]+","+u.coords.scrCoords[2]+" x e";pathNode.setAttribute("v",b);return s};JXG.VMLRenderer.prototype.drawArc=function(b){var h,a={},g,f,e,d,o,k={};h=b.getRadius();a.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.midpoint.coords.usrCoords[1],b.board.origin.scrCoords[2]/(b.board.unitY*b.board.zoomY)],b.board);f=b.board.algebra.trueAngle(b.point2,b.midpoint,a);g=b.board.algebra.trueAngle(b.point3,b.midpoint,a);if(f<g){g-=360}e=this.drawArcLine(b.id,h,g,f,b.midpoint,b.board,b);d=b.rendNodeStroke;if(b.visProp.lastArrow){d.setAttribute("endarrow","block");d.setAttribute("endarrowlength","long")}if(b.visProp.firstArrow){d.setAttribute("startarrow","block");d.setAttribute("startarrowlength","long")}this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setDashStyle(b,b.visProp);this.setShadow(b);k.coords=b.board.algebra.projectPointToCircle(b.point3,b);o=this.drawArcFill(b.id,h,b.midpoint,b.point2,k,b.board,b);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);this.setGradient(b);this.appendChildPrimitive(e,"lines");this.appendChildPrimitive(o,"angles");if(b.visProp.draft){this.setDraft(b)}};JXG.AbstractRenderer.prototype.updateArc=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawArc(a);return};JXG.VMLRenderer.prototype.drawAngle=function(e){var a={},v,u,b={},k,h,f,g,d,s={},o={},q;a.midpoint=e.point2;a.getRadius=function(){return e.radius};v=e.board.algebra.projectPointToCircle(e.point1,a);u=e.board.algebra.projectPointToCircle(e.point3,a);b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[e.point2.coords.usrCoords[1],e.board.origin.scrCoords[2]/(e.board.unitY*e.board.zoomY)],e.board);h=e.board.algebra.trueAngle(e.point1,e.point2,b);k=e.board.algebra.trueAngle(e.point3,e.point2,b);if(h<k){k-=360}f=this.drawArcLine(e.id,e.radius,k,h,e.point2,e.board,e);this.setObjectStrokeColor(e,e.visProp.strokeColor,e.visProp.strokeOpacity);this.setObjectStrokeWidth(e,e.visProp.strokeWidth);g=e.visProp.dash;d=e.rendNodeStroke;d.setAttribute("dashstyle",this.dashArray[g]);this.setShadow(e);s.coords=v;o.coords=u;q=this.drawArcFill(e.id,e.radius,e.point2,s,o,e.board,e);this.setObjectFillColor(e,e.visProp.fillColor,e.visProp.fillOpacity);this.appendChildPrimitive(f,"lines");this.appendChildPrimitive(q,"angles");if(e.visProp.draft){this.setDraft(e)}if(!e.visProp.visible){e.hideElement(e)}};JXG.VMLRenderer.prototype.updateAngle=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawAngle(a);return};JXG.VMLRenderer.prototype.drawImage=function(b){var d,a;a="data:image/png;base64,"+b.imageBase64String;d=this.container.ownerDocument.createElement("img");d.style.position="absolute";d.setAttribute("id",b.id);d.setAttribute("src",a);this.container.appendChild(d);this.appendChildPrimitive(d,b.displayLevel);d.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand')";b.rendNode=d;this.updateImage(b)};JXG.VMLRenderer.prototype.transformImage=function(d,b){var e=d.rendNode,a;a=this.joinTransforms(d,b);e.style.left=(d.coords.scrCoords[1]+a[1][0])+"px";e.style.top=(d.coords.scrCoords[2]-d.size[1]+a[2][0])+"px";e.filters.item(0).M11=a[1][1];e.filters.item(0).M12=a[1][2];e.filters.item(0).M21=a[2][1];e.filters.item(0).M22=a[2][2]};JXG.VMLRenderer.prototype.joinTransforms=function(f,e){var b=[[1,0,0],[0,1,0],[0,0,1]],d,a=e.length;for(d=0;d<a;d++){b=JXG.Math.matMatMult(e[d].matrix,b)}return b};JXG.VMLRenderer.prototype.transformImageParent=function(b,a){};JXG.VMLRenderer.prototype.removeGrid=function(a){var b=document.getElementById("gridx");this.remove(b);b=document.getElementById("gridy");this.remove(b);a.hasGrid=false};JXG.VMLRenderer.prototype.hide=function(a){var b=a.rendNode;b.style.visibility="hidden";if(a.type==JXG.OBJECT_TYPE_ARC||a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode2;b.style.visibility="hidden"}};JXG.VMLRenderer.prototype.show=function(a){var b=a.rendNode;b.style.visibility="inherit";if(a.type==JXG.OBJECT_TYPE_ARC||a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode2;b.style.visibility="inherit"}};JXG.VMLRenderer.prototype.setDashStyle=function(b,a){var d;if(a.dash>=0){d=b.rendNodeStroke;d.setAttribute("dashstyle",this.dashArray[a.dash])}};JXG.VMLRenderer.prototype.setObjectStrokeColor=function(e,a,b){var h,g,f,d;if(typeof b=="function"){g=b()}else{g=b}g=(g>0)?g:0;if(typeof a=="function"){h=a()}else{h=a}if(e.type==JXG.OBJECT_TYPE_TEXT){e.rendNode.style.color=h}else{f=e.rendNode;f.setAttribute("stroked","true");f.setAttribute("strokecolor",h);if(e.id=="gridx"){d=document.getElementById("gridx_stroke")}else{if(e.id=="gridy"){d=document.getElementById("gridy_stroke")}else{d=e.rendNodeStroke}}if(g!=undefined){d.setAttribute("opacity",(g*100)+"%")}}};JXG.VMLRenderer.prototype.setObjectFillColor=function(d,a,b){var f,e;if(typeof b=="function"){e=b()}else{e=b}e=(e>0)?e:0;if(typeof a=="function"){f=a()}else{f=a}if(d.type==JXG.OBJECT_TYPE_ARC||d.type==JXG.OBJECT_TYPE_ANGLE){if(f=="none"){d.rendNode2.setAttribute("filled","false")}else{d.rendNode2.setAttribute("filled","true");d.rendNode2.setAttribute("fillcolor",f);if(e!=undefined){d.rendNode2Fill.setAttribute("opacity",(e*100)+"%")}}}else{if(f=="none"){d.rendNode.setAttribute("filled","false")}else{d.rendNode.setAttribute("filled","true");d.rendNode.setAttribute("fillcolor",f);if(e!=undefined){d.rendNodeFill.setAttribute("opacity",(e*100)+"%")}}}};JXG.VMLRenderer.prototype.remove=function(a){if(a!=null){a.removeNode(true)}};JXG.VMLRenderer.prototype.suspendRedraw=function(){this.container.style.display="none"};JXG.VMLRenderer.prototype.unsuspendRedraw=function(){this.container.style.display=""};JXG.VMLRenderer.prototype.setAttributes=function(e,d,h,b){var g,a,f;len=d.length;for(a=0;a<len;a++){f=d[a];if(b[f]!=null){if(typeof b[f]=="function"){g=b[f]();g=(g>0)?g:0}else{g=b[f]}e.setAttribute(h[a],g)}}};JXG.VMLRenderer.prototype.setGridDash=function(b,a){var a=document.getElementById(b+"_stroke");a.setAttribute("dashstyle","Dash")};JXG.VMLRenderer.prototype.setObjectStrokeWidth=function(d,b){var a,e;if(typeof b=="function"){a=b()}else{a=b}if(d.elementClass!=JXG.OBJECT_CLASS_POINT){e=d.rendNode;this.setPropertyPrimitive(e,"stroked","true");if(a!=null){this.setPropertyPrimitive(e,"stroke-width",a)}}else{e=d.rendNode;this.setPropertyPrimitive(e,"stroked","true");if(a!=null){this.setPropertyPrimitive(e,"stroke-width",a)}}};JXG.VMLRenderer.prototype.createPrimitive=function(b,h){var d,a,g,f,e;a=this.container.ownerDocument.createElement("v:fill");a.setAttribute("id",h+"_fill");g=this.container.ownerDocument.createElement("v:stroke");g.setAttribute("id",h+"_stroke");f=this.container.ownerDocument.createElement("v:shadow");f.setAttribute("id",h+"_shadow");if(b=="circle"||b=="ellipse"){d=this.container.ownerDocument.createElement("v:oval");d.appendChild(a);d.appendChild(g);d.appendChild(f)}else{if(b=="polygon"||b=="path"||b=="shape"){d=this.container.ownerDocument.createElement("v:shape");d.appendChild(a);d.appendChild(g);d.appendChild(f);e=this.container.ownerDocument.createElement("v:path");e.setAttribute("id",h+"_path");d.appendChild(e)}else{d=this.container.ownerDocument.createElement("v:"+b);d.appendChild(a);d.appendChild(g);d.appendChild(f)}}d.style.position="absolute";d.setAttribute("id",h);return d};JXG.VMLRenderer.prototype.appendNodesToElement=function(a,b){if(b=="shape"||b=="path"||b=="polygon"){a.rendNodePath=document.getElementById(a.id+"_path")}a.rendNodeFill=document.getElementById(a.id+"_fill");a.rendNodeStroke=document.getElementById(a.id+"_stroke");a.rendNodeShadow=document.getElementById(a.id+"_shadow");a.rendNode=document.getElementById(a.id)};JXG.VMLRenderer.prototype.makeArrow=function(d,b,e){var a=b.rendNodeStroke;a.setAttribute("endarrow","block");a.setAttribute("endarrowlength","long")};JXG.VMLRenderer.prototype.makeArrows=function(b){var a;if(b.visProp.firstArrow){a=b.rendNodeStroke;a.setAttribute("startarrow","block");a.setAttribute("startarrowlength","long")}else{a=b.rendNodeStroke;if(a!=null){a.setAttribute("startarrow","none")}}if(b.visProp.lastArrow){a=b.rendNodeStroke;a.setAttribute("id",b.id+"stroke");a.setAttribute("endarrow","block");a.setAttribute("endarrowlength","long")}else{a=b.rendNodeStroke;if(a!=null){a.setAttribute("endarrow","none")}}};JXG.VMLRenderer.prototype.updateLinePrimitive=function(f,b,a,e,d){f.setAttribute("from",[b,a].join(","));f.setAttribute("to",[e,d].join(","))};JXG.VMLRenderer.prototype.updateCirclePrimitive=function(d,a,e,b){d.style.left=(a-b)+"px";d.style.top=(e-b)+"px";d.style.width=(b*2)+"px";d.style.height=(b*2)+"px"};JXG.VMLRenderer.prototype.updateRectPrimitive=function(e,a,f,b,d){e.style.left=(a)+"px";e.style.top=(f)+"px";e.style.width=(b)+"px";e.style.height=(d)+"px"};JXG.VMLRenderer.prototype.updateEllipsePrimitive=function(b,a,f,e,d){b.style.left=(a-e)+"px";b.style.top=(f-d)+"px";b.style.width=(e*2)+"px";b.style.height=(d*2)+"px"};JXG.VMLRenderer.prototype.updatePathPrimitive=function(d,e,b){var a=b.canvasWidth,f=b.canvasHeight;d.style.width=a;d.style.height=f;d.setAttribute("coordsize",(this.resolution*a)+","+(this.resolution*f));d.setAttribute("path",e.join(""))};JXG.VMLRenderer.prototype.updatePathStringPrimitive=function(a){var q=-10000,g=-10000,o=[],k=3*a.board.canvasHeight,y=100*a.board.canvasWidth,s=Math.min(a.numberPoints,8192),f,u,d=" m ",e=" l ",b=d,v=(a.curveType!="plot"),x=(a.curveType=="functiongraph");if(a.numberPoints<=0){return""}if(v&&a.board.options.curve.RDPsmoothing){a.points=this.RamenDouglasPeuker(a.points,1)}s=Math.min(s,a.points.length);for(f=0;f<s;f++){u=a.points[f].scrCoords;if(isNaN(u[1])||isNaN(u[2])||Math.abs(u[1])>y||(x&&(u[2]>k||u[2]<-0.5*k))){b=d}else{o.push([b,Math.round(this.resolution*u[1]),", ",Math.round(this.resolution*u[2])].join(""));b=e}q=u[1];g=u[2]}o.push(" e");return o};JXG.VMLRenderer.prototype.updatePathStringPoint=function(e,a,d){var b=[];if(d=="x"){b.push("m "+(this.resolution*(e.coords.scrCoords[1]-a))+", "+(this.resolution*(e.coords.scrCoords[2]-a))+" l "+(this.resolution*(e.coords.scrCoords[1]+a))+", "+(this.resolution*(e.coords.scrCoords[2]+a))+" m "+(this.resolution*(e.coords.scrCoords[1]+a))+", "+(this.resolution*(e.coords.scrCoords[2]-a))+" l "+(this.resolution*(e.coords.scrCoords[1]-a))+", "+(this.resolution*(e.coords.scrCoords[2]+a)))}else{if(d=="+"){b.push("m "+(this.resolution*(e.coords.scrCoords[1]-a))+", "+(this.resolution*(e.coords.scrCoords[2]))+" l "+(this.resolution*(e.coords.scrCoords[1]+a))+", "+(this.resolution*(e.coords.scrCoords[2]))+" m "+(this.resolution*(e.coords.scrCoords[1]))+", "+(this.resolution*(e.coords.scrCoords[2]-a))+" l "+(this.resolution*(e.coords.scrCoords[1]))+", "+(this.resolution*(e.coords.scrCoords[2]+a)))}}return b};JXG.VMLRenderer.prototype.updatePolygonePrimitive=function(f,d){var g=d.vertices[0].coords.scrCoords[1],b=d.vertices[0].coords.scrCoords[1],e=d.vertices[0].coords.scrCoords[2],a=d.vertices[0].coords.scrCoords[2],h,o=d.vertices.length,u,s,q,k=[];f.setAttribute("stroked","false");for(h=1;h<o-1;h++){u=d.vertices[h].coords.scrCoords;if(u[1]<g){g=u[1]}if(u[1]>b){b=u[1]}if(u[2]<e){e=u[2]}if(u[2]>a){a=u[2]}}s=Math.round(b-g);q=Math.round(a-e);f.style.width=s;f.style.height=q;f.setAttribute("coordsize",s+","+q);k.push("m ");u=d.vertices[0].coords.scrCoords;k.push(u[1]+","+u[2]);k.push(" l ");for(h=1;h<o-1;h++){u=d.vertices[h].coords.scrCoords;k.push(u[1]+","+u[2]);if(h<o-2){k.push(", ")}}k.push(" x e");f.setAttribute("path",k.join(""))};JXG.VMLRenderer.prototype.appendChildPrimitive=function(a,b){switch(b){case"images":a.style.zIndex="1";break;case"grid":a.style.zIndex="1";break;case"angles":a.style.zIndex="2";break;case"sectors":a.style.zIndex="2";break;case"polygone":a.style.zIndex="2";break;case"curves":a.style.zIndex="4";break;case"circles":a.style.zIndex="4";break;case"lines":a.style.zIndex="4";break;case"arcs":a.style.zIndex="4";break;case"points":a.style.zIndex="5";break}this.container.appendChild(a)};JXG.VMLRenderer.prototype.setPropertyPrimitive=function(f,e,g){var d="",a,b;switch(e){case"stroke":d="strokecolor";break;case"stroke-width":d="strokeweight";break;case"stroke-dasharray":d="dashstyle";break}if(d!=""){b;if(typeof g=="function"){b=g()}else{b=g}f.setAttribute(d,b)}};JXG.VMLRenderer.prototype.drawVerticalGrid=function(e,b,g,d){var f=this.createPrimitive("path","gridx"),a=[];while(e.scrCoords[1]<b.scrCoords[1]+g-1){a.push(" m "+(this.resolution*e.scrCoords[1])+", "+0+" l "+(this.resolution*e.scrCoords[1])+", "+(this.resolution*d.canvasHeight)+" ");e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1]+g,e.scrCoords[2]])}this.updatePathPrimitive(f,a,d);return f};JXG.VMLRenderer.prototype.drawHorizontalGrid=function(e,b,g,d){var f=this.createPrimitive("path","gridy"),a=[];while(e.scrCoords[2]<=b.scrCoords[2]+g-1){a.push(" m "+0+", "+(this.resolution*e.scrCoords[2])+" l "+(this.resolution*d.canvasWidth)+", "+(this.resolution*e.scrCoords[2])+" ");e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1],e.scrCoords[2]+g])}this.updatePathPrimitive(f,a,d);return f};