/*
    Copyright 2008, 
        Matthias Ehmann,
        Michael Gerhaeuser,
        Carsten Miller,
        Bianca Valentin,
        Alfred Wassermann,
        Peter Wilfahrt

    This file is part of JSXGraph.

    JSXGraph is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    JSXGraph is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with JSXGraph.  If not, see <http://www.gnu.org/licenses/>.
*/
    
var JXG={};JXG.countDrawings=0;JXG.countTime=0;JXG.require=function(libraryName){};JXG.rendererFiles=[];JXG.rendererFiles['svg']='SVGRenderer';JXG.rendererFiles['vml']='VMLRenderer';JXG.baseFiles=null;JXG.AbstractRenderer=function(){this.vOffsetText=8;this.enhancedRendering=true;};JXG.AbstractRenderer.prototype.drawPoint=function(el){var node;var node2;var size=this.getPointSize(el.visProp['style']);if(el.visProp['style']==0||el.visProp['style']==1||el.visProp['style']==2){node=this.createPrimitive('line',el.id+'_x1');this.setStrokeProp(node,el.visProp);node2=this.createPrimitive('line',el.id+'_x2');this.setStrokeProp(node2,el.visProp);this.appendChildPrimitive(node,'points');this.appendChildPrimitive(node2,'points');el.rendNodeX1=node;el.rendNodeX2=node2;}
else if(el.visProp['style']==3||el.visProp['style']==4||el.visProp['style']==5||el.visProp['style']==6){node=this.createPrimitive('circle',el.id);this.setStrokeProp(node,el.visProp);this.setFillProp(node,el.visProp);this.appendChildPrimitive(node,'points');el.rendNode=node;}
else if(el.visProp['style']==7||el.visProp['style']==8||el.visProp['style']==9){node=this.createPrimitive('rect',el.id);this.setStrokeProp(node,el.visProp);this.setFillProp(node,el.visProp);this.appendChildPrimitive(node,'points');el.rendNode=node;}
else if(el.visProp['style']==10||el.visProp['style']==11||el.visProp['style']==12){node=this.createPrimitive('line',el.id+'_x1');this.setStrokeProp(node,el.visProp);node2=this.createPrimitive('line',el.id+'_x2');this.setStrokeProp(node2,el.visProp);this.appendChildPrimitive(node,'points');this.appendChildPrimitive(node2,'points');el.rendNodeX1=node;el.rendNodeX2=node2;}
this.setDraft(el);this.updatePoint(el);};JXG.AbstractRenderer.prototype.updatePoint=function(el){if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);this.setObjectFillColor(el,el.visProp['fillColor'],el.visProp['fillOpacity']);}else{this.setDraft(el);}}
var size=this.getPointSize(el.visProp['style']);if(el.visProp['style']==0||el.visProp['style']==1||el.visProp['style']==2){this.updateLinePrimitive(el.rendNodeX1,el.coords.scrCoords[1]-size,el.coords.scrCoords[2]-size,el.coords.scrCoords[1]+size,el.coords.scrCoords[2]+size);this.updateLinePrimitive(el.rendNodeX2,el.coords.scrCoords[1]+size,el.coords.scrCoords[2]-size,el.coords.scrCoords[1]-size,el.coords.scrCoords[2]+size);}
else if(el.visProp['style']==3||el.visProp['style']==4||el.visProp['style']==5||el.visProp['style']==6){this.updateCirclePrimitive(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2],size+1);}
else if(el.visProp['style']==7||el.visProp['style']==8||el.visProp['style']==9){this.updateRectPrimitive(el.rendNode,el.coords.scrCoords[1]-size,el.coords.scrCoords[2]-size,size*2,size*2);}
else if(el.visProp['style']==10||el.visProp['style']==11||el.visProp['style']==12){this.updateLinePrimitive(el.rendNodeX1,el.coords.scrCoords[1]-size,el.coords.scrCoords[2],el.coords.scrCoords[1]+size,el.coords.scrCoords[2]);this.updateLinePrimitive(el.rendNodeX2,el.coords.scrCoords[1],el.coords.scrCoords[2]-size,el.coords.scrCoords[1],el.coords.scrCoords[2]+size);}};JXG.AbstractRenderer.prototype.changePointStyle=function(el){var node=$(el.id);if(node!=null){this.remove(node);}
else{this.remove($(el.id+'_x1'));this.remove($(el.id+'_x2'));}
this.drawPoint(el);if(!el.visProp['visible']){this.hide(el);}
if(el.visProp['draft']){this.setDraft(el);}};JXG.AbstractRenderer.prototype.drawLine=function(el){var node=this.createPrimitive('line',el.id);this.appendChildPrimitive(node,'lines');el.rendNode=node;this.setDashStyle(el.rendNode,el.visProp);this.updateLine(el);};JXG.AbstractRenderer.prototype.updateLine=function(el){var screenCoords1=new JXG.Coords(JXG.COORDS_BY_USER,el.point1.coords.usrCoords,el.board);var screenCoords2=new JXG.Coords(JXG.COORDS_BY_USER,el.point2.coords.usrCoords,el.board);if(el.visProp['straightFirst']||el.visProp['straightLast']){this.calcStraight(el,screenCoords1,screenCoords2);}
this.updateLinePrimitive(el.rendNode,screenCoords1.scrCoords[1],screenCoords1.scrCoords[2],screenCoords2.scrCoords[1],screenCoords2.scrCoords[2]);if(el.image!=null){var ax=screenCoords1.scrCoords[1];var ay=screenCoords1.scrCoords[2];var bx=screenCoords2.scrCoords[1];var by=screenCoords2.scrCoords[2];var beta;var sgn=(bx-ax>0)?1:-1;if(Math.abs(bx-ax)>0.0000001){beta=Math.atan((by-ay)/(bx-ax))+((sgn<0)?Math.PI:0);}else{beta=((by-ay>0)?0.5:-0.5)*Math.PI;}
var x=250;var y=256;var m=[[1,0,0],[x*(1-Math.cos(beta))+y*Math.sin(beta),Math.cos(beta),-Math.sin(beta)],[y*(1-Math.cos(beta))-x*Math.sin(beta),Math.sin(beta),Math.cos(beta)]];el.imageTransformMatrix=m;}
this.makeArrows(el);if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);}else{this.setDraft(el);}}}
JXG.AbstractRenderer.prototype.drawCurve=function(el){var node=this.createPrimitive('path',el.id);this.appendChildPrimitive(node,'curves');el.rendNode=node;this.setStrokeProp(el.rendNode,el.visProp);this.setFillProp(el.rendNode,el.visProp);this.setDashStyle(el.rendNode,el.visProp);this.updateCurve(el);};JXG.AbstractRenderer.prototype.updateCurve=function(el){if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);this.setObjectFillColor(el,el.visProp['fillColor'],el.visProp['fillOpacity']);}else{this.setDraft(el);}}
this.updatePathPrimitive(el.rendNode,this.updatePathStringPrimitive(el));};JXG.AbstractRenderer.prototype.calcStraightv1=function(el,screenCoords1,screenCoords2){var slope=el.getSlope();var rise=el.getRise();if(slope=="INF"){var x1=screenCoords1.scrCoords[1];var y1=screenCoords1.scrCoords[2];var x2=screenCoords2.scrCoords[1];var y2=screenCoords2.scrCoords[2];if(screenCoords1.scrCoords[2]<screenCoords2.scrCoords[2]){if(el.visProp['straightFirst']){y1=0;}
if(el.visProp['straightLast']){y2=el.board.canvasHeight;}}else{if(el.visProp['straightFirst']){y1=el.board.canvasHeight;}
if(el.visProp['straightLast']){y2=0;}}
screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,[x1,y1],this);screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,[x2,y2],this);return;}
var coordsLeft=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,rise],el.board);var coordsRight=new JXG.Coords(JXG.COORDS_BY_SCREEN,[el.board.canvasWidth,slope*el.board.canvasWidth+rise],el.board);var coordsTop=new JXG.Coords(JXG.COORDS_BY_SCREEN,[Math.round(-rise/slope),0],el.board);var coordsBottom=new JXG.Coords(JXG.COORDS_BY_SCREEN,[Math.round((el.board.canvasHeight-rise)/slope),el.board.canvasHeight],el.board);if(coordsLeft.scrCoords[2]<0){var distP1Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Top<distP2Top)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}else if((distP1Top>distP2Top)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}
if(coordsRight.scrCoords[2]>el.board.canvasHeight){var distP1Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Bottom<distP2Bottom)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}else if((distP1Bottom>distP2Bottom)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}}else{var distP1Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Right<distP2Right)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}else if((distP1Right>distP2Right)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}}}else if(coordsLeft.scrCoords[2]>el.board.canvasHeight){var distP1Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Bottom<distP2Bottom)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}else if((distP1Bottom>distP2Bottom)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}
if(coordsRight.scrCoords[2]<0){var distP1Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Top<distP2Top)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}else if((distP1Top>distP2Top)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}}else{var distP1Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Right<distP2Right)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}else if((distP1Right>distP2Right)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}}}else{var distP1Left=coordsLeft.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Left=coordsLeft.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Left<distP2Left)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsLeft.scrCoords.slice(1));}else if((distP1Left>distP2Left)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsLeft.scrCoords.slice(1));}
if(coordsRight.scrCoords[2]<0){var distP1Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Top=coordsTop.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Top<distP2Top)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}else if((distP1Top>distP2Top)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsTop.scrCoords.slice(1));}}else if(coordsRight.scrCoords[2]>el.board.canvasHeight){var distP1Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Bottom=coordsBottom.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Bottom<distP2Bottom)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}else if((distP1Bottom>distP2Bottom)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsBottom.scrCoords.slice(1));}}else{var distP1Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords1);var distP2Right=coordsRight.distance(JXG.COORDS_BY_SCREEN,screenCoords2);if((distP1Right<distP2Right)&&el.visProp['straightFirst']){screenCoords1.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}else if((distP1Right>distP2Right)&&el.visProp['straightLast']){screenCoords2.setCoordinates(JXG.COORDS_BY_SCREEN,coordsRight.scrCoords.slice(1));}}}};JXG.AbstractRenderer.prototype.calcStraight=function(el,point1,point2){var b=el.board.algebra;var eps=0.0001;var c=[];c[0]=el.stdform[0]-
el.stdform[1]*el.board.origin.scrCoords[1]/(el.board.unitX*el.board.zoomX)+
el.stdform[2]*el.board.origin.scrCoords[2]/(el.board.unitY*el.board.zoomY);c[1]=el.stdform[1]/(el.board.unitX*el.board.zoomX);c[2]=el.stdform[2]/(-el.board.unitY*el.board.zoomY);var s=[];s[0]=b.crossProduct(c,[0,0,1]);s[1]=b.crossProduct(c,[0,1,0]);s[2]=b.crossProduct(c,[-el.board.canvasHeight,0,1]);s[3]=b.crossProduct(c,[-el.board.canvasWidth,1,0]);for(var i=0;i<4;i++){if(Math.abs(s[i][0])>eps){for(var j=2;j>=0;j--){s[i][j]/=s[i][0];}}}
var d1,d2;if(s[1][2]<0||Math.abs(s[1][0])<eps){d1=b.affineDistance(s[0],point1.scrCoords);d2=b.affineDistance(s[0],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}
if(s[3][2]>el.board.canvasHeight||Math.abs(s[3][0])<eps){d1=b.affineDistance(s[2],point1.scrCoords);d2=b.affineDistance(s[2],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}}else{d1=b.affineDistance(s[3],point1.scrCoords);d2=b.affineDistance(s[3],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}}}else if(s[1][2]>el.board.canvasHeight){d1=b.affineDistance(s[2],point1.scrCoords);d2=b.affineDistance(s[2],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}
if(s[3][2]<0||Math.abs(s[3][0])<eps){d1=b.affineDistance(s[0],point1.scrCoords);d2=b.affineDistance(s[0],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}}else{d1=b.affineDistance(s[3],point1.scrCoords);d2=b.affineDistance(s[3],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}}}else{d1=b.affineDistance(s[1],point1.scrCoords);d2=b.affineDistance(s[1],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[1].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[1].slice(1));}
if(s[3][2]<0||Math.abs(s[3][0])<eps){d1=b.affineDistance(s[0],point1.scrCoords);d2=b.affineDistance(s[0],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[0].slice(1));}}else if(s[3][2]>el.board.canvasHeight||Math.abs(s[3][0])<eps){d1=b.affineDistance(s[2],point1.scrCoords);d2=b.affineDistance(s[2],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[2].slice(1));}}else{d1=b.affineDistance(s[3],point1.scrCoords);d2=b.affineDistance(s[3],point2.scrCoords);if((d1<d2)&&el.visProp['straightFirst']){point1.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}else if((d1>d2)&&el.visProp['straightLast']){point2.setCoordinates(JXG.COORDS_BY_SCREEN,s[3].slice(1));}}}};JXG.AbstractRenderer.prototype.drawCircle=function(el){var node=this.createPrimitive('ellipse',el.id);this.setStrokeProp(node,el.visProp);this.setFillProp(node,el.visProp);this.setDashStyle(node,el.visProp);this.appendChildPrimitive(node,'circles');el.rendNode=node;this.setDraft(el);this.updateCircle(el);};JXG.AbstractRenderer.prototype.updateCircle=function(el){if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);this.setObjectFillColor(el,el.visProp['fillColor'],el.visProp['fillOpacity']);}else{this.setDraft(el);}}
var radius=el.getRadius();this.updateEllipsePrimitive(el.rendNode,el.midpoint.coords.scrCoords[1],el.midpoint.coords.scrCoords[2],(radius*el.board.unitX*el.board.zoomX),(radius*el.board.unitY*el.board.zoomY));}
JXG.AbstractRenderer.prototype.drawPolygon=function(el){var node=this.createPrimitive('polygon',el.id);el.visProp['fillOpacity']=0.3;el.visProp['strokeColor']='none';this.setFillProp(node,el.visProp);this.setStrokeProp(node,el.visProp);this.appendChildPrimitive(node,'polygone');el.rendNode=node;this.setDraft(el);this.updatePolygon(el);};JXG.AbstractRenderer.prototype.updatePolygon=function(el){if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);this.setObjectFillColor(el,el.visProp['fillColor'],el.visProp['fillOpacity']);}else{this.setDraft(el);}}
var pStr="";for(var i=0;i<el.vertices.length-1;i++){var screenCoords=el.vertices[i].coords.scrCoords;pStr=pStr+screenCoords[1]+","+screenCoords[2];if(i<el.vertices.length-2){pStr+=" ";}}
this.updatePolygonePrimitive(el.rendNode,pStr);};JXG.AbstractRenderer.prototype.drawArrow=function(el){var node=this.createPrimitive('line',el.id);this.setStrokeProp(node,el.visProp);this.setDashStyle(node,el.visProp);this.makeArrow(node,el);this.appendChildPrimitive(node,'lines');el.rendNode=node;this.setDraft(el);this.updateArrow(el);};JXG.AbstractRenderer.prototype.updateArrow=function(el){if(this.enhancedRendering){if(!el.visProp['draft']){this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);this.setObjectStrokeColor(el,el.visProp['strokeColor'],el.visProp['strokeOpacity']);this.setObjectFillColor(el,el.visProp['fillColor'],el.visProp['fillOpacity']);}else{this.setDraft(el);}}
this.updateLinePrimitive(el.rendNode,el.point1.coords.scrCoords[1],el.point1.coords.scrCoords[2],el.point2.coords.scrCoords[1],el.point2.coords.scrCoords[2]);}
JXG.AbstractRenderer.prototype.drawAxis=function(axis){};JXG.AbstractRenderer.prototype.updateAxis=function(axis){};JXG.AbstractRenderer.prototype.updateAxisTicks=function(axis,oldTicksCount){var i;if(oldTicksCount==axis.ticks.length){return;}else if(oldTicksCount<axis.ticks.length){for(i=oldTicksCount;i<axis.ticks.length;i++){var tick=this.createPrimitive('line',axis.id+'tick'+i);this.appendChildPrimitive(tick,'lines');this.setStrokeProp(tick,axis.visProp);}
this.updateAxisTicksInnerLoop(axis,oldTicksCount);}else if(oldTicksCount>axis.ticks.length){for(i=axis.ticks.length;i<oldTicksCount;i++){this.remove($(axis.id+'tick'+i));}}}
JXG.AbstractRenderer.prototype.updateAxisTicksInnerLoop=function(axis,start){var eps=0.00001;var slope=-axis.getSlope();var dist=3*axis.r/2;var dx,dy;if(Math.abs(slope)<eps){dx=0;dy=dist;}else if((Math.abs(slope)>1/eps)||(isNaN(slope))){dx=dist;dy=0;}else{dx=dist/Math.sqrt(1/(slope*slope)+1);dy=-dx/slope;}
for(var i=start;i<axis.ticks.length;i++){var c=axis.ticks[i];var tick=$(axis.id+'tick'+i);var tickLabel=$(axis.id+'tick'+i+'text');this.updateLinePrimitive(tick,c.scrCoords[1]+dx,c.scrCoords[2]-dy,c.scrCoords[1]-dx,c.scrCoords[2]+dy);this.setStrokeProp(tick,axis.visProp);}}
JXG.AbstractRenderer.prototype.removeAxisTicks=function(axis){for(var i=0;i<axis.ticks.length;i++){var tick=$(axis.id+'tick'+i);this.remove(tick);}}
JXG.AbstractRenderer.prototype.drawArc=function(arc){};JXG.AbstractRenderer.prototype.updateArc=function(el){this.remove(el.rendNode);this.remove(el.rendNodeFill);var node=el.rendNodeTriangleStart;if(node!=null){this.remove(node);}
node=el.rendNodeTriangleEnd;if(node!=null){this.remove(node);}
this.drawArc(el);this.setDraft(el);return;};JXG.AbstractRenderer.prototype.drawLabel=function(el){var node=this.container.ownerDocument.createElement('div');node.style.position='absolute';node.style.fontSize=el.board.fontSize+'px';node.style.color=el.color;node.className='JXGText';node.setAttribute('id',el.id);node.innerHTML=el.nameHTML;this.container.appendChild(node);el.rendNode=node;this.updateLabel(el);};JXG.AbstractRenderer.prototype.updateLabel=function(el){el.rendNode.style.left=(el.coords.scrCoords[1])+'px';el.rendNode.style.top=(el.coords.scrCoords[2]-this.vOffsetText)+'px';};JXG.AbstractRenderer.prototype.drawText=function(el){var node=this.container.ownerDocument.createElement('div');node.setAttribute('id',el.id);node.style.position='absolute';node.style.fontSize=el.board.fontSize+'px';node.style.color=el.visProp['strokeColor'];node.className='JXGtext';node.style.zIndex='10';this.container.appendChild(node);el.rendNode=node;this.updateText(el);};JXG.AbstractRenderer.prototype.updateText=function(el){this.updateTextStyle(el);el.rendNode.style.left=(el.coords.scrCoords[1])+'px';el.rendNode.style.top=(el.coords.scrCoords[2]-this.vOffsetText)+'px';el.rendNode.innerHTML=el.plaintextStr;};JXG.AbstractRenderer.prototype.updateTextStyle=function(el){if(el.visProp['fontSize']){if(typeof el.visProp['fontSize']=='function'){var fs=el.visProp['fontSize']();el.rendNode.style.fontSize=(fs>0?fs:0);}else{el.rendNode.style.fontSize=(el.visProp['fontSize']);}}};JXG.AbstractRenderer.prototype.drawAngle=function(angle){};JXG.AbstractRenderer.prototype.updateAngle=function(angle){};JXG.AbstractRenderer.prototype.drawImage=function(image){};JXG.AbstractRenderer.prototype.updateImage=function(el){this.updateRectPrimitive(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2]-el.size[1],el.size[0],el.size[1]);if(el.parent!=null){this.transformImageParent(el,el.parent.imageTransformMatrix);}else{this.transformImageParent(el);}
this.transformImage(el,el.transformations);};JXG.AbstractRenderer.prototype.drawGrid=function(board){board.hasGrid=true;var gridX=board.gridX;var gridY=board.gridY;var node;var k=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],board);var k2=new JXG.Coords(JXG.COORDS_BY_SCREEN,[board.canvasWidth,board.canvasHeight],board);var tmp=Math.ceil(k.usrCoords[1]);var j=0;for(var i=0;i<=gridX+1;i++){if(tmp-i/gridX<k.usrCoords[1]){j=i-1;break;}}
tmp=Math.floor(k2.usrCoords[1]);var j2=0;for(var i=0;i<=gridX+1;i++){if(tmp+i/gridX>k2.usrCoords[1]){j2=i-1;break;}}
tmp=Math.ceil(k2.usrCoords[2]);var l2=0;for(var i=0;i<=gridY+1;i++){if(tmp-i/gridY<k2.usrCoords[2]){l2=i-1;break;}}
tmp=Math.floor(k.usrCoords[2]);var l=0;for(var i=0;i<=gridY+1;i++){if(tmp+i/gridY>k.usrCoords[2]){l=i-1;break;}}
var gx=Math.round((1.0/gridX)*board.zoomX*board.unitX);var gy=Math.round((1.0/gridY)*board.zoomY*board.unitY);var topLeft=new JXG.Coords(JXG.COORDS_BY_USER,[Math.ceil(k.usrCoords[1])-j/gridX,Math.floor(k.usrCoords[2])+l/gridY],board);var bottomRight=new JXG.Coords(JXG.COORDS_BY_USER,[Math.floor(k2.usrCoords[1])+j2/gridX,Math.ceil(k2.usrCoords[2])-l2/gridY],board);var i=0;while(topLeft.scrCoords[1]<bottomRight.scrCoords[1]+gx-1){var node2=this.createPrimitive('line','gridx'+i);this.updateLinePrimitive(node2,topLeft.scrCoords[1],0,topLeft.scrCoords[1],board.canvasHeight);if(!board.snapToGrid){this.setPropertyPrimitive(node2,'stroke',board.gridColor);}
else{this.setPropertyPrimitive(node2,'stroke','#FF8080');}
this.setPropertyPrimitive(node2,'stroke-width','0.4px');if(board.gridDash){this.setPropertyPrimitive(node2,'stroke-dasharray','5, 5');}
this.appendChildPrimitive(node2,'grid');i++;topLeft.setCoordinates(JXG.COORDS_BY_SCREEN,[topLeft.scrCoords[1]+gx,topLeft.scrCoords[2]]);}
i=0;while(topLeft.scrCoords[2]<=bottomRight.scrCoords[2]+gy-1){var node2=this.createPrimitive('line','gridy'+i);this.updateLinePrimitive(node2,0,topLeft.scrCoords[2],board.canvasWidth,topLeft.scrCoords[2]);if(!board.snapToGrid){this.setPropertyPrimitive(node2,'stroke',board.gridColor);}
else{this.setPropertyPrimitive(node2,'stroke','#FF8080');}
this.setPropertyPrimitive(node2,'stroke-width','0.4px');if(board.gridDash){this.setPropertyPrimitive(node2,'stroke-dasharray','5, 5');}
this.appendChildPrimitive(node2,'grid');i++;topLeft.setCoordinates(JXG.COORDS_BY_SCREEN,[topLeft.scrCoords[1],topLeft.scrCoords[2]+gy]);}};JXG.AbstractRenderer.prototype.removeGrid=function(board){};JXG.AbstractRenderer.prototype.hide=function(obj){};JXG.AbstractRenderer.prototype.show=function(obj){};JXG.AbstractRenderer.prototype.setObjectStrokeWidth=function(el,width){var w;if(typeof width=='function'){w=width();}else{w=width;}
if(el.elementClass!=JXG.OBJECT_CLASS_POINT){var node;if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode2;}
else{node=el.rendNode;}
this.setPropertyPrimitive(node,'stroked','true');if(w!=null){this.setPropertyPrimitive(node,'stroke-width',w);}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;this.setPropertyPrimitive(node,'stroked','true');if(w!=null){this.setPropertyPrimitive(node,'stroke-width',w);}}
else{var node=el.rendNodeX1;this.setPropertyPrimitive(node,'stroked','true');if(w!=null){this.setPropertyPrimitive(node,'stroke-width',w);}
var node=el.rendNodeX2;this.setPropertyPrimitive(node,'stroked','true');if(w!=null){this.setPropertyPrimitive(node,'stroke-width',w);}}}};JXG.AbstractRenderer.prototype.setObjectStrokeColor=function(obj,color,opacity){};JXG.AbstractRenderer.prototype.setObjectDash=function(obj){};JXG.AbstractRenderer.prototype.setObjectFillColor=function(obj,color,opacity){};JXG.AbstractRenderer.prototype.setDraft=function(obj){if(!obj.visProp['draft']){return;}
var draftColor='#565656';var draftOpacity=0.8;if(obj.type==JXG.OBJECTT_TYPE_POLYGON){this.setObjectFillColor(obj,draftColor,draftOpacity);}
else{if(obj.elementClass==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(obj,draftColor,draftOpacity);}
else{this.setObjectFillColor(obj,'none',0);}
this.setObjectStrokeColor(obj,draftColor,draftOpacity);this.setObjectStrokeWidth(obj,'1px');}};JXG.AbstractRenderer.prototype.removeDraft=function(obj){if(obj.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(obj,obj.visProp['fillColor'],obj.visProp['fillColorOpacity']);}
else{if(obj.type==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(obj,obj.visProp['fillColor'],obj.visProp['fillColorOpacity']);}
this.setObjectStrokeColor(obj,obj.visProp['strokeColor'],obj.visProp['strokeColorOpacity']);this.setObjectStrokeWidth(obj,obj.visProp['strokeWidth']);}};JXG.AbstractRenderer.prototype.highlight=function(obj){if(obj.visProp['draft']==false){if(obj.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(obj,obj.visProp['highlightStrokeColor'],obj.visProp['highlightStrokeOpacity']);this.setObjectFillColor(obj,obj.visProp['highlightStrokeColor'],obj.visProp['highlightStrokeOpacity']);}
else if(obj.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(obj,obj.visProp['highlightFillColor'],obj.visProp['highlightFillOpacity']);for(i=0;i<obj.borders.length;i++){this.setObjectStrokeColor(obj.borders[i],obj.borders[i].visProp['highlightStrokeColor'],obj.visProp['highlightStrokeOpacity']);}}
else{this.setObjectStrokeColor(obj,obj.visProp['highlightStrokeColor'],obj.visProp['highlightStrokeOpacity']);this.setObjectFillColor(obj,obj.visProp['highlightFillColor'],obj.visProp['highlightFillOpacity']);}}};JXG.AbstractRenderer.prototype.noHighlight=function(obj){if(obj.visProp['draft']==false){if(obj.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(obj,obj.visProp['strokeColor'],obj.visProp['strokeOpacity']);this.setObjectFillColor(obj,obj.visProp['strokeColor'],obj.visProp['strokeOpacity']);}
else if(obj.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(obj,obj.visProp['fillColor'],obj.visProp['fillOpacity']);for(i=0;i<obj.borders.length;i++){this.setObjectStrokeColor(obj.borders[i],obj.borders[i].visProp['strokeColor'],obj.visProp['strokeOpacity']);}}
else{this.setObjectStrokeColor(obj,obj.visProp['strokeColor'],obj.visProp['strokeOpacity']);this.setObjectFillColor(obj,obj.visProp['fillColor'],obj.visProp['fillOpacity']);}}};JXG.AbstractRenderer.prototype.setLabelColor=function(el){el.rendNode.style.color=el.color;};JXG.AbstractRenderer.prototype.suspendRedraw=function(){};JXG.AbstractRenderer.prototype.unsuspendRedraw=function(){};JXG.AbstractRenderer.prototype.remove=function(shape){};JXG.AbstractRenderer.prototype.getPointSize=function(style){var size=0;switch(style){case 0:size=2;break;case 1:size=3;break;case 2:size=4;break;case 3:size=1;break;case 4:size=2;break;case 5:size=3;break;case 6:size=4;break;case 7:size=2;break;case 8:size=3;break;case 9:size=4;break;case 10:size=2;break;case 11:size=3;break;case 12:size=4;break;default:}
return size;};JXG.FileReader=new function(){this.parseFileContent=function(url,board,format){this.request=false;var e;try{this.request=new XMLHttpRequest();this.request.overrideMimeType('text/xml; charset=iso-8859-1');}catch(e){try{this.request=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{this.request=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){this.request=false;}}}
if(!this.request){alert("AJAX not activated!");return;}
this.request.open("GET",url,true);this.cb=(function(){var request=this.request;if(request.readyState==4){this.parseString(request.responseText,board,format);}}).bind(this);this.request.onreadystatechange=this.cb;this.request.send(null);};this.cleanWhitespace=function(el){var cur=el.firstChild;while(cur!=null){if(cur.nodeType==3&&!/\S/.test(cur.nodeValue)){el.removeChild(cur);}else if(cur.nodeType==1){this.cleanWhitespace(cur);}
cur=cur.nextSibling;}};this.stringToXMLTree=function(fileStr){if(typeof DOMParser=="undefined"){DOMParser=function(){};DOMParser.prototype.parseFromString=function(str,contentType){if(typeof ActiveXObject!="undefined"){var d=new ActiveXObject("MSXML.DomDocument");d.loadXML(str);return d;}}}
var parser=new DOMParser();var tree=parser.parseFromString(fileStr,"text/xml");this.cleanWhitespace(tree);return tree;};this.parseString=function(fileStr,board,format){if(format.toLowerCase()=='geonext'){fileStr=JXG.GeonextReader.prepareString(fileStr);}
board.xmlString=fileStr;var tree=this.stringToXMLTree(fileStr);this.readElements(tree,board,format);};this.readElements=function(tree,board,format){if(format.toLowerCase()=='geonext'){if(tree.getElementsByTagName('GEONEXT').length!=0){JXG.GeonextReader.readGeonext(tree,board);}}
else if(tree.getElementsByTagName('geogebra').length!=0){}
else if(format.toLowerCase()=='intergeo'){JXG.IntergeoReader.readIntergeo(tree,board);}
board.afterLoad();};};JXG.GeonextReader=new function(){this.changeOriginIds=function(board,id){if((id=='gOOe0')||(id=='gXOe0')||(id=='gYOe0')||(id=='gXLe0')||(id=='gYLe0')){return board.id+id;}
else{return id;}};this.colorProperties=function(gxtEl,Data){gxtEl.colorStroke=Data.getElementsByTagName('color')[0].getElementsByTagName('stroke')[0].firstChild.data;gxtEl.highlightStrokeColor=Data.getElementsByTagName('color')[0].getElementsByTagName('lighting')[0].firstChild.data;gxtEl.colorFill=Data.getElementsByTagName('color')[0].getElementsByTagName('fill')[0].firstChild.data;gxtEl.colorLabel=Data.getElementsByTagName('color')[0].getElementsByTagName('label')[0].firstChild.data;gxtEl.colorDraft=Data.getElementsByTagName('color')[0].getElementsByTagName('draft')[0].firstChild.data;return gxtEl;};this.firstLevelProperties=function(gxtEl,Data){var arr=Data.childNodes;$R(0,arr.length-1).each(function(n){if(arr[n].firstChild!=null&&arr[n].nodeName!='data'&&arr[n].nodeName!='straight'){var key=arr[n].nodeName;gxtEl[key]=arr[n].firstChild.data;}});return gxtEl;};this.boardProperties=function(gxtEl,Data){return gxtEl;};this.defProperties=function(gxtEl,Data){if(Data.nodeType==3||Data.nodeType==8){return null;}
gxtEl.ident=Data.nodeName;if(gxtEl.ident=="text"||gxtEl.ident=="intersection"||gxtEl.ident=="composition"){gxtEl.name='';}
else{gxtEl.name=Data.getElementsByTagName('name')[0].firstChild.data;}
gxtEl.id=Data.getElementsByTagName('id')[0].firstChild.data;return gxtEl;};this.visualProperties=function(gxtEl,Data){gxtEl.visible=Data.getElementsByTagName('visible')[0].firstChild.data;gxtEl.trace=Data.getElementsByTagName('trace')[0].firstChild.data;return gxtEl;};this.readNodes=function(gxtEl,Data,nodeType,prefix){var key;var arr=Data.getElementsByTagName(nodeType)[0].childNodes;$R(0,arr.length-1).each(function(n){if(arr[n].firstChild!=null){if(prefix!=null){key=prefix+arr[n].nodeName.capitalize();}else{key=arr[n].nodeName;}
gxtEl[key]=arr[n].firstChild.data;}});return gxtEl;};this.subtreeToString=function(root){try{return(new XMLSerializer()).serializeToString(root);}catch(e){return root.xml;}
return null;};this.readImage=function(node){var pic='';var nod=node;if(nod!=null){pic=nod.data;while(nod.nextSibling!=null){nod=nod.nextSibling;pic+=nod.data;}}
return pic;};this.parseImage=function(board,fileNode,level,x,y,w,h,el){if(fileNode==null){return null;}
if(fileNode.getElementsByTagName('src')[0]!=null){var tag='src';}else if(fileNode.getElementsByTagName('image')[0]!=null){var tag='image';}else{return null;}
var picStr=this.readImage(fileNode.getElementsByTagName(tag)[0].firstChild);if(picStr!=''){if(tag=='src'){var x=fileNode.getElementsByTagName('x')[0].firstChild.data;var y=fileNode.getElementsByTagName('y')[0].firstChild.data;var w=fileNode.getElementsByTagName('width')[0].firstChild.data;var h=fileNode.getElementsByTagName('height')[0].firstChild.data;}else{var node=document.createElement('img');node.setAttribute('id','tmpimg');node.style.display='none';document.getElementsByTagName('body')[0].appendChild(node);node.setAttribute('src','data:image/png;base64,'+picStr);var wOrg=node.width;var hOrg=node.height;wOrg=(wOrg==0)?3:wOrg;hOrg=(hOrg==0)?3:hOrg;y-=hOrg*w/wOrg*0.5;h=hOrg*w/wOrg;document.getElementsByTagName('body')[0].removeChild(node);}
if(el!=null){var id=el.id+'_image';}else{var id=false;}
var im=new JXG.Image(board,picStr,[x,y],[w,h],level,id,false,el);return im;}};this.readConditions=function(node,board){board.conditions='';if(node!=null){for(var i=0;i<node.getElementsByTagName('data').length;i++){var s;var e;var ob=node.getElementsByTagName('data')[i];s=JXG.GeonextReader.subtreeToString(ob);board.conditions+=s;}}};this.printDebugMessage=function(outputEl,gxtEl,nodetyp,success){};this.readGeonext=function(tree,board){var boardTmp={};boardData=tree.getElementsByTagName('board')[0];boardTmp.ident="board";boardTmp.id=boardData.getElementsByTagName('id')[0].firstChild.data;boardTmp.width=boardData.getElementsByTagName('width')[0].firstChild.data;boardTmp.height=boardData.getElementsByTagName('height')[0].firstChild.data;boardTmp.fontSize=(boardData.getElementsByTagName('fontsize')[0]!=null)?document.body.style.fontSize=boardData.getElementsByTagName('fontsize')[0].firstChild.data:document.body.style.fontSize;boardTmp.modus=boardData.getElementsByTagName('modus')[0].firstChild.data;boardTmp.originX=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('origin')[0].getElementsByTagName('x')[0].firstChild.data;boardTmp.originY=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('origin')[0].getElementsByTagName('y')[0].firstChild.data;boardTmp.zoomX=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('zoom')[0].getElementsByTagName('x')[0].firstChild.data;boardTmp.zoomY=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('zoom')[0].getElementsByTagName('y')[0].firstChild.data;boardTmp.unitX=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('unit')[0].getElementsByTagName('x')[0].firstChild.data;boardTmp.unitY=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('unit')[0].getElementsByTagName('y')[0].firstChild.data;boardTmp.viewportTop=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('viewport')[0].getElementsByTagName('top')[0].firstChild.data;boardTmp.viewportLeft=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('viewport')[0].getElementsByTagName('left')[0].firstChild.data;boardTmp.viewportBottom=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('viewport')[0].getElementsByTagName('bottom')[0].firstChild.data;boardTmp.viewportRight=boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('viewport')[0].getElementsByTagName('right')[0].firstChild.data;this.readConditions(boardData.getElementsByTagName('conditions')[0],boardTmp);board.origin={};board.origin.usrCoords=[1,0,0];board.origin.scrCoords=[1,1*boardTmp.originX,1*boardTmp.originY];board.zoomX=1*boardTmp.zoomX;board.zoomY=1*boardTmp.zoomY;board.unitX=1*boardTmp.unitX;board.unitY=1*boardTmp.unitY;board.fontSize=1*boardTmp.fontSize;board.geonextCompatibilityMode=true;delete(JXG.JSXGraph.boards[board.id]);board.id=boardTmp.id;JXG.JSXGraph.boards[board.id]=board;board.initGeonextBoard();board.renderer.enhancedRendering=false;JXG.GeonextReader.parseImage(board,boardData.getElementsByTagName('file')[0],'images');var snap=(boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('snap')[0].firstChild.data=="true")?board.snapToGrid=true:null;var gridX=(boardData.getElementsByTagName('grid')[1].getElementsByTagName('x')[0].firstChild.data)?board.gridX=boardData.getElementsByTagName('grid')[1].getElementsByTagName('x')[0].firstChild.data*1:null;var gridY=(boardData.getElementsByTagName('grid')[1].getElementsByTagName('y')[0].firstChild.data)?board.gridY=boardData.getElementsByTagName('grid')[1].getElementsByTagName('y')[0].firstChild.data*1:null;board.calculateSnapSizes();var gridDash=boardData.getElementsByTagName('grid')[1].getElementsByTagName('dash')[0].firstChild.data;board.gridDash=board.algebra.str2Bool(gridDash);var gridColor=boardData.getElementsByTagName('grid')[1].getElementsByTagName('color')[0].firstChild.data;var gridOpacity;if(gridColor.length=='9'&&gridColor.substr(0,1)=='#'){gridOpacity=gridColor.substr(7,2);gridColor=gridColor.substr(0,7);}
else{gridOpacity='FF';}
board.gridColor=gridColor;board.gridOpacity=gridOpacity;var grid=(boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('grid')[0].firstChild.data=="true")?board.renderer.drawGrid(board):null;if(boardData.getElementsByTagName('coordinates')[0].getElementsByTagName('coord')[0].firstChild.data=="true"){var axisX=board.createElement('axis',[[0,0],[1,0]]);axisX.setProperty('strokeColor:'+axisX.visProp['strokeColor'],'strokeWidth:'+axisX.visProp['strokeWidth'],'fillColor:none','highlightStrokeColor:'+axisX.visProp['highlightStrokeColor'],'highlightFillColor:none','visible:true');var axisY=board.createElement('axis',[[0,0],[0,1]]);axisY.setProperty('strokeColor:'+axisY.visProp['strokeColor'],'strokeWidth:'+axisY.visProp['strokeWidth'],'fillColor:none','highlightStrokeColor:'+axisY.visProp['highlightStrokeColor'],'highlightFillColor:none','visible:true');}
var bgcolor=boardData.getElementsByTagName('background')[0].getElementsByTagName('color')[0].firstChild.data;var opacity=1;if(bgcolor.length=='9'&&bgcolor.substr(0,1)=='#'){opacity=bgcolor.substr(7,2);bgcolor=bgcolor.substr(0,7);}
$(board.container).style.backgroundColor=bgcolor;$R(0,tree.getElementsByTagName("elements")[0].childNodes.length-1).each(function(s){var Data=tree.getElementsByTagName("elements")[0].childNodes[s];var gxtEl={};gxtEl=JXG.GeonextReader.defProperties(gxtEl,Data);if(gxtEl==null)return;switch(Data.nodeName.toLowerCase()){case"point":gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.fixed=Data.getElementsByTagName('fix')[0].firstChild.data;JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'points');try{p=new JXG.Point(board,[1*gxtEl.x,1*gxtEl.y],gxtEl.id,gxtEl.name,true);p.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorStroke,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.highlightStrokeColor,'labelColor:'+gxtEl.colorLabel,'visible:'+gxtEl.visible,'fixed:'+gxtEl.fixed,'draft:'+gxtEl.draft);p.setStyle(1*gxtEl.style);p.traced=(gxtEl.trace=='false')?false:true;JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');}catch(e){}
break;case"line":gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'straight','straight');gxtEl.first=JXG.GeonextReader.changeOriginIds(board,gxtEl.first);gxtEl.last=JXG.GeonextReader.changeOriginIds(board,gxtEl.last);var l=new JXG.Line(board,gxtEl.first,gxtEl.last,gxtEl.id,gxtEl.name);var x=l.point1.coords.usrCoords[1];var y=l.point1.coords.usrCoords[2];var w=l.point1.coords.distance(JXG.COORDS_BY_USER,l.point2.coords);var h=0;l.image=JXG.GeonextReader.parseImage(board,Data,'lines',x,y,w,h,l);gxtEl.straightFirst=(gxtEl.straightFirst=='false')?false:true;gxtEl.straightLast=(gxtEl.straightLast=='false')?false:true;l.setStraight(gxtEl.straightFirst,gxtEl.straightLast);l.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'dash:'+gxtEl.dash,'draft:'+gxtEl.draft);l.traced=(gxtEl.trace=='false')?false:true;JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"circle":gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.midpoint=Data.getElementsByTagName('data')[0].getElementsByTagName('midpoint')[0].firstChild.data;JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'circles');if(Data.getElementsByTagName('data')[0].getElementsByTagName('radius').length>0){gxtEl.radiuspoint=Data.getElementsByTagName('data')[0].getElementsByTagName('radius')[0].firstChild.data;gxtEl.radius=null;gxtEl.method="twoPoints";}
else if(Data.getElementsByTagName('data')[0].getElementsByTagName('radiusvalue').length>0){gxtEl.radiuspoint=null;gxtEl.radius=Data.getElementsByTagName('data')[0].getElementsByTagName('radiusvalue')[0].firstChild.data;gxtEl.radiusnum=Data.getElementsByTagName('data')[0].getElementsByTagName('radiusnum')[0].firstChild.data;gxtEl.method="pointRadius";}
if(gxtEl.method=="twoPoints"){if(board.objects[gxtEl.radiuspoint].type==JXG.OBJECT_TYPE_LINE){gxtEl.method="pointLine";gxtEl.radiuspoint=JXG.GeonextReader.changeOriginIds(board,gxtEl.radiuspoint);}
else if(board.objects[gxtEl.radiuspoint].type==JXG.OBJECT_TYPE_CIRCLE){gxtEl.method="pointCircle";}}
if(gxtEl.method=='pointRadius'){gxtEl.midpoint=JXG.GeonextReader.changeOriginIds(board,gxtEl.midpoint);var c=new JXG.Circle(board,gxtEl.method,gxtEl.midpoint,gxtEl.radius,gxtEl.id,gxtEl.name);}else{gxtEl.midpoint=JXG.GeonextReader.changeOriginIds(board,gxtEl.midpoint);var c=new JXG.Circle(board,gxtEl.method,gxtEl.midpoint,gxtEl.radiuspoint,gxtEl.id,gxtEl.name);}
c.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'dash:'+gxtEl.dash,'draft:'+gxtEl.draft);c.traced=(gxtEl.trace=='false')?false:true;JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"slider":gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.fixed=Data.getElementsByTagName('fix')[0].firstChild.data;gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'animate','animate');JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'points');try{var s=new JXG.Point(board,[1*gxtEl.x,1*gxtEl.y],gxtEl.id,gxtEl.name,true);gxtEl.parent=JXG.GeonextReader.changeOriginIds(board,gxtEl.parent);s.makeGlider(gxtEl.parent);s.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorStroke,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.highlightStrokeColor,'visible:'+gxtEl.visible,'fixed:'+gxtEl.fixed,'labelColor:'+gxtEl.colorLabel,'draft:'+gxtEl.draft);s.onPolygon=board.algebra.str2Bool(gxtEl.onpolygon);s.traced=(gxtEl.trace=='false')?false:true;s.setStyle(1*gxtEl.style);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');}catch(e){}
break;case"cas":gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.fixed=Data.getElementsByTagName('fix')[0].firstChild.data;gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'points');var p=new JXG.Point(board,[1*gxtEl.xval,1*gxtEl.yval],gxtEl.id,gxtEl.name,true);p.addConstraint(gxtEl.x,gxtEl.y);p.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorStroke,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.highlightStrokeColor,'visible:'+gxtEl.visible,'fixed:'+gxtEl.fixed,'labelColor:'+gxtEl.colorLabel,'draft:'+gxtEl.draft);p.traced=(gxtEl.trace=='false')?false:true;p.setStyle(1*gxtEl.style);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"intersection":gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.outputFirstId=Data.getElementsByTagName('first')[1].getElementsByTagName('id')[0].firstChild.data;gxtEl.outputFirstName=Data.getElementsByTagName('first')[1].getElementsByTagName('name')[0].firstChild.data;gxtEl.outputFirstVisible=Data.getElementsByTagName('first')[1].getElementsByTagName('visible')[0].firstChild.data;gxtEl.outputFirstTrace=Data.getElementsByTagName('first')[1].getElementsByTagName('trace')[0].firstChild.data;gxtEl.outputFirstFixed=Data.getElementsByTagName('first')[1].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputFirstStyle=Data.getElementsByTagName('first')[1].getElementsByTagName('style')[0].firstChild.data;gxtEl.outputFirstStrokewidth=Data.getElementsByTagName('first')[1].getElementsByTagName('strokewidth')[0].firstChild.data;gxtEl.outputFirstColorStroke=Data.getElementsByTagName('first')[1].getElementsByTagName('color')[0].getElementsByTagName('stroke')[0].firstChild.data;gxtEl.outputFirstHighlightStrokeColor=Data.getElementsByTagName('first')[1].getElementsByTagName('color')[0].getElementsByTagName('lighting')[0].firstChild.data;gxtEl.outputFirstColorFill=Data.getElementsByTagName('first')[1].getElementsByTagName('color')[0].getElementsByTagName('fill')[0].firstChild.data;gxtEl.outputFirstColorLabel=Data.getElementsByTagName('first')[1].getElementsByTagName('color')[0].getElementsByTagName('label')[0].firstChild.data;gxtEl.outputFirstColorDraft=Data.getElementsByTagName('first')[1].getElementsByTagName('color')[0].getElementsByTagName('draft')[0].firstChild.data;gxtEl.first=JXG.GeonextReader.changeOriginIds(board,gxtEl.first);gxtEl.last=JXG.GeonextReader.changeOriginIds(board,gxtEl.last);if((((board.objects[gxtEl.first]).type==(board.objects[gxtEl.last]).type)&&((board.objects[gxtEl.first]).type==JXG.OBJECT_TYPE_LINE||(board.objects[gxtEl.first]).type==JXG.OBJECT_TYPE_ARROW))||(((board.objects[gxtEl.first]).type==JXG.OBJECT_TYPE_LINE)&&((board.objects[gxtEl.last]).type==JXG.OBJECT_TYPE_ARROW))||(((board.objects[gxtEl.last]).type==JXG.OBJECT_TYPE_LINE)&&((board.objects[gxtEl.first]).type==JXG.OBJECT_TYPE_ARROW))){var inter=new JXG.Intersection(board,gxtEl.id,board.objects[gxtEl.first],board.objects[gxtEl.last],gxtEl.outputFirstId,'',gxtEl.outputFirstName,'');if(gxtEl.outputFirstVisible=="false"){inter.hideElement();}
inter.p.setProperty('strokeColor:'+gxtEl.outputFirstColorStroke,'strokeWidth:'+gxtEl.outputFirstStrokewidth,'fillColor:'+gxtEl.outputFirstColorStroke,'highlightStrokeColor:'+gxtEl.outputFirstHighlightStrokeColor,'highlightFillColor:'+gxtEl.outputFirstHighlightStrokeColor,'visible:'+gxtEl.outputFirstVisible,'labelColor:'+gxtEl.outputFirstColorLabel,'draft:'+gxtEl.draft);inter.p.setStyle(1*gxtEl.outputFirstStyle);inter.p.traced=(gxtEl.outputFirstTrace=='false')?false:true;}
else{gxtEl.outputLastId=Data.getElementsByTagName('last')[1].getElementsByTagName('id')[0].firstChild.data;gxtEl.outputLastName=Data.getElementsByTagName('last')[1].getElementsByTagName('name')[0].firstChild.data;gxtEl.outputLastVisible=Data.getElementsByTagName('last')[1].getElementsByTagName('visible')[0].firstChild.data;gxtEl.outputLastTrace=Data.getElementsByTagName('last')[1].getElementsByTagName('trace')[0].firstChild.data;gxtEl.outputLastFixed=Data.getElementsByTagName('last')[1].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputLastStyle=Data.getElementsByTagName('last')[1].getElementsByTagName('style')[0].firstChild.data;gxtEl.outputLastStrokewidth=Data.getElementsByTagName('last')[1].getElementsByTagName('strokewidth')[0].firstChild.data;var tmp=Data.getElementsByTagName('last')[1].getElementsByTagName('color')[0];gxtEl.outputLastColorStroke=tmp.getElementsByTagName('stroke')[0].firstChild.data;gxtEl.outputLastHighlightStrokeColor=tmp.getElementsByTagName('lighting')[0].firstChild.data;gxtEl.outputLastColorFill=tmp.getElementsByTagName('fill')[0].firstChild.data;gxtEl.outputLastColorLabel=tmp.getElementsByTagName('label')[0].firstChild.data;gxtEl.outputLastColorDraft=tmp.getElementsByTagName('draft')[0].firstChild.data;var inter=new JXG.Intersection(board,gxtEl.id,board.objects[gxtEl.first],board.objects[gxtEl.last],gxtEl.outputFirstId,gxtEl.outputLastId,gxtEl.outputFirstName,gxtEl.outputLastName);inter.p1.setProperty('strokeColor:'+gxtEl.outputFirstColorStroke,'strokeWidth:'+gxtEl.outputFirstStrokewidth,'fillColor:'+gxtEl.outputFirstColorStroke,'highlightStrokeColor:'+gxtEl.outputFirstHighlightStrokeColor,'highlightFillColor:'+gxtEl.outputFirstHighlightStrokeColor,'visible:'+gxtEl.outputFirstVisible,'labelColor:'+gxtEl.outputFirstColorLabel,'draft:'+gxtEl.draft);inter.p1.setStyle(1*gxtEl.outputFirstStyle);inter.p1.traced=(gxtEl.outputFirstTrace=='false')?false:true;inter.p2.setProperty('strokeColor:'+gxtEl.outputLastColorStroke,'strokeWidth:'+gxtEl.outputLastStrokewidth,'fillColor:'+gxtEl.outputLastColorStroke,'highlightStrokeColor:'+gxtEl.outputLastHighlightStrokeColor,'highlightFillColor:'+gxtEl.outputLastHighlightStrokeColor,'visible:'+gxtEl.outputLastVisible,'labelColor:'+gxtEl.outputLastColorLabel,'draft:'+gxtEl.draft);inter.p2.setStyle(1*gxtEl.outputLastStyle);inter.p2.traced=(gxtEl.outputLastTrace=='false')?false:true;if(gxtEl.outputFirstVisible=="false"){if(gxtEl.outputLastVisible=="false"){inter.hideElement();}
else{inter.p1.hideElement();}}
else{if(gxtEl.outputLastVisible=="false"){inter.p2.hideElement();}}}
JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"composition":gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);switch(gxtEl.type){case"210070":gxtEl.typeName="ARROW_PARALLEL";break;case"210080":gxtEl.typeName="BISECTOR";break;case"210090":gxtEl.typeName="CIRCUMCIRCLE";break;case"210100":gxtEl.typeName="CIRCUMCIRCLE_CENTER";break;case"210110":gxtEl.typeName="MIDPOINT";break;case"210120":gxtEl.typeName="MIRROR_LINE";break;case"210125":gxtEl.typeName="MIRROR_POINT";break;case"210130":gxtEl.typeName="NORMAL";break;case"210140":gxtEl.typeName="PARALLEL";break;case"210150":gxtEl.typeName="PARALLELOGRAM_POINT";break;case"210160":gxtEl.typeName="PERPENDICULAR";break;case"210170":gxtEl.typeName="PERPENDICULAR_POINT";break;case"210180":gxtEl.typeName="ROTATION";break;case"210190":gxtEl.typeName="SECTOR";break;}
gxtEl.defEl=[];var numberDefEls=0;for(var i=0;i<Data.getElementsByTagName('data')[0].getElementsByTagName('input').length;i++){gxtEl.defEl[i]=Data.getElementsByTagName('data')[0].getElementsByTagName('input')[i].firstChild.data;numberDefEls=i+1;}
gxtEl.outputId=Data.getElementsByTagName('output')[0].getElementsByTagName('id')[0].firstChild.data;gxtEl.outputName=Data.getElementsByTagName('output')[0].getElementsByTagName('name')[0].firstChild.data;gxtEl.outputVisible=Data.getElementsByTagName('output')[0].getElementsByTagName('visible')[0].firstChild.data;gxtEl.outputTrace=Data.getElementsByTagName('output')[0].getElementsByTagName('trace')[0].firstChild.data;gxtEl.outputStrokewidth=gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'output','output');gxtEl.outputName=Data.getElementsByTagName('output')[0].getElementsByTagName('name')[0].firstChild.data;gxtEl.outputDash=Data.getElementsByTagName('output')[0].getElementsByTagName('dash')[0].firstChild.data;gxtEl.outputDraft=Data.getElementsByTagName('output')[0].getElementsByTagName('draft')[0].firstChild.data;gxtEl.outputStrokewidth=Data.getElementsByTagName('output')[0].getElementsByTagName('strokewidth')[0].firstChild.data;gxtEl.outputColorStroke=Data.getElementsByTagName('output')[0].getElementsByTagName('color')[0].getElementsByTagName('stroke')[0].firstChild.data;gxtEl.outputHighlightStrokeColor=Data.getElementsByTagName('output')[0].getElementsByTagName('color')[0].getElementsByTagName('lighting')[0].firstChild.data;gxtEl.outputColorFill=Data.getElementsByTagName('output')[0].getElementsByTagName('color')[0].getElementsByTagName('fill')[0].firstChild.data;gxtEl.outputColorLabel=Data.getElementsByTagName('output')[0].getElementsByTagName('color')[0].getElementsByTagName('label')[0].firstChild.data;gxtEl.outputColorDraft=Data.getElementsByTagName('output')[0].getElementsByTagName('color')[0].getElementsByTagName('draft')[0].firstChild.data;gxtEl.defEl[0]=JXG.GeonextReader.changeOriginIds(board,gxtEl.defEl[0]);gxtEl.defEl[1]=JXG.GeonextReader.changeOriginIds(board,gxtEl.defEl[1]);gxtEl.defEl[2]=JXG.GeonextReader.changeOriginIds(board,gxtEl.defEl[2]);if(gxtEl.typeName=="MIDPOINT"){if(numberDefEls==2){board.addMidpoint(gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.outputId,gxtEl.outputName);}else if(numberDefEls==1){board.addMidpoint(board.objects[gxtEl.defEl[0]].point1.id,board.objects[gxtEl.defEl[0]].point2.id,gxtEl.outputId,gxtEl.outputName);}}
else if(gxtEl.typeName=="NORMAL"){board.addNormal(gxtEl.defEl[1],gxtEl.defEl[0],gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="PARALLEL"){board.addParallel(gxtEl.defEl[1],gxtEl.defEl[0],gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="CIRCUMCIRCLE"){var umkreisId=Data.getElementsByTagName('output')[1].getElementsByTagName('id')[0].firstChild.data;var umkreisName=Data.getElementsByTagName('output')[1].getElementsByTagName('name')[0].firstChild.data;board.addCircumcenter(gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.defEl[2],gxtEl.outputId,gxtEl.outputName,umkreisId,umkreisName);}
else if(gxtEl.typeName=="CIRCUMCIRCLE_CENTER"){board.addCircumcenterMidpoint(gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.defEl[2],gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="BISECTOR"){board.addAngleBisector(gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.defEl[2],gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="MIRROR_LINE"){board.addReflection(gxtEl.defEl[1],gxtEl.defEl[0],gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="MIRROR_POINT"){board.addRotation(gxtEl.defEl[0],gxtEl.defEl[1],Math.PI,gxtEl.outputId,gxtEl.outputName);}
else if(gxtEl.typeName=="PARALLELOGRAM_POINT"){if(gxtEl.defEl.length==2){board.addParallelPoint(JXG.GetReferenceFromParameter(gxtEl.defEl[0]).point1,JXG.GetReferenceFromParameter(gxtEl.defEl[0]).point2,gxtEl.defEl[1],gxtEl.outputId,gxtEl.outputName);}else{board.addParallelPoint(gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.defEl[2],gxtEl.outputId,gxtEl.outputName);}}
else if(gxtEl.typeName=="SECTOR"){JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'sectors');var defEl=[];var defElN=[];var defElV=[];var defElT=[];var defElD=[];var defElDr=[];var defElSW=[];var defElColStr=[];var defElHColStr=[];var defElColF=[];var defElColL=[];for(var i=0;i<Data.getElementsByTagName('output').length;i++){defEl[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('id')[0].firstChild.data;defEl[i]=JXG.GeonextReader.changeOriginIds(board,defEl[i]);defElN[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('name')[0];defElV[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('visible')[0].firstChild.data;defElT[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('trace')[0].firstChild.data;defElD[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('dash')[0].firstChild.data;defElDr[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('draft')[0].firstChild.data;defElSW[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('strokewidth')[0].firstChild.data;var tmp=Data.getElementsByTagName('output')[i].getElementsByTagName('color')[0];defElColStr[i]=tmp.getElementsByTagName('stroke')[0].firstChild.data;defElHColStr[i]=tmp.getElementsByTagName('lighting')[0].firstChild.data;defElColF[i]=tmp.getElementsByTagName('fill')[0].firstChild.data;defElColL[i]=tmp.getElementsByTagName('label')[0].firstChild.data;}
var s=new JXG.Sector(board,gxtEl.defEl[0],gxtEl.defEl[1],gxtEl.defEl[2],[defEl[0],defEl[1],defEl[2],defEl[3]],[defElN[0].firstChild.data,defElN[1].firstChild.data,defElN[2].firstChild.data,defElN[3].firstChild.data],gxtEl.id);var arcId=defEl[0];board.objects[arcId].setProperty('strokeColor:'+defElColStr[0],'strokeWidth:'+defElSW[0],'fillColor:'+defElColF[0],'highlightStrokeColor:'+defElHColStr[0],'highlightFillColor:'+defElColF[0],'visible:'+defElV[0],'dash:'+defElD[0],'draft:'+defElDr[0]);board.objects[arcId].traced=(defElT[0]=='false')?false:true;gxtEl.firstArrow=Data.getElementsByTagName('output')[0].getElementsByTagName('firstarrow')[0].firstChild.data;gxtEl.lastArrow=Data.getElementsByTagName('output')[0].getElementsByTagName('lastarrow')[0].firstChild.data;gxtEl.firstArrow=(gxtEl.firstArrow=='false')?false:true;gxtEl.lastArrow=(gxtEl.lastArrow=='false')?false:true;board.objects[arcId].setArrow(gxtEl.firstArrow,gxtEl.lastArrow);var pointId=defEl[1];gxtEl.fixed=Data.getElementsByTagName('output')[1].getElementsByTagName('fix')[0].firstChild.data;board.objects[pointId].setProperty('strokeColor:'+defElColStr[1],'strokeWidth:'+defElSW[1],'fillColor:'+defElColStr[1],'highlightStrokeColor:'+defElHColStr[1],'highlightFillColor:'+defElHColStr[1],'visible:'+defElV[1],'fixed:'+gxtEl.fixed,'labelColor:'+defElColL[1],'draft:'+defElDr[1]);gxtEl.style=Data.getElementsByTagName('output')[1].getElementsByTagName('style')[0].firstChild.data;board.objects[pointId].setStyle(1*gxtEl.style);board.objects[pointId].traced=(defElT[1]=='false')?false:true;var line1Id=defEl[2];var tmp=Data.getElementsByTagName('output')[2].getElementsByTagName('straight')[0];gxtEl.straightFirst=tmp.getElementsByTagName('first')[0].firstChild.data;gxtEl.straightLast=tmp.getElementsByTagName('last')[0].firstChild.data;gxtEl.straightFirst=(gxtEl.straightFirst=='false')?false:true;gxtEl.straightLast=(gxtEl.straightLast=='false')?false:true;board.objects[line1Id].setStraight(gxtEl.straightFirst,gxtEl.straightLast);board.objects[line1Id].setProperty('strokeColor:'+defElColStr[2],'strokeWidth:'+defElSW[2],'fillColor:'+defElColF[2],'highlightStrokeColor:'+defElHColStr[2],'highlightFillColor:'+defElColF[2],'visible:'+defElV[2],'dash:'+defElD[2],'draft:'+defElDr[2]);board.objects[line1Id].traced=(defElT[2]=='false')?false:true;var line2Id=defEl[3];tmp=Data.getElementsByTagName('output')[3].getElementsByTagName('straight')[0];gxtEl.straightFirst=tmp.getElementsByTagName('first')[0].firstChild.data;gxtEl.straightLast=tmp.getElementsByTagName('last')[0].firstChild.data;gxtEl.straightFirst=(gxtEl.straightFirst=='false')?false:true;gxtEl.straightLast=(gxtEl.straightLast=='false')?false:true;board.objects[line2Id].setStraight(gxtEl.straightFirst,gxtEl.straightLast);board.objects[line2Id].setProperty('strokeColor:'+defElColStr[3],'strokeWidth:'+defElSW[3],'fillColor:'+defElColF[3],'highlightStrokeColor:'+defElHColStr[3],'highlightFillColor:'+defElColF[3],'visible:'+defElV[3],'dash:'+defElD[3],'draft:'+defElDr[3]);board.objects[line2Id].traced=(defElT[3]=='false')?false:true;}
else if(gxtEl.typeName=="PERPENDICULAR"){var defEl=[];var defElN=[];var defElV=[];var defElT=[];var defElD=[];var defElDr=[];var defElSW=[];var defElColStr=[];var defElHColStr=[];var defElColF=[];var defElColL=[];for(var i=0;i<Data.getElementsByTagName('output').length;i++){defEl[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('id')[0].firstChild.data;defEl[i]=JXG.GeonextReader.changeOriginIds(board,defEl[i]);defElN[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('name')[0];defElV[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('visible')[0].firstChild.data;defElT[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('trace')[0].firstChild.data;defElD[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('dash')[0].firstChild.data;defElDr[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('draft')[0].firstChild.data;defElSW[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('strokewidth')[0].firstChild.data;var tmp=Data.getElementsByTagName('output')[i].getElementsByTagName('color')[0];defElColStr[i]=tmp.getElementsByTagName('stroke')[0].firstChild.data;defElHColStr[i]=tmp.getElementsByTagName('lighting')[0].firstChild.data;defElColF[i]=tmp.getElementsByTagName('fill')[0].firstChild.data;defElColL[i]=tmp.getElementsByTagName('label')[0].firstChild.data;}
gxtEl.outputFixed=Data.getElementsByTagName('output')[0].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputStyle=Data.getElementsByTagName('output')[0].getElementsByTagName('style')[0].firstChild.data;board.addPerpendicular(gxtEl.defEl[1],gxtEl.defEl[0],defEl[1],defElN[1].firstChild.data,defEl[0],defElN[0].firstChild.data);var pid=defEl[0];board.objects[pid].setProperty('strokeColor:'+defElColStr[0],'strokeWidth:'+defElSW[0],'fillColor:'+defElColStr[0],'highlightStrokeColor:'+defElHColStr[0],'highlightFillColor:'+defElHColStr[0],'visible:'+defElV[0],'fixed:'+gxtEl.outputFixed,'labelColor:'+defElColL[0],'draft:'+defElDr[0]);board.objects[pid].setStyle(1*gxtEl.outputStyle);board.objects[pid].traced=(defElT[0]=='false')?false:true;var lid=defEl[1];board.objects[lid].setProperty('strokeColor:'+defElColStr[1],'strokeWidth:'+defElSW[1],'fillColor:'+defElColF[1],'highlightStrokeColor:'+defElHColStr[1],'highlightFillColor:'+defElColF[1],'visible:'+defElV[1],'dash:'+defElD[1],'draft:'+defElDr[1]);board.objects[lid].traced=(defElT[1]=='false')?false:true;}
else if(gxtEl.typeName=="ARROW_PARALLEL"){var defEl=[];var defElN=[];var defElV=[];var defElT=[];var defElD=[];var defElDr=[];var defElSW=[];var defElColStr=[];var defElHColStr=[];var defElColF=[];var defElColL=[];for(var i=0;i<Data.getElementsByTagName('output').length;i++){defEl[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('id')[0].firstChild.data;defEl[i]=JXG.GeonextReader.changeOriginIds(board,defEl[i]);defElN[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('name')[0];defElV[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('visible')[0].firstChild.data;defElT[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('trace')[0].firstChild.data;defElD[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('dash')[0].firstChild.data;defElDr[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('draft')[0].firstChild.data;defElSW[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('strokewidth')[0].firstChild.data;var tmp=Data.getElementsByTagName('output')[i].getElementsByTagName('color')[0];defElColStr[i]=tmp.getElementsByTagName('stroke')[0].firstChild.data;defElHColStr[i]=tmp.getElementsByTagName('lighting')[0].firstChild.data;defElColF[i]=tmp.getElementsByTagName('fill')[0].firstChild.data;defElColL[i]=tmp.getElementsByTagName('label')[0].firstChild.data;}
gxtEl.outputFixed=Data.getElementsByTagName('output')[1].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputStyle=Data.getElementsByTagName('output')[1].getElementsByTagName('style')[0].firstChild.data;board.addArrowParallel(gxtEl.defEl[1],gxtEl.defEl[0],defEl[0],defEl[1],defElN[0].firstChild.data,defElN[1].firstChild.data);var aid=defEl[0];board.objects[aid].setProperty('strokeColor:'+defElColStr[0],'strokeWidth:'+defElSW[0],'fillColor:'+defElColF[0],'highlightStrokeColor:'+defElHColStr[0],'highlightFillColor:'+defElColF[0],'visible:'+defElV[0],'dash:'+defElD[0],'draft:'+defElDr[0]);board.objects[aid].traced=(defElT[0]=='false')?false:true;var pid=defEl[1];board.objects[pid].setProperty('strokeColor:'+defElColStr[1],'strokeWidth:'+defElSW[1],'fillColor:'+defElColStr[1],'highlightStrokeColor:'+defElHColStr[1],'highlightFillColor:'+defElHColStr[1],'visible:'+defElV[1],'fixed:'+gxtEl.outputFixed,'labelColor:'+defElColL[1],'draft:'+defElDr[1]);board.objects[pid].setStyle(1*gxtEl.outputStyle);board.objects[pid].traced=(defElT[1]=='false')?false:true;}
else if(gxtEl.typeName=="PERPENDICULAR_POINT"){board.addPerpendicularPoint(gxtEl.defEl[1],gxtEl.defEl[0],gxtEl.outputId,gxtEl.outputName);}
else{throw('GEONExT-Element '+gxtEl.typeName+' not yet implemented');}
if(gxtEl.typeName=="MIDPOINT"||gxtEl.typeName=="MIRROR_LINE"||gxtEl.typeName=="CIRCUMCIRCLE_CENTER"||gxtEl.typeName=="PERPENDICULAR_POINT"||gxtEl.typeName=="MIRROR_POINT"||gxtEl.typeName=="PARALLELOGRAM_POINT"){gxtEl.outputFixed=Data.getElementsByTagName('output')[0].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputStyle=Data.getElementsByTagName('output')[0].getElementsByTagName('style')[0].firstChild.data;board.objects[gxtEl.outputId].setProperty('strokeColor:'+gxtEl.outputColorStroke,'strokeWidth:'+gxtEl.outputStrokewidth,'fillColor:'+gxtEl.outputColorStroke,'highlightStrokeColor:'+gxtEl.outputHighlightStrokeColor,'highlightFillColor:'+gxtEl.outputHighlightStrokeColor,'visible:'+gxtEl.outputVisible,'fixed:'+gxtEl.outputFixed,'labelColor:'+gxtEl.outputColorLabel,'draft:'+gxtEl.outputDraft);board.objects[gxtEl.outputId].setStyle(1*gxtEl.outputStyle);board.objects[gxtEl.outputId].traced=(gxtEl.outputTrace=='false')?false:true;}
else if(gxtEl.typeName=="BISECTOR"||gxtEl.typeName=="NORMAL"||gxtEl.typeName=="PARALLEL"){var tmp=Data.getElementsByTagName('output')[0].getElementsByTagName('straight')[0];gxtEl.straightFirst=tmp.getElementsByTagName('first')[0].firstChild.data;gxtEl.straightLast=tmp.getElementsByTagName('last')[0].firstChild.data;gxtEl.straightFirst=(gxtEl.straightFirst=='false')?false:true;gxtEl.straightLast=(gxtEl.straightLast=='false')?false:true;board.objects[gxtEl.outputId].setStraight(gxtEl.straightFirst,gxtEl.straightLast);board.objects[gxtEl.outputId].setProperty('strokeColor:'+gxtEl.outputColorStroke,'strokeWidth:'+gxtEl.outputStrokewidth,'fillColor:'+gxtEl.outputColorFill,'highlightStrokeColor:'+gxtEl.outputHighlightStrokeColor,'highlightFillColor:'+gxtEl.outputColorFill,'visible:'+gxtEl.outputVisible,'dash:'+gxtEl.outputDash,'draft:'+gxtEl.outputDraft);board.objects[gxtEl.outputId].traced=(gxtEl.outputTrace=='false')?false:true;}
else if(gxtEl.typeName=="CIRCUMCIRCLE"){var defEl=[];var defElN=[];var defElV=[];var defElT=[];var defElD=[];var defElDr=[];var defElSW=[];var defElColStr=[];var defElHColStr=[];var defElColF=[];var defElColL=[];for(var i=0;i<Data.getElementsByTagName('output').length;i++){defEl[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('id')[0].firstChild.data;defEl[i]=JXG.GeonextReader.changeOriginIds(board,defEl[i]);defElN[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('name')[0];defElV[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('visible')[0].firstChild.data;defElT[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('trace')[0].firstChild.data;defElD[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('dash')[0].firstChild.data;defElDr[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('draft')[0].firstChild.data;defElSW[i]=Data.getElementsByTagName('output')[i].getElementsByTagName('strokewidth')[0].firstChild.data;var tmp=Data.getElementsByTagName('output')[i].getElementsByTagName('color')[0];defElColStr[i]=tmp.getElementsByTagName('stroke')[0].firstChild.data;defElHColStr[i]=tmp.getElementsByTagName('lighting')[0].firstChild.data;defElColF[i]=tmp.getElementsByTagName('fill')[0].firstChild.data;defElColL[i]=tmp.getElementsByTagName('label')[0].firstChild.data;}
gxtEl.outputFixed=Data.getElementsByTagName('output')[0].getElementsByTagName('fix')[0].firstChild.data;gxtEl.outputStyle=Data.getElementsByTagName('output')[0].getElementsByTagName('style')[0].firstChild.data;var pid=defEl[0];board.objects[pid].setProperty('strokeColor:'+defElColStr[0],'strokeWidth:'+defElSW[0],'fillColor:'+defElColStr[0],'highlightStrokeColor:'+defElHColStr[0],'highlightFillColor:'+defElHColStr[0],'visible:'+defElV[0],'fixed:'+gxtEl.outputFixed,'labelColor:'+defElColL[0],'draft:'+defElDr[0]);board.objects[pid].setStyle(1*gxtEl.outputStyle);board.objects[pid].traced=(defElT[0]=='false')?false:true;var cid=defEl[1];board.objects[cid].setProperty('strokeColor:'+defElColStr[1],'strokeWidth:'+defElSW[1],'fillColor:'+defElColF[1],'highlightStrokeColor:'+defElHColStr[1],'highlightFillColor:'+defElColF[1],'visible:'+defElV[1],'dash:'+defElD[1],'draft:'+defElDr[1]);board.objects[cid].traced=(defElT[1]=='false')?false:true;}
JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"polygon":gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.dataVertex=[];for(var i=0;i<Data.getElementsByTagName('data')[0].getElementsByTagName('vertex').length;i++){gxtEl.dataVertex[i]=Data.getElementsByTagName('data')[0].getElementsByTagName('vertex')[i].firstChild.data;gxtEl.dataVertex[i]=JXG.GeonextReader.changeOriginIds(board,gxtEl.dataVertex[i]);}
gxtEl.border=[];for(var i=0;i<Data.getElementsByTagName('border').length;i++){gxtEl.border[i]={};var tmp=Data.getElementsByTagName('border')[i];gxtEl.border[i].id=tmp.getElementsByTagName('id')[0].firstChild.data;gxtEl.border[i].name=tmp.getElementsByTagName('name')[0].firstChild.data;gxtEl.border[i].straightFirst=tmp.getElementsByTagName('straight')[0].getElementsByTagName('first')[0].firstChild.data;gxtEl.border[i].straightLast=tmp.getElementsByTagName('straight')[0].getElementsByTagName('last')[0].firstChild.data;gxtEl.border[i].straightFirst=(gxtEl.border[i].straightFirst=='false')?false:true;gxtEl.border[i].straightLast=(gxtEl.border[i].straightLast=='false')?false:true;gxtEl.border[i].strokewidth=tmp.getElementsByTagName('strokewidth')[0].firstChild.data;gxtEl.border[i].dash=tmp.getElementsByTagName('dash')[0].firstChild.data;gxtEl.border[i].visible=tmp.getElementsByTagName('visible')[0].firstChild.data;gxtEl.border[i].draft=tmp.getElementsByTagName('draft')[0].firstChild.data;gxtEl.border[i].trace=tmp.getElementsByTagName('trace')[0].firstChild.data;gxtEl.border[i].colorStroke=tmp.getElementsByTagName('color')[0].getElementsByTagName('stroke')[0].firstChild.data;gxtEl.border[i].highlightStrokeColor=tmp.getElementsByTagName('color')[0].getElementsByTagName('lighting')[0].firstChild.data;gxtEl.border[i].colorFill=tmp.getElementsByTagName('color')[0].getElementsByTagName('fill')[0].firstChild.data;gxtEl.border[i].colorLabel=tmp.getElementsByTagName('color')[0].getElementsByTagName('label')[0].firstChild.data;gxtEl.border[i].colorDraft=tmp.getElementsByTagName('color')[0].getElementsByTagName('draft')[0].firstChild.data;}
JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'polygone');var p=new JXG.Polygon(board,gxtEl.dataVertex,gxtEl.border,gxtEl.id,gxtEl.name);p.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'draft:'+gxtEl.draft,'trace:'+gxtEl.trace);for(i=0;i<p.borders.length;i++){p.borders[i].setStraight(gxtEl.border[i].straightFirst,gxtEl.border[i].straightLast);p.borders[i].setProperty('strokeColor:'+gxtEl.border[i].colorStroke,'strokeWidth:'+gxtEl.border[i].strokewidth,'fillColor:'+gxtEl.border[i].colorFill,'highlightStrokeColor:'+gxtEl.border[i].highlightStrokeColor,'highlightFillColor:'+gxtEl.border[i].colorFill,'visible:'+gxtEl.border[i].visible,'dash:'+gxtEl.border[i].dash,'draft:'+gxtEl.border[i].draft,'trace:'+gxtEl.border[i].trace);}
JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"graph":gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.funct=Data.getElementsByTagName('data')[0].getElementsByTagName('function')[0].firstChild.data;JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'graphs');var g=new JXG.Curve(board,['x',gxtEl.funct],gxtEl.id,gxtEl.name);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');g.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:none','highlightStrokeColor:'+gxtEl.highlightStrokeColor);break;case"arrow":gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'straight','straight');gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl.first=JXG.GeonextReader.changeOriginIds(board,gxtEl.first);gxtEl.last=JXG.GeonextReader.changeOriginIds(board,gxtEl.last);var a=new JXG.Line(board,gxtEl.first,gxtEl.last,gxtEl.id,gxtEl.name);a.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'dash:'+gxtEl.dash,'draft:'+gxtEl.draft);a.setStraight(false,false);a.setArrow(false,true);a.traced=(gxtEl.trace=='false')?false:true;JXG.GeonextReader.printDebugMessage('debug',a,Data.nodeName,'OK');break;case"arc":gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.firstArrow=Data.getElementsByTagName('firstarrow')[0].firstChild.data;gxtEl.lastArrow=Data.getElementsByTagName('lastarrow')[0].firstChild.data;JXG.GeonextReader.parseImage(board,Data.getElementsByTagName('image')[0],'arcs');gxtEl.midpoint=JXG.GeonextReader.changeOriginIds(board,gxtEl.midpoint);gxtEl.angle=JXG.GeonextReader.changeOriginIds(board,gxtEl.angle);gxtEl.radius=JXG.GeonextReader.changeOriginIds(board,gxtEl.radius);var a=new JXG.Arc(board,gxtEl.midpoint,gxtEl.radius,gxtEl.angle,gxtEl.id,gxtEl.name);a.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'dash:'+gxtEl.dash,'draft:'+gxtEl.draft);a.traced=(gxtEl.trace=='false')?false:true;gxtEl.firstArrow=(gxtEl.firstArrow=='false')?false:true;gxtEl.lastArrow=(gxtEl.lastArrow=='false')?false:true;a.setArrow(gxtEl.firstArrow,gxtEl.lastArrow);JXG.GeonextReader.printDebugMessage('debug',a,Data.nodeName,'OK');break;case"angle":gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.txt=JXG.GeonextReader.subtreeToString(Data.getElementsByTagName('text')[0]);var a=new JXG.Angle(board,gxtEl.first,gxtEl.middle,gxtEl.last,gxtEl.radius,gxtEl.txt,gxtEl.id,gxtEl.name);a.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:'+gxtEl.colorFill,'highlightStrokeColor:'+gxtEl.highlightStrokeColor,'highlightFillColor:'+gxtEl.colorFill,'visible:'+gxtEl.visible,'dash:'+gxtEl.dash);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case"text":if(gxtEl.id.match(/oldVersion/))break;gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.visualProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.readNodes(gxtEl,Data,'data');gxtEl.mpStr=JXG.GeonextReader.subtreeToString(Data.getElementsByTagName('data')[0].getElementsByTagName('mp')[0]);gxtEl.mpStr=gxtEl.mpStr.replace(/<\/?mp>/g,'');try{if(Data.getElementsByTagName('data')[0].getElementsByTagName('parent')[0].firstChild){gxtEl.parent=Data.getElementsByTagName('data')[0].getElementsByTagName('parent')[0].firstChild.data;}}catch(e){}
gxtEl.condition=Data.getElementsByTagName('condition')[0].firstChild.data;gxtEl.content=Data.getElementsByTagName('content')[0].firstChild.data;gxtEl.fix=Data.getElementsByTagName('fix')[0].firstChild.data;gxtEl.autodigits=Data.getElementsByTagName('digits')[0].firstChild.data;gxtEl.parent=JXG.GeonextReader.changeOriginIds(board,gxtEl.parent);var c=new JXG.Text(board,gxtEl.mpStr,gxtEl.parent,[gxtEl.x,gxtEl.y],gxtEl.id,gxtEl.name,gxtEl.autodigits);c.setProperty('labelColor:'+gxtEl.colorLabel);if(gxtEl.visible=="false"){c.hideElement();}
break;case'parametercurve':gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.functionx=Data.getElementsByTagName('functionx')[0].firstChild.data;gxtEl.functiony=Data.getElementsByTagName('functiony')[0].firstChild.data;gxtEl.min=Data.getElementsByTagName('min')[0].firstChild.data;gxtEl.max=Data.getElementsByTagName('max')[0].firstChild.data;var g=new JXG.Curve(board,[gxtEl.functionx,gxtEl.functiony,'t',gxtEl.min,gxtEl.max],gxtEl.id,gxtEl.name);g.setProperty('strokeColor:'+gxtEl.colorStroke,'strokeWidth:'+gxtEl.strokewidth,'fillColor:none','highlightStrokeColor:'+gxtEl.highlightStrokeColor);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;case'tracecurve':gxtEl.tracepoint=Data.getElementsByTagName('tracepoint')[0].firstChild.data;gxtEl.traceslider=Data.getElementsByTagName('traceslider')[0].firstChild.data;JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'<b>ERR</b>');break;case'group':gxtEl=JXG.GeonextReader.boardProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.colorProperties(gxtEl,Data);gxtEl=JXG.GeonextReader.firstLevelProperties(gxtEl,Data);gxtEl.members=[];for(var i=0;i<Data.getElementsByTagName('data')[0].getElementsByTagName('member').length;i++){gxtEl.members[i]=Data.getElementsByTagName('data')[0].getElementsByTagName('member')[i].firstChild.data;gxtEl.members[i]=JXG.GeonextReader.changeOriginIds(board,gxtEl.members[i]);}
var g=new JXG.Group(board,gxtEl.id,gxtEl.name,gxtEl.members);JXG.GeonextReader.printDebugMessage('debug',gxtEl,Data.nodeName,'OK');break;default:if(Data.nodeName!="#text"){}}
delete(gxtEl);});board.addConditions(boardTmp.conditions);};this.decodeString=function(str){if(str.indexOf("<GEONEXT>")<0){var unz=(new JXG.Gunzip(Base64.decodeAsArray(str))).unzip();if(unz=="")
return str;else
return unz;}else{return str;}};this.prepareString=function(fileStr){if(fileStr.indexOf('GEONEXT')<0){fileStr=JXG.GeonextReader.decodeString(fileStr);}
fileStr=JXG.GeonextReader.fixXML(fileStr);return fileStr;};this.fixXML=function(str){var arr=["active","angle","animate","animated","arc","area","arrow","author","autodigits","axis","back","background","board","border","bottom","buttonsize","cas","circle","color","comment","composition","condition","conditions","content","continuous","control","coord","coordinates","cross","cs","dash","data","description","digits","direction","draft","editable","elements","event","file","fill","first","firstarrow","fix","fontsize","free","full","function","functionx","functiony","GEONEXT","graph","grid","group","height","id","image","info","information","input","intersection","item","jsf","label","last","lastarrow","left","lefttoolbar","lighting","line","loop","max","maximized","member","middle","midpoint","min","modifier","modus","mp","mpx","multi","name","onpolygon","order","origin","output","overline","parametercurve","parent","point","pointsnap","polygon","position","radius","radiusnum","radiusvalue","right","section","selectedlefttoolbar","showconstruction","showcoord","showinfo","showunit","showx","showy","size","slider","snap","speed","src","start","stop","straight","stroke","strokewidth","style","term","text","top","trace","tracecurve","type","unit","value","VERSION","vertex","viewport","visible","width","wot","x","xooy","xval","y","yval","zoom"];str=str.escapeHTML();var list=arr.join('|');var regex='\&lt;(/?('+list+'))\&gt;';var expr=new RegExp(regex,'g');str=str.replace(expr,'<$1>');str=str.replace(/(<content>.*)<arc>(.*<\/content>)/g,'$1&lt;arc&gt;$2');str=str.replace(/(<mp>.*)<arc>(.*<\/mpx>)/g,'$1&lt;arc&gt;$2');str=str.replace(/(<mpx>.*)<arc>(.*<\/mpx>)/g,'$1&lt;arc&gt;$2');return str;};};JXG.IntergeoReader=new function(){this.board=null;this.objects={};this.readIntergeo=function(tree,board){this.board=board;this.board.origin={};this.board.origin.usrCoords=[1,0,0];this.board.origin.scrCoords=[1,400,300];this.board.unitX=30;this.board.unitY=30;this.readElements(tree.getElementsByTagName("elements"));this.readConstraints(tree.getElementsByTagName("constraints"));};this.readElements=function(tree){$R(0,tree[0].childNodes.length-1).each(function(s){var node=tree[0].childNodes[s];if(node.nodeType>1){return;}
if(node.nodeName=='point'){JXG.IntergeoReader.addPoint(node);}
else if(node.nodeName=='line'){JXG.IntergeoReader.storeLine(node);}
else{}});};this.addPoint=function(node){var i=0;var p=node.childNodes[i];while(p.nodeType>1){i++;p=node.childNodes[i];}
if(p.nodeName=='homogeneous_coordinates'){var c=[];for(var j=0;j<p.childNodes.length;j++){if(p.childNodes[j].nodeType==1){if(p.childNodes[j].nodeName=='double'){c.push(p.childNodes[j].firstChild.data);}else{}}}
this.board.createElement('point',[c[0]/c[2],c[1]/c[2]],{name:node.getAttribute('id'),id:node.getAttribute('id')});}else if(p.nodeName=='euclidean_coordinates'){var c=[];for(var j=0;j<p.childNodes.length;j++){if(p.childNodes[j].nodeType==1){c.push(p.childNodes[j].firstChild.data);}}
this.board.createElement('point',[c[0],c[1]],{name:node.getAttribute('id'),id:node.getAttribute('id')});}else if(p.nodeName=='polar_coordinates'){var c=[];for(var j=0;j<p.childNodes.length;j++){if(p.childNodes[j].nodeType==1){c.push(p.childNodes[j].firstChild.data);}}
this.board.createElement('point',[c[0]*Math.cos(c[1]),c[0]*Math.sin(c[1])],{name:node.getAttribute('id'),id:node.getAttribute('id')});}else{}};this.storeLine=function(node){this.objects[node.getAttribute('id')]={'id':node.getAttribute('id'),'coords':null};var i=0;var p=node.childNodes[i];while(p.nodeType>1){i++;p=node.childNodes[i];}
if(p.nodeName=='homogeneous_coordinates'){var c=[];for(var j=0;j<p.childNodes.length;j++){if(p.childNodes[j].nodeType==1){if(p.childNodes[j].nodeName=='double'){c.push(parseFloat(p.childNodes[j].firstChild.data));}else{}}}
this.objects[node.getAttribute('id')].coords=c;}};this.readConstraints=function(tree){$R(0,tree[0].childNodes.length-1).each(function(s){var node=tree[0].childNodes[s];if(node.nodeType>1){return;}
if(node.nodeName=='line_through_two_points'){JXG.IntergeoReader.addLineThroughTwoPoints(node);}
else if(node.nodeName=='line_parallel_to_line_through_point'){JXG.IntergeoReader.addLineParallelToLineThroughPoint(node);}
else if(node.nodeName=='line_perpendicular_to_line_through_point'){JXG.IntergeoReader.addLinePerpendicularToLineThroughPoint(node);}
else if(node.nodeName=='point_intersection_of_two_lines'){JXG.IntergeoReader.addPointIntersectionOfTwoLines(node);}
else if(node.nodeName=='free_point'){}
else if(node.nodeName=='free_line'){JXG.IntergeoReader.addFreeLine(node);}
else if(node.nodeName=='point_on_line'){JXG.IntergeoReader.addPointOnLine(node);}
else if(node.nodeName=='angular_bisector_of_three_points'){JXG.IntergeoReader.addAngularBisectorOfThreePoints(node);}
else{}});};this.readParams=function(node){var param=[];for(var j=0;j<node.childNodes.length;j++){if(node.childNodes[j].nodeType==1){param.push(node.childNodes[j].firstChild.data);}}
return param;};this.addLineThroughTwoPoints=function(node){var param=JXG.IntergeoReader.readParams(node);if(this.board.objects[param[1]]!=null&&this.board.objects[param[2]]!=null){var el=this.board.createElement('line',[param[1],param[2]],{name:param[0],id:param[0]});}};this.addLineParallelToLineThroughPoint=function(node){var param=JXG.IntergeoReader.readParams(node);var comp=this.board.createElement('parallel',[param[1],this.objects[param[2]].id],{name:param[0],id:param[0]});this.objects[param[0]].id=el[0].id;};this.addLinePerpendicularToLineThroughPoint=function(node){var param=JXG.IntergeoReader.readParams(node);var comp=this.board.createElement('perpendicular',[param[1],this.objects[param[2]].id],{name:param[0],id:param[0]});comp[0].setProperty("straightFirst:true","straightLast:true");comp[1].setProperty("visible:false");this.objects[param[0]].id=comp[0].id;};this.addPointIntersectionOfTwoLines=function(node){var param=JXG.IntergeoReader.readParams(node);if(this.board.objects[param[1]]!=null&&this.board.objects[param[2]]!=null){var f=function(){return this.board.algebra.intersectLineLine(this.board.elementsByName[param[1]],this.board.elementsByName[param[2]]);};this.board.createElement('point',[f],{name:param[0],id:param[0]});}}
this.addFreeLine=function(node){var param=JXG.IntergeoReader.readParams(node);var a=this.objects[param[0]].coords[0];var b=this.objects[param[0]].coords[1];var c=this.objects[param[0]].coords[2];var p1=this.board.createElement('point',[(c-b)/(b-a),(a-c)/(b-a)],{visible:false});var p2=this.board.createElement('point',[(c-b)/(b-a)-b,(a-c)/(b-a)+a],{visible:false});var comp=this.board.createElement('line',[p1,p2],{name:param[0],id:param[0]});};this.addPointOnLine=function(node){var param=JXG.IntergeoReader.readParams(node);var p=JXG.GetReferenceFromParameter(this.board,param[0]);p.makeGlider(this.objects[param[1]].id);};this.addAngularBisectorOfThreePoints=function(node){var param=JXG.IntergeoReader.readParams(node);var comp=this.board.createElement('bisector',[param[1],param[2],param[3]],{name:param[0],id:param[0]});comp.setProperty("straightFirst:false","straightLast:true");this.objects[param[0]].id=comp.id;};};JXG.JSXGraph=new function(forceRenderer){this.licenseText='JSXGraph v0.60 Copyright (C) 2008 see http://jsxgraph.org';this.rendererType='';this.boards={};this.elements={};var ie;var opera;if((forceRenderer=='undefined')||(forceRenderer==null)||(forceRenderer=='')){ie=navigator.appVersion.match(/MSIE (\d\.\d)/);opera=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);if((!ie)||(opera)){this.rendererType='svg';}
else{this.rendererType='vml';}}else{this.rendererType=forceRenderer;}
JXG.rendererFiles[this.rendererType].split(',').each(function(include){JXG.require(JXG.requirePath+include+'.js');});this.initBoard=function(box,atts){var renderer;if(typeof atts=='undefined')
atts={};originX=((typeof atts["originX"])=='undefined'?150:atts["originX"]);originY=((typeof atts["originY"])=='undefined'?150:atts["originY"]);zoomX=((typeof atts["zoomX"])=='undefined'?1.0:atts["zoomX"]);zoomY=((typeof atts["zoomY"])=='undefined'?1.0:atts["zoomY"]);unitX=((typeof atts["unitX"])=='undefined'?50:atts["unitX"]);unitY=((typeof atts["unitY"])=='undefined'?50:atts["unitY"]);if(this.rendererType=='svg'){renderer=new JXG.SVGRenderer($(box));}else if(this.rendererType=='vml'){renderer=new JXG.VMLRenderer($(box));}else{renderer=new JXG.SilverlightRenderer($(box));}
var dimensions=$(box).getDimensions();var board=new JXG.Board(box,renderer,'',[originX,originY],1.0,1.0,unitX,unitY,dimensions.width,dimensions.height);this.boards[board.id]=board;board.initGeonextBoard();return board;}
this.loadBoardFromFile=function(box,file,format){var renderer;if(this.rendererType=='svg'){renderer=new JXG.SVGRenderer($(box));}else{renderer=new JXG.VMLRenderer($(box));}
var dimensions=$(box).getDimensions();var board=new JXG.Board(box,renderer,'',[150,150],1.0,1.0,50,50,dimensions.width,dimensions.height);board.beforeLoad();JXG.FileReader.parseFileContent(file,board,format);this.boards[board.id]=board;return board;}
this.loadBoardFromString=function(box,string,format){var renderer;if(this.rendererType=='svg'){renderer=new JXG.SVGRenderer($(box));}else{renderer=new JXG.VMLRenderer($(box));}
var dimensions=$(box).getDimensions();var board=new JXG.Board(box,renderer,'',[150,150],1.0,1.0,50,50,dimensions.width,dimensions.height);board.beforeLoad();JXG.FileReader.parseString(string,board,format);this.boards[board.id]=board;return board;}
this.freeBoard=function(board){if(typeof(board)=='string'){board=this.boards[board];}
Event.stopObserving(board.container,'mousedown',board.onMouseDownListener);Event.stopObserving(board.container,'mouseup',board.onMouseUpListener);Event.stopObserving(board.container,'mousemove',board.onMouseMoveListener);for(var el in board.objects){board.removeObject(board.objects[el]);}
$(board.container).innerHTML='';for(var el in board.objects){delete(board.objects[el]);}
delete(board.renderer);delete(board.algebra);delete(this.boards[board.id]);}
this.registerElement=function(element,creator){element=element.toLowerCase();this.elements[element]=creator;}
this.unregisterElement=function(element){delete(this.elements[element]);}};JXG.GetReferenceFromParameter=function(board,object){if(typeof(object)=='string'){if(board.objects[object]!=null){object=board.objects[object];}else if(board.elementsByName[object]!=null){object=board.elementsByName[object];}}
return object;};JXG.IsString=function(s){return Object.isString(s);};JXG.IsNumber=function(n){if(typeof n=='number')
return true;return false;};JXG.IsFunction=function(f){return Object.isFunction(f);};JXG.IsArray=function(a){return Object.isArray(a);};JXG.IsPoint=function(p){if(typeof p=='object'){return(p.elementClass==JXG.OBJECT_CLASS_POINT);}
return false;};JXG.createEvalFunction=function(board,param,n){var f=[];for(var i=0;i<n;i++){if(typeof param[i]=='string'){var str=board.algebra.geonext2JS(param[i]);str=str.replace(/this\.board\./g,'board.');f[i]=new Function('','return '+(str)+';');}}
return function(k){var a=param[k];if(typeof a=='string'){return f[k]();}else if(typeof a=='function'){return a();}else if(typeof a=='number'){return a;}
return 0;}}
JXG.OBJECT_TYPE_ARC=0x4F544143;JXG.OBJECT_TYPE_ARROW=0x4F544157;JXG.OBJECT_TYPE_AXIS=0x4F544158;JXG.OBJECT_TYPE_CIRCLE=0x4F54434C;JXG.OBJECT_TYPE_CURVE=0x4F544750;JXG.OBJECT_TYPE_IMAGE=0x4F54524D;JXG.OBJECT_TYPE_LINE=0x4F544C4E;JXG.OBJECT_TYPE_POINT=0x4F545054;JXG.OBJECT_TYPE_SLIDER=0x4F545344;JXG.OBJECT_TYPE_CAS=0x4F544350;JXG.OBJECT_TYPE_POLYGON=0x4F545059;JXG.OBJECT_TYPE_SECTOR=0x4F545343;JXG.OBJECT_TYPE_TEXT=0x4F545445;JXG.OBJECT_TYPE_ANGLE=0x4F544147;JXG.OBJECT_TYPE_INTERSECTION=0x4F54524E;JXG.OBJECT_CLASS_POINT=1;JXG.OBJECT_CLASS_LINE=2;JXG.OBJECT_CLASS_CIRCLE=3;JXG.OBJECT_CLASS_CURVE=4;JXG.OBJECT_CLASS_AREA=5;JXG.OBJECT_CLASS_OTHER=6;JXG.GeometryElement=function(){this.board=null;this.id='';this.needsUpdate=true;this.name='';this.visProp={};this.isReal=true;this.visProp['dash']=0;this.childElements={};this.notExistingParents={};this.traced=false;this.traces={};this.numTraces=0;this.transformations=[];this.baseElement=null;this.descendants={};this.ancestors={};this.stdform=[1,0,0,0,1,1,0,0];this.afterFirstUpdate=false;this.needsRegularUpdate=true;};JXG.GeometryElement.prototype.init=function(board,id,name){if(typeof(board)=='string'){board=JXG.JSXGraph.boards[board];}
this.board=board;this.id=id;if((name!=null)&&(typeof name!='undefined')){name=name;}else{name=this.board.generateName(this);}
this.board.elementsByName[name]=this;this.name=name;this.visProp['strokeColor']=this.board.options.elements.color.strokeColor
this.visProp['highlightStrokeColor']=this.board.options.elements.color.highlightStrokeColor;this.visProp['fillColor']=this.board.options.elements.color.fillColor;this.visProp['highlightFillColor']=this.board.options.elements.color.highlightFillColor;this.visProp['strokeWidth']=this.board.options.elements.strokeWidth;this.visProp['strokeOpacity']=this.board.options.elements.color.strokeOpacity;this.visProp['highlightStrokeOpacity']=this.board.options.elements.color.highlightStrokeOpacity;this.visProp['fillOpacity']=this.board.options.elements.color.fillOpacity;this.visProp['highlightFillOpacity']=this.board.options.elements.color.highlightFillOpacity;this.visProp['draft']=this.board.options.elements.draft;};JXG.GeometryElement.prototype.addChild=function(obj){this.childElements[obj.id]=obj;this.addDescendants(obj);obj.ancestors[this.id]=this;for(el in this.descendants){this.descendants[el].ancestors[this.id]=this;for(el2 in this.ancestors){this.descendants[el].ancestors[this.ancestors[el2].id]=this.ancestors[el2];}}
for(el in this.ancestors){for(el2 in this.descendants){this.ancestors[el].descendants[this.descendants[el2].id]=this.descendants[el2];}}};JXG.GeometryElement.prototype.addDescendants=function(obj){this.descendants[obj.id]=obj;for(el in obj.childElements){this.addDescendants(obj.childElements[el]);}};JXG.GeometryElement.prototype.update=function(){if(this.traced){this.cloneToBackground(true);}};JXG.GeometryElement.prototype.updateRenderer=function(){};JXG.GeometryElement.prototype.hideElement=function(){this.visProp['visible']=false;this.board.renderer.hide(this);if(this.label!=null){this.label.hiddenByParent=true;if(this.label.show){this.board.renderer.hide(this.label);this.label.show=true;}}};JXG.GeometryElement.prototype.showElement=function(){this.visProp['visible']=true;this.board.renderer.show(this);if(this.label!=null&&this.label.hiddenByParent){this.label.hiddenByParent=false;if(this.label.show){this.board.renderer.show(this.label);}}};JXG.GeometryElement.prototype.setProperty=function(){var color;var opacity;var pair;for(var i=0;i<arguments.length;i++){var pairRaw=arguments[i];if(typeof pairRaw=='string'){pair=pairRaw.split(':');}else if(!Object.isArray(pairRaw)){for(var i=0;i<Object.keys(pairRaw).length;i++){var key=Object.keys(pairRaw)[i];this.setProperty([key,pairRaw[key]]);}
return;}else{pair=pairRaw;}
switch(pair[0].replace(/\s+/g).toLowerCase()){case'strokewidth':this.visProp['strokeWidth']=pair[1];this.board.renderer.setObjectStrokeWidth(this,this.visProp['strokeWidth']);break;case'strokecolor':color=pair[1];if(color.length=='9'&&color.substr(0,1)=='#'){opacity=color.substr(7,2);color=color.substr(0,7);}
else{opacity='FF';}
this.visProp['strokeColor']=color;this.visProp['strokeOpacity']=parseInt(opacity.toUpperCase(),16)/255;this.board.renderer.setObjectStrokeColor(this,this.visProp['strokeColor'],this.visProp['strokeOpacity']);break;case'fillcolor':color=pair[1];if(color.length=='9'&&color.substr(0,1)=='#'){opacity=color.substr(7,2);color=color.substr(0,7);}
else{opacity='FF';}
this.visProp['fillColor']=color;this.visProp['fillOpacity']=parseInt(opacity.toUpperCase(),16)/255;this.board.renderer.setObjectFillColor(this,this.visProp['fillColor'],this.visProp['fillOpacity']);break;case'highlightstrokecolor':color=pair[1];if(color.length=='9'&&color.substr(0,1)=='#'){opacity=color.substr(7,2);color=color.substr(0,7);}
else{opacity='FF';}
this.visProp['highlightStrokeColor']=color;this.visProp['highlightStrokeOpacity']=parseInt(opacity.toUpperCase(),16)/255;break;case'highlightfillcolor':color=pair[1];if(color.length=='9'&&color.substr(0,1)=='#'){opacity=color.substr(7,2);color=color.substr(0,7);}
else{opacity='FF';}
this.visProp['highlightFillColor']=color;this.visProp['highlightFillOpacity']=parseInt(opacity.toUpperCase(),16)/255;break;case'fillopacity':this.visProp['fillOpacity']=pair[1];this.board.renderer.setObjectFillColor(this,this.visProp['fillColor'],this.visProp['fillOpacity']);break;case'strokeopacity':this.visProp['strokeOpacity']=pair[1];this.board.renderer.setObjectStrokeColor(this,this.visProp['strokeColor'],this.visProp['strokeOpacity']);break;case'highlightfillopacity':this.visProp['highlightFillOpacity']=pair[1];break;case'strokeopacity':this.visProp['highlightStrokeOpacity']=pair[1];break;case'labelcolor':color=pair[1];if(color.length=='9'&&color.substr(0,1)=='#'){opacity=color.substr(7,2);color=color.substr(0,7);}
else{opacity='FF';}
if(opacity=='00'){if(this.label!=null){this.label.hideElement();}}
if(this.label!=null){this.label.color=color;this.board.renderer.setLabelColor(this.label);}
if(this.type==JXG.OBJECT_TYPE_TEXT){this.visProp['strokeColor']=color;this.board.renderer.setObjectStrokeColor(this,this.visProp['strokeColor'],1);}
break;case'visible':if(pair[1]=='false'||pair[1]==false){this.visProp['visible']=false;this.hideElement();}
else if(pair[1]=='true'||pair[1]==true){this.visProp['visible']=true;this.showElement();}
break;case'dash':this.setDash(pair[1]);break;case'trace':if(pair[1]=='false'||pair[1]==false){this.traced=false;}
else if(pair[1]=='true'||pair[1]==true){this.traced=true;}
break;case'style':this.setStyle(1*pair[1]);break;case'fixed':this.fixed=(pair[1]=='false')?false:true;break;case'draft':if(pair[1]=='false'||pair[1]==false){if(this.visProp['draft']==true){this.visProp['draft']=false;this.board.renderer.removeDraft(this);}}
else if(pair[1]=='true'||pair[1]==true){this.visProp['draft']=true;this.board.renderer.setDraft(this);}
break;case'straightfirst':if(pair[1]=='false'||pair[1]==false){this.visProp['straightFirst']=false;}
else if(pair[1]=='true'||pair[1]==true){this.visProp['straightFirst']=true;}
this.setStraight(this.visProp['straightFirst'],this.visProp['straightLast']);break;case'straightlast':if(pair[1]=='false'||pair[1]==false){this.visProp['straightLast']=false;}
else if(pair[1]=='true'||pair[1]==true){this.visProp['straightLast']=true;}
this.setStraight(this.visProp['straightFirst'],this.visProp['straightLast']);break;case'firstarrow':if(pair[1]=='false'||pair[1]==false){this.visProp['firstArrow']=false;}
else if(pair[1]=='true'||pair[1]==true){this.visProp['firstArrow']=true;}
this.setArrow(this.visProp['firstArrow'],this.visProp['lastArrow']);break;case'lastarrow':if(pair[1]=='false'||pair[1]==false){this.visProp['lastArrow']=false;}
else if(pair[1]=='true'||pair[1]==true){this.visProp['lastArrow']=true;}
this.setArrow(this.visProp['firstArrow'],this.visProp['lastArrow']);break;case'withticks':if(pair[1]=='false'||pair[1]==false){this.disableTicks();}
else if(pair[1]=='true'||pair[1]==true){this.enableTicks();}
break;case'curvetype':this.curveType=pair[1];break;case'fontsize':this.visProp['fontSize']=pair[1];break;}}};JXG.GeometryElement.prototype.setDash=function(dash){this.visProp['dash']=dash;this.board.renderer.setObjectDash(this);};JXG.GeometryElement.prototype.prepareUpdate=function(){this.needsUpdate=true;return;for(var Elements in this.childElements){if(this.board.objects[Elements]!=undefined){this.childElements[Elements].prepareUpdate();}else{delete(this.childElements[Elements]);}}};JXG.GeometryElement.prototype.remove=function(){this.board.renderer.remove($(this.id));};JXG.GeometryElement.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board);};JXG.GeometryElement.prototype.setStyle=function(x){};JXG.GeometryElement.prototype.setStraight=function(x,y){};JXG.GeometryElement.prototype.clearTrace=function(){for(var obj in this.traces){this.board.renderer.remove(this.traces[obj]);}
this.numTraces=0;};JXG.GeometryElement.prototype.cloneToBackground=function(addToTrace){return;};JXG.GeometryElement.prototype.normalize=function(){this.stdform=this.board.algebra.normalize(this.stdform);};JXG.GeometryElement.prototype.toJSON=function(){var json='{"name":'+Object.toJSON(this.name);json+=', '+'"id":'+Object.toJSON(this.id);var vis=[];for(var key in this.visProp){if(this.visProp[key]!=null){vis.push('"'+key+'":'+Object.toJSON(this.visProp[key]));}}
json+=', "visProp":{'+vis.toString()+'}';json+='}';return json;};JXG.Board=function(container,renderer,id,origin,zoomX,zoomY,unitX,unitY,canvasWidth,canvasHeight){this.BOARD_MODE_NONE=0x0000;this.BOARD_MODE_DRAG=0x0001;this.BOARD_MODE_CONSTRUCT=0x0010;this.BOARD_MODE_MOVE_ORIGIN=0x0002;this.BOARD_QUALITY_LOW=0x1;this.BOARD_QUALITY_HIGH=0x2;this.CONSTRUCTION_TYPE_POINT=0x43545054;this.CONSTRUCTION_TYPE_CIRCLE=0x4354434C;this.CONSTRUCTION_TYPE_LINE=0x43544C4E;this.CONSTRUCTION_TYPE_GLIDER=0x43544744;this.CONSTRUCTION_TYPE_MIDPOINT=0x43544D50;this.CONSTRUCTION_TYPE_PERPENDICULAR=0x43545044;this.CONSTRUCTION_TYPE_PARALLEL=0x4354504C;this.CONSTRUCTION_TYPE_INTERSECTION=0x43544953;this.container=container;$(this.container).undoPositioned;this.renderer=renderer;this.options=new JXG.Options();this.dimension=2;this.origin={};this.origin.usrCoords=[1,0,0];this.origin.scrCoords=[1,origin[0],origin[1]];this.zoomX=zoomX;this.zoomY=zoomY;this.unitX=unitX;this.unitY=unitY;this.canvasWidth=canvasWidth;this.canvasHeight=canvasHeight;this.fontSize=this.options.fontSize;this.algebra=new JXG.Algebra(this);this.mathStatistics=new JXG.MathStatistics();if((id!='')&&(id!=null)&&(typeof $(id)!='undefined'))
this.id=id;else
this.id=this.generateId();this.hooks=[];this.objects={};this.highlightedObjects={};this.numObjects=0;this.elementsByName={};this.mode=this.BOARD_MODE_NONE;this.updateQuality=this.BOARD_QUALITY_HIGH;this.isSuspendedRedraw=false;this.snapToGrid=this.options.grid.snapToGrid;this.gridX=this.options.grid.gridX;this.gridY=this.options.grid.gridY;this.gridColor=this.options.grid.gridColor;this.gridOpacity=this.options.grid.gridOpacity;this.gridDash=this.options.grid.gridDash;this.snapSizeX=this.options.grid.snapSizeX;this.snapSizeY=this.options.grid.snapSizeY;this.calculateSnapSizes();this.hasGrid=this.options.grid.hasGrid;this.drag_dx=0;this.drag_dy=0;this.drag_obj=null;this.xmlString='';this.renderer.displayCopyright(JXG.JSXGraph.licenseText,this.options.fontSize);this.fullUpdate=false;this.reducedUpdate=false;this.geonextCompatibilityMode=false;this.onMouseDownListener=this.mouseDownListener.bindAsEventListener(this);this.onMouseUpListener=this.mouseUpListener.bindAsEventListener(this);this.onMouseMoveListener=this.mouseMoveListener.bindAsEventListener(this);Event.observe(this.container,'mousedown',this.onMouseDownListener);Event.observe(this.container,'mousemove',this.onMouseMoveListener);};JXG.Board.prototype.generateName=function(object){var possibleNames;if(object.elementClass==JXG.OBJECT_CLASS_POINT){possibleNames=['','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];}else{possibleNames=['','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];}
var maxNameLength=3;var nameBase='';if(object.elementClass==JXG.OBJECT_CLASS_POINT||object.elementClass==JXG.OBJECT_CLASS_LINE){nameBase='';}
else if(object.type==JXG.OBJECT_TYPE_POLYGON){nameBase='P_';}
else if(object.type==JXG.OBJECT_TYPE_CIRCLE){nameBase='k_';}
else{nameBase='s_';}
var indices=[];var name='';var tmp='';var i=0;var j=0;for(i=0;i<maxNameLength;i++){indices[i]=0;}
while(indices[maxNameLength-1]<possibleNames.length){for(indices[0]=1;indices[0]<possibleNames.length;indices[0]++){name=nameBase;for(i=maxNameLength;i>0;i--){name+=possibleNames[indices[i-1]];}
if(this.elementsByName[name]==null){return name;}}
indices[0]=possibleNames.length;for(i=1;i<maxNameLength;i++){if(indices[i-1]==possibleNames.length){indices[i-1]=1;indices[i]++;}}}
return'';};JXG.Board.prototype.generateId=function(){var r=1;while(JXG.JSXGraph.boards['gxtBoard'+r]!=null){r=Math.round(Math.random()*33);}
return('gxtBoard'+r);};JXG.Board.prototype.getRelativeMouseCoordinates=function(Evt){var cPos=Element.cumulativeOffset($(this.container));cPos[0]+=parseInt($(this.container).getStyle('borderLeftWidth'));cPos[1]+=parseInt($(this.container).getStyle('borderTopWidth'));cPos[0]+=parseInt($(this.container).getStyle('paddingLeft'));cPos[1]+=parseInt($(this.container).getStyle('paddingTop'));return cPos;};JXG.Board.prototype.mouseUpListener=function(Evt){this.updateQuality=this.BOARD_QUALITY_HIGH;Event.stopObserving(this.container,'mouseup',this.onMouseUpListener);if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.fullUpdate=true;this.moveOrigin();}
this.mode=this.BOARD_MODE_NONE;var save=this.reducedUpdate;this.reducedUpdate=false;this.update();this.reducedUpdate=save;this.fullUpdate=false;this.drag_obj=null;};JXG.Board.prototype.mouseDownListener=function(Evt){var el;var cPos=this.getRelativeMouseCoordinates(Evt);var dx=Event.pointerX(Evt)-cPos[0];var dy=Event.pointerY(Evt)-cPos[1];if(Evt.shiftKey){this.drag_dx=dx-this.origin.scrCoords[1];this.drag_dy=dy-this.origin.scrCoords[2];this.mode=this.BOARD_MODE_MOVE_ORIGIN;Event.observe(this.container,'mouseup',this.onMouseUpListener);return;}
if(this.mode==this.BOARD_MODE_CONSTRUCT)return;this.mode=this.BOARD_MODE_DRAG;if(this.mode==this.BOARD_MODE_DRAG){for(el in this.objects){if((this.objects[el].hasPoint!=undefined)&&(this.objects[el].hasPoint(dx,dy))&&((this.objects[el].type==JXG.OBJECT_TYPE_POINT)||(this.objects[el].type==JXG.OBJECT_TYPE_GLIDER))&&(this.objects[el].visProp['visible'])&&(!this.objects[el].fixed)){this.drag_obj=this.objects[el];if((this.objects[el].type==JXG.OBJECT_TYPE_POINT)||(this.objects[el].type==JXG.OBJECT_TYPE_GLIDER)){break;}}}}
if(this.drag_obj==null){this.mode=this.BOARD_MODE_NONE;return;}
this.dragObjCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[dx,dy],this);Event.observe(this.container,'mouseup',this.onMouseUpListener);};JXG.Board.prototype.mouseMoveListener=function(Evt){var el;var cPos=this.getRelativeMouseCoordinates(Evt);var x=Event.pointerX(Evt)-cPos[0];var y=Event.pointerY(Evt)-cPos[1];this.updateQuality=this.BOARD_QUALITY_LOW;this.dehighlightAll();if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.origin.scrCoords[1]=x-this.drag_dx;this.origin.scrCoords[2]=y-this.drag_dy;this.fullUpdate=true;this.moveOrigin();}
else if(this.mode==this.BOARD_MODE_DRAG){var newPos=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this);if(this.drag_obj.type==JXG.OBJECT_TYPE_POINT||this.drag_obj.type==JXG.OBJECT_TYPE_LINE||this.drag_obj.type==JXG.OBJECT_TYPE_CIRCLE||this.drag_obj.type==JXG.OBJECT_TYPE_CURVE){if((this.geonextCompatibilityMode&&this.drag_obj.type==JXG.OBJECT_TYPE_POINT)||this.drag_obj.group.length!=0){this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,newPos.usrCoords[1],newPos.usrCoords[2]);}else{this.drag_obj.setPositionByTransform(JXG.COORDS_BY_USER,newPos.usrCoords[1]-this.dragObjCoords.usrCoords[1],newPos.usrCoords[2]-this.dragObjCoords.usrCoords[2]);this.dragObjCoords=newPos;}
this.update();}else if(this.drag_obj.type==JXG.OBJECT_TYPE_GLIDER){var oldCoords=this.drag_obj.coords;this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,newPos.usrCoords[1],newPos.usrCoords[2]);if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){this.drag_obj.coords=this.algebra.projectPointToCircle(this.drag_obj,this.drag_obj.slideObject);}else if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_LINE){this.drag_obj.coords=this.algebra.projectPointToLine(this.drag_obj,this.drag_obj.slideObject);}
if(this.drag_obj.group.length!=0){this.drag_obj.group[this.drag_obj.group.length-1].dX=this.drag_obj.coords.scrCoords[1]-oldCoords.scrCoords[1];this.drag_obj.group[this.drag_obj.group.length-1].dY=this.drag_obj.coords.scrCoords[2]-oldCoords.scrCoords[2];this.drag_obj.group[this.drag_obj.group.length-1].update(this);}else{this.update(this.drag_obj);}}}
else{for(el in this.objects){if((this.objects[el].hasPoint!=undefined)&&(this.objects[el].hasPoint(x,y))&&(this.objects[el].visProp['visible']==true)){this.renderer.highlight(this.objects[el]);this.highlightedObjects[el]=this.objects[el];}}}
this.fullUpdate=false;};JXG.Board.prototype.dehighlightAll=function(){for(var Element in this.highlightedObjects){this.renderer.noHighlight(this.highlightedObjects[Element]);}
this.highlightedObjects={};};JXG.Board.prototype.getScrCoordsOfMouse=function(x,y){if(this.snapToGrid){var newCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this);newCoords.setCoordinates(JXG.COORDS_BY_USER,[Math.round((newCoords.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((newCoords.usrCoords[2])*this.snapSizeY)/this.snapSizeY]);return[newCoords.scrCoords[1],newCoords.scrCoords[2]];}else{return[x,y];}}
JXG.Board.prototype.getUsrCoordsOfMouse=function(Evt){var cPos=this.getRelativeMouseCoordinates(Evt);var x=Event.pointerX(Evt)-cPos[0];var y=Event.pointerY(Evt)-cPos[1];var newCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this);if(this.snapToGrid){newCoords.setCoordinates(JXG.COORDS_BY_USER,[Math.round((newCoords.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((newCoords.usrCoords[2])*this.snapSizeY)/this.snapSizeY]);}
return[newCoords.usrCoords[1],newCoords.usrCoords[2]];}
JXG.Board.prototype.getAllUnderMouse=function(Evt){var elList=this.getAllObjectsUnderMouse(Evt);elList.push(this.getUsrCoordsOfMouse(Evt));return elList;};JXG.Board.prototype.getAllObjectsUnderMouse=function(Evt){var cPos=this.getRelativeMouseCoordinates(Evt);var dx=Event.pointerX(Evt)-cPos[0];var dy=Event.pointerY(Evt)-cPos[1];var elList=[];for(el in this.objects){if(this.objects[el].hasPoint(dx,dy)){elList.push(this.objects[el]);}}
return elList;};JXG.Board.prototype.setBoardMode=function(mode){this.mode=mode;};JXG.Board.prototype.moveOrigin=function(){for(var Element in this.objects){if((this.objects[Element].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[Element].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[Element].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[Element].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[Element].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[Element].type!=JXG.OBJECT_TYPE_AXIS))
this.objects[Element].coords.usr2screen();}}
this.update();if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this);}};JXG.Board.prototype.addPoint=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'P'+number;}
obj.label.id=elementId+"Label";this.objects[elementId]=obj;this.elementsByName[obj.name]=obj;obj.id=elementId;this.renderer.drawPoint(obj);this.renderer.drawLabel(obj.label);if(!obj.visProp['visible']){this.renderer.hide(obj);}
if(!obj.label.show){this.renderer.hide(obj.label);}
return elementId;};JXG.Board.prototype.addLine=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'L'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawLine(obj);return elementId;};JXG.Board.prototype.addCircle=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'C'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawCircle(obj);return elementId;};JXG.Board.prototype.addPolygon=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Py'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawPolygon(obj);return elementId;};JXG.Board.prototype.addArc=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Ac'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawArc(obj);return elementId;};JXG.Board.prototype.addSector=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Sc'+number;}
this.objects[elementId]=obj;obj.id=elementId;return elementId;};JXG.Board.prototype.addAngle=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Ag'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawAngle(obj);return elementId;};JXG.Board.prototype.addCurve=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'G'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawCurve(obj);return elementId;};JXG.Board.prototype.addChart=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Chart'+number;}
this.objects[elementId]=obj;obj.id=elementId;return elementId;};JXG.Board.prototype.addMidpoint=function(p1,p2,id,name){var point1=JXG.GetReferenceFromParameter(this,p1);var point2=JXG.GetReferenceFromParameter(this,p2);var midpointCoords=this.algebra.midpoint(point1,point2).usrCoords.slice(1);var p=new JXG.Point(this,midpointCoords,id,name,true);p.fixed=true;point1.addChild(p);point2.addChild(p);p.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.midpoint(point1,point2);this.label.setCoordinates(this.coords);if(this.traced){this.cloneToBackground(true);}}};return p;};JXG.Board.prototype.addReflection=function(line,point,id,name){var po=JXG.GetReferenceFromParameter(this,point);var li=JXG.GetReferenceFromParameter(this,line);var reflectCoords=this.algebra.reflection(li,po).usrCoords.slice(1);var p=new JXG.Point(this,reflectCoords,id,name,true);p.fixed=true;po.addChild(p);li.addChild(p);p.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.reflection(li,po);this.label.setCoordinates(this.coords);if(this.traced){this.cloneToBackground(true);}}};return p;};JXG.Board.prototype.addRotation=function(rotpoint,point,phi,id,name){var po=JXG.GetReferenceFromParameter(this,point);var ropo=JXG.GetReferenceFromParameter(this,rotpoint);var rotCoords=this.algebra.rotation(ropo,po,phi).usrCoords.slice(1);var p=new JXG.Point(this,rotCoords,id,name,true);p.fixed=true;po.addChild(p);ropo.addChild(p);p.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.rotation(ropo,po,phi);this.label.setCoordinates(this.coords);this.needsUpdate=false;if(this.traced){this.cloneToBackground(true);}}};return p;};JXG.Board.prototype.addParallel=function(l,p,id,name){var point=JXG.GetReferenceFromParameter(this,p);var line=JXG.GetReferenceFromParameter(this,l);var number=this.numObjects;number++;if((id=='')||(id==null)){id=this.id+'L'+number;}
var p2coords=this.algebra.parallel(line.point1,line.point2,point).usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,id+"P2",name,false);point2.fixed=true;point.addChild(point2);var parallel=new JXG.Line(this,point.id,point2.id,id,id);parallel.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.parallel(line.point1,line.point2,point);this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};return parallel;};JXG.Board.prototype.addArrowParallel=function(a,p,arrowId,pointId,arrowName,pointName){var point=JXG.GetReferenceFromParameter(this,p);var arrow=JXG.GetReferenceFromParameter(this,a);var number=this.numObjects;number++;if((arrowId=='')||(arrowId==null)){arrowId=this.id+'A'+number;}
number++;if((pointId=='')||(pointId==null)){pointId=this.id+'P'+number;}
var p2coords=this.algebra.parallel(arrow.point1,arrow.point2,point).usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,pointId,pointName,true);point2.fixed=true;point.addChild(point2);arrow.addChild(point2);var parallelArrow=new JXG.Line(this,point.id,point2.id,arrowId,arrowName);parallelArrow.setStraight(false,false);parallelArrow.setArrow(false,true);parallelArrow.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.parallel(arrow.point1,arrow.point2,point);this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};point2.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.parallel(arrow.point1,arrow.point2,point);if(this.label.show){this.label.setCoordinates(this.coords);}
if(this.traced){this.cloneToBackground(true);}}};return[parallelArrow,point2];};JXG.Board.prototype.addParallelPoint=function(p1,p2,p3,id,name){var number=this.numObjects;number++;if((id=='')||(id==null)){id=this.id+'P'+number;}
p1=JXG.GetReferenceFromParameter(this,p1);p2=JXG.GetReferenceFromParameter(this,p2);p3=JXG.GetReferenceFromParameter(this,p3);var p2coords=this.algebra.parallel(p1,p2,p3).usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,id,name,true);point2.fixed=true;p1.addChild(point2);p3.addChild(point2);if(p1.type==JXG.OBJECT_TYPE_POINT){p2.addChild(point2);}
point2.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.parallel(p1,p2,p3);this.label.setCoordinates(this.coords);if(this.traced){this.cloneToBackground(true);}}};return point2;};JXG.Board.prototype.addArrow=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'A'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawArrow(obj);return elementId;};JXG.Board.prototype.addAxis=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'A'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawAxis(obj);return elementId;};JXG.Board.prototype.addNormal=function(l,p,id,name){var point=JXG.GetReferenceFromParameter(this,p);var line=JXG.GetReferenceFromParameter(this,l);var number=this.numObjects;number++;if((id=='')||(id==null)){id=this.id+'L'+number;}
var erg=this.algebra.perpendicular(line,point);var p2coords=erg[0].usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,id+"P2",'',false);point2.fixed=true;point.addChild(point2);line.addChild(point2);var perpendicular;if(erg[1]){perpendicular=new JXG.Line(this,point2.id,point.id,id,name);}
else{perpendicular=new JXG.Line(this,point.id,point2.id,id,name);}
perpendicular.changed=erg[1];perpendicular.update=function(){if(this.needsUpdate){var erg=this.board.algebra.perpendicular(line,point);point2.coords=erg[0];if(this.changed!=erg[1]){var tmp=this.point1;this.point1=this.point2;this.point2=tmp;}
this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};return perpendicular;};JXG.Board.prototype.addPerpendicular=function(l,p,idL,nameL,idP,nameP){var point=JXG.GetReferenceFromParameter(this,p);var line=JXG.GetReferenceFromParameter(this,l);var number=this.numObjects;number++;if((idL=='')||(idL==null)){idL=this.id+'L'+number;}
number++;if((idP=='')||(idP==null)){idP=this.id+'P'+number;}
var erg=this.algebra.perpendicular(line,point);var p2coords=erg[0].usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,idP,nameP,true);point2.fixed=true;point.addChild(point2);line.addChild(point2);var perpendicular;if(erg[1]){perpendicular=new JXG.Line(this,point2.id,point.id,idL,nameL);}
else{perpendicular=new JXG.Line(this,point.id,point2.id,idL,nameL);}
perpendicular.setStraight(false,false);perpendicular.changed=erg[1];perpendicular.update=function(){if(this.needsUpdate){var erg=this.board.algebra.perpendicular(line,point);point2.coords=erg[0];if(this.changed!=erg[1]){var tmp=this.point1;this.point1=this.point2;this.point2=tmp;}
this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};return[perpendicular,point2];};JXG.Board.prototype.addPerpendicularPoint=function(l,p,idP,nameP){var point=JXG.GetReferenceFromParameter(this,p);var line=JXG.GetReferenceFromParameter(this,l);var number=this.numObjects;number++;if((idP=='')||(idP==null)){idP=this.id+'P'+number;}
var p2coords=this.algebra.perpendicular(line,point)[0].usrCoords.slice(1);var point2=new JXG.Point(this,p2coords,idP,nameP,true);point2.fixed=true;point.addChild(point2);line.addChild(point2);point2.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.perpendicular(line,point)[0];this.label.setCoordinates(this.coords);if(this.traced){this.cloneToBackground(true);}}};return point2;};JXG.Board.prototype.addCircumcenter=function(point1,point2,point3,midpointId,midpointName,circleId,circleName){var p1=JXG.GetReferenceFromParameter(this,point1);var p2=JXG.GetReferenceFromParameter(this,point2);var p3=JXG.GetReferenceFromParameter(this,point3);var midpointCoordinates=this.algebra.circumcenterMidpoint(p1,p2,p3);var midpoint=new JXG.Point(this,midpointCoordinates.usrCoords.slice(1),midpointId,midpointName,true);midpoint.fixed=true;p1.addChild(midpoint);p2.addChild(midpoint);p3.addChild(midpoint);var circumcircle=new JXG.Circle(this,'pointRadius',midpoint.id,function(){return this.midpoint.coords.distance(JXG.COORDS_BY_USER,p1.coords);},circleId,circleName);p1.addChild(circumcircle);p2.addChild(circumcircle);p3.addChild(circumcircle);midpoint.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.circumcenterMidpoint(p1,p2,p3);if(this.label.show){this.label.setCoordinates(this.coords);}
if(this.traced){this.cloneToBackground(true);}}};circumcircle.update=function(){if(this.needsUpdate){this.updateRadius();this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};return[midpoint,circumcircle];};JXG.Board.prototype.addCircumcenterMidpoint=function(point1,point2,point3,midpointId,midpointName){var p1=JXG.GetReferenceFromParameter(this,point1);var p2=JXG.GetReferenceFromParameter(this,point2);var p3=JXG.GetReferenceFromParameter(this,point3);var mp=this.algebra.circumcenterMidpoint(p1,p2,p3).usrCoords.slice(1);var midpoint=new JXG.Point(this,mp,midpointId,midpointName,true);midpoint.fixed=true;p1.addChild(midpoint);p2.addChild(midpoint);p3.addChild(midpoint);midpoint.update=function(){if(this.needsUpdate){this.coords=this.board.algebra.circumcenterMidpoint(p1,p2,p3);if(this.label.show){this.label.setCoordinates(this.coords);}
if(this.traced){this.cloneToBackground(true);}}};return midpoint;};JXG.Board.prototype.addIntersection=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'I'+number;}
this.objects[elementId]=obj;obj.id=elementId;obj.intersect1.addChild(obj);obj.intersect2.addChild(obj);return elementId;};JXG.Board.prototype.addAngleBisector=function(p1,p2,p3,id,name){var point1=JXG.GetReferenceFromParameter(this,p1);var point2=JXG.GetReferenceFromParameter(this,p2);var point3=JXG.GetReferenceFromParameter(this,p3);var number=this.numObjects;number++;if((id=='')||(id==null)){id=this.id+'L'+number;}
var pCoords=this.algebra.angleBisector(point1,point2,point3).usrCoords.slice(1);var point=new JXG.Point(this,pCoords,id+"P2",'',false);point.fixed=true;point1.addChild(point);point2.addChild(point);point3.addChild(point);var bisector=new JXG.Line(this,p2,point.id,id,name);bisector.setStraight(false,true);bisector.update=function(){if(this.needsUpdate){this.point2.coords=this.board.algebra.angleBisector(point1,point2,point3);this.updateStdform();if(this.traced){this.cloneToBackground(true);}}};return bisector;};JXG.Board.prototype.addText=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'T'+number;}
this.objects[elementId]=obj;obj.id=elementId;this.renderer.drawText(obj);return elementId;};JXG.Board.prototype.addConditions=function(str){var res=null;var plaintext='var el,x,y,c;\n';var i=str.indexOf('<data>');var j=str.indexOf('</data>');if(i<0){return;}
while(i>=0){var term=str.slice(i+6,j);var m=term.indexOf('=');var left=term.slice(0,m);var right=term.slice(m+1);m=left.indexOf('.');var name=left.slice(0,m);var el=this.elementsByName[name.unescapeHTML()];var property=left.slice(m+1).replace(/\s+/g,'').toLowerCase();right=this.algebra.geonext2JS(right);right=right.replace(/this\.board\./g,'this.');if(typeof this.elementsByName[name]=='undefined'){alert("debug conditions: |"+name+"| undefined");}
plaintext+="el = this.objects[\""+el.id+"\"];\n";switch(property){case'x':plaintext+='y=el.coords.usrCoords[2];\n';plaintext+='el.coords=new JXG.Coords(JXG.COORDS_BY_USER,['+(right)+',y],this);\n';plaintext+='el.update();\n';break;case'y':plaintext+='x=el.coords.usrCoords[1];\n';plaintext+='el.coords=new JXG.Coords(JXG.COORDS_BY_USER,[x,'+(right)+'],this);\n';plaintext+='el.update();\n';break;case'visible':plaintext+='c='+(right)+';\n';plaintext+='if (c) {el.showElement();} else {el.hideElement();}\n';break;case'position':plaintext+='el.position = '+(right)+';\n';plaintext+='el.update();\n';break;case'stroke':plaintext+='el.strokeColor = '+(right)+';\n';break;case'strokewidth':plaintext+='el.strokeWidth = '+(right)+';\n';break;case'label':break;default:alert("property '"+property+"' in conditions not implemented:"+right);break;}
str=str.slice(j+7);i=str.indexOf('<data>');j=str.indexOf('</data>');}
plaintext+='this.prepareUpdate();\n';plaintext+='this.updateElements();\n';plaintext+='return true;\n';this.updateConditions=new Function(plaintext);this.updateConditions();};JXG.Board.prototype.updateConditions=function(){return false;};JXG.Board.prototype.addImage=function(obj){var number=this.numObjects;this.numObjects++;var elementId=obj.id;if((elementId=='')||(elementId==null)){elementId=this.id+'Im'+number;}
this.objects[elementId]=obj;this.elementsByName[obj.name]=obj;obj.id=elementId;this.renderer.drawImage(obj);if(!obj.visProp['visible']){this.renderer.hide(obj);}
return elementId;};JXG.Board.prototype.addIntegral=function(interval,curve,ids,names,atts){if(!JXG.IsArray(ids)||(ids.length!=5)){ids=['','','','',''];}
if(!JXG.IsArray(names)||(names.length!=5)){names=['','','','',''];}
var points=[];var attribs={};if((typeof atts!='undefined')&&(atts!=null))
attribs=atts;attribs.name=names[0];attribs.id=ids[0];attribs.slideObject=curve;var start=0;if(interval[0]>curve.points[0].usrCoords[1])
start=interval[0];else
start=curve.points[0].usrCoords[1];var pa_on_curve=board.createElement('point',[start,curve.yterm(start)],attribs);attribs.name=names[1];attribs.id=ids[1];attribs.visible=false;attribs.slideObject=null;var pa_on_axis=board.createElement('point',[function(){return pa_on_curve.X();},0],attribs);points.push(pa_on_axis);points.push(pa_on_curve);pa_on_curve.addChild(pa_on_axis);var fakePoint;for(var i=0;i<curve.numberPoints;i++){if((interval[0]<=curve.points[i].usrCoords[1])&&(curve.points[i].usrCoords[1]<=interval[1])){fakePoint={type:JXG.OBJECT_TYPE_POINT,elementClass:JXG.OBJECT_CLASS_POINT,addChild:function(el){},coords:curve.points[i]};points.push(fakePoint);}}
attribs.name=names[2];attribs.id=ids[2];attribs.slideObject=curve;attribs.visible=true;var pb_on_curve=board.createElement('point',[points[points.length-1].coords.usrCoords[1],curve.yterm(points[points.length-1].coords.usrCoords[1])],attribs);attribs.name=names[3];attribs.id=ids[3];attribs.slideObject=null;attribs.visible=false;var pb_on_axis=board.createElement('point',[function(){return pb_on_curve.X()},0],attribs);points.push(pb_on_curve);points.push(pb_on_axis);pb_on_curve.addChild(pb_on_axis);var Int=this.algebra.I([points[0].coords.usrCoords[1],points[points.length-1].coords.usrCoords[1]],curve.yterm);var t=board.createElement('text',[function(){return pb_on_curve.X()+0.2;},function(){return pb_on_curve.Y()-1.0;},'&int; = '+this.algebra.round(Int,4)]);var attribs={};if((typeof atts!='undefined')&&(atts!=null))
attribs=atts;attribs.withLines=false;attribs.name=names[4];attribs.id=ids[4];attribs.visible=true;var p=board.createElement('polygon',points,attribs);p.update=function(){var fakePoint;var ps=[pa_on_axis,pa_on_curve];for(var i=0;i<curve.numberPoints;i++){if((pa_on_axis.X()<=curve.points[i].usrCoords[1])&&(curve.points[i].usrCoords[1]<=pb_on_axis.X())){fakePoint={type:JXG.OBJECT_TYPE_POINT,elementClass:JXG.OBJECT_CLASS_POINT,addChild:function(el){},coords:curve.points[i]};ps.push(fakePoint);}}
ps.push(pb_on_curve);ps.push(pb_on_axis);ps.push(pa_on_axis);var Int=this.board.algebra.I([points[0].coords.usrCoords[1],points[points.length-1].coords.usrCoords[1]],curve.yterm);t.plaintextStr='&int; = '+this.board.algebra.round(Int,4);this.vertices=ps;}
pa_on_curve.addChild(p);pb_on_curve.addChild(p);pa_on_curve.addChild(t);pb_on_curve.addChild(t);return p;}
JXG.Board.prototype.calculateSnapSizes=function(){var p1=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this);var p2=new JXG.Coords(JXG.COORDS_BY_USER,[1/this.gridX,1/this.gridY],this);var x=p1.scrCoords[1]-p2.scrCoords[1];var y=p1.scrCoords[2]-p2.scrCoords[2];this.snapSizeX=this.gridX;while(Math.abs(x)>25){this.snapSizeX*=2;x/=2;}
this.snapSizeY=this.gridY;while(Math.abs(y)>25){this.snapSizeY*=2;y/=2;}};JXG.Board.prototype.applyZoom=function(){this.updateQuality=this.BOARD_QUALITY_HIGH;for(var Element in this.objects){if((this.objects[Element].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[Element].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[Element].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[Element].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[Element].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[Element].type!=JXG.OBJECT_TYPE_AXIS))
this.objects[Element].coords.usr2screen();}}
this.calculateSnapSizes();this.fullUpdate=true;this.update();this.fullUpdate=false;if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this);}};JXG.Board.prototype.zoomIn=function(){this.zoomX*=this.options.zoom.factor;this.zoomY*=this.options.zoom.factor;this.applyZoom();};JXG.Board.prototype.zoomOut=function(){this.zoomX/=this.options.zoom.factor;this.zoomY/=this.options.zoom.factor;this.applyZoom();};JXG.Board.prototype.zoom100=function(){this.zoomX=1.0;this.zoomY=1.0;this.applyZoom();};JXG.Board.prototype.zoomAllPoints=function(){var ratio=this.zoomX/this.zoomY;var minX=0;var maxX=0;var minY=0;var maxY=0;for(var Element in this.objects){if((this.objects[Element].elementClass==JXG.OBJECT_CLASS_POINT)&&this.objects[Element].visProp['visible']){if(this.objects[Element].coords.usrCoords[1]<minX){minX=this.objects[Element].coords.usrCoords[1];}
if(this.objects[Element].coords.usrCoords[1]>maxX){maxX=this.objects[Element].coords.usrCoords[1];}
if(this.objects[Element].coords.usrCoords[2]>maxY){maxY=this.objects[Element].coords.usrCoords[2];}
if(this.objects[Element].coords.usrCoords[2]<minY){minY=this.objects[Element].coords.usrCoords[2];}}}
var border=50;var borderX=border/(this.unitX*this.zoomX);var borderY=border/(this.unitY*this.zoomY);var distX=maxX-minX+2*borderX;var distY=maxY-minY+2*borderY;var newZoom=Math.min(this.canvasWidth/(this.unitX*distX),this.canvasHeight/(this.unitY*distY));var newZoomY=newZoom;var newZoomX=newZoom*ratio;var newOriginX=-(minX-borderX)*this.unitX*newZoomX;var newOriginY=(maxY+borderY)*this.unitY*newZoomY;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[newOriginX,newOriginY],this);this.zoomX=newZoomX;this.zoomY=newZoomY;this.applyZoom();};JXG.Board.prototype.removeObject=function(object){object=JXG.GetReferenceFromParameter(this,object);if(object==undefined){return;}
try{for(var Elements in object.childElements){object.childElements[Elements].board.removeObject(object.childElements[Elements]);}
for(var el in this.objects){if(typeof this.objects[el].childElements!='undefined')
delete(this.objects[el].childElements[object.id]);}
delete(this.objects[object.id]);delete(this.elementsByName[object.name]);if(object.remove!=undefined)object.remove();}catch(e){}};JXG.Board.prototype.initGeonextBoard=function(){var p1=new JXG.Point(this,[0,0],this.id+'gOOe0','Ursprung',false);p1.fixed=true;var p2=new JXG.Point(this,[1,0],this.id+'gXOe0','Punkt_1_0',false);p2.fixed=true;var p3=new JXG.Point(this,[0,1],this.id+'gYOe0','Punkt_0_1',false);p3.fixed=true;var l1=new JXG.Line(this,this.id+'gOOe0',this.id+'gXOe0',this.id+'gXLe0','X-Achse');l1.hideElement();var l2=new JXG.Line(this,this.id+'gOOe0',this.id+'gYOe0',this.id+'gYLe0','Y-Achse');l2.hideElement();};JXG.Board.prototype.resizeContainer=function(canvasWidth,canvasHeight){this.canvasWidth=1*canvasWidth;this.canvasHeight=1*canvasHeight;$(this.container).style.width=(this.canvasWidth)+'px';$(this.container).style.height=(this.canvasHeight)+'px';};JXG.Board.prototype.showDependencies=function(){var el;var t='<p>\n';for(el in this.objects){var i=0;for(c in this.objects[el].childElements){i++;}
if(i>=0){t+='<b>'+this.objects[el].id+':</b> ';}
for(c in this.objects[el].childElements){t+=this.objects[el].childElements[c].id+'('+this.objects[el].childElements[c].name+')'+', ';}
t+='<p>\n';}
t+='</p>\n';var f=window.open();f.document.open();f.document.write(t);f.document.close();};JXG.Board.prototype.showXML=function(){var f=window.open("");f.document.open();f.document.write("<pre>"+this.xmlString.escapeHTML()+"</pre>");f.document.close();}
JXG.Board.prototype.prepareUpdate=function(drag){for(var el in this.objects){this.objects[el].needsUpdate=true;}};JXG.Board.prototype.updateElements=function(drag){drag=JXG.GetReferenceFromParameter(this,drag);var count=-1;if(!this.reducedUpdate)count=1;for(var el in this.objects){var pEl=this.objects[el];if(!this.fullUpdate&&!pEl.needsRegularUpdate&&pEl.afterFirstUpdate){continue;}
if(drag==null||pEl.id!=drag.id){if(count>=0||!pEl.afterFirstUpdate||this.fullUpdate){pEl.update(true);}}else{pEl.update(false);count=5;}
if(this.reducedUpdate)count--;}};JXG.Board.prototype.updateRenderer=function(drag){drag=JXG.GetReferenceFromParameter(this,drag);var count=-1;if(!this.reducedUpdate)count=1;for(var el in this.objects){var pEl=this.objects[el];if(!this.fullUpdate&&!pEl.needsRegularUpdate&&pEl.afterFirstUpdate){continue;}
if(drag==null||pEl.id!=drag.id){if(count>=0||!pEl.afterFirstUpdate||this.fullUpdate){pEl.updateRenderer();}}else{pEl.updateRenderer();count=5;}
if(this.reducedUpdate)count--;pEl.afterFirstUpdate=true;}};JXG.Board.prototype.addHook=function(hook){this.hooks.push(hook);hook(this);return(this.hooks.length-1);}
JXG.Board.prototype.removeHook=function(id){this.hooks[id]=null;}
JXG.Board.prototype.updateHooks=function(){for(var i=0;i<this.hooks.length;i++){if(this.hooks[i]!=null)
this.hooks[i](this);}};JXG.Board.prototype.update=function(drag){if(this.isSuspendedUpdate){return;}
this.prepareUpdate(drag);this.updateElements(drag);this.updateConditions();this.renderer.suspendRedraw();this.updateRenderer(drag);this.renderer.unsuspendRedraw();this.updateHooks();for(var boards in JXG.JSXGraph.boards){if(JXG.JSXGraph.boards[boards]!=this){JXG.JSXGraph.boards[boards].prepareUpdate(drag);JXG.JSXGraph.boards[boards].updateElements(drag);JXG.JSXGraph.boards[boards].updateConditions();JXG.JSXGraph.boards[boards].renderer.suspendRedraw();JXG.JSXGraph.boards[boards].updateRenderer(drag);JXG.JSXGraph.boards[boards].renderer.unsuspendRedraw();JXG.JSXGraph.boards[boards].updateHooks();}}};JXG.Board.prototype.createElement=function(elementType,parents,attributes){if(parents==null||parents.length==0){return null;}
var el;elementType=elementType.toLowerCase();if(attributes==null){attributes={};}
for(var i=0;i<parents.length;i++){parents[i]=JXG.GetReferenceFromParameter(this,parents[i]);}
if(JXG.JSXGraph.elements[elementType]!=null){el=JXG.JSXGraph.elements[elementType](this,parents,attributes);}else{throw"JXG.createElement: Unknown element type given: "+elementType;}
if(el==undefined){return;};if(JXG.IsArray(attributes))
attributes=attributes[0];try{if(el.multipleElements){for(var s in el){if(typeof el[s].setProperty!='undefined')
el[s].setProperty(attributes);}}else{if(typeof el.setProperty!='undefined')
el.setProperty(attributes);}}catch(e){};this.update();return el;};JXG.Board.prototype.clearTraces=function(){for(var el in this.objects){if(this.objects[el].traced)
this.objects[el].clearTrace();}};JXG.Board.prototype.beforeLoad=function(){};JXG.Board.prototype.afterLoad=function(){};JXG.Board.prototype.suspendUpdate=function(){this.isSuspendedUpdate=true;}
JXG.Board.prototype.unsuspendUpdate=function(){this.isSuspendedUpdate=false;this.update();}
JXG.COORDS_BY_USER=0x0001;JXG.COORDS_BY_SCREEN=0x0002;JXG.Coords=function(method,coordinates,board){this.board=board;this.usrCoords=[1,0,0];this.scrCoords=[1,0,0];if(method==JXG.COORDS_BY_USER){if(coordinates.length<=2){this.usrCoords[1]=coordinates[0];this.usrCoords[2]=coordinates[1];}else{this.usrCoords[0]=coordinates[0];this.usrCoords[1]=coordinates[1];this.usrCoords[2]=coordinates[2];this.normalizeUsrCoords();}
this.usr2screen();}else{this.scrCoords[1]=coordinates[0];this.scrCoords[2]=coordinates[1];this.screen2usr();}};JXG.Coords.prototype.normalizeUsrCoords=function(){var eps=0.000001;if(Math.abs(this.usrCoords[0])>eps){this.usrCoords[1]/=this.usrCoords[0];this.usrCoords[2]/=this.usrCoords[0];this.usrCoords[0]=1.0;}};JXG.Coords.prototype.usr2screen=function(){this.scrCoords[0]=Math.round(this.usrCoords[0]);this.scrCoords[1]=Math.round(this.usrCoords[0]*this.board.origin.scrCoords[1]+this.usrCoords[1]*this.board.unitX*this.board.zoomX);this.scrCoords[2]=Math.round(this.usrCoords[0]*this.board.origin.scrCoords[2]-this.usrCoords[2]*this.board.unitY*this.board.zoomY);};JXG.Coords.prototype.screen2usr=function(){this.usrCoords[0]=1.0;this.usrCoords[1]=(this.scrCoords[1]-this.board.origin.scrCoords[1])/(this.board.unitX*this.board.zoomX);this.usrCoords[2]=(this.board.origin.scrCoords[2]-this.scrCoords[2])/(this.board.unitY*this.board.zoomY);};JXG.Coords.prototype.distance=function(method,coordinates){var sum=0;if(method==JXG.COORDS_BY_USER){for(var i=1;i<this.board.dimension+1;i++){sum+=(this.usrCoords[i]-coordinates.usrCoords[i])*(this.usrCoords[i]-coordinates.usrCoords[i]);}}else{for(var i=1;i<this.board.dimension+1;i++){sum+=(this.scrCoords[i]-coordinates.scrCoords[i])*(this.scrCoords[i]-coordinates.scrCoords[i]);}}
return Math.sqrt(sum);};JXG.Coords.prototype.setCoordinates=function(method,coordinates){if(method==JXG.COORDS_BY_USER){this.usrCoords[1]=coordinates[0];this.usrCoords[2]=coordinates[1];this.usr2screen();}else{this.scrCoords[1]=coordinates[0];this.scrCoords[2]=coordinates[1];this.screen2usr();}};JXG.Point=function(board,coordinates,id,name,show){this.constructor();this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;this.init(board,id,name);if(coordinates==null){coordinates=[0,0];}
this.coords=new JXG.Coords(JXG.COORDS_BY_USER,coordinates,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,coordinates,this.board);this.label=new JXG.Label(this.board,this.name,this.coords,this.id+"Label");this.label.show=show;if(!show){this.label.hiddenByParent=true;}
this.fixed=false;this.position;this.onPolygon=false;this.visProp['style']=this.board.options.point.style;this.r=this.board.options.precision.hasPoint;this.visProp['fillColor']=this.board.options.point.fillColor;this.visProp['highlightFillColor']=this.board.options.point.highlightFillColor;this.visProp['visible']=show;this.slideObject=null;this.group=[];this.id=this.board.addPoint(this);};JXG.Point.prototype=new JXG.GeometryElement();JXG.Point.prototype.hasPoint=function(x,y){var coordsScr=this.coords.scrCoords;return((Math.abs(coordsScr[1]-x)<this.r+2)&&(Math.abs(coordsScr[2]-y))<this.r+2);};JXG.Point.prototype.update=function(fromParent){if(!this.needsUpdate){return;}
if(typeof fromParent=='undefined'){fromParent=false;}
if(this.traced){this.cloneToBackground(true);}
if(this.type==JXG.OBJECT_TYPE_GLIDER){if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){if(fromParent){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.X()+Math.cos(this.position),this.slideObject.midpoint.Y()+Math.sin(this.position)]);this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject);}else{this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject);this.position=this.board.algebra.rad([this.slideObject.midpoint.X()+1.0,this.slideObject.midpoint.Y()],this.slideObject.midpoint,this);}}else if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){this.coords=this.board.algebra.projectPointToLine(this,this.slideObject);var p1coords=this.slideObject.point1.coords;var p2coords=this.slideObject.point2.coords;if(fromParent){this.coords.setCoordinates(JXG.COORDS_BY_USER,[p1coords.usrCoords[1]+this.position*(p2coords.usrCoords[1]-p1coords.usrCoords[1]),p1coords.usrCoords[2]+this.position*(p2coords.usrCoords[2]-p1coords.usrCoords[2])]);}else{var factor=1;var distP1S=p1coords.distance(JXG.COORDS_BY_USER,this.coords);var distP1P2=p1coords.distance(JXG.COORDS_BY_USER,p2coords);var distP2S=p2coords.distance(JXG.COORDS_BY_USER,this.coords);if(((distP1S>distP1P2)||(distP2S>distP1P2))&&(distP1S<distP2S)){factor=-1;}
this.position=factor*distP1S/distP1P2;}
var p1Scr=this.slideObject.point1.coords.scrCoords;var p2Scr=this.slideObject.point2.coords.scrCoords;var i;if(this.slideObject.getSlope()==0){i=1;}else{i=2;}
var y=this.coords.scrCoords[i];if(!this.slideObject.visProp['straightFirst']){if(p1Scr[i]<p2Scr[i]){if(y<p1Scr[i]){this.coords=this.slideObject.point1.coords;}}
else if(p1Scr[i]>p2Scr[i]){if(y>p1Scr[i]){this.coords=this.slideObject.point1.coords;}}}
if(!this.slideObject.visProp['straightLast']){if(p1Scr[i]<p2Scr[i]){if(y>p2Scr[i]){this.coords=this.slideObject.point2.coords;}}
else if(p1Scr[i]>p2Scr[i]){if(y<p2Scr[i]){this.coords=this.slideObject.point2.coords;}}}
if(this.onPolygon){var p1=this.slideObject.point1.coords;var p2=this.slideObject.point2.coords;if(Math.abs(this.coords.scrCoords[1]-p1.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-p1.scrCoords[2])<this.r){var poly=this.slideObject.parentPolygon;for(var i=0;i<poly.borders.length;i++){if(this.slideObject==poly.borders[i]){this.slideObject=poly.borders[(i-1+poly.borders.length)%poly.borders.length];break;}}}
else if(Math.abs(this.coords.scrCoords[1]-p2.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-p2.scrCoords[2])<this.r){var poly=this.slideObject.parentPolygon;for(var i=0;i<poly.borders.length;i++){if(this.slideObject==poly.borders[i]){this.slideObject=poly.borders[(i+1+poly.borders.length)%poly.borders.length];break;}}}}}else if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject);}}
if(this.type==JXG.OBJECT_TYPE_CAS){this.updateConstraint();}
this.updateTransform();this.needsUpdate=false;};JXG.Point.prototype.updateRenderer=function(){if(this.visProp['visible']){var wasReal=this.isReal;this.isReal=(isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]))?false:true;if(this.isReal){if(wasReal!=this.isReal){this.board.renderer.show(this);if(this.label.show)this.board.renderer.show(this.label);}
this.board.renderer.updatePoint(this);}else{if(wasReal!=this.isReal){this.board.renderer.hide(this);if(this.label.show)this.board.renderer.hide(this.label);}}}
if(this.label.show&&this.isReal){this.label.setCoordinates(this.coords);this.board.renderer.updateLabel(this.label);}};JXG.Point.prototype.X=function(){return this.coords.usrCoords[1];};JXG.Point.prototype.Y=function(){return this.coords.usrCoords[2];};JXG.Point.prototype.XEval=function(){return this.coords.usrCoords[1];};JXG.Point.prototype.YEval=function(){return this.coords.usrCoords[2];};JXG.Point.prototype.Dist=function(point2){return this.coords.distance(JXG.COORDS_BY_USER,point2.coords);};JXG.Point.prototype.setPositionDirectly=function(method,x,y){var oldCoords=this.coords;this.coords=new JXG.Coords(method,[x,y],this.board);if(this.group.length!=0){this.group[this.group.length-1].dX=this.coords.scrCoords[1]-oldCoords.scrCoords[1];this.group[this.group.length-1].dY=this.coords.scrCoords[2]-oldCoords.scrCoords[2];this.group[this.group.length-1].update(this);}else{this.update();}};JXG.Point.prototype.setPositionByTransform=function(method,x,y){var oldCoords=this.coords;var t=this.board.createElement('transform',[x,y],{type:'translate'});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(t);}else{this.addTransform(this,t);}
if(this.group.length!=0){}else{this.update();}};JXG.Point.prototype.setPosition=function(method,x,y){this.setPositionByTransform(method,x,y);};JXG.Point.prototype.makeGlider=function(slideObject){this.slideObject=JXG.GetReferenceFromParameter(this.board,slideObject);this.type=JXG.OBJECT_TYPE_GLIDER;this.slideObject.addChild(this);this.needsUpdate=true;this.update();};JXG.Point.prototype.addConstraint=function(xterm,yterm){this.type=JXG.OBJECT_TYPE_CAS;var elements=this.board.elementsByName;if(yterm==null){this.updateConstraint=function(){this.coords=xterm();};if(!this.board.isSuspendedUpdate){this.update();}
return;}
if(typeof xterm=='string'){var newxterm=this.board.algebra.geonext2JS(xterm);this.XEval=new Function('','return '+newxterm+';');}else if(typeof xterm=='function'){this.XEval=xterm;}else if(typeof xterm=='number'){this.XEval=function(){return xterm;};}
if(typeof yterm=='string'){var newyterm=this.board.algebra.geonext2JS(yterm);this.YEval=new Function('','return '+newyterm+';');}else if(typeof yterm=='function'){this.YEval=yterm;}else if(typeof yterm=='number'){this.YEval=function(){return yterm;};}
var fs='this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.XEval(),this.YEval()]);';this.updateConstraint=new Function('',fs);if(!this.board.isSuspendedUpdate){this.update();}
return;};JXG.Point.prototype.updateTransform=function(){if(this.transformations.length==0||this.baseElement==null){return;}
if(this===this.baseElement){var c=this.transformations[0].apply(this.baseElement,'self');}else{var c=this.transformations[0].apply(this.baseElement);}
this.coords.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);for(var i=1;i<this.transformations.length;i++){c=this.transformations[i].apply(this);this.coords.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);}};JXG.Point.prototype.addTransform=function(el,transform){if(this.transformations.length==0){this.baseElement=el;}
if(JXG.IsArray(transform)){list=transform;}else{list=[transform];}
for(var i=0;i<list.length;i++){this.transformations.push(list[i]);}};JXG.Point.prototype.startAnimation=function(direction,stepCount){if((this.type==JXG.OBJECT_TYPE_GLIDER)&&(typeof this.intervalCode=='undefined')){this.intervalCode=window.setInterval('JXG.JSXGraph.boards[\''+this.board.id+'\'].objects[\''+this.id+'\'].animate('+direction+', '+stepCount+')',250);if(typeof this.intervalCount=='undefined')
this.intervalCount=0;}};JXG.Point.prototype.stopAnimation=function(){if(typeof this.intervalCode!='undefined'){window.clearInterval(this.intervalCode);delete(this.intervalCode);}};JXG.Point.prototype.animate=function(direction,stepCount){this.intervalCount++;if(this.intervalCount>stepCount)
this.intervalCount=0;if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){var distance=this.slideObject.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.slideObject.point2.coords);var slope=this.slideObject.getSlope();var dX;var dY;if(slope!='INF'){var alpha=Math.atan(slope);dX=Math.round((this.intervalCount/stepCount)*distance*Math.cos(alpha));dY=Math.round((this.intervalCount/stepCount)*distance*Math.sin(alpha));}else{dX=0;dY=Math.round((this.intervalCount/stepCount)*distance);}
var startPoint;var factor=1;if(direction<0){startPoint=this.slideObject.point2;if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0)
factor=-1;else if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0){if(this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0)
factor=-1;}}else{startPoint=this.slideObject.point1;if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0)
factor=-1;else if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0){if(this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0)
factor=-1;}}
this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[startPoint.coords.scrCoords[1]+factor*dX,startPoint.coords.scrCoords[2]+factor*dY]);}else if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){var newX;if(direction>0){newX=Math.round(this.intervalCount/stepCount*this.board.canvasWidth);}else{newX=Math.round((stepCount-this.intervalCount)/stepCount*this.board.canvasWidth);}
this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[newX,0]);this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject);}else if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){var alpha;if(direction<0){alpha=this.intervalCount/stepCount*2*Math.PI;}else{alpha=(stepCount-this.intervalCount)/stepCount*2*Math.PI;}
var radius=this.slideObject.getRadius();this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.coords.usrCoords[1]+radius*Math.cos(alpha),this.slideObject.midpoint.coords.usrCoords[2]+radius*Math.sin(alpha)]);}
this.board.update(this);};JXG.Point.prototype.setStyle=function(i){this.visProp['style']=i;this.board.renderer.changePointStyle(this);};JXG.Point.prototype.remove=function(){this.board.renderer.remove($(this.label.id));if(this.visProp['style']>=3&&this.visProp['style']<=9){this.board.renderer.remove($(this.id));}
else{this.board.renderer.remove($(this.id+'_x1'));this.board.renderer.remove($(this.id+'_x2'))}};JXG.Point.prototype.getTextAnchor=function(){return this.coords;};JXG.Point.prototype.cloneToBackground=function(addToTrace){var copy={};copy.id=this.id+'T'+this.numTraces;this.numTraces++;copy.coords=this.coords;copy.visProp=this.visProp;copy.elementClass=JXG.OBJECT_CLASS_POINT;this.board.renderer.drawPoint(copy);if((this.visProp['style']>=3)&&(this.visProp['style']<=9)){this.traces[copy.id]=$(copy.id);}
else{this.traces[copy.id+'_x1']=$(copy.id+'_x1');this.traces[copy.id+'_x2']=$(copy.id+'_x2');}
delete copy;};JXG.createPoint=function(board,parentArr,atts){var el;if((JXG.IsNumber(parentArr[0]))&&(JXG.IsNumber(parentArr[1]))){el=new JXG.Point(board,parentArr,atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));if(atts["slideObject"]!=null){el.makeGlider(atts["slideObject"]);}else{el.baseElement=el;}}
else if((JXG.IsString(parentArr[0])||JXG.IsNumber(parentArr[0])||JXG.IsFunction(parentArr[0]))&&(JXG.IsString(parentArr[1])||JXG.IsNumber(parentArr[1]))||JXG.IsFunction(parentArr[1])){el=new JXG.Point(board,[0,0],atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));el.addConstraint(parentArr[0],parentArr[1]);}
else if((typeof parentArr[0]=='function')&&parentArr[1]==null){el=new JXG.Point(board,[0,0],atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));el.addConstraint(parentArr[0]);}
else if((typeof parentArr[0]=='object')&&(typeof parentArr[1]=='object')){el=new JXG.Point(board,[0,0],atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));el.addTransform(parentArr[0],parentArr[1]);}
else{throw("JSXGraph error: Can't create point with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}
return el;};JXG.createGlider=function(board,parentArr,atts){var el;if(parentArr.length==1){el=new JXG.Point(board,[0,0],atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));}else{el=new JXG.Point(board,parentArr.slice(0,-1),atts['id'],atts['name'],(atts['visible']==undefined)||board.algebra.str2Bool(atts['visible']));}
el.makeGlider(parentArr[parentArr.length-1]);return el;};JXG.JSXGraph.registerElement('point',JXG.createPoint);JXG.JSXGraph.registerElement('glider',JXG.createGlider);JXG.Line=function(board,p1,p2,id,name){this.constructor();this.init(board,id,name);this.type=JXG.OBJECT_TYPE_LINE;this.elementClass=JXG.OBJECT_CLASS_LINE;this.point1=JXG.GetReferenceFromParameter(this.board,p1);this.point2=JXG.GetReferenceFromParameter(this.board,p2);this.image=null;this.imageTransformMatrix=[[1,0,0],[0,1,0],[0,0,1]];this.r=this.board.options.precision.hasPoint;this.visProp['straightFirst']=this.board.options.line.straightFirst;this.visProp['straightLast']=this.board.options.line.straightLast;this.visProp['visible']=true;this.visProp['firstArrow']=this.board.options.line.firstArrow;this.visProp['lastArrow']=this.board.options.line.lastArrow;this.ticks=[];this.visProp['withTicks']=this.board.options.line.ticks.withTicks;this.ticksDelta=this.board.options.line.ticks.ticksDelta;this.parentPolygon=null;this.id=this.board.addLine(this);this.point1.addChild(this);this.point2.addChild(this);this.update();};JXG.Line.prototype=new JXG.GeometryElement;JXG.Line.prototype.hasPoint=function(x,y){var p1Scr=this.point1.coords.scrCoords;var p2Scr=this.point2.coords.scrCoords;var coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this.board);var has=false;var i;var slope=this.getSlope();var rise=this.getRise();if(this.visProp['straightFirst']&&this.visProp['straightLast']){if(slope!="INF"){for(i=-this.r;i<this.r;i++){has=has|(Math.abs(y-(slope*(x+i)+rise))<this.r);}}
else{has=(Math.abs(x-p1Scr[1])<this.r);}}
else{if(slope!="INF"){for(i=-this.r;i<this.r;i++){has=has|(Math.abs(y-(slope*(x+i)+rise))<this.r);}
if(has){var distP1P=coords.distance(JXG.COORDS_BY_SCREEN,this.point1.coords);var distP2P=coords.distance(JXG.COORDS_BY_SCREEN,this.point2.coords);var distP1P2=this.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.point2.coords);if((distP1P>distP1P2)||(distP2P>distP1P2)){if(distP1P<distP2P){if(!this.visProp['straightFirst']){has=false;}}
else{if(!this.visProp['straightLast']){has=false;}}}}}
else{has=(Math.abs(x-p1Scr[1])<this.r);if(has){if(!this.visProp['straightFirst']){if(p1Scr[2]<p2Scr[2]){if(y<p1Scr[2]){has=false;}}
else if(p1Scr[2]>p2Scr[2]){if(y>p1Scr[2]){has=false;}}}
if(!this.visProp['straightLast']){if(p1Scr[2]<p2Scr[2]){if(y>p2Scr[2]){has=false;}}
else if(p1Scr[2]>p2Scr[2]){if(y<p2Scr[2]){has=false;}}}}}}
return has;};JXG.Line.prototype.update=function(){if(this.needsUpdate){if(true||!this.board.geonextCompatibilityMode){this.updateStdform();}
if(this.visProp['withTicks'])
this.updateTickCoordinates();}
if(this.traced){this.cloneToBackground(true);}};JXG.Line.prototype.updateStdform=function(){var v=[];v=this.board.algebra.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=v[0];this.stdform[1]=v[1];this.stdform[2]=v[2];this.stdform[3]=0;this.normalize();};JXG.Line.prototype.updateTickCoordinates=function(first){if(typeof first=='undefined'){first=false;}
if(!this.visProp['withTicks'])
return;var c1=new JXG.Coords(JXG.COORDS_BY_USER,[this.point1.coords.usrCoords[1],this.point1.coords.usrCoords[2]],this.board);var c2=new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.coords.usrCoords[1],this.point2.coords.usrCoords[2]],this.board);this.board.renderer.calcStraight(this,c1,c2);var p1=this.point1.coords;var oldTicksCount=this.ticks.length;this.ticks=new Array();var dx=p1.usrCoords[1]-c1.usrCoords[1];var dy=p1.usrCoords[2]-c1.usrCoords[2];var total_length=Math.sqrt(dx*dx+dy*dy);var deltaX=(this.ticksDelta*dx)/(total_length);var deltaY=(this.ticksDelta*dy)/(total_length);var x=p1.usrCoords[1];var y=p1.usrCoords[2];this.ticks[0]=new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);var countTicks=Math.floor(total_length/this.ticksDelta);for(var i=0;i<countTicks;i++){x=x-deltaX;y=y-deltaY;this.ticks[i+1]=new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);}
var offset=countTicks;dx=p1.usrCoords[1]-c2.usrCoords[1];dy=p1.usrCoords[2]-c2.usrCoords[2];total_length=Math.sqrt(dx*dx+dy*dy);deltaX=(this.ticksDelta*dx)/(total_length);deltaY=(this.ticksDelta*dy)/(total_length);x=p1.usrCoords[1];y=p1.usrCoords[2];countTicks=Math.floor(total_length/this.ticksDelta);for(var i=0;i<countTicks;i++){x=x-deltaX;y=y-deltaY;this.ticks[offset+i+1]=new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);}
if(!first){this.board.renderer.updateAxisTicks(this,oldTicksCount);}
this.board.renderer.updateAxisTicksInnerLoop(this,0);};JXG.Line.prototype.updateRenderer=function(){if(this.needsUpdate&&this.visProp['visible']){var wasReal=this.isReal;this.isReal=(isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2]))?false:true;if(this.isReal){if(wasReal!=this.isReal){this.board.renderer.show(this);}
this.board.renderer.updateLine(this);}else{if(wasReal!=this.isReal){this.board.renderer.hide(this);}}
this.board.renderer.updateLine(this);this.needsUpdate=false;}};JXG.Line.prototype.enableTicks=function(){if(this.visProp['withTicks'])
return;this.visProp['withTicks']=true;this.updateTickCoordinates();};JXG.Line.prototype.disableTicks=function(){if(!this.visProp['withTicks'])
return;this.visProp['withTicks']=false;this.board.renderer.removeAxisTicks(this);this.ticks=new Array();};JXG.Line.prototype.getRise=function(){var p1Scr=this.point1.coords.scrCoords;var p2Scr=this.point2.coords.scrCoords;return Math.round((p1Scr[2]-(p1Scr[1]*(p2Scr[2]-p1Scr[2]))/(p2Scr[1]-p1Scr[1])));};JXG.Line.prototype.getSlope=function(){var p1scr=this.point1.coords.scrCoords;var p2scr=this.point2.coords.scrCoords;if(Math.abs(p2scr[1]-p1scr[1])>=10e-5){return((p2scr[2]-p1scr[2])/(p2scr[1]-p1scr[1]));}
else{return"INF";}};JXG.Line.prototype.setStraight=function(straightFirst,straightLast){this.visProp['straightFirst']=straightFirst;this.visProp['straightLast']=straightLast;this.board.renderer.updateLine(this);};JXG.Line.prototype.setArrow=function(firstArrow,lastArrow){this.visProp['firstArrow']=firstArrow;this.visProp['lastArrow']=lastArrow;this.board.renderer.updateLine(this);};JXG.Line.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0.5*(this.point2.X()-this.point1.X()),0.5*(this.point2.Y()-this.point1.Y())],this.board);};JXG.Line.prototype.cloneToBackground=function(addToTrace){var copy={};copy.id=this.id+'T'+this.numTraces;this.numTraces++;copy.point1=this.point1;copy.point2=this.point2;copy.stdform=this.stdform;copy.board={};copy.board.unitX=this.board.unitX;copy.board.unitY=this.board.unitY;copy.board.zoomX=this.board.zoomX;copy.board.zoomY=this.board.zoomY;copy.board.origin=this.board.origin;copy.board.canvasHeight=this.board.canvasHeight;copy.board.canvasWidth=this.board.canvasWidth;copy.board.dimension=this.board.dimension;copy.board.algebra=this.board.algebra;copy.visProp=this.visProp;var s=this.getSlope();var r=this.getRise();copy.getSlope=function(){return s;};copy.getRise=function(){return r;};this.board.renderer.enhancedRendering=true;this.board.renderer.drawLine(copy);this.board.renderer.enhancedRendering=false;this.traces[copy.id]=$(copy.id);delete copy;};JXG.Line.prototype.addTransform=function(transform){var list;if(JXG.IsArray(transform)){list=transform;}else{list=[transform];}
for(var i=0;i<list.length;i++){this.point1.transformations.push(list[i]);this.point2.transformations.push(list[i]);}};JXG.Line.prototype.setPosition=function(method,x,y){var t=this.board.createElement('transform',[x,y],{type:'translate'});if(this.point1.transformations.length>0&&this.point1.transformations[this.point1.transformations.length-1].isNumericMatrix){this.point1.transformations[this.point1.transformations.length-1].melt(t);}else{this.point1.addTransform(this.point1,t);}
if(this.point2.transformations.length>0&&this.point2.transformations[this.point2.transformations.length-1].isNumericMatrix){this.point2.transformations[this.point2.transformations.length-1].melt(t);}else{this.point2.addTransform(this.point2,t);}};JXG.createLine=function(board,parentArr,atts){var el;if((parentArr[0].elementClass==JXG.OBJECT_CLASS_POINT)&&(parentArr[1].elementClass==JXG.OBJECT_CLASS_POINT)){var p1=JXG.GetReferenceFromParameter(board,parentArr[0]);var p2=JXG.GetReferenceFromParameter(board,parentArr[1]);el=new JXG.Line(board,p1.id,p2.id,atts['id'],atts['name']);}else
throw("Can't create line with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");return el;};JXG.JSXGraph.registerElement('line',JXG.createLine);JXG.createArrow=function(board,parents,attributes){var el;if((JXG.IsPoint(parents[0]))&&(JXG.IsPoint(parents[1]))){el=new JXG.Line(board,parents[0],parents[1],attributes['id'],attributes['name']);el.setStraight(false,false);el.setArrow(false,true);}
else
throw("Can't create arrow with parent types '"+(typeof parents[0])+"' and '"+(typeof parents[1])+"'.");return el;};JXG.JSXGraph.registerElement('arrow',JXG.createArrow);JXG.createAxis=function(board,parents,attributes){if((JXG.IsArray(parents[0])||JXG.IsPoint(parents[0]))&&(JXG.IsArray(parents[1])||JXG.IsPoint(parents[1]))){var point1;if(JXG.IsPoint(parents[0].type))
point1=parents[0];else
point1=new JXG.Point(board,parents[0],'','',false);var point2;if(JXG.IsPoint(parents[1]))
point2=parents[1];else
point2=new JXG.Point(board,parents[1],'','',false);point1.fixed=true;point2.fixed=true;if(attributes==null)
attributes=new Object();attributes.lastArrow=true;attributes.straightFirst=true;attributes.straightLast=true;attributes.withTicks=true;if(attributes.strokeWidth==null)
attributes.strokeWidth=2;var el=board.createElement('line',[point1,point2],attributes);}
else
throw("Can't create point with parent types '"+(typeof parents[0])+"' and '"+(typeof parents[1])+"'.");return el;};JXG.JSXGraph.registerElement('axis',JXG.createAxis);JXG.Group=function(board,id,name){this.board=board;this.objects={};var number=this.board.numObjects;this.board.numObjects++;if((id=='')||(id==null)||(typeof id=='undefined')){this.id=this.board.id+'Group'+number;}else{this.id=id;}
this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;if((name=='')||(name==null)||(typeof name=='undefined')){this.name='group_'+this.board.generateName(this);}else{this.name=name;}
delete(this.type);var objArray;if((arguments.length==4)&&(Object.isArray(arguments[3])))
objArray=arguments[3];else{objArray=[];for(var i=3;i<arguments.length;i++){objArray.push(arguments[i]);}}
for(var i=0;i<objArray.length;i++){var obj=JXG.GetReferenceFromParameter(this.board,objArray[i]);if((!obj.fixed)&&((obj.type==JXG.OBJECT_TYPE_POINT)||(obj.type==JXG.OBJECT_TYPE_GLIDER))){if(obj.group.length!=0){this.addGroup(obj.group[obj.group.length-1]);}else{this.addPoint(obj);}}}
for(var el in this.objects){this.objects[el].group.push(this);}
this.dX=0;this.dY=0;};JXG.Group.prototype.ungroup=function(){for(var el in this.objects){if(this.objects[el].group[this.objects[el].group.length-1]==this){this.objects[el].group.pop();}
delete(this.objects[el]);}};JXG.Group.prototype.update=function(point){var obj=null;for(var Elements in this.objects){obj=this.objects[Elements];if(obj.id!=point.id){obj.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[obj.coords.scrCoords[1]+this.dX,obj.coords.scrCoords[2]+this.dY],obj.board);}}
for(var Elements in this.objects){if(this.board.objects[Elements]!=undefined){this.objects[Elements].update(false);}else{delete(this.objects[Elements]);}}};JXG.Group.prototype.addPoint=function(object){this.objects[object.id]=object;};JXG.Group.prototype.addPoints=function(objects){for(var p in objects)
this.objects[p.id]=p;};JXG.Group.prototype.addGroup=function(group){for(var el in group.objects){this.addPoint(group.objects[el]);}};JXG.Circle=function(board,method,par1,par2,id,name){this.constructor();this.init(board,id,name);this.type=JXG.OBJECT_TYPE_CIRCLE;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.method=method;this.midpoint=JXG.GetReferenceFromParameter(this.board,par1);this.midpoint.addChild(this);this.visProp['visible']=true;this.point2=null;this.radius=0;this.line=null;this.circle=null;if(method=='twoPoints'){this.point2=JXG.GetReferenceFromParameter(board,par2);this.point2.addChild(this);this.radius=this.getRadius();this.id=this.board.addCircle(this);}
else if(method=='pointRadius'){this.generateTerm(par2);this.updateRadius();this.id=this.board.addCircle(this);this.notifyParents(par2);}
else if(method=='pointLine'){this.line=JXG.GetReferenceFromParameter(board,par2);this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords);this.line.addChild(this);this.id=this.board.addCircle(this);}
else if(method=='pointCircle'){this.circle=JXG.GetReferenceFromParameter(board,par2);this.radius=this.circle.getRadius();this.circle.addChild(this);this.id=this.board.addCircle(this);}};JXG.Circle.prototype=new JXG.GeometryElement;JXG.Circle.prototype.hasPoint=function(x,y){var genauigkeit=this.board.options.precision.hasPoint;genauigkeit=genauigkeit/(this.board.unitX*this.board.zoomX);var checkPoint=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this.board);var r=this.getRadius();var dist=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-checkPoint.usrCoords[1],2)+
Math.pow(this.midpoint.coords.usrCoords[2]-checkPoint.usrCoords[2],2));return(Math.abs(dist-r)<genauigkeit);};JXG.Circle.prototype.update=function(){if(this.traced){this.cloneToBackground(true);}
if(this.needsUpdate){if(this.method=='pointLine'){this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords);}
else if(this.method=='pointCircle'){this.radius=this.circle.getRadius();}
else if(this.method=='pointRadius'){this.radius=this.updateRadius();}
if(!this.board.geonextCompatibilityMode){this.updateStdform();}}};JXG.Circle.prototype.updateStdform=function(){this.stdform[3]=0.5;this.stdform[4]=this.getRadius();this.stdform[1]=-this.midpoint.coords.usrCoords[1];this.stdform[2]=-this.midpoint.coords.usrCoords[2];this.normalize();};JXG.Circle.prototype.updateRenderer=function(){if(this.needsUpdate&&this.visProp['visible']){var wasReal=this.isReal;this.isReal=(isNaN(this.midpoint.coords.usrCoords[1]+this.midpoint.coords.usrCoords[2]+this.getRadius()))?false:true;if(this.isReal){if(wasReal!=this.isReal){this.board.renderer.show(this);}
this.board.renderer.updateCircle(this);}else{if(wasReal!=this.isReal){this.board.renderer.hide(this);}}
this.needsUpdate=false;}};JXG.Circle.prototype.generateTerm=function(term){if(typeof term=='string'){var elements=this.board.elementsByName;var newTerm=this.board.algebra.geonext2JS(term+'');this.updateRadius=new Function('return '+newTerm+';');}else if(typeof term=='number'){this.updateRadius=function(){return term;};}else{this.updateRadius=term;}}
JXG.Circle.prototype.notifyParents=function(contentStr){var res=null;var elements=this.board.elementsByName;this.board.algebra.findDependencies(this,contentStr+'');}
JXG.Circle.prototype.getRadius=function(){if(this.method=='twoPoints'){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)));}
else if(this.method=='pointLine'||this.method=='pointCircle'){return this.radius;}
else if(this.method=='pointRadius'){return this.updateRadius();}}
JXG.Circle.prototype.getTextAnchor=function(){return this.midpoint.coords;};JXG.Circle.prototype.cloneToBackground=function(addToTrace){var copy={};copy.id=this.id+'T'+this.numTraces;this.numTraces++;copy.midpoint={};copy.midpoint.coords=this.midpoint.coords;var r=this.getRadius();copy.getRadius=function(){return r;};copy.board={};copy.board.unitX=this.board.unitX;copy.board.unitY=this.board.unitY;copy.board.zoomX=this.board.zoomX;copy.board.zoomY=this.board.zoomY;copy.visProp=this.visProp;this.board.renderer.drawCircle(copy);this.traces[copy.id]=$(copy.id);delete copy;};JXG.Circle.prototype.addTransform=function(transform){var list;if(JXG.IsArray(transform)){list=transform;}else{list=[transform];}
for(var i=0;i<list.length;i++){this.midpoint.transformations.push(list[i]);if(this.method=='twoPoints'){this.point2.transformations.push(list[i]);}}};JXG.Circle.prototype.setPosition=function(method,x,y){var t=this.board.createElement('transform',[x,y],{type:'translate'});this.addTransform(t);};JXG.createCircle=function(board,parentArr,atts){var el;if((parentArr[0].elementClass==JXG.OBJECT_CLASS_POINT)&&(parentArr[1].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'twoPoints',parentArr[0],parentArr[1],atts['id'],atts['name']);}else if((JXG.IsNumber(parentArr[0])||JXG.IsFunction(parentArr[0])||JXG.IsString(parentArr[0]))&&(parentArr[1].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointRadius',parentArr[1],parentArr[0],atts['id'],atts['name']);}else if((JXG.IsNumber(parentArr[1])||JXG.IsFunction(parentArr[1])||JXG.IsString(parentArr[1]))&&(parentArr[0].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointRadius',parentArr[0],parentArr[1],atts['id'],atts['name']);}else if((parentArr[0].type==JXG.OBJECT_TYPE_CIRCLE)&&(parentArr[1].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointCircle',parentArr[1],parentArr[0],atts['id'],atts['name']);}else if((parentArr[1].type==JXG.OBJECT_TYPE_CIRCLE)&&(parentArr[0].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointCircle',parentArr[0],parentArr[1],atts['id'],atts['name']);}else if((parentArr[0].type==JXG.OBJECT_TYPE_LINE)&&(parentArr[1].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointLine',parentArr[1],parentArr[0],atts['id'],atts['name']);}else if((parentArr[1].type==JXG.OBJECT_TYPE_LINE)&&(parentArr[0].elementClass==JXG.OBJECT_CLASS_POINT)){el=new JXG.Circle(board,'pointLine',parentArr[0],parentArr[1],atts['id'],atts['name']);}else
throw("Can't create circle with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");return el;};JXG.JSXGraph.registerElement('circle',JXG.createCircle);JXG.Polygon=function(board,vertices,borders,id,name,withLines){this.constructor();this.type=JXG.OBJECT_TYPE_POLYGON;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(board,id,name);if((typeof withLines=='undefined')||(withLines==null)){withLines=true;}
this.withLines=withLines;this.vertices=[];for(var i=0;i<vertices.length;i++){var vertex=JXG.GetReferenceFromParameter(this.board,vertices[i]);this.vertices[i]=vertex;}
if((typeof borders=='undefined')||(borders==null)){borders=[];for(var i=0;i<vertices.length-1;i++){borders[i]={};}}
if(this.vertices[this.vertices.length-1]!=this.vertices[0]){this.vertices.push(this.vertices[0]);borders.push({});}
this.visProp['fillColor']=this.board.options.polygon.fillColor;this.visProp['highlightFillColor']=this.board.options.polygon.highlightFillColor;this.visProp['fillOpacity']=this.board.options.polygon.fillOpacity;this.visProp['highlightFillOpacity']=this.board.options.polygon.highlightFillOpacity;var l;this.borders=[];if(withLines){for(var i=0;i<this.vertices.length-1;i++){l=new JXG.Line(board,this.vertices[i],this.vertices[i+1],borders[i].id,borders[i].name);l.setStraight(false,false);this.borders[i]=l;l.parentPolygon=this;}}
for(var i=0;i<this.vertices.length-1;i++){var vertex=JXG.GetReferenceFromParameter(this.board,this.vertices[i]);vertex.addChild(this);}
this.id=this.board.addPolygon(this);};JXG.Polygon.prototype=new JXG.GeometryElement;JXG.Polygon.prototype.hasPoint=function(x,y){return false;};JXG.Polygon.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updatePolygon(this);this.needsUpdate=false;}};JXG.Polygon.prototype.getTextAnchor=function(){var a=0;var b=0;var x=0;var y=0;a=x=this.vertices[0].X();b=y=this.vertices[0].Y();for(var i=0;i<this.vertices.length;i++){if(this.vertices[i].X()<a)
a=this.vertices[i].X();if(this.vertices[i].X()>x)
x=this.vertices[i].X();if(this.vertices[i].Y()>b)
b=this.vertices[i].Y();if(this.vertices[i].Y()<y)
y=this.vertices[i].Y();}
return new JXG.Coords(JXG.COORDS_BY_USER,[(a+x)*0.5,(b+y)*0.5],this.board);};JXG.Polygon.prototype.cloneToBackground=function(addToTrace){var copy={};copy.id=this.id+'T'+this.numTraces;this.numTraces++;copy.vertices=this.vertices;copy.visProp=this.visProp;this.board.renderer.drawPolygon(copy);this.traces[copy.id]=$(copy.id);delete copy;};JXG.createPolygon=function(board,parentArr,atts){var el;for(var i=0;i<parentArr.length;i++){if(!JXG.IsPoint(parentArr[i]))
throw("Can't create polygon with parent types other than 'point'.");}
el=new JXG.Polygon(board,parentArr,atts["borders"],atts["id"],atts["name"],atts["withLines"]);return el;};JXG.JSXGraph.registerElement('polygon',JXG.createPolygon);JXG.Curve=function(board,definingArr,id,name){this.constructor();this.points=[];this.numberPoints=0;this.type=JXG.OBJECT_TYPE_CURVE;this.elementClass=JXG.OBJECT_CLASS_CURVE;this.init(board,id,name);this.visProp['strokeWidth']=this.board.options.curve.strokeWidth;this.visProp['visible']=true;this.dataX=null;this.dataY=null;this.curveType='none';this.curveType=null;if(definingArr[2]!=null){this.varname=definingArr[2];}else{this.varname='x';}
this.xterm=definingArr[0];this.yterm=definingArr[1];this.generateTerm(this.xterm,this.yterm,this.varname,definingArr[3],definingArr[4]);this.updateCurve();this.id=this.board.addCurve(this);if(typeof this.xterm=='string'){this.notifyParents(this.xterm);}
if(typeof this.yterm=='string'){this.notifyParents(this.yterm);}};JXG.Curve.prototype=new JXG.GeometryElement;JXG.Curve.prototype.minX=function(){if(this.curveType=='polar'){return 0.0;}else{var leftCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board);return leftCoords.usrCoords[1];}};JXG.Curve.prototype.maxX=function(){if(this.curveType=='polar'){return 2.0*Math.PI;}else{var rightCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board);return rightCoords.usrCoords[1];}};JXG.Curve.prototype.hasPoint=function(x,y){var t,dist,c,trans,i,j,tX,tY;var prec=5/(this.board.unitX*this.board.zoomX);var checkPoint=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this.board);x=checkPoint.usrCoords[1];y=checkPoint.usrCoords[2];if(this.curveType=='parameter'){var steps=300;var d=(this.maxX()-this.minX())/steps;for(i=0,t=this.minX();i<steps;i++){tX=this.X(t);tY=this.Y(t);for(j=0;j<this.transformations.length;j++){trans=this.transformations[j];trans.update();c=trans.matVecMult(trans.matrix,[1,tX,tY]);tX=c[1];tY=c[2];}
dist=Math.sqrt((x-tX)*(x-tX)+(y-tY)*(y-tY));if(dist<prec){return true;}
t+=d;}}else if(this.curveType=='polar'){return false;}else{var steps=300;var d=(this.maxX()-this.minX())/steps;for(i=0,t=this.minX();i<steps;i++){tX=this.X(t);tY=this.Y(t);for(j=0;j<this.transformations.length;j++){trans=this.transformations[j];trans.update();c=trans.matVecMult(trans.matrix,[1,tX,tY]);tX=c[1];tY=c[2];}
dist=Math.sqrt((x-tX)*(x-tX)+(y-tY)*(y-tY));if(dist<prec){return true;}
t+=d;}}
return(dist<prec);};JXG.Curve.prototype.allocatePoints=function(){if(this.points.length<this.numberPoints){for(var i=this.points.length;i<this.numberPoints;i++){this.points[i]=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board);}}};JXG.Curve.prototype.update=function(){if(this.needsUpdate){this.updateCurve();}};JXG.Curve.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateCurve(this);this.needsUpdate=false;}};JXG.Curve.prototype.updateDataArray=function(){};JXG.Curve.prototype.updateCurve=function(){this.updateDataArray();if(this.curveType=='plot'&&this.dataX!=null){this.numberPoints=this.dataX.length;}else{if(this.board.updateQuality==this.board.BOARD_QUALITY_HIGH){this.numberPoints=this.board.canvasWidth*1.0;}else{this.numberPoints=this.board.canvasWidth*0.25;}}
this.allocatePoints();var len=this.numberPoints;var mi=this.minX();var ma=this.maxX();var x,y;var stepSize=(ma-mi)/len;for(var i=0;i<len;i++){if(this.dataX!=null){x=i;if(this.dataY!=null){y=i;}else{y=this.X(x);}}else{x=mi+i*stepSize;y=x;}
if(this.curveType=='polar'){var r=this.X(x);var offs=[0,0];if(this.dataY!=null){offs=this.dataY;}
this.points[i].setCoordinates(JXG.COORDS_BY_USER,[r*Math.cos(x)+offs[0],r*Math.sin(x)+offs[1]]);}else{this.points[i].setCoordinates(JXG.COORDS_BY_USER,[this.X(x),this.Y(y)]);}
this.updateTransform(this.points[i]);}};JXG.Curve.prototype.updateTransform=function(p){if(this.transformations.length==0){return p;}
for(var i=0;i<this.transformations.length;i++){var t=this.transformations[i];t.update();var c=t.matVecMult(t.matrix,p.usrCoords);p.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);}
return p;};JXG.Curve.prototype.addTransform=function(transform){var list;if(JXG.IsArray(transform)){list=transform;}else{list=[transform];}
for(var i=0;i<list.length;i++){this.transformations.push(list[i]);}};JXG.Curve.prototype.setPosition=function(method,x,y){var t=this.board.createElement('transform',[x,y],{type:'translate'});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(t);}else{this.addTransform(t);}};JXG.Curve.prototype.generateTerm=function(xterm,yterm,varname,mi,ma){this.numberPoints=this.board.canvasWidth*1.0;if(typeof xterm=='string'){var newxterm=this.board.algebra.geonext2JS(xterm);this.X=new Function(varname,'return '+newxterm+';');this.curveType='graph';}else if(typeof xterm=='function'){this.X=xterm;this.curveType='parameter';}else if(typeof xterm=='number'){this.X=function(){return xterm;};this.curveType='parameter';}else if(typeof xterm=='object'){this.curveType='plot';this.dataX=xterm;this.X=function(i){return this.dataX[i];};this.numberPoints=this.dataX.length;}
if(typeof yterm=='string'){var newyterm=this.board.algebra.geonext2JS(yterm);this.Y=new Function(varname,'return '+newyterm+';');}else if(typeof yterm=='function'){this.Y=yterm;}else if(typeof yterm=='number'){this.Y=function(){return yterm;};}else if(typeof yterm=='object'){this.dataY=yterm;this.Y=function(i){return this.dataY[i];};}
if(mi!=null){if(typeof mi=='string'){var newMin=this.board.algebra.geonext2JS(mi);this.minX=new Function('','return '+newMin+';');}else if(typeof mi=='function'){this.minX=mi;}else if(typeof mi=='number'){this.minX=function(){return mi;};}}
if(ma!=null){if(typeof ma=='string'){var newMax=this.board.algebra.geonext2JS(ma);this.maxX=new Function('','return '+newMax+';');}else if(typeof ma=='function'){this.maxX=ma;}else if(typeof ma=='number'){this.maxX=function(){return ma;};}}};JXG.Curve.prototype.notifyParents=function(contentStr){var res=null;var elements=this.board.elementsByName;this.board.algebra.findDependencies(this,contentStr);};JXG.createCurve=function(board,parentArr,atts){return new JXG.Curve(board,parentArr,atts['id'],atts['name']);};JXG.JSXGraph.registerElement('curve',JXG.createCurve);JXG.Arc=function(board,p1,p2,p3,id,name){this.constructor();this.type=JXG.OBJECT_TYPE_ARC;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.init(board,id,name);this.midpoint=JXG.GetReferenceFromParameter(this.board,p1);this.point2=JXG.GetReferenceFromParameter(this.board,p2);this.point3=JXG.GetReferenceFromParameter(this.board,p3);this.r=this.board.options.precision.hasPoint;this.visProp['visible']=true;this.visProp['firstArrow']=this.board.options.arc.firstArrow;this.visProp['lastArrow']=this.board.options.arc.lastArrow;this.id=this.board.addArc(this);this.midpoint.addChild(this);this.point2.addChild(this);this.point3.addChild(this);};JXG.Arc.prototype=new JXG.GeometryElement;JXG.Arc.prototype.hasPoint=function(x,y){var genauigkeit=this.r/(this.board.unitX*this.board.zoomX);var checkPoint=new JXG.Coords(JXG.COORDS_BY_SCREEN,[x,y],this.board);var r=this.getRadius();var dist=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-checkPoint.usrCoords[1],2)+
Math.pow(this.midpoint.coords.usrCoords[2]-checkPoint.usrCoords[2],2));var has=(Math.abs(dist-r)<genauigkeit);if(has){var p={};p.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1],this.board.origin.usrCoords[2]/(this.board.unitY*this.board.zoomY)],this.board);var angle1=this.board.algebra.trueAngle(this.point2,this.midpoint,p);var angle2=this.board.algebra.trueAngle(this.point3,this.midpoint,p);var xy={};xy.coords=checkPoint;var angle3=this.board.algebra.trueAngle(xy,this.midpoint,p);if(angle1>=angle2){if(angle1<angle3||angle3<angle2){has=false;}}
else{if(angle3>angle1){if(angle3<angle2){has=false;}}}}
return has;};JXG.Arc.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)));};JXG.Arc.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateArc(this);this.needsUpdate=false;}};JXG.Arc.prototype.setArrow=function(firstArrow,lastArrow){this.visProp['firstArrow']=firstArrow;this.visProp['lastArrow']=lastArrow;this.board.renderer.updateArc(this);};JXG.createArc=function(board,parents,attributes){var el;if((JXG.IsPoint(parents[0]))&&(JXG.IsPoint(parents[1]))&&(JXG.IsPoint(parents[2]))){el=new JXG.Arc(board,parents[0],parents[1],parents[2],attributes['id'],attributes['name']);}
else
throw("Can't create Arc with parent types '"+(typeof parents[0])+"' and '"+(typeof parents[1])+"' and '"+(typeof parents[2])+"'.");return el;};JXG.JSXGraph.registerElement('arc',JXG.createArc);JXG.Sector=function(board,p1,p2,p3,ids,names,id){this.constructor();this.type=JXG.OBJECT_TYPE_SECTOR;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(board,id,'');if(!JXG.IsArray(ids)){ids=[null,null,null,null];}
if(!JXG.IsArray(names)){names=[null,null,null,null];}
this.point1=JXG.GetReferenceFromParameter(this.board,p1);this.point2=JXG.GetReferenceFromParameter(this.board,p2);this.point3=JXG.GetReferenceFromParameter(this.board,p3);this.r=this.board.options.precision.hasPoint;this.visProp['visible']=true;var circle={};circle.midpoint=this.point1;var radius=this.getRadius();circle.getRadius=function(){return radius;}
var p4coords=this.board.algebra.projectPointToCircle(this.point3,circle);var p=new JXG.Point(board,[p4coords.usrCoords[1],p4coords.usrCoords[2]],ids[1],names[1],true);p.fixed=true;this.addChild(p);p.update=function(){var circle={};circle.midpoint=JXG.GetReferenceFromParameter(this.board,p1);var radius=(Math.sqrt(Math.pow(JXG.GetReferenceFromParameter(this.board,p1).coords.usrCoords[1]-JXG.GetReferenceFromParameter(this.board,p2).coords.usrCoords[1],2)+Math.pow(JXG.GetReferenceFromParameter(this.board,p1).coords.usrCoords[2]-JXG.GetReferenceFromParameter(this.board,p2).coords.usrCoords[2],2)));circle.getRadius=function(){return radius;}
p4coords=this.board.algebra.projectPointToCircle(JXG.GetReferenceFromParameter(this.board,p3),circle);this.coords=p4coords;this.board.renderer.updatePoint(this);if(this.label.show){this.label.setCoordinates(this.coords);this.board.renderer.updateLabel(this.label);}}
var l1=new JXG.Line(board,p1,p2,ids[2],names[2]);var l2=new JXG.Line(board,p1,p.id,ids[3],names[3]);l1.setStraight(false,false);l2.setStraight(false,false);var a=new JXG.Arc(board,p1,p2,p3,ids[0],names[0]);a.visProp['fillColor']=this.board.options.sector.fillColor;a.visProp['highlightFillColor']=this.board.options.sector.highlightFillColor;a.visProp['fillOpacity']=this.board.options.sector.fillOpacity;a.visProp['highlightFillOpacity']=this.board.options.sector.highlightFillOpacity;this.point4=p;this.lines=[l1,l2];this.arc=a;this.id=this.board.addSector(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this);};JXG.Sector.prototype=new JXG.GeometryElement;JXG.Sector.prototype.hasPoint=function(x,y){return false;};JXG.Sector.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.point1.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.point1.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)));};JXG.Sector.prototype.updateRenderer=function(){};JXG.createSector=function(board,parentArr,atts){var el;if((JXG.IsPoint(parentArr[0]))&&(JXG.IsPoint(parentArr[1]))&&(JXG.IsPoint(parentArr[2]))){el=new JXG.Sector(board,parentArr[0],parentArr[1],parentArr[2],atts["ids"],atts["names"],atts['id']);}
else
throw("Can't create sector with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"' and '"+(typeof parentArr[2])+"'.");return el;};JXG.JSXGraph.registerElement('sector',JXG.createSector);JXG.Angle=function(board,p1,p2,p3,radius,text,id,name){this.constructor();this.type=JXG.OBJECT_TYPE_ANGLE;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(board,id,name);this.point1=JXG.GetReferenceFromParameter(this.board,p1);this.point2=JXG.GetReferenceFromParameter(this.board,p2);this.point3=JXG.GetReferenceFromParameter(this.board,p3);this.radius=this.board.options.angle.radius;if(radius!=undefined&&radius!=null){this.radius=radius;}
this.visProp['fillColor']=this.board.options.angle.fillColor;this.visProp['highlightFillColor']=this.board.options.angle.highlightFillColor;this.visProp['fillOpacity']=this.board.options.angle.fillOpacity;this.visProp['highlightFillOpacity']=this.board.options.angle.highlightFillOpacity;this.visProp['strokeColor']=this.board.options.angle.strokeColor;this.text=text;this.id=this.board.addAngle(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this);};JXG.Angle.prototype=new JXG.GeometryElement;JXG.Angle.prototype.hasPoint=function(x,y){return false;};JXG.Angle.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateAngle(this);this.needsUpdate=false;}};JXG.createAngle=function(board,parents,attributes){var el;if((JXG.IsPoint(parents[0]))&&(JXG.IsPoint(parents[1]))&&(JXG.IsPoint(parents[2]))){el=new JXG.Angle(board,parents[0],parents[1],parents[2],attributes['id'],attributes['name']);}
else
throw("Can't create angle with parent types '"+(typeof parents[0])+"' and '"+(typeof parents[1])+"' and '"+(typeof parents[2])+"'.");return el;};JXG.JSXGraph.registerElement('angle',JXG.createAngle);JXG.Label=function(board,name,coordinates,id){if(typeof(board)=='string'){board=JXG.Geonext.boards[board];}
this.board=board;this.id=id;this.name=name+"Label";this.nameHTML=this.board.algebra.replaceSup(this.board.algebra.replaceSub(name));this.distanceX=10;this.distanceY=10;this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[coordinates.usrCoords[1]*1+this.distanceX/(this.board.unitX*this.board.zoomX),coordinates.usrCoords[2]*1+this.distanceY/(this.board.unitY*this.board.zoomY)],this.board);this.show=true;this.color='#000000';this.hiddenByParent=false;};JXG.Label.prototype.hideElement=function(){this.show=false;this.board.renderer.hide(this);};JXG.Label.prototype.showElement=function(){this.show=true;this.board.renderer.show(this);};JXG.Label.prototype.setCoordinates=function(coordinates){this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[coordinates.usrCoords[1]*1+this.distanceX/(this.board.unitX*this.board.zoomX),coordinates.usrCoords[2]*1+this.distanceY/(this.board.unitY*this.board.zoomY)],this.board);};JXG.Algebra=function(board){this.board=board;this.eps=0.00001;};JXG.Algebra.prototype.angle=function(A,B,C){var a=[];var b=[];var c=[];if(A.coords==null){a[0]=A[0];a[1]=A[1];}else{a[0]=A.coords.usrCoords[1];a[1]=A.coords.usrCoords[2];}
if(B.coords==null){b[0]=B[0];b[1]=B[1];}else{b[0]=B.coords.usrCoords[1];b[1]=B.coords.usrCoords[2];}
if(C.coords==null){c[0]=C[0];c[1]=C[1];}else{c[0]=C.coords.usrCoords[1];c[1]=C.coords.usrCoords[2];}
var u=a[0]-b[0];var v=a[1]-b[1];var s=c[0]-b[0];var t=c[1]-b[1];var theta=Math.atan((u*t-v*s)/(u*s+v*t));return theta;};JXG.Algebra.prototype.trueAngle=function(A,B,C){var ax;var ay;var bx;var by;var cx;var cy;if(A.coords==null){ax=A[0];ay=A[1];}else{ax=A.coords.usrCoords[1];ay=A.coords.usrCoords[2];}
if(B.coords==null){bx=B[0];by=B[1];}else{bx=B.coords.usrCoords[1];by=B.coords.usrCoords[2];}
if(C.coords==null){cx=C[0];cy=C[1];}else{cx=C.coords.usrCoords[1];cy=C.coords.usrCoords[2];}
var sp=(cx-bx)*(ax-bx)+(cy-by)*(ay-by);var cp=(ax-bx)*(cy-by)-(ay-by)*(cx-bx);var l1=Math.sqrt((ax-bx)*(ax-bx)+(ay-by)*(ay-by));var l2=Math.sqrt((cx-bx)*(cx-bx)+(cy-by)*(cy-by));var phiacos=sp/(l1*l2);if(phiacos>1){phiacos=1;}else if(phiacos<-1){phiacos=-1;}
var phicos=Math.acos(phiacos);var phi=0;if((Math.sin(phicos)*cp)<0){phi=2*Math.PI-phicos;}else{phi=phicos;}
phi=(phi/Math.PI)*180;return phi;};JXG.Algebra.prototype.angleBisector=function(A,B,C){var x=A.coords.usrCoords[1]-B.coords.usrCoords[1];var y=A.coords.usrCoords[2]-B.coords.usrCoords[2];var d=Math.sqrt(x*x+y*y);x/=d;y/=d;var phiA=Math.acos(x);if(y<0){phiA*=-1;}
if(phiA<0){phiA+=2*Math.PI;}
x=C.coords.usrCoords[1]-B.coords.usrCoords[1];y=C.coords.usrCoords[2]-B.coords.usrCoords[2];d=Math.sqrt(x*x+y*y);x/=d;y/=d;var phiC=Math.acos(x);if(y<0){phiC*=-1;}
if(phiC<0){phiC+=2*Math.PI;}
var phi=(phiA+phiC)*0.5;if(phiA>phiC){phi+=Math.PI;}
x=Math.cos(phi)+B.coords.usrCoords[1];y=Math.sin(phi)+B.coords.usrCoords[2];return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.midpoint=function(A,B){return new JXG.Coords(JXG.COORDS_BY_USER,[(A.coords.usrCoords[1]+B.coords.usrCoords[1])/2,(A.coords.usrCoords[2]+B.coords.usrCoords[2])/2],this.board);};JXG.Algebra.prototype.parallel=function(point1,point2,point){var factor=1;var x=point.coords.usrCoords[1]+factor*(point2.coords.usrCoords[1]-point1.coords.usrCoords[1]);var y=point.coords.usrCoords[2]+factor*(point2.coords.usrCoords[2]-point1.coords.usrCoords[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.reflection=function(line,point){var v=line.point2.coords.usrCoords[1]-line.point1.coords.usrCoords[1];var w=line.point2.coords.usrCoords[2]-line.point1.coords.usrCoords[2];var x0=point.coords.usrCoords[1]-line.point1.coords.usrCoords[1];var y0=point.coords.usrCoords[2]-line.point1.coords.usrCoords[2];var mu=(v*y0-w*x0)/(v*v+w*w);var x1=point.coords.usrCoords[1]+2*mu*w;var y1=point.coords.usrCoords[2]-2*mu*v;return new JXG.Coords(JXG.COORDS_BY_USER,[x1,y1],this.board);};JXG.Algebra.prototype.rotation=function(rotpoint,point,phi){var x0=point.coords.usrCoords[1]-rotpoint.coords.usrCoords[1];var y0=point.coords.usrCoords[2]-rotpoint.coords.usrCoords[2];var x1,y1;var c=Math.cos(phi);var s=Math.sin(phi);x1=x0*c-y0*s+rotpoint.coords.usrCoords[1];y1=x0*s+y0*c+rotpoint.coords.usrCoords[2];return new JXG.Coords(JXG.COORDS_BY_USER,[x1,y1],this.board);};JXG.Algebra.prototype.perpendicular=function(line,point){var x;var y;var change;var A=line.point1.coords;var B=line.point2.coords;var C=point.coords;if(point==line.point1){x=A.usrCoords[1]+B.usrCoords[2]-A.usrCoords[2];y=A.usrCoords[2]-B.usrCoords[1]+A.usrCoords[1];change=true;}
else if(point==line.point2){x=B.usrCoords[1]+A.usrCoords[2]-B.usrCoords[2];y=B.usrCoords[2]-A.usrCoords[1]+B.usrCoords[1];change=false;}
else if(((Math.abs(A.usrCoords[1]-B.usrCoords[1])>this.eps)&&(Math.abs(C.usrCoords[2]-(A.usrCoords[2]-B.usrCoords[2])*(C.usrCoords[1]-A.usrCoords[1])/(A.usrCoords[1]-B.usrCoords[1])-A.usrCoords[2])<this.eps))||((Math.abs(A.usrCoords[1]-B.usrCoords[1])<=this.eps)&&(Math.abs(A.usrCoords[1]-C.usrCoords[1])<this.eps))){x=C.usrCoords[1]+B.usrCoords[2]-C.usrCoords[2];y=C.usrCoords[2]-B.usrCoords[1]+C.usrCoords[1];change=true;if(Math.abs(x-C.usrCoords[1])<this.eps&&Math.abs(y-C.usrCoords[2])<this.eps){x=C.usrCoords[1]+A.usrCoords[2]-C.usrCoords[2];y=C.usrCoords[2]-A.usrCoords[1]+C.usrCoords[1];change=false;}}
else{var fmd=line.point1.coords.usrCoords[2]-line.point2.coords.usrCoords[2];var emc=line.point1.coords.usrCoords[1]-line.point2.coords.usrCoords[1];var d0=line.point2.coords.usrCoords[1]*fmd-line.point2.coords.usrCoords[2]*emc;var d1=point.coords.usrCoords[1]*emc+point.coords.usrCoords[2]*fmd;var den=fmd*fmd+emc*emc;if(Math.abs(den)<this.eps){den=this.eps;}
x=(d0*fmd+d1*emc)/den;y=(d1*fmd-d0*emc)/den;change=true;}
return[new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board),change];};JXG.Algebra.prototype.circumcenterMidpoint=function(point1,point2,point3){var u=((point1.coords.usrCoords[1]-point2.coords.usrCoords[1])*(point1.coords.usrCoords[1]+point2.coords.usrCoords[1])+
(point1.coords.usrCoords[2]-point2.coords.usrCoords[2])*(point1.coords.usrCoords[2]+point2.coords.usrCoords[2]))/2.0;var v=((point2.coords.usrCoords[1]-point3.coords.usrCoords[1])*(point2.coords.usrCoords[1]+point3.coords.usrCoords[1])+
(point2.coords.usrCoords[2]-point3.coords.usrCoords[2])*(point2.coords.usrCoords[2]+point3.coords.usrCoords[2]))/2.0;var den=(point1.coords.usrCoords[1]-point2.coords.usrCoords[1])*(point2.coords.usrCoords[2]-point3.coords.usrCoords[2])-
(point2.coords.usrCoords[1]-point3.coords.usrCoords[1])*(point1.coords.usrCoords[2]-point2.coords.usrCoords[2]);if(Math.abs(den)<this.eps){den=this.eps;}
var x=(u*(point2.coords.usrCoords[2]-point3.coords.usrCoords[2])-v*(point1.coords.usrCoords[2]-point2.coords.usrCoords[2]))/den;var y=(v*(point1.coords.usrCoords[1]-point2.coords.usrCoords[1])-u*(point2.coords.usrCoords[1]-point3.coords.usrCoords[1]))/den;return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.intersectLineLine=function(line1,line2){var d0=line1.point1.coords.usrCoords[1]*line1.point2.coords.usrCoords[2]-line1.point1.coords.usrCoords[2]*line1.point2.coords.usrCoords[1];var d1=line2.point1.coords.usrCoords[1]*line2.point2.coords.usrCoords[2]-line2.point1.coords.usrCoords[2]*line2.point2.coords.usrCoords[1];var den=(line1.point2.coords.usrCoords[2]-line1.point1.coords.usrCoords[2])*(line2.point1.coords.usrCoords[1]-line2.point2.coords.usrCoords[1])
-(line1.point1.coords.usrCoords[1]-line1.point2.coords.usrCoords[1])*(line2.point2.coords.usrCoords[2]-line2.point1.coords.usrCoords[2]);if(Math.abs(den)<this.eps){den=this.eps;}
var x=(d0*(line2.point1.coords.usrCoords[1]-line2.point2.coords.usrCoords[1])-d1*(line1.point1.coords.usrCoords[1]-line1.point2.coords.usrCoords[1]))/den;var y=(d1*(line1.point2.coords.usrCoords[2]-line1.point1.coords.usrCoords[2])-d0*(line2.point2.coords.usrCoords[2]-line2.point1.coords.usrCoords[2]))/den;return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.intersectCircleLine=function(circle,line){var eA=line.point1;var eB=line.point2;var fM=circle.midpoint;s=eA.Dist(eB);if(s>0){var d0=fM.Dist(eA);var d1=fM.Dist(eB);var b=((d0*d0)+(s*s)-(d1*d1))/(2*s);var w=(d0*d0)-(b*b);w=(w<0)?0:w;var h=Math.sqrt(w);var r=circle.getRadius();var n1=Math.sqrt((r*r)-h*h);var dx=eB.coords.usrCoords[1]-eA.coords.usrCoords[1];var dy=eB.coords.usrCoords[2]-eA.coords.usrCoords[2];var firstPointX=fM.coords.usrCoords[1]+(h/s)*dy;var firstPointY=fM.coords.usrCoords[2]-(h/s)*dx;d0=(eB.coords.usrCoords[1]*dy)-(eB.coords.usrCoords[2]*dx);d1=(firstPointX*dx)+(firstPointY*dy);var l=(dy*dy)+(dx*dx);if(Math.abs(l)<this.eps){l=this.eps;}
var x=((d0*dy)+(d1*dx))/l;var y=((d1*dy)-(d0*dx))/l;var n1s=n1/s;var firstPoint=new JXG.Coords(JXG.COORDS_BY_USER,[x+n1s*dx,y+n1s*dy],this.board);var secondPoint=new JXG.Coords(JXG.COORDS_BY_USER,[x-n1s*dx,y-n1s*dy],this.board);var d=fM.coords.distance(JXG.COORDS_BY_USER,firstPoint);if((r<(d-1))||isNaN(d)){return[0];}else{return[2,firstPoint,secondPoint];}}};JXG.Algebra.prototype.intersectCircleLineOrg=function(circle,line){var intersection={};var eA=line.point1;var eB=line.point2;var fM=circle.midpoint;s=eA.Dist(eB);if(s>0){var d0=fM.Dist(eA);var d1=fM.Dist(eB);var b=((d0*d0)+(s*s)-(d1*d1))/(2*s);var w=(d0*d0)-(b*b);w=(w<0)?0:w;var h=Math.sqrt(w);var r=circle.getRadius();var n1=Math.sqrt((r*r)-(h*h));var dx=eB.X()-eA.X();var dy=eB.Y()-eA.Y();var firstPoint=new JXG.Coords(JXG.COORDS_BY_USER,[fM.X()+(h/s)*dy,fM.Y()-(h/s)*dx],this.board);d0=(eB.X()*dy)-(eB.Y()*dx);d1=(firstPoint.usrCoords[1]*dx)+(firstPoint.usrCoords[2]*dy);var l=(dy*dy)+(dx*dx);if(Math.abs(l)<this.eps){l=this.eps;}
var x=((d0*dy)+(d1*dx))/l;var y=((d1*dy)-(d0*dx))/l;firstPoint=new JXG.Coords(JXG.COORDS_BY_USER,[x+(n1/s)*dx,y+(n1/s)*dy],this.board);var secondPoint=new JXG.Coords(JXG.COORDS_BY_USER,[x-(n1/s)*dx,y-(n1/s)*dy],this.board);var d=fM.coords.distance(JXG.COORDS_BY_USER,firstPoint);if((r<(d-1))||isNaN(d)){intersection[0]=0;}else{intersection[0]=2;}
intersection[1]=firstPoint;intersection[2]=secondPoint;return intersection;}};JXG.Algebra.prototype.intersectCircleCircleOrg=function(circle1,circle2){var intersection={};var r1=circle1.getRadius();var r2=circle2.getRadius();var rSum=r1+r2;var rDiff=Math.abs(r1-r2);var midpointDist=circle1.midpoint.coords.distance(JXG.COORDS_BY_USER,circle2.midpoint.coords);if(midpointDist>rSum){return[0];}
else if(midpointDist<rDiff){return[0];}
else{intersection[0]=1;var a=(r1*r1-r2*r2+midpointDist*midpointDist)/(2*midpointDist);var h=Math.sqrt(r1*r1-a*a);var dx=(circle2.midpoint.coords.usrCoords[1]-circle1.midpoint.coords.usrCoords[1]);var dy=(circle2.midpoint.coords.usrCoords[2]-circle1.midpoint.coords.usrCoords[2]);var p=new JXG.Coords(JXG.COORDS_BY_USER,[circle1.midpoint.coords.usrCoords[1]+dx*a/midpointDist,circle1.midpoint.coords.usrCoords[2]+dy*a/midpointDist],this.board);var b=h/midpointDist;intersection[1]=new JXG.Coords(JXG.COORDS_BY_USER,[p.usrCoords[1]-b*dy,p.usrCoords[2]+b*dx],this.board);intersection[2]=new JXG.Coords(JXG.COORDS_BY_USER,[p.usrCoords[1]+b*dy,p.usrCoords[2]-b*dx],this.board);return intersection;}};JXG.Algebra.prototype.intersectCircleCircle=function(circle1,circle2){var intersection={};var r1=circle1.getRadius();var r2=circle2.getRadius();var rSum=r1+r2;var rDiff=Math.abs(r1-r2);var midpointDist=circle1.midpoint.coords.distance(JXG.COORDS_BY_USER,circle2.midpoint.coords);if(midpointDist>rSum){return[0];}
else if(midpointDist<rDiff){return[0];}
else{s=midpointDist;if(s!=0){intersection[0]=1;var dx=circle2.midpoint.coords.usrCoords[1]-circle1.midpoint.coords.usrCoords[1];var dy=circle2.midpoint.coords.usrCoords[2]-circle1.midpoint.coords.usrCoords[2];var a=(s*s-r2*r2+r1*r1)/(2*s);var h=Math.sqrt(r1*r1-a*a);intersection[1]=new JXG.Coords(JXG.COORDS_BY_USER,[circle1.midpoint.coords.usrCoords[1]+(a/s)*dx+(h/s)*dy,circle1.midpoint.coords.usrCoords[2]+(a/s)*dy-(h/s)*dx],this.board);intersection[2]=new JXG.Coords(JXG.COORDS_BY_USER,[circle1.midpoint.coords.usrCoords[1]+(a/s)*dx-(h/s)*dy,circle1.midpoint.coords.usrCoords[2]+(a/s)*dy+(h/s)*dx],this.board);}
else{return[0];}
return intersection;}};JXG.Algebra.prototype.projectPointToCircle=function(point,circle){var dist=point.coords.distance(JXG.COORDS_BY_USER,circle.midpoint.coords);if(Math.abs(dist)<this.eps){dist=this.eps;}
var factor=circle.getRadius()/dist;var x=circle.midpoint.coords.usrCoords[1]+factor*(point.coords.usrCoords[1]-circle.midpoint.coords.usrCoords[1]);var y=circle.midpoint.coords.usrCoords[2]+factor*(point.coords.usrCoords[2]-circle.midpoint.coords.usrCoords[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.projectPointToLine=function(point,line){var fmd=line.point1.coords.usrCoords[2]-line.point2.coords.usrCoords[2];var emc=line.point1.coords.usrCoords[1]-line.point2.coords.usrCoords[1];var d0=line.point2.coords.usrCoords[1]*fmd-line.point2.coords.usrCoords[2]*emc;var d1=point.coords.usrCoords[1]*emc+point.coords.usrCoords[2]*fmd;var den=fmd*fmd+emc*emc;if(Math.abs(den)<this.eps){den=this.eps;}
var x=(d0*fmd+d1*emc)/den;var y=(d1*fmd-d0*emc)/den;return new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);};JXG.Algebra.prototype.projectPointToCurve=function(point,curve){var newCoords,x,y,t;if(curve.curveType=='parameter'){x=point.X();y=point.Y();t=point.position||0.0;t=this.root(this.D(function(t){return(x-curve.X(t))*(x-curve.X(t))+(y-curve.Y(t))*(y-curve.Y(t));}),t);if(t<curve.minX()){t=curve.minX();}
if(t>curve.maxX()){t=curve.maxX();}
point.position=t;newCoords=new JXG.Coords(JXG.COORDS_BY_USER,[curve.X(t),curve.Y(t)],this.board);}else if(curve.curveType=='polar'){x=point.X();y=point.Y();t=point.position||0.0;var offs=(curve.dataY!=null)?curve.dataY:[0,0];t=this.root(this.D(function(t){var r=curve.X(t);return(x-r*Math.cos(t)-offs[0])*(x-r*Math.cos(t)-offs[0])+(y-r*Math.sin(t)-offs[1])*(y-r*Math.sin(t)-offs[1]);}),t);point.position=t;var r=curve.X(t);newCoords=new JXG.Coords(JXG.COORDS_BY_USER,[r*Math.cos(t)+offs[0],r*Math.sin(t)+offs[1]],this.board);}else{t=point.X();x=t;y=curve.Y(t);newCoords=new JXG.Coords(JXG.COORDS_BY_USER,[x,y],this.board);}
return curve.updateTransform(newCoords);};JXG.Algebra.prototype.replacePow=function(te){var count,pos,c;var s='';var leftop,rightop;var i=te.indexOf('^');while(i>=0){var left=te.slice(0,i);if(left.charAt(left.length-1)==')'){count=1;pos=left.length-2;while(pos>=0&&count>0){c=left.charAt(pos);if(c==')'){count++;}
else if(c=='('){count--;}
pos--;}
if(count==0){leftop='';var pre=left.substring(0,pos+1);var p=pos;while(p>=0&&pre.substr(p,1).match(/(\w+)/)){leftop=RegExp.$1+leftop;p--;}
leftop+=left.substring(pos+1,left.length);leftop=leftop.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1");}}else{leftop='\\w+';}
var right=te.slice(i+1);if(right.match(/^([\w\.]*\()/)){count=1;pos=RegExp.$1.length;while(pos<right.length&&count>0){c=right.charAt(pos);if(c==')'){count--;}
else if(c=='('){count++;}
pos++;}
if(count==0){rightop=right.substring(0,pos);rightop=rightop.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1");}}else{rightop='[\\w\\.]+';}
var expr=new RegExp('('+leftop+')\\^('+rightop+')');te=te.replace(expr,"this.board.algebra.pow($1,$2)");i=te.indexOf('^');}
return te;};JXG.Algebra.prototype.replaceIf=function(te){var s='';var left,right;var first=null;var second=null;var third=null;var i=te.indexOf('If(');if(i<0){return te;}
te=te.replace(/""/g,'0');while(i>=0){left=te.slice(0,i);right=te.slice(i+3);var count=1;var pos=0;var k1=-1;var k2=-1;while(pos<right.length&&count>0){var c=right.charAt(pos);if(c==')'){count--;}else if(c=='('){count++;}else if(c==','&&count==1){if(k1<0){k1=pos;}else{k2=pos;}}
pos++;}
var meat=right.slice(0,pos-1);right=right.slice(pos);if(k1<0){return'';}
if(k2<0){return'';}
first=meat.slice(0,k1);second=meat.slice(k1+1,k2);third=meat.slice(k2+1);first=this.replaceIf(first);second=this.replaceIf(second);third=this.replaceIf(third);s+=left+'(('+first+')?'+'('+second+'):('+third+'))';te=right;first=null;second=null;i=te.indexOf('If(');}
s+=right;return s;};JXG.Algebra.prototype.replaceSub=function(te){var i=te.indexOf('_{');while(i>=0){te=te.substr(0,i)+te.substr(i).replace(/_\{/,'<sub>');var j=te.substr(i).indexOf('}');if(j>=0){te=te.substr(0,j)+te.substr(j).replace(/\}/,'</sub>');}
i=te.indexOf('_{');}
i=te.indexOf('_');while(i>=0){te=te.substr(0,i)+te.substr(i).replace(/_(.?)/,'<sub>$1</sub>');i=te.indexOf('_');}
return te;};JXG.Algebra.prototype.replaceSup=function(te){var i=te.indexOf('^{');while(i>=0){te=te.substr(0,i)+te.substr(i).replace(/\^\{/,'<sup>');var j=te.substr(i).indexOf('}');if(j>=0){te=te.substr(0,j)+te.substr(j).replace(/\}/,'</sup>');}
i=te.indexOf('^{');}
i=te.indexOf('^');while(i>=0){te=te.substr(0,i)+te.substr(i).replace(/\^(.?)/,'<sup>$1</sup>');i=te.indexOf('^');}
return te;};JXG.Algebra.prototype.replaceNameById=function(term){var pos=0;var end;var elName;var elID;var el;pos=term.indexOf('X(');while(pos>=0){if(pos>=0){end=term.indexOf(')',pos+2);if(end>=0){elName=term.slice(pos+2,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+2)+el.id+term.slice(end);}}
end=term.indexOf(')',pos+2);pos=term.indexOf('X(',end);}
pos=term.indexOf('Y(');while(pos>=0){if(pos>=0){end=term.indexOf(')',pos+2);if(end>=0){elName=term.slice(pos+2,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+2)+el.id+term.slice(end);}}
end=term.indexOf(')',pos+2);pos=term.indexOf('Y(',end);}
pos=term.indexOf('L(');while(pos>=0){if(pos>=0){end=term.indexOf(')',pos+2);if(end>=0){elName=term.slice(pos+2,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+2)+el.id+term.slice(end);}}
end=term.indexOf(')',pos+2);pos=term.indexOf('L(',end);}
pos=term.indexOf('Dist(');while(pos>=0){if(pos>=0){end=term.indexOf(',',pos+5);if(end>=0){elName=term.slice(pos+5,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+5)+el.id+term.slice(end);}}
end=term.indexOf(',',pos+5);pos=term.indexOf(',',end);end=term.indexOf(')',pos+1);if(end>=0){elName=term.slice(pos+1,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+1)+el.id+term.slice(end);}
end=term.indexOf(')',pos+1);pos=term.indexOf('Dist(',end);}
pos=term.indexOf('Deg(');while(pos>=0){if(pos>=0){end=term.indexOf(',',pos+4);if(end>=0){elName=term.slice(pos+4,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+4)+el.id+term.slice(end);}}
end=term.indexOf(',',pos+4);pos=term.indexOf(',',end);end=term.indexOf(',',pos+1);if(end>=0){elName=term.slice(pos+1,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+1)+el.id+term.slice(end);}
end=term.indexOf(',',pos+1);pos=term.indexOf(',',end);end=term.indexOf(')',pos+1);if(end>=0){elName=term.slice(pos+1,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+1)+el.id+term.slice(end);}
end=term.indexOf(')',pos+1);pos=term.indexOf('Deg(',end);}
pos=term.indexOf('Rad(');while(pos>=0){if(pos>=0){end=term.indexOf(',',pos+4);if(end>=0){elName=term.slice(pos+4,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+4)+el.id+term.slice(end);}}
end=term.indexOf(',',pos+4);pos=term.indexOf(',',end);end=term.indexOf(',',pos+1);if(end>=0){elName=term.slice(pos+1,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+1)+el.id+term.slice(end);}
end=term.indexOf(',',pos+1);pos=term.indexOf(',',end);end=term.indexOf(')',pos+1);if(end>=0){elName=term.slice(pos+1,end);elName=elName.replace(/\\(['"])?/g,"$1");el=this.board.elementsByName[elName];term=term.slice(0,pos+1)+el.id+term.slice(end);}
end=term.indexOf(')',pos+1);pos=term.indexOf('Rad(',end);}
return term;};JXG.Algebra.prototype.replaceIdByObj=function(term){expr=/(X|Y|L)\(([\w_]+)\)/g;term=term.replace(expr,"this.board.objects[\"$2\"].$1()");expr=/(Dist)\(([\w_]+),([\w_]+)\)/g;term=term.replace(expr,'this.board.objects[\"$2\"].Dist(this.board.objects[\"$3\"])');expr=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g;term=term.replace(expr,'this.board.algebra.trueAngle(this.board.objects[\"$2\"],this.board.objects[\"$3\"],this.board.objects[\"$4\"])');expr=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g;term=term.replace(expr,'this.board.algebra.rad(this.board.objects[\"$1\"],this.board.objects[\"$2\"],this.board.objects[\"$3\"])');return term;};JXG.Algebra.prototype.geonext2JS=function(term){term=term.replace(/&lt;/g,'<');term=term.replace(/&gt;/g,'>');term=term.replace(/&amp;/g,'&');var elements=this.board.elementsByName;var expr;var newterm=term;newterm=this.replaceNameById(newterm);newterm=this.replaceIf(newterm);newterm=this.replacePow(newterm);newterm=this.replaceIdByObj(newterm);var from=['Abs','ACos','ASin','ATan','Ceil','Cos','Exp','Floor','Log','Max','Min','Pow','Random','Round','Sin','Sqrt','Tan','Trunc'];var to=['Math.abs','Math.acos','Math.asin','Math.atan','Math.ceil','Math.cos','Math.exp','Math.floor','Math.log','Math.max','Math.min','Math.pow','Math.random','this.board.algebra.round','Math.sin','Math.sqrt','Math.tan','Math.ceil'];for(var i=0;i<from.length;i++){expr=new RegExp(from[i],"g");newterm=newterm.replace(expr,to[i]);}
newterm=newterm.replace(/True/g,'true');newterm=newterm.replace(/False/g,'false');newterm=newterm.replace(/fasle/g,'false');newterm=newterm.replace(/Pi/g,'Math.PI');return newterm;};JXG.Algebra.prototype.findDependencies=function(me,term){var el;var expr;var elements=this.board.elementsByName;for(el in elements){if(el!=me.name){var elmask=el.replace(/\[/g,'\\[');elmask=elmask.replace(/\]/g,'\\]');expr=new RegExp("\\(\(\[\\w\\[\\]'_ \]+,\)*\("+elmask+"\)\(,\[\\w\\[\\]'_ \]+\)*\\)","g");if(term.search(expr)>=0){elements[el].addChild(me);}}}};JXG.Algebra.prototype.distance=function(array1,array2){var sum=0;if(array1.length!=array2.length){return;}
for(var i=0;i<array1.length;i++){sum+=(array1[i]-array2[i])*(array1[i]-array2[i]);}
return Math.sqrt(sum);};JXG.Algebra.prototype.affineDistance=function(array1,array2){var eps=0.000001;if(array1.length!=array2.length){return;}
var d=this.distance(array1,array2);if(d>eps&&(Math.abs(array1[0])<eps||Math.abs(array2[0])<eps)){return Infinity;}else{return d;}};JXG.Algebra.prototype.rad=function(A,B,C){var phi=this.trueAngle(A,B,C);return phi*Math.PI/180.0;};JXG.Algebra.prototype.matVecMult=function(mat1,vec){var m=mat1.length;var n=vec.length;var res=[];for(var i=0;i<m;i++){var s=0;for(var k=0;k<n;k++){s+=mat1[i][k]*vec[k];}
res[i]=s;}
return res;};JXG.Algebra.prototype.matMatMult=function(mat1,mat2){var m=mat1.length;var n=mat2[0].length;var m2=mat2.length;var res=[];for(var i=0;i<mat1.length;i++){res[i]=[];}
for(i=0;i<m;i++){for(var j=0;j<n;j++){var s=0;for(var k=0;k<m2;k++){s+=mat1[i][k]*mat2[k][j];}
res[i][j]=s;}}
return res;};JXG.Algebra.prototype.str2Bool=function(s){if(s==undefined||s==null){return true;}
if(typeof s=='boolean'){return s;}
if(s.toLowerCase()!='true'){return false;}else{return true;}};JXG.Algebra.prototype.pow=function(a,b){if(a==null||b==null){return 1;}
if(Math.floor(b)==b){return Math.pow(a,b);}else{if(a>0){return Math.exp(b*Math.log(Math.abs(a)));}else{return null;}}};JXG.Algebra.prototype.round=function(a,n){if(typeof a=='string')return a;if(n==0||n==null){return Math.round(a).toString();}
if(n<1||n>14){return false;}
var e=Math.pow(10,n);var k=(Math.round(a*e)/e).toString();if(k.indexOf('.')==-1){k+='.';}
k+=e.toString().substring(1);return k.substring(0,k.indexOf('.')+n+1);};JXG.Algebra.prototype.D=function(f){var h=0.00001;return function(x){return(f(x+h)-f(x-h))/(2.0*h);};};JXG.Algebra.prototype.cosh=function(x){return(Math.exp(x)+Math.exp(-x))*0.5;};JXG.Algebra.prototype.sinh=function(x){return(Math.exp(x)-Math.exp(-x))*0.5;};JXG.Algebra.prototype.I=function(interval,f){return JXG.Math.Numerics.NewtonCotes(interval,f);};JXG.Algebra.prototype.newton=function(f,x){var i=0;var h=0.0000001;var newf=f(x);while(i<50&&Math.abs(newf)>h){var df=this.D(f)(x);if(Math.abs(df)>h){x-=newf/df;}else{x+=(Math.random()*0.2-1.0);}
newf=f(x);i++;}
return x;};JXG.Algebra.prototype.root=function(f,x){return this.newton(f,x);};JXG.Algebra.prototype.crossProduct=function(c1,c2){var x=c1[1]*c2[2]-c1[2]*c2[1];var y=c1[2]*c2[0]-c1[0]*c2[2];var z=c1[0]*c2[1]-c1[1]*c2[0];return[x,y,z];};JXG.Algebra.prototype.meet=function(el1,el2){var eps=0.000001;if(Math.abs(el1[3])<eps&&Math.abs(el2[3])<eps){return this.meetLineLine(el1,el2);}else if(Math.abs(el1[3])>=eps&&Math.abs(el2[3])<eps){return this.meetLineCircle(el2,el1);}else if(Math.abs(el1[3])<eps&&Math.abs(el2[3])>=eps){return this.meetLineCircle(el1,el2);}else{return this.meetCircleCircle(el1,el2);}};JXG.Algebra.prototype.meetLineLine=function(l1,l2){var s=this.crossProduct(l1,l2);if(Math.abs(s[0])>0.000001){s[1]/=s[0];s[2]/=s[0];}
return[new JXG.Coords(JXG.COORDS_BY_USER,s.slice(1),this.board),new JXG.Coords(JXG.COORDS_BY_USER,s.slice(1),this.board)];};JXG.Algebra.prototype.meetLineCircle=function(lin,circ){var eps=0.000001;if(circ[4]<eps){return[new JXG.Coords(JXG.COORDS_BY_USER,circ.slice(1,3),this.board),new JXG.Coords(JXG.COORDS_BY_USER,circ.slice(1,3),this.board)];}
var c=circ[0];var b=circ.slice(1,3);var a=circ[3];var d=lin[0];var n=lin.slice(1,3);var A=a;var B=(b[0]*n[1]-b[1]*n[0]);var C=a*d*d-(b[0]*n[0]+b[1]*n[1])*d+c;var k=B*B-4*A*C;if(k>=0){k=Math.sqrt(k);var t=[(-B+k)/(2*A),(-B-k)/(2*A)];return[new JXG.Coords(JXG.COORDS_BY_USER,[-t[0]*(-n[1])-d*n[0],-t[0]*n[0]-d*n[1]],this.board),new JXG.Coords(JXG.COORDS_BY_USER,[-t[1]*(-n[1])-d*n[0],-t[1]*n[0]-d*n[1]],this.board)];}else{return[new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board),new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)];}};JXG.Algebra.prototype.meetCircleCircle=function(circ1,circ2){var eps=0.000001;if(circ1[4]<eps){if(this.distance(circ1.slice(1,3),circ2.slice(1,3))==circ2[4]){return[new JXG.Coords(JXG.COORDS_BY_USER,circ1.slice(1,3),this.board),new JXG.Coords(JXG.COORDS_BY_USER,circ1.slice(1,3),this.board)];}else{return[new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board),new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)];}}
if(circ2[4]<eps){if(this.distance(circ2.slice(1,3),circ1.slice(1,3))==circ1[4]){return[new JXG.Coords(JXG.COORDS_BY_USER,circ2.slice(1,3),this.board),new JXG.Coords(JXG.COORDS_BY_USER,circ2.slice(1,3),this.board)];}else{return[new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board),new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)];}}
var radicalAxis=[circ2[3]*circ1[0]-circ1[3]*circ2[0],circ2[3]*circ1[1]-circ1[3]*circ2[1],circ2[3]*circ1[2]-circ1[3]*circ2[2],0,1,Infinity,Infinity,Infinity];radicalAxis=this.normalize(radicalAxis);return this.meetLineCircle(radicalAxis,circ1);};JXG.Algebra.prototype.normalize=function(stdform){var a2=2*stdform[3];var r=stdform[4]/(a2);stdform[5]=r;stdform[6]=-stdform[1]/a2;stdform[7]=-stdform[2]/a2;if(r==Infinity||isNaN(r)){var n=Math.sqrt(stdform[1]*stdform[1]+stdform[2]*stdform[2]);stdform[0]/=n;stdform[1]/=n;stdform[2]/=n;stdform[3]=0;stdform[4]=1;}else if(Math.abs(r)>=1){stdform[0]=(stdform[6]*stdform[6]+stdform[7]*stdform[7]-r*r)/(2*r);stdform[1]=-stdform[6]/r;stdform[2]=-stdform[7]/r;stdform[3]=1/(2*r);stdform[4]=1;}else{var signr=(r<=0)?(-1):(1);stdform[0]=signr*(stdform[6]*stdform[6]+stdform[7]*stdform[7]-r*r)*0.5;stdform[1]=-signr*stdform[6];stdform[2]=-signr*stdform[7];stdform[3]=signr/2;stdform[4]=signr*r;}
return stdform;};JXG.Intersection=function(Board,Id,Intersect1,Intersect2,InterId1,InterId2,InterName1,InterName2){this.constructor();this.board=Board;this.id=Id;this.name=this.id;this.visProp={};this.visProp['visible']=true;this.show=true;this.real=true;this.notExistingParents={};this.intersect1=JXG.GetReferenceFromParameter(this.board,Intersect1);this.intersect2=JXG.GetReferenceFromParameter(this.board,Intersect2);this.type=JXG.OBJECT_TYPE_INTERSECTION;if(((this.intersect1=='')||(this.intersect1==undefined))&&((this.intersect2=='')||(this.intersect2==undefined))){return;}
if(((this.intersect1.type==this.intersect2.type)&&(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect1.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect2.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect2.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect1.type==JXG.OBJECT_TYPE_ARROW))){var coords=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2).usrCoords.slice(1);this.p=new JXG.Point(this.board,coords,InterId1,InterName1,true);this.p.fixed=true;this.addChild(this.p);this.real=true;this.update=function(){if(this.needsUpdate){this.p.coords=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2);this.needsUpdate=false;}}
this.hideElement=function(){this.visProp['visible']=false;this.p.hideElement();}
this.showElement=function(){this.visProp['visible']=true;this.p.showElement();}
this.hideChild=function(id){this.notExistingParents[id]=this.board.objects[id];for(var el in this.descendants){if(this.descendants[el].visProp['visible']&&this.descendants[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.descendants[el].hideElement();this.descendants[el].visProp['visible']=true;}
this.descendants[el].notExistingParents[id]=this.board.objects[id];}}
this.showChild=function(id){for(el in this.board.objects){delete(this.board.objects[el].notExistingParents[id]);if(this.board.objects[el].visProp['visible']&&Object.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement();}}}}}
else if(((Intersect1.type==Intersect2.type)&&(Intersect1.type==JXG.OBJECT_TYPE_CIRCLE||Intersect1.type==JXG.OBJECT_TYPE_ARC))||(Intersect1.type==JXG.OBJECT_TYPE_CIRCLE&&Intersect2.type==JXG.OBJECT_TYPE_ARC)||(Intersect2.type==JXG.OBJECT_TYPE_CIRCLE&&Intersect1.type==JXG.OBJECT_TYPE_ARC)){this.p1=new JXG.Point(this.board,[0,0],InterId1,InterName1,false);this.p1.fixed=true;this.p1.label.show=true;this.p2=new JXG.Point(this.board,[0,0],InterId2,InterName2,false);this.p2.fixed=true;this.p2.label.show=true;this.addChild(this.p1);this.addChild(this.p2);var coordinates=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);if(coordinates[0]==1){this.p1.coords=coordinates[1];this.p1.showElement();this.p1.updateRenderer();this.p2.coords=coordinates[2];this.p2.showElement();this.p2.updateRenderer();this.real=true;}
else{this.real=false;}
this.update=function(){if(!this.needsUpdate){return;}
var coordinates=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);var p1show=this.p1.visProp['visible'];var p2show=this.p2.visProp['visible'];if(coordinates[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp['visible']=p1show;this.p2.visProp['visible']=p2show;this.real=false;}}else{this.p1.coords=coordinates[1];this.p2.coords=coordinates[2];if(!this.real){this.showChild(this.id);this.real=true;}}
this.needsUpdate=false;}
this.hideElement=function(){this.visProp['visible']=false;this.p1.hideElement();this.p2.hideElement();}
this.showElement=function(){this.visProp['visible']=true;this.p1.showElement();this.p2.showElement();}
this.hideChild=function(id){this.notExistingParents[id]=this.board.objects[id];for(var el in this.descendants){if(this.descendants[el].visProp['visible']&&this.descendants[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.descendants[el].hideElement();this.descendants[el].visProp['visible']=true;}
this.descendants[el].notExistingParents[id]=this.board.objects[id];}}
this.showChild=function(id){for(el in this.board.objects){delete(this.board.objects[el].notExistingParents[id]);if(this.board.objects[el].visProp['visible']&&Object.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement();}}}}}
else{this.p1=new JXG.Point(this.board,[0,0],InterId1,InterName1,false);this.p1.fixed=true;this.p1.label.show=true;this.p2=new JXG.Point(this.board,[0,0],InterId2,InterName2,false);this.p2.fixed=true;this.p2.label.show=true;this.addChild(this.p1);this.addChild(this.p2);if(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW){var swap=this.intersect1;this.intersect1=this.intersect2;this.intersect2=swap;}
var coordinates=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);if(coordinates[0]==1){this.p1.coords=coordinates[1];this.p1.showElement();this.p1.update();}
else if(coordinates[0]==2){this.p1.coords=coordinates[1];this.p1.showElement();this.p2.coords=coordinates[2];this.p2.showElement();this.p1.updateRenderer();this.p2.updateRenderer();this.real=true;}
else{this.real=false;}
this.update=function(){if(!this.needsUpdate){return;}
var coordinates=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);var show1=this.p1.visProp['visible'];var show2=this.p2.visProp['visible'];if(coordinates[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp['visible']=show1;this.p2.visProp['visible']=show2;this.real=false;}}else if(coordinates[0]==2){this.p1.coords=coordinates[1];this.p2.coords=coordinates[2];if(!this.real){this.showChild(this.id);this.real=true;}}
this.needsUpdate=false;}
this.hideElement=function(){this.visProp['visible']=false;this.p1.hideElement();this.p2.hideElement();}
this.showElement=function(){this.visProp['visible']=true;this.p1.showElement();this.p2.showElement();}
this.hideChild=function(id){this.notExistingParents[id]=this.board.objects[id];for(var el in this.descendants){if(this.descendants[el].visProp['visible']&&this.descendants[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.descendants[el].hideElement();this.descendants[el].visProp['visible']=true;}
this.descendants[el].notExistingParents[id]=this.board.objects[id];}}
this.showChild=function(id){for(el in this.board.objects){delete(this.board.objects[el].notExistingParents[id]);if(this.board.objects[el].visProp['visible']&&Object.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement();}}}}}
this.id=this.board.addIntersection(this);};JXG.Intersection.prototype=new JXG.GeometryElement();JXG.Intersection.prototype.update=function(){return;};JXG.Intersection.prototype.hasPoint=function(x,y){return false;};JXG.Intersection.prototype.hideChild=function(id){};JXG.Intersection.prototype.showChild=function(id){};JXG.Intersection.prototype.remove=function(){if(this.p!=undefined)
this.board.removeObject(this.p);if(this.p1!=undefined)
this.board.removeObject(this.p1);if(this.p2!=undefined)
this.board.removeObject(this.p2);return;};JXG.Intersection.prototype.updateRenderer=function(){};JXG.createPerpendicular=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_LINE){if(!JXG.IsArray(atts['id'])){atts['id']=['',''];}
if(!JXG.IsArray(atts['name'])){atts['name']=['',''];}
return board.addPerpendicular(parentArr[1],parentArr[0],atts['id'][0],atts['name'][0],atts['id'][1],atts['name'][1]);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){if(!JXG.IsArray(atts['id'])){atts['id']=['',''];}
if(!JXG.IsArray(atts['name'])){atts['name']=['',''];}
return board.addPerpendicular(parentArr[0],parentArr[1],atts['id'][0],atts['name'][0],atts['id'][1],atts['name'][1]);}
else{throw("Can't create perpendicular with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createMidpoint=function(board,parentArr,atts){if(parentArr.length==2&&JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])){return board.addMidpoint(parentArr[0],parentArr[1],atts['id'],atts['name']);}
else if(parentArr.length==1&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){return board.addMidpoint(parentArr[0].point1,parentArr[0].point2,atts['id'],atts['name']);}
else{throw("Can't create midpoint.");}};JXG.createParallel=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_LINE){return board.addParallel(parentArr[1],parentArr[0],atts['id'],atts['name']);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){return board.addParallel(parentArr[0],parentArr[1],atts['id'],atts['name']);}
else{throw("Can't create parallel with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createNormal=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_LINE){return board.addNormal(parentArr[1],parentArr[0],atts['id'],atts['name']);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){return board.addNormal(parentArr[0],parentArr[1],atts['id'],atts['name']);}
else{throw("Can't create normal with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createBisector=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])&&JXG.IsPoint(parentArr[2])){return board.addAngleBisector(parentArr[0],parentArr[1],parentArr[2],atts['id'],atts['name']);}
else{throw("Can't create angle bisector with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createArrowParallel=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_ARROW){if(!JXG.IsArray(atts['id'])){atts['id']=['',''];}
if(!JXG.IsArray(atts['name'])){atts['name']=['',''];}
return board.addArrowParallel(parentArr[1],parentArr[0],atts['id'][0],atts['name'][0],atts['id'][1],atts['name'][1]);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_ARROW){if(!JXG.IsArray(atts['id'])){atts['id']=['',''];}
if(!JXG.IsArray(atts['name'])){atts['name']=['',''];}
return board.addArrowParallel(parentArr[0],parentArr[1],atts['id'][0],atts['name'][0],atts['id'][1],atts['name'][1]);}
else{throw("Can't create parallel arrow with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createCircumcircle=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])&&JXG.IsPoint(parentArr[2])){if(!JXG.IsArray(atts['id'])){atts['id']=['',''];}
if(!JXG.IsArray(atts['name'])){atts['name']=['',''];}
return board.addCircumcenter(parentArr[0],parentArr[1],parentArr[2],atts['id'][0],atts['name'][0],atts['id'][1],atts['name'][1]);}
else{throw("Can't create circumcircle with parent types '"+(typeof parentArr[0])+"', '"+(typeof parentArr[1])+"' and '"+(typeof parentArr[2])+"'.");}};JXG.createCircumcircleMidpoint=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])&&JXG.IsPoint(parentArr[2])){return board.addCircumcenterMidpoint(parentArr[0],parentArr[1],parentArr[2],atts['id'],atts['name']);}
else{throw("Can't create circumcircle midpoint with parent types '"+(typeof parentArr[0])+"', '"+(typeof parentArr[1])+"' and '"+(typeof parentArr[2])+"'.");}};JXG.createParallelPoint=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])&&JXG.IsPoint(parentArr[2])){return board.addParallelPoint(parentArr[0],parentArr[1],parentArr[2],atts['id'],atts['name']);}
else{throw("Can't create parallel point with parent types '"+(typeof parentArr[0])+"', '"+(typeof parentArr[1])+"' and '"+(typeof parentArr[2])+"'.");}};JXG.createReflection=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_LINE){return board.addReflection(parentArr[1],parentArr[0],atts['id'],atts['name']);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){return board.addReflection(parentArr[0],parentArr[1],atts['id'],atts['name']);}
else{throw("Can't create reflection point with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createPerpendicularPoint=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_LINE){return board.addPerpendicularPoint(parentArr[1],parentArr[0],atts['id'],atts['name']);}
else if(JXG.IsPoint(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_LINE){return board.addPerpendicularPoint(parentArr[0],parentArr[1],atts['id'],atts['name']);}
else{throw("Can't create perpendicular point with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createMirrorPoint=function(board,parentArr,atts){if(JXG.IsPoint(parentArr[0])&&JXG.IsPoint(parentArr[1])){return board.addRotation(parentArr[0],parentArr[1],Math.PI,atts['id'],atts['name']);}
else{throw("Can't create mirror point with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.createIntegral=function(board,parentArr,atts){if(!JXG.IsArray(atts['id'])||(atts['id'].length!=5)){atts['id']=['','','','',''];}
if(!JXG.IsArray(atts['name'])||(atts['name'].length!=5)){atts['name']=['','','','',''];}
if(JXG.IsArray(parentArr[0])&&parentArr[1].type==JXG.OBJECT_TYPE_CURVE){return board.addIntegral(parentArr[0],parentArr[1],atts['id'],atts['name'],atts);}else if(JXG.IsArray(parentArr[1])&&parentArr[0].type==JXG.OBJECT_TYPE_CURVE){return board.addIntegral(parentArr[1],parentArr[0],atts['id'],atts['name'],atts);}else{throw("Can't create integral with parent types '"+(typeof parentArr[0])+"' and '"+(typeof parentArr[1])+"'.");}};JXG.JSXGraph.registerElement('arrowparallel',JXG.createArrowParallel);JXG.JSXGraph.registerElement('bisector',JXG.createBisector);JXG.JSXGraph.registerElement('circumcircle',JXG.createCircumcircle);JXG.JSXGraph.registerElement('circumcirclemidpoint',JXG.createCircumcircleMidpoint);JXG.JSXGraph.registerElement('integral',JXG.createIntegral);JXG.JSXGraph.registerElement('midpoint',JXG.createMidpoint);JXG.JSXGraph.registerElement('mirrorpoint',JXG.createMirrorPoint);JXG.JSXGraph.registerElement('normal',JXG.createNormal);JXG.JSXGraph.registerElement('parallel',JXG.createParallel);JXG.JSXGraph.registerElement('parallelpoint',JXG.createParallelPoint);JXG.JSXGraph.registerElement('perpendicular',JXG.createPerpendicular);JXG.JSXGraph.registerElement('perpendicularpoint',JXG.createPerpendicularPoint);JXG.JSXGraph.registerElement('reflection',JXG.createReflection);JXG.Text=function(board,contentStr,element,coords,id,name,digits){this.constructor();this.type=JXG.OBJECT_TYPE_TEXT;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.init(board,id,name);this.contentStr=contentStr;this.plaintextStr='';this.visProp['strokeColor']=this.board.options.text.strokeColor;this.visProp['visible']=true;if(digits!=null){this.digits=digits;}else{this.digits=2;}
if((this.element=this.board.objects[element])){var anchor=this.element.getTextAnchor();this.element.addChild(this);this.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[parseFloat(coords[0]),parseFloat(coords[1])],this.board);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+anchor.usrCoords[1],this.relativeCoords.usrCoords[2]+anchor.usrCoords[2]],this.board);}else{var xterm=coords[0];if(typeof xterm=='string'){var newxterm=this.board.algebra.geonext2JS(xterm);this.X=new Function('','return '+newxterm+';');}else if(typeof xterm=='function'){this.X=xterm;}else if(typeof xterm=='number'){this.X=function(){return xterm;};}
var yterm=coords[1];if(typeof yterm=='string'){var newyterm=this.board.algebra.geonext2JS(yterm);this.Y=new Function('','return '+newyterm+';');}else if(typeof yterm=='function'){this.Y=yterm;}else if(typeof yterm=='number'){this.Y=function(){return yterm;};}
this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board);var fs='this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()]);';this.updateCoords=new Function('',fs);}
if(typeof this.contentStr=='function'){this.updateText=function(){this.plaintextStr=this.contentStr();};}else{var plaintext;if(typeof this.contentStr=='number'){plaintext=this.board.round(this.contentStr,this.digits);}else{plaintext=this.generateTerm(this.contentStr);}
this.updateText=new Function('this.plaintextStr = '+plaintext+';');}
this.updateText();this.id=this.board.addText(this);this.notifyParents(this.contentStr);};JXG.Text.prototype=new JXG.GeometryElement();JXG.Text.prototype.hasPoint=function(x,y){return false;};JXG.Text.prototype.update=function(){if(this.needsUpdate){if(this.relativeCoords){var anchor=this.element.getTextAnchor();this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+anchor.usrCoords[1],this.relativeCoords.usrCoords[2]+anchor.usrCoords[2]]);}else{this.updateCoords();}
this.updateText();}};JXG.Text.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateText(this);this.needsUpdate=false;}};JXG.Text.prototype.generateTerm=function(contentStr){var res=null;var elements=this.board.elementsByName;var plaintext='""';contentStr=contentStr.replace(/\"/g,'\\"');contentStr=contentStr.replace(/\'/g,"\\'");contentStr=contentStr.replace(/&amp;arc;/g,'&ang;');contentStr=contentStr.replace(/<arc\s*\/>/g,'&ang;');contentStr=contentStr.replace(/<sqrt\s*\/>/g,'&radic;');var i;i=contentStr.indexOf('<value>');var j=contentStr.indexOf('</value>');if(i>=0){while(i>=0){plaintext+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(contentStr.slice(0,i)))+'"';var term=contentStr.slice(i+7,j);var res=this.board.algebra.geonext2JS(term);res=res.replace(/\\"/g,'"');res=res.replace(/\\'/g,"'");if(res.indexOf('this.board.algebra.round')<0){plaintext+='+(this.board.algebra.round('+res+','+(this.digits)+'))';}else{plaintext+='+('+res+')';}
contentStr=contentStr.slice(j+8);i=contentStr.indexOf('<value>');j=contentStr.indexOf('</value>');}}
plaintext+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(contentStr))+'"';plaintext=plaintext.replace(/<overline>/g,'<span style=text-decoration:overline>');plaintext=plaintext.replace(/<\/overline>/g,'</span>');plaintext=plaintext.replace(/<arrow>/g,'<span style=text-decoration:overline>');plaintext=plaintext.replace(/<\/arrow>/g,'</span>');plaintext=plaintext.replace(/&amp;/g,'&');return plaintext;};JXG.Text.prototype.notifyParents=function(contentStr){var res=null;var elements=this.board.elementsByName;do{var search=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;res=search.exec(contentStr);if(res!=null){this.board.algebra.findDependencies(this,res[1]);contentStr=contentStr.substr(res.index);contentStr=contentStr.replace(search,'');}}while(res!=null);};JXG.createText=function(board,parentArr,atts){return new JXG.Text(board,parentArr[parentArr.length-1],null,parentArr,atts['id'],atts['name'],atts['digits']);};JXG.JSXGraph.registerElement('text',JXG.createText);JXG.Image=function(board,imageBase64String,coordinates,size,displayLevel,id,name,el){this.type=JXG.OBJECT_TYPE_IMAGE;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.transformations=[];this.init(board,id,name);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,coordinates,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,coordinates,this.board);this.size=[size[0]*board.zoomX*board.unitX,size[1]*board.zoomY*board.unitY];this.imageBase64String=imageBase64String;this.displayLevel=displayLevel;this.parent=el;this.visProp['visible']=true;this.id=this.board.addImage(this);};JXG.Image.prototype=new JXG.GeometryElement;JXG.Image.prototype.hasPoint=function(x,y){return false;};JXG.Image.prototype.updateRenderer=function(){this.updateTransform();this.board.renderer.updateImage(this);};JXG.Image.prototype.updateTransform=function(){if(this.transformations.length==0){return;}
for(var i=0;i<this.transformations.length;i++){this.transformations[i].update();}};JXG.Image.prototype.addTransform=function(transform){if(JXG.IsArray(transform)){for(var i=0;i<transform.length;i++){this.transformations.push(transform[i]);}}else{this.transformations.push(transform);}};JXG.createImage=function(board,parentArr,atts){return new JXG.Image(board,atts['imageString'],parentArr[0],parentArr[1],'images',false,false,undefined);};JXG.JSXGraph.registerElement('image',JXG.createImage);JXG.createSlider=function(board,parentArr,atts){var sx=parentArr[0];var sy=parentArr[1];var sw=parentArr[2];var smin=parentArr[3];var smax=parentArr[4];var start=(parentArr[5]-smin)*sw/(smax-smin);var p1=board.createElement('point',[sx,sy],{visible:false,fixed:true,name:''});var p2=board.createElement('point',[sx+sw,sy],{visible:false,fixed:true,name:''});var l1=board.createElement('line',[p1,p2],{straightFirst:false,straightLast:false,strokewidth:1,name:''});var ticks=10;for(i=0;i<ticks+1;i++){var t1=board.createElement('point',[sx+i*sw/ticks,sy-0.25+i%2*0.1],{visible:false,fixed:true,name:''});var t2=board.createElement('point',[sx+i*sw/ticks,sy+0.25-i%2*0.1],{visible:false,fixed:true,name:''});var tt=board.createElement('line',[t1,t2],{straightFirst:false,straightLast:false,strokewidth:2-i%2,name:''});}
var p3=board.createElement('point',[sx+start,sy],{slideObject:l1,style:6,strokeColor:'#0080c0',fillColor:'#0080c0',name:''});var p4=board.createElement('point',[function(){return((p3.X()-sx)/sw*(smax-smin)+smin);},function(){return(sy+1);}],{visible:false,name:''});var l2=board.createElement('line',[p1,p3],{straightFirst:false,straightLast:false,strokewidth:3,strokeColor:'#0080c0',name:''});var t=board.createElement('text',[sx+sw+0.25,sy,function(){return board.round(p4.X(),2);}],{name:''});return p4;};JXG.JSXGraph.registerElement('slider',JXG.createSlider);JXG.Math=new Object();JXG.Math.eps=0.000001;JXG.Math.Vector=function(elements){this.length=0;if((typeof elements!=undefined)&&(elements!=null)){for(var i=0;i<elements.length;i++){this.push(elements[i]);}}};JXG.Math.Vector.prototype=new Array();JXG.Math.Vector.prototype.n=function(){return this.length;};JXG.Math.Vector.prototype.exchange=function(i,j){var temp=this[i];this[i]=this[j];this[j]=temp;};JXG.Math.Matrix=function(elements){this.length=0;var oldLength=0;var testLength=false;if((typeof elements!=undefined)&&(elements!=null)){for(var i=0;i<elements.length;i++){this.push(new Array());if(testLength){if(oldLength!=elements[i].length){this.length=0;throw new JXG.DimensionMismatchException("Your array contains arrays with different lengths.");}}
for(var j=0;j<elements[i].length;j++){this[i].push(elements[i][j]);}
oldLength=elements[i].length;testLength=true;}}};JXG.Math.Matrix.prototype=new Array();JXG.Math.Matrix.prototype.m=function(){return this.length;};JXG.Math.Matrix.prototype.n=function(){if(this.length>0)
return this[0].length;else
return 0;};JXG.Math.Matrix.prototype.exchangeRows=function(i,j){var temp=this[i];this[i]=this[j];this[j]=temp;};JXG.DimensionMismatchException=function(message){if((typeof message!=undefined)&&(message!=null))
this.message=message;else
this.message=null;};JXG.DimensionMismatchException.prototype.what=function(){var default_msg="Matrix has incorrect dimensions";if(this.message!=null)
return default_msg+": "+this.message+".";else
return default_msg+".";};JXG.SingularMatrixException=function(message){if((typeof message!=undefined)&&(message!=null))
this.message=message;else
this.message=null;};JXG.SingularMatrixException.prototype.what=function(){var default_msg="Matrix is singular";if(this.message!=null)
return default_msg+": "+this.message+".";else
return default_msg+".";};JXG.Math.Numerics=new Object();JXG.Math.Numerics.INT_TRAPEZ=0x00001;JXG.Math.Numerics.INT_SIMPSON=0x00002;JXG.Math.Numerics.INT_MILNE=0x00003;JXG.Math.Numerics.number_of_nodes=28;JXG.Math.Numerics.integration_type=JXG.INT_MILNE;JXG.Math.Numerics.backwardSolve=function(R,b){var x=b;for(var i=R.m()-1;i>=0;i--){for(var j=R.n()-1;j>i;j--){x[i]-=R[i][j]*x[j];}
x[i]/=R[i][i];}
return x;};JXG.Math.Numerics.Gauss=function(A,b){var eps=1.e-12;var P=new JXG.Math.Vector();for(var i=0;i<A.n();i++){P.push(i);}
for(var j=0;j<A.n();j++)
{for(var i=A.n()-1;i>j;i--){if(Math.abs(A[i][j])>JXG.Math.eps){if(Math.abs(A[j][j])<JXG.Math.eps){A.exchangeRows(i,j);b.exchange(i,j);P.exchange(i,j);}
else{A[i][j]/=A[j][j];b[i]-=A[i][j]*b[j];for(var k=j+1;k<A.n();k++){A[i][k]-=A[i][j]*A[j][k];}}}
if(Math.abs(A[j][j])<JXG.Math.eps){throw new SingularMatrixException();}}}
var y=JXG.Math.Numerics.backwardSolve(A,b);var x=new JXG.Math.Vector();for(var i=0;i<y.n();i++){x.push(y[P[i]]);}
return x;};JXG.Math.Numerics.QR=function(A,b){};JXG.Math.Numerics.NewtonCotes=function(interval,f){var integral_value=0.0;var step_size=(interval[1]-interval[0])/this.number_of_nodes;switch(this.integration_type){case JXG.INT_TRAPEZ:integral_value=(f(interval[0])+f(interval[1]))*0.5;var evaluation_point=interval[0];for(var i=0;i<this.number_of_nodes-1;i++)
{evaluation_point+=step_size;integral_value+=f(evaluation_point);}
integral_value*=step_size;break;case JXG.INT_SIMPSON:if(this.number_of_nodes%2>0){throw"Error: INT_SIMPSONS requires Algebra.number_of_nodes dividable by 2.";}
var number_of_intervals=this.number_of_nodes/2.0;integral_value=f(interval[0])+f(interval[1]);evaluation_point=interval[0];for(i=0;i<number_of_intervals-1;i++)
{evaluation_point+=2.0*step_size;integral_value+=2.0*f(evaluation_point);}
evaluation_point=interval[0]-step_size;for(i=0;i<number_of_intervals;i++)
{evaluation_point+=2.0*step_size;integral_value+=4.0*f(evaluation_point);}
integral_value*=step_size/3.0;break;default:if(this.number_of_nodes%4>0){throw"Error in INT_MILNE: Algebra.number_of_nodes must be a multiple of 4";}
number_of_intervals=this.number_of_nodes*0.25;integral_value=7.0*(f(interval[0])+f(interval[1]));evaluation_point=interval[0];for(i=0;i<number_of_intervals-1;i++)
{evaluation_point+=4.0*step_size;integral_value+=14.0*f(evaluation_point);}
evaluation_point=interval[0]-3.0*step_size;for(i=0;i<number_of_intervals;i++)
{evaluation_point+=4.0*step_size;integral_value+=32.0*(f(evaluation_point)+f(evaluation_point+2*step_size));}
evaluation_point=interval[0]-2.0*step_size;for(i=0;i<number_of_intervals;i++)
{evaluation_point+=4.0*step_size;integral_value+=12.0*f(evaluation_point);}
integral_value*=2.0*step_size/45.0;}
return integral_value;};JXG.Math.Numerics.splineDef=function(x,y){if(x.length!=y.length)
throw"Error in JXG.Math.Numerics.splineDef: Input vector dimensions do not match.";var n=x.length;var dx=new Array();var delta=new Array();for(var i=0;i<n-1;i++){dx.push(x[i+1]-x[i]);}
for(var i=0;i<n-2;i++){delta.push(6*(y[i+2]-y[i+1])/(dx[i+1])-6*(y[i+1]-y[i])/(dx[i]));}
var diag=new Array();var z=new Array();var l;diag.push(2*(dx[0]+dx[1]));z.push(delta[0]);for(var i=0;i<n-3;i++){l=dx[i+1]/diag[i];diag.push(2*(dx[i+1]+dx[i+2])-l*dx[i+1]);z.push(delta[i+1]-l*z[i]);}
var F=new Array();F[n-3]=z[n-3]/diag[n-3];for(var i=n-4;i>=0;i--){F[i]=(z[i]-(dx[i+1]*F[i+1]))/diag[i];}
for(var i=n-3;i>=0;i--)
F[i+1]=F[i];F[0]=0;F[n-1]=0;return new JXG.Math.Vector(F);};JXG.Math.Numerics.splineEval=function(x0,x,y,F){if(x.length!=y.length)
throw"Error in JXG.Math.Numerics.splineEval: Defining vector dimensions do not match.";var n=x.length;var l=1;var asArray=false;if(JXG.IsArray(x0)){l=x0.length;asArray=true;}else
x0=[x0];var y0=new Array();for(var i=0;i<l;i++){if((x0[i]<x[0])||(x[i]>x[n-1]))
throw"Error in JXG.Math.Numerics.splineEval: Evaluation point outside spline interval.";var j;for(j=1;j<n;j++){if(x0[i]<=x[j])
break;}
j--;var a=y[j];var b=(y[j+1]-y[j])/(x[j+1]-x[j])-(x[j+1]-x[j])/6*(F[j+1]+2*F[j]);var c=F[j]/2;var d=(F[j+1]-F[j])/(6*(x[j+1]-x[j]));var x_=x0[i]-x[j];y0.push(a+b*x_+c*x_*x_+d*x_*x_*x_);}
if(asArray)
return y0;else
return y0[0];};JXG.MathStatistics=function(){};JXG.MathStatistics.prototype.sum=function(arr){var res=0;for(var i=0,len=arr.length;i<len;i++){res+=arr[i];}
return res;};JXG.MathStatistics.prototype.prod=function(arr){var res=1;for(var i=0,len=arr.length;i<len;i++){res*=arr[i];}
return res;};JXG.MathStatistics.prototype.mean=function(arr){if(arr.length>0){return this.sum(arr)/arr.length;}else{return 0.0;}};JXG.MathStatistics.prototype.median=function(arr){if(arr.length>0){var tmp=arr.clone();tmp.sort();var len=tmp.length;if(len%2==1){return tmp[parseInt(len*0.5)];}else{return(tmp[len*0.5-1]+tmp[len*0.5])*0.5;}}else{return 0.0;}};JXG.MathStatistics.prototype.variance=function(arr){if(arr.length>1){var m=this.mean(arr);var res=0;for(var i=0,len=arr.length;i<len;i++){res+=(arr[i]-m)*(arr[i]-m);}
return res/(arr.length-1);}else{return 0.0;}};JXG.MathStatistics.prototype.sd=function(arr){return Math.sqrt(this.variance(arr));};JXG.MathStatistics.prototype.weightedMean=function(arr,w){if(arr.length!=w.length){return;}
if(arr.length>0){var t=this.multiply(arr,w);return this.mean(t);}else{return 0.0;}};JXG.MathStatistics.prototype.max=function(arr){if(arr.length==0){return NaN;}
var res=arr[0];for(var i=1,len=arr.length;i<len;i++){res=(arr[i]>res)?(arr[i]):res;}
return res;};JXG.MathStatistics.prototype.min=function(arr){if(arr.length==0){return NaN;}
var res=arr[0];for(var i=1,len=arr.length;i<len;i++){res=(arr[i]<res)?(arr[i]):res;}
return res;};JXG.MathStatistics.prototype.range=function(arr){return[this.min(arr),this.max(arr)];};JXG.MathStatistics.prototype.diff=function(arr){return arr;}
JXG.MathStatistics.prototype.min=function(arr){if(arr.length==0){return NaN;}
var res=arr[0];for(var i=1,len=arr.length;i<len;i++){res=(arr[i]<res)?(arr[i]):res;}
return res;};JXG.MathStatistics.prototype.abs=function(arr){var res=[];if(typeof Object.isArray(arr1)){for(var i=0,len=arr.length;i<len;i++){res[i]=Math.abs(arr[i]);}}else if(typeof arr=='number'){return Math.abs(arr);}else{res=null;}
return res;};JXG.MathStatistics.prototype.add=function(arr1,arr2){var res=[];if(typeof Object.isArray(arr1)&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]+arr2;}}else if(typeof arr1=='number'&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1+arr2[i];}}else if(typeof Object.isArray(arr1)&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]+arr2[i];}}else if(typeof arr1=='number'&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1+arr2;}}else{res=null;}
return res;};JXG.MathStatistics.prototype.divide=function(arr1,arr2){var res=[];if(typeof Object.isArray(arr1)&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]/arr2;}}else if(typeof arr1=='number'&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1/arr2[i];}}else if(typeof Object.isArray(arr1)&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]/arr2[i];}}else if(typeof arr1=='number'&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1/arr2;}}else{res=null;}
return res;};JXG.MathStatistics.prototype.mod=function(arr1,arr2){var res=[];if(typeof Object.isArray(arr1)&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]%arr2;}}else if(typeof arr1=='number'&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1%arr2[i];}}else if(typeof Object.isArray(arr1)&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]%arr2[i];}}else if(typeof arr1=='number'&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1%arr2;}}else{res=null;}
return res;};JXG.MathStatistics.prototype.multiply=function(arr1,arr2){var res=[];if(typeof Object.isArray(arr1)&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]*arr2;}}else if(typeof arr1=='number'&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1*arr2[i];}}else if(typeof Object.isArray(arr1)&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]*arr2[i];}}else if(typeof arr1=='number'&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1*arr2;}}else{res=null;}
return res;};JXG.MathStatistics.prototype.subtract=function(arr1,arr2){var res=[];if(typeof Object.isArray(arr1)&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]-arr2;}}else if(typeof arr1=='number'&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1-arr2[i];}}else if(typeof Object.isArray(arr1)&&typeof Object.isArray(arr2)){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1[i]-arr2[i];}}else if(typeof arr1=='number'&&typeof arr2=='number'){for(var i=0,len=Math.min(arr1.length,arr2.length);i<len;i++){res[i]=arr1-arr2;}}else{res=null;}
return res;};JXG.Chart=function(board,parents,attributes){this.constructor();if(parents.length==0){return;}
this.elements=[];var id=attributes['id'];var name=attributes['name'];this.init(board,id,name);this.id=this.board.addChart(this);var x,y,i;if(parents.length>0&&(typeof parents[0]=='number')){y=parents;x=[];for(i=0;i<y.length;i++){x[i]=i+1;}}else{if(parents.length==1){y=parents[0];x=[];var len;if(typeof y=='function'){len=y().length;}else{len=y.length;}
for(i=0;i<len;i++){x[i]=i+1;}}
if(parents.length==2){y=parents[1];x=parents[0];}}
if(attributes==undefined)attributes={};var style=attributes['chartStyle']||'line';style=style.replace(/ /g,'');style=style.split(',');var c;for(i=0;i<style.length;i++){switch(style[i]){case'bar':c=this.drawBar(board,[x,y],attributes);break;case'line':c=this.drawLine(board,[x,y],attributes);break;case'spline':c=this.drawSpline(board,[x,y],attributes);break;case'pie':c=this.drawPie(board,[y],attributes);break;case'point':c=this.drawPoints(board,[x,y],attributes);break;};this.elements.push(c);};};JXG.Chart.prototype=new JXG.GeometryElement;JXG.Chart.prototype.drawLine=function(board,parents,attributes){var c=board.createElement('curve',parents,attributes);return c;};JXG.Chart.prototype.drawSpline=function(board,parents,attributes){var x=parents[0];var y=parents[1];var F=JXG.Math.Numerics.splineDef(x,y);var px=new Array();var i=0;var delta=(x[x.length-1]-x[0])/board.canvasWidth*1.0;while(x[0]+i*delta<x[x.length-1]){px[i]=x[0]+i*delta;i++;}
var py=JXG.Math.Numerics.splineEval(px,x,y,F);var c=board.createElement('curve',[px,py],attributes);return c;}
JXG.Chart.prototype.drawBar=function(board,parents,attributes){var i;var pols=[];if(attributes['fillOpacity']==undefined){attributes['fillOpacity']=0.6;}
var x=parents[0];var y=parents[1];var w;if(attributes&&attributes['width']){w=attributes['width'];}else{if(x.length<=1){w=1;}else{w=x[1]-x[0];for(i=1;i<x.length-1;i++){w=(x[i+1]-x[i]<w)?(x[i+1]-x[i]):w;}}
w*=0.8;}
for(i=0;i<x.length;i++){var xp0,xp1,xp2,yp,ypL;if(typeof x[i]=='function'){xp0=function(){return x[i]()-w*0.5;};xp1=function(){return x[i]();};xp2=function(){return x[i]()+w*0.5;};}else{xp0=x[i]-w*0.5;xp1=x[i];xp2=x[i]+w*0.5;}
if(typeof y[i]=='function'){ypL=yp;}else{ypL=y[i]+0.2;}
yp=y[i];var p=[];if(attributes['dir']=='horizontal'){p[0]=board.createElement('point',[0,xp0],{name:'',fixed:true,visible:false});p[1]=board.createElement('point',[yp,xp0],{name:'',fixed:true,visible:false});p[2]=board.createElement('point',[yp,xp2],{name:'',fixed:true,visible:false});p[3]=board.createElement('point',[0,xp2],{name:'',fixed:true,visible:false});if(attributes['labels']&&attributes['labels'][i]){board.createElement('text',[yp,xp2,attributes['labels'][i]],attributes);}}else{p[0]=board.createElement('point',[xp0,0],{name:'',fixed:true,visible:false});p[1]=board.createElement('point',[xp0,yp],{name:'',fixed:true,visible:false});p[2]=board.createElement('point',[xp2,yp],{name:'',fixed:true,visible:false});p[3]=board.createElement('point',[xp2,0],{name:'',fixed:true,visible:false});if(attributes['labels']&&attributes['labels'][i]){board.createElement('text',[xp2,yp,attributes['labels'][i]],attributes);}}
attributes['withLines']=false;pols[i]=board.createElement('polygon',p,attributes);}
return pols;};JXG.Chart.prototype.drawPoints=function(board,parents,attributes){var i;var points=[];attributes['fixed']=true;attributes['name']='';var x=parents[0];var y=parents[1];for(i=0;i<x.length;i++){points[i]=board.createElement('point',[x[i],y[i]],attributes);}
return points;};JXG.Chart.prototype.drawPie=function(board,parents,attributes){var y=parents[0];if(y.length<=0){return;}
if(typeof y[0]=='function'){return;}
var i;var p=[];var line=[];var arc=[];var s=board.mathStatistics.sum(y);var colorArray=attributes['colorArray']||['#B02B2C','#3F4C6B','#C79810','#D15600','#FFFF88','#C3D9FF','#4096EE','#008C00'];var radius=attributes['radius']||4;var myAtts={};myAtts['name']=attributes['name'];myAtts['id']=attributes['id'];myAtts['strokeWidth']=attributes['strokeWidth']||1;myAtts['strokeColor']=attributes['strokeColor']||'none';myAtts['straightFirst']=false;myAtts['straightLast']=false;myAtts['fillColor']=attributes['fillColor']||'#FFFF88';myAtts['fillOpacity']=attributes['fillOpacity']||0.6;myAtts['highlightFillColor']=attributes['highlightFillColor']||'#FF7400';myAtts['highlightStrokeColor']=attributes['highlightStrokeColor']||'#FF7400';var cent=attributes['center']||[0,0];var xc=cent[0];var yc=cent[1];var center=board.createElement('point',[xc,yc],{name:'',fixed:true,visible:false});p[0]=board.createElement('point',[radius+xc,0+yc],{name:'',fixed:true,visible:false});var rad=0.0;for(i=0;i<y.length;i++){rad+=(s!=0)?(2*Math.PI*y[i]/s):0;var xcoord=radius*Math.cos(rad)+xc;var ycoord=radius*Math.sin(rad)+yc;p[i+1]=board.createElement('point',[xcoord,ycoord],{name:'',fixed:true,visible:false});line[i]=board.createElement('line',[center,p[i]],{strokeColor:'#ffffff',straightFirst:false,straightLast:false,strokeWidth:6,strokeOpacity:1.0});myAtts['fillColor']=colorArray[i%colorArray.length];arc[i]=board.createElement('arc',[center,p[i],p[i+1]],myAtts);}
return arc;};JXG.Chart.prototype.updateRenderer=function(){};JXG.Chart.prototype.update=function(){if(this.needsUpdate){this.updateDataArray();}};JXG.Chart.prototype.updateDataArray=function(){};JXG.createChart=function(board,parents,attributes){return new JXG.Chart(board,parents,attributes);};JXG.JSXGraph.registerElement('chart',JXG.createChart);var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+
this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);}
return output;},decode:function(input,utf8){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
if(utf8)
output=Base64._utf8_decode(output);return output;},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;},_utf8_decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}
else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}
else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;},_destrip:function(stripped){stripped.replace(/ /g,"");lines=[];var lineno=stripped.length/76;for(var i=0;i<lineno;i++)
lines[i]=stripped.substr(i*76,76);if(lineno!=stripped.length/76)
lines[lines.length]=stripped.substr(lineno*76,stripped.length-(lineno*76));var destripped="";for(var i=0;i<lines.length;i++)
destripped+=lines[i]+"\n";return destripped;},decodeAsArray:function(input){var dec=this.decode(input);var ar=[];for(i=0;i<dec.length;i++){ar[i]=dec.charCodeAt(i);}
return ar;},decodeGEONExT:function(input){return decodeAsArray(destrip(input),false);}};JXG.Gunzip=function(barray){var output="";var bitReverse=[0x00,0x80,0x40,0xc0,0x20,0xa0,0x60,0xe0,0x10,0x90,0x50,0xd0,0x30,0xb0,0x70,0xf0,0x08,0x88,0x48,0xc8,0x28,0xa8,0x68,0xe8,0x18,0x98,0x58,0xd8,0x38,0xb8,0x78,0xf8,0x04,0x84,0x44,0xc4,0x24,0xa4,0x64,0xe4,0x14,0x94,0x54,0xd4,0x34,0xb4,0x74,0xf4,0x0c,0x8c,0x4c,0xcc,0x2c,0xac,0x6c,0xec,0x1c,0x9c,0x5c,0xdc,0x3c,0xbc,0x7c,0xfc,0x02,0x82,0x42,0xc2,0x22,0xa2,0x62,0xe2,0x12,0x92,0x52,0xd2,0x32,0xb2,0x72,0xf2,0x0a,0x8a,0x4a,0xca,0x2a,0xaa,0x6a,0xea,0x1a,0x9a,0x5a,0xda,0x3a,0xba,0x7a,0xfa,0x06,0x86,0x46,0xc6,0x26,0xa6,0x66,0xe6,0x16,0x96,0x56,0xd6,0x36,0xb6,0x76,0xf6,0x0e,0x8e,0x4e,0xce,0x2e,0xae,0x6e,0xee,0x1e,0x9e,0x5e,0xde,0x3e,0xbe,0x7e,0xfe,0x01,0x81,0x41,0xc1,0x21,0xa1,0x61,0xe1,0x11,0x91,0x51,0xd1,0x31,0xb1,0x71,0xf1,0x09,0x89,0x49,0xc9,0x29,0xa9,0x69,0xe9,0x19,0x99,0x59,0xd9,0x39,0xb9,0x79,0xf9,0x05,0x85,0x45,0xc5,0x25,0xa5,0x65,0xe5,0x15,0x95,0x55,0xd5,0x35,0xb5,0x75,0xf5,0x0d,0x8d,0x4d,0xcd,0x2d,0xad,0x6d,0xed,0x1d,0x9d,0x5d,0xdd,0x3d,0xbd,0x7d,0xfd,0x03,0x83,0x43,0xc3,0x23,0xa3,0x63,0xe3,0x13,0x93,0x53,0xd3,0x33,0xb3,0x73,0xf3,0x0b,0x8b,0x4b,0xcb,0x2b,0xab,0x6b,0xeb,0x1b,0x9b,0x5b,0xdb,0x3b,0xbb,0x7b,0xfb,0x07,0x87,0x47,0xc7,0x27,0xa7,0x67,0xe7,0x17,0x97,0x57,0xd7,0x37,0xb7,0x77,0xf7,0x0f,0x8f,0x4f,0xcf,0x2f,0xaf,0x6f,0xef,0x1f,0x9f,0x5f,0xdf,0x3f,0xbf,0x7f,0xff];var cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99];var cpdist=[0x0001,0x0002,0x0003,0x0004,0x0005,0x0007,0x0009,0x000d,0x0011,0x0019,0x0021,0x0031,0x0041,0x0061,0x0081,0x00c1,0x0101,0x0181,0x0201,0x0301,0x0401,0x0601,0x0801,0x0c01,0x1001,0x1801,0x2001,0x3001,0x4001,0x6001];var cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var bA=barray;var bytepos=0;var bitpos=0;var bb=1;var bits=0;function readByte(){bits+=8;if(bytepos<bA.length)
return bA[++bytepos];else
return-1;};function byteAlign(){bb=1;};function readBit(){bits++;var carry=(bb&1);bb>>=1;if(bb==0){bb=readByte();carry=(bb&1);bb=(bb>>1)|0x80;}
return carry;};function readBits(a){var res=0;var i=a;while(i--){res=(res<<1)|readBit();}
if(a){res=bitReverse[res]>>(8-a);}
return res;};var buf32k=new Array(32768);var bIdx=0;var CRC,SIZE;function flushBuffer(){bIdx=0;};function addBuffer(a){SIZE++;buf32k[bIdx++]=a;output+=String.fromCharCode(a);if(bIdx==0x8000){bIdx=0;}};function HufNode(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1;};var LITERALS=288;var literalTree=new Array(LITERALS);var distanceTree=new Array(32);var treepos=0;var Places=null;var Places2=null;var impDistanceTree=new Array(64);var impLengthTree=new Array(64);var len=0;var fpos=new Array(17);fpos[0]=0;var flens;var fmax;function IsPat(){while(1){if(fpos[len]>=fmax)
return-1;if(flens[fpos[len]]==len)
return fpos[len]++;fpos[len]++;}};function Rec(){var curplace=Places[treepos];var tmp;if(len==17){return-1;}
treepos++;len++;tmp=IsPat();if(tmp>=0){curplace.b0=tmp;}else{curplace.b0=0x8000;if(Rec())
return-1;}
tmp=IsPat();if(tmp>=0){curplace.b1=tmp;curplace.jump=null;}else{curplace.b1=0x8000;curplace.jump=Places[treepos];curplace.jumppos=treepos;if(Rec())
return-1;}
len--;return 0;};function CreateTree(currentTree,numval,lengths,show){var i;Places=currentTree;treepos=0;flens=lengths;fmax=numval;for(i=0;i<17;i++)
fpos[i]=0;len=0;if(Rec()){return-1;}
return 0;};function DecodeValue(currentTree){var xtreepos=0;var X=currentTree[xtreepos];while(1){var b;if(b=readBit()){if(!(X.b1&0x8000)){return X.b1;}
X=X.jump;for(i=0;i<currentTree.length;i++){if(currentTree[i]===X){xtreepos=i;break;}}}else{if(!(X.b0&0x8000)){return X.b0;}
xtreepos++;X=currentTree[xtreepos];}}
return-1;};function DeflateLoop(){var last,c,type,i;do{var last=readBit();var type=readBits(2);switch(type){case 0:break;case 1:break;case 2:break;case 3:break;default:break;}
if(type==0){}else if(type==1){var j;while(1){j=(bitReverse[readBits(7)]>>1);if(j>23){j=(j<<1)|readBit();if(j>199){j-=128;j=(j<<1)|readBit();}else{j-=48;if(j>143){j=j+136;}}}else{j+=256;}
if(j<256){addBuffer(j);}else if(j==256){break;}else{var len,dist;j-=256+1;len=readBits(cplext[j])+cplens[j];j=bitReverse[readBits(5)]>>3;if(cpdext[j]>8){dist=readBits(8);dist|=(readBits(cpdext[j]-8)<<8);}else{dist=readBits(cpdext[j]);}
dist+=cpdist[j];for(j=0;j<len;j++){var c=buf32k[(bIdx-dist)&0x7fff];addBuffer(c);}}}}else if(type==2){var j,n,literalCodes,distCodes,lenCodes;var ll=new Array(288+32);literalCodes=257+readBits(5);distCodes=1+readBits(5);lenCodes=4+readBits(4);for(j=0;j<19;j++){ll[j]=0;}
for(j=0;j<lenCodes;j++){ll[border[j]]=readBits(3);}
for(i=0;i<distanceTree.length;i++)
distanceTree[i]=new HufNode();if(CreateTree(distanceTree,19,ll,0)){flushBuffer();return 1;}
for(a=0;a<distanceTree.length;a++){}
n=literalCodes+distCodes;i=0;z=-1;while(i<n){z++;j=DecodeValue(distanceTree);if(j<16){ll[i++]=j;}else if(j==16){var l;j=3+readBits(2);if(i+j>n){flushBuffer();return 1;}
l=i?ll[i-1]:0;while(j--){ll[i++]=l;}}else{if(j==17){j=3+readBits(3);}else{j=11+readBits(7);}
if(i+j>n){flushBuffer();return 1;}
while(j--){ll[i++]=0;}}}
for(i=0;i<literalTree.length;i++)
literalTree[i]=new HufNode();if(CreateTree(literalTree,literalCodes,ll,0)){flushBuffer();return 1;}
for(i=0;i<distanceTree.length;i++)
distanceTree[i]=new HufNode();ll2=new Array();for(i=literalCodes;i<ll.length;i++){ll2[i-literalCodes]=ll[i];}
if(CreateTree(distanceTree,distCodes,ll2,0)){flushBuffer();return 1;}
while(1){j=DecodeValue(literalTree);if(j>=256){var len,dist;j-=256;if(j==0){break;}
j--;len=readBits(cplext[j])+cplens[j];j=DecodeValue(distanceTree);if(cpdext[j]>8){dist=readBits(8);dist|=(readBits(cpdext[j]-8)<<8);}else{dist=readBits(cpdext[j]);}
dist+=cpdist[j];while(len--){var c=buf32k[(bIdx-dist)&0x7fff];addBuffer(c);}}else{addBuffer(j);}}}}while(!last);flushBuffer();byteAlign();return 0;};JXG.Gunzip.prototype.unzip=function(){readByte(2);DeflateLoop();return(output);};};JXG.Transformation=function(board,type,params){this.elementClass=JXG.OBJECT_CLASS_OTHER;this.matrix=[[1,0,0],[0,1,0],[0,0,1]];this.board=board;this.isNumericMatrix=false;this.setMatrix(board,type,params);};JXG.Transformation.prototype={};JXG.Transformation.prototype.update=function(){};JXG.Transformation.prototype.setMatrix=function(board,type,params){var i;this.isNumericMatrix=true;for(i=0;i<params.length;i++){if(typeof params[i]!='number'){this.isNumericMatrix=false;break;}}
if(type=='translate'){this.evalParam=JXG.createEvalFunction(board,params,2);this.update=function(){this.matrix[1][0]=this.evalParam(0);this.matrix[2][0]=this.evalParam(1);};}else if(type=='scale'){this.evalParam=JXG.createEvalFunction(board,params,2);this.update=function(){this.matrix[1][1]=this.evalParam(0);this.matrix[2][2]=this.evalParam(1);};}else if(type=='reflect'){if(params.length<4){params[0]=JXG.GetReferenceFromParameter(board,params[0]);}
if(params.length==2){params[1]=JXG.GetReferenceFromParameter(board,params[1]);}
if(params.length==4){this.evalParam=JXG.createEvalFunction(board,params,4);}
this.update=function(){if(params.length==1){var x=params[0].point2.X()-params[0].point1.X();var y=params[0].point2.Y()-params[0].point1.Y();var xoff=params[0].point1.X();var yoff=params[0].point1.Y();}else if(params.length==2){var x=params[1].X()-params[0].X();var y=params[1].Y()-params[0].Y();var xoff=params[0].X();var yoff=params[0].Y();}else if(params.length==4){var x=this.evalParam(2)-this.evalParam(0);var y=this.evalParam(3)-this.evalParam(1);var xoff=this.evalParam(0);var yoff=this.evalParam(1);}
var d=x*x+y*y;this.matrix[1][1]=(x*x-y*y)/d;this.matrix[1][2]=2*x*y/d;this.matrix[2][1]=2*x*y/d;this.matrix[2][2]=(-x*x+y*y)/d;this.matrix[1][0]=xoff*(1-this.matrix[1][1])-yoff*this.matrix[1][2];this.matrix[2][0]=yoff*(1-this.matrix[2][2])-xoff*this.matrix[2][1];};}else if(type=='rotate'){if(params.length==3){this.evalParam=JXG.createEvalFunction(board,params,3);}else if(params.length<=2){this.evalParam=JXG.createEvalFunction(board,params,1);if(params.length==2){params[1]=JXG.GetReferenceFromParameter(board,params[1]);}}
this.update=function(){var beta=this.evalParam(0);this.matrix[1][1]=Math.cos(beta);this.matrix[1][2]=-Math.sin(beta);this.matrix[2][1]=Math.sin(beta);this.matrix[2][2]=Math.cos(beta);if(params.length>1){if(params.length==3){var x=this.evalParam(1);var y=this.evalParam(2);}else{var x=params[1].X();var y=params[1].Y();}
this.matrix[1][0]=x*(1-Math.cos(beta))+y*Math.sin(beta);this.matrix[2][0]=y*(1-Math.cos(beta))-x*Math.sin(beta);}};}else if(type=='shear'){this.evalParam=JXG.createEvalFunction(board,params,1);this.update=function(){var beta=this.evalParam(0);this.matrix[1][1]=Math.tan(beta);};}else if(type=='generic'){this.evalParam=JXG.createEvalFunction(board,params,9);this.update=function(){this.matrix[0][0]=this.evalParam(0);this.matrix[0][1]=this.evalParam(1);this.matrix[0][2]=this.evalParam(2);this.matrix[1][0]=this.evalParam(3);this.matrix[1][1]=this.evalParam(4);this.matrix[1][2]=this.evalParam(5);this.matrix[2][0]=this.evalParam(6);this.matrix[2][1]=this.evalParam(7);this.matrix[2][2]=this.evalParam(8);};}};JXG.Transformation.prototype.apply=function(p){this.update();if(arguments[1]!=null){return this.matVecMult(this.matrix,p.initialCoords.usrCoords);}else{return this.matVecMult(this.matrix,p.coords.usrCoords);}};JXG.Transformation.prototype.applyOnce=function(p){if(!JXG.IsArray(p)){this.update();var c=this.matVecMult(this.matrix,p.coords.usrCoords);p.coords.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);}else{for(var i=0;i<p.length;i++){this.update();var c=this.matVecMult(this.matrix,p[i].coords.usrCoords);p[i].coords.setCoordinates(JXG.COORDS_BY_USER,[c[1],c[2]]);}}};JXG.Transformation.prototype.bindTo=function(p){if(JXG.IsArray(p)){for(var i=0;i<p.length;i++){p[i].transformations.push(this);}}else{p.transformations.push(this);}};JXG.Transformation.prototype.matVecMult=function(mat1,vec){return this.board.algebra.matVecMult(mat1,vec);};JXG.Transformation.prototype.setProperty=function(term){};JXG.Transformation.prototype.melt=function(t){var res=[];for(var i=0;i<t.matrix.length;i++){res[i]=[];}
this.update();t.update();for(i=0;i<t.matrix.length;i++){for(var j=0;j<this.matrix[0].length;j++){var s=0;for(var k=0;k<this.matrix.length;k++){s+=t.matrix[i][k]*this.matrix[k][j];}
res[i][j]=s;}}
this.update=function(){for(i=0;i<this.matrix.length;i++){for(j=0;j<this.matrix[0].length;j++){this.matrix[i][j]=res[i][j];}}};return true;};JXG.createTransform=function(board,parentArr,atts){return new JXG.Transformation(board,atts['type'],parentArr);};JXG.JSXGraph.registerElement('transform',JXG.createTransform);JXG.Board.prototype.angle=function(A,B,C){return this.algebra.angle(A,B,C);};JXG.Board.prototype.rad=function(A,B,C){return this.algebra.rad(A,B,C);};JXG.Board.prototype.distance=function(arr1,arr2){return this.algebra.distance(arr1,arr2);};JXG.Board.prototype.pow=function(a,b){return this.algebra.pow(a,b);};JXG.Board.prototype.round=function(x,n){return this.algebra.round(x,n);};JXG.Board.prototype.cosh=function(x){return this.algebra.cosh(x);};JXG.Board.prototype.sinh=function(x){return this.algebra.sinh(x);};JXG.Board.prototype.D=function(f){return this.algebra.D(f);};JXG.Board.prototype.I=function(interval,f){return this.algebra.I(interval,f);};JXG.Board.prototype.root=function(f,x){return this.algebra.root(f,x);};JXG.Board.prototype.abs=Math.abs;JXG.Board.prototype.acos=Math.acos;JXG.Board.prototype.asin=Math.asin;JXG.Board.prototype.atan=Math.atan;JXG.Board.prototype.ceil=Math.ceil;JXG.Board.prototype.cos=Math.cos;JXG.Board.prototype.exp=Math.exp;JXG.Board.prototype.floor=Math.floor;JXG.Board.prototype.log=Math.log;JXG.Board.prototype.max=Math.max;JXG.Board.prototype.min=Math.min;JXG.Board.prototype.random=Math.random;JXG.Board.prototype.sin=Math.sin;JXG.Board.prototype.sqrt=Math.sqrt;JXG.Board.prototype.tan=Math.tan;JXG.Board.prototype.trunc=Math.ceil;JXG.Board.prototype.factorial=function(n){if(n<0){return NaN;}else{var f=1;while(n>1){f*=n;n--;}
return f;}};JXG.Point.prototype.setPositionX=function(method,x){var y=(method==JXG.COORDS_BY_USER)?this.coords.usrCoords[2]:this.coords.scrCoords[2];this.setPosition(method,x,y);};JXG.Point.prototype.setPositionY=function(method,y){var x=(method==JXG.COORDS_BY_USER)?this.coords.usrCoords[1]:this.coords.scrCoords[1];this.setPosition(method,x,y);};JXG.Board.prototype.getElement=function(el){return JXG.GetReferenceFromParameter(this,el);};JXG.Board.prototype.intersectionOptions=['point',[[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_CIRCLE],[JXG.OBJECT_CLASS_CIRCLE,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.intersectionFunc=function(el1,el2,i){return function(){return el1.board.algebra.meet(el1.stdform,el2.stdform)[i];};};JXG.Board.prototype.pointFunc=function(){return[null];};JXG.Board.prototype.pointOptions=['point',[[JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.lineFunc=function(){return arguments;};JXG.Board.prototype.lineOptions=['line',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentFunc=function(){return arguments;};JXG.Board.prototype.linesegmentOptions=['line',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentAtts={straightFirst:false,straightLast:false};JXG.Board.prototype.arrowFunc=function(){return arguments;};JXG.Board.prototype.arrowOptions=['arrow',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circleFunc=function(){return arguments;};JXG.Board.prototype.circleOptions=['circle',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.arrowparallelOptions=['arrowparallel',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.arrowparallelFunc=function(){return arguments;};JXG.Board.prototype.bisectorOptions=['bisector',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.bisectorFunc=function(){return arguments;};JXG.Board.prototype.circumcircleOptions=['circumcircle',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcircleFunc=function(){return arguments;};JXG.Board.prototype.circumcirclemidpointOptions=['circumcirclemidpoint',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcirclemidpointFunc=function(){return arguments;};JXG.Board.prototype.integralOptions=['integral',[[]]];JXG.Board.prototype.integralFunc=function(){return arguments;};JXG.Board.prototype.midpointOptions=['midpoint',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.midpointFunc=function(){return arguments;};JXG.Board.prototype.mirrorpointOptions=['mirrorpoint',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.mirrorpointFunc=function(){return arguments;};JXG.Board.prototype.normalOptions=['normal',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.normalFunc=function(){return arguments;};JXG.Board.prototype.parallelOptions=['parallel',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.parallelFunc=function(){return arguments;};JXG.Board.prototype.parallelpointOptions=['parallelpoint',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.parallelpointFunc=function(){return arguments;};JXG.Board.prototype.perpendicularOptions=['perpendicular',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularFunc=function(){return arguments;};JXG.Board.prototype.perpendicularpointOptions=['perpendicularpoint',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularpointFunc=function(){return arguments;};JXG.Board.prototype.reflectionOptions=['reflection',[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.reflectionFunc=function(){return arguments;};JXG.Options=function(){this.fontSize=12;this.grid=new Object();this.grid.hasGrid=false;this.grid.gridX=2;this.grid.gridY=2;this.grid.gridColor='#C0C0C0';this.grid.gridOpacity='1';this.grid.gridDash=true;this.grid.snapToGrid=false;this.grid.snapSizeX=2;this.grid.snapSizeY=2;this.zoom=new Object();this.zoom.factor=1.25;this.elements=new Object();this.elements.color=new Object();this.elements.color.strokeOpacity=1;this.elements.color.highlightStrokeOpacity=1;this.elements.color.fillOpacity=1;this.elements.color.highlightFillOpacity=1;this.elements.color.strokeColor='#0000ff';this.elements.color.highlightStrokeColor='#C3D9FF';this.elements.color.fillColor='none';this.elements.color.highlightFillColor='none';this.elements.draft=false;this.elements.strokeWidth='2px';this.point=new Object();this.point.style=1;this.point.fillColor='#ff0000';this.point.highlightFillColor='#EEEEEE';this.line=new Object();this.line.firstArrow=false;this.line.lastArrow=false;this.line.straightFirst=true;this.line.straightLast=true;this.line.ticks=new Object();this.line.ticks.withTicks=false;this.line.ticks.ticksDelta=1;this.angle=new Object();this.angle.radius=1.0;this.angle.fillColor='#FF7F00';this.angle.highlightFillColor='#FF7F00';this.angle.strokeColor='#FF7F00';this.angle.fillOpacity=0.3;this.angle.highlightFillOpacity=0.3;this.arc=new Object();this.arc.firstArrow=false;this.arc.lastArrow=false;this.polygon=new Object();this.polygon.fillColor='#00FF00';this.polygon.highlightFillColor='#00FF00';this.polygon.fillOpacity=0.3;this.polygon.highlightFillOpacity=0.3;this.sector=new Object();this.sector.fillColor='#00FF00';this.sector.highlightFillColor='#00FF00';this.sector.fillOpacity=0.3;this.sector.highlightFillOpacity=0.3;this.text=new Object();this.text.strokeColor='#000000';this.curve=new Object();this.curve.strokeWidth='1px';this.precision=new Object();this.precision.hasPoint=4;this.precision.epsilon=0.0001;}
JXG.GeometryElement.prototype.useBlackWhite=function(){}
JXG.SVGRenderer=function(container){this.constructor();this.svgRoot=null;this.suspendHandle=null;this.svgNamespace='http://www.w3.org/2000/svg';this.xlinkNamespace='http://www.w3.org/1999/xlink';this.container=container;this.container.style.MozUserSelect='none';this.container.style.overflow='hidden';if(this.container.style.position==''){this.container.style.position='relative';}
this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg");this.container.appendChild(this.svgRoot);this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,'defs');this.svgRoot.appendChild(this.defs);this.images=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.images);this.grid=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.grid);this.angles=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.angles);this.sectors=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.sectors);this.polygone=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.polygone);this.curves=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.curves);this.circles=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.circles);this.lines=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.lines);this.arcs=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.arcs);this.points=this.container.ownerDocument.createElementNS(this.svgNamespace,'g');this.svgRoot.appendChild(this.points);this.dashArray=['2, 2','5, 5','10, 10','20, 20','20, 10, 10, 10','20, 5, 10, 5'];}
JXG.SVGRenderer.prototype=new JXG.AbstractRenderer;JXG.SVGRenderer.prototype.displayCopyright=function(str,fontsize){var node=this.createPrimitive('text','licenseText');node.setAttributeNS(null,'x','20');node.setAttributeNS(null,'y',2+fontsize);node.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+fontsize+"; fill:#356AA0;  opacity:0.3;");var t=document.createTextNode(str);node.appendChild(t);this.appendChildPrimitive(node,'images');};JXG.SVGRenderer.prototype.drawAxis=function(el){var node=this.createPrimitive('line',el.id);node.setAttributeNS(null,'stroke',el.visProp['strokeColor']);node.setAttributeNS(null,'stroke-width',el.visProp['strokeWidth']);var node2=this.createArrowHead(el);node2.setAttributeNS(null,'fill',el.visProp['strokeColor']);this.defs.appendChild(node2);node.setAttributeNS(null,'marker-end','url(#'+el.id+'Triangle)');this.lines.appendChild(node);el.rendNode=node;el.rendNodeTriangle=node2;this.updateAxisTicks(el,0);this.updateAxis(el);}
JXG.SVGRenderer.prototype.updateAxis=function(el){var screenCoords1=new JXG.Coords(JXG.COORDS_BY_USER,[el.point1.coords.usrCoords[1],el.point1.coords.usrCoords[2]],el.board);var screenCoords2=new JXG.Coords(JXG.COORDS_BY_USER,[el.point2.coords.usrCoords[1],el.point2.coords.usrCoords[2]],el.board);if(el.visProp['straightFirst']||el.visProp['straightLast']){this.calcStraight(el,screenCoords1,screenCoords2);}
var node=$(el.id);if(el.point1.coords.scrCoords[1]==el.point2.coords.scrCoords[1]){this.updateLinePrimitive(node,el.board.origin.scrCoords[1],el.board.canvasHeight,el.board.origin.scrCoords[1],0);}else{this.updateLinePrimitive(node,0,el.board.origin.scrCoords[2],el.board.canvasWidth,el.board.origin.scrCoords[2]);}
this.setStrokeProp(node,el.visProp);this.updateAxisTicksInnerLoop(el,0);}
JXG.SVGRenderer.prototype.drawArc=function(el){var node=this.createPrimitive('path',el.id);var radius=el.getRadius();var angle=el.board.algebra.trueAngle(el.point2,el.midpoint,el.point3);var circle={};circle.midpoint=el.midpoint;circle.getRadius=function(){return radius;}
var point3=el.board.algebra.projectPointToCircle(el.point3,circle);var pathString='M '+el.point2.coords.scrCoords[1]+' '+el.point2.coords.scrCoords[2]+' A ';pathString+=Math.round(radius*el.board.unitX*el.board.zoomX)+' '+Math.round(radius*el.board.unitY*el.board.zoomY)+' 0 ';if(angle>=180){pathString+='1 ';}
else{pathString+='0 ';}
pathString+='0 ';pathString+=point3.scrCoords[1]+' '+point3.scrCoords[2];this.updatePathPrimitive(node,pathString);this.setStrokeProp(node,el.visProp);node.setAttributeNS(null,'fill','none');this.setDashStyle(node,el.visProp);var node2;var node3;if(el.visProp['firstArrow']){var node2=this.createArrowHead(el,'Start');this.defs.appendChild(node2);el.rendNodeTriangleStart=node2;node.setAttributeNS(null,'marker-end','url(#'+el.id+'TriangleStart)');}
if(el.visProp['lastArrow']){var node2=this.createArrowHead(el,'End');this.defs.appendChild(node2);el.rendNodeTriangleEnd=node2;node.setAttributeNS(null,'marker-start','url(#'+el.id+'TriangleEnd)');}
var node4=this.createPrimitive('path',el.id+'_fill');var pathString2='M '+el.midpoint.coords.scrCoords[1]+" "+el.midpoint.coords.scrCoords[2];pathString2+=' L '+el.point2.coords.scrCoords[1]+' '+el.point2.coords.scrCoords[2]+' A ';pathString2+=Math.round(radius*el.board.unitX*el.board.zoomX)+' '+Math.round(radius*el.board.unitY*el.board.zoomY)+' 0 ';if(angle>=180){pathString2+='1 ';}
else{pathString2+='0 ';}
pathString2+='0 ';pathString2+=point3.scrCoords[1]+' '+point3.scrCoords[2];pathString2+=' L '+el.midpoint.coords.scrCoords[1]+" "+el.midpoint.coords.scrCoords[2]+' z';this.updatePathPrimitive(node4,pathString2);this.setFillProp(node4,el.visProp);node4.setAttributeNS(null,'stroke','none');this.arcs.appendChild(node);el.rendNode=node;this.sectors.appendChild(node4);el.rendNodeFill=node4;this.setDraft(el);if(!el.visProp['visible']){el.hideElement();}}
JXG.SVGRenderer.prototype.drawAngle=function(el){var angle=el.board.algebra.trueAngle(el.point1,el.point2,el.point3);var circle={};circle.midpoint=el.point2;circle.getRadius=function(){return el.radius;}
var projectedP1=el.board.algebra.projectPointToCircle(el.point1,circle);var projectedP3=el.board.algebra.projectPointToCircle(el.point3,circle);var node=this.createPrimitive('path',el.id+'_1');var pathString='M '+el.point2.coords.scrCoords[1]+" "+el.point2.coords.scrCoords[2];pathString+=' L '+projectedP1.scrCoords[1]+' '+projectedP1.scrCoords[2]+' A ';pathString+=Math.round(el.radius*el.board.unitX*el.board.zoomX)+' '+Math.round(el.radius*el.board.unitY*el.board.zoomY)+' 0 ';if(angle>=180){pathString+='1 ';}
else{pathString+='0 ';}
pathString+='0 ';pathString+=projectedP3.scrCoords[1]+' '+projectedP3.scrCoords[2];pathString+=' L '+el.point2.coords.scrCoords[1]+" "+el.point2.coords.scrCoords[2]+' z';node.setAttributeNS(null,'d',pathString);node.setAttributeNS(null,'fill',el.visProp['fillColor']);node.setAttributeNS(null,'fill-opacity',el.visProp['fillOpacity']);node.setAttributeNS(null,'stroke','none');var node2=this.createPrimitive('path',el.id+'_2');var pathString='M '+projectedP1.scrCoords[1]+' '+projectedP1.scrCoords[2]+' A ';pathString+=Math.round(el.radius*el.board.unitX*el.board.zoomX)+' '+Math.round(el.radius*el.board.unitY*el.board.zoomY)+' 0 ';if(angle>=180){pathString+='1 ';}
else{pathString+='0 ';}
pathString+='0 ';pathString+=projectedP3.scrCoords[1]+' '+projectedP3.scrCoords[2];node2.setAttributeNS(null,'d',pathString);node2.setAttributeNS(null,'id',el.id+'_2');node2.setAttributeNS(null,'fill','none');node2.setAttributeNS(null,'stroke',el.visProp['strokeColor']);node2.setAttributeNS(null,'stroke-opacity',el.visProp['strokeOpacity']);this.appendChildPrimitive(node,'angles');el.rendNode1=node;this.appendChildPrimitive(node2,'angles');el.rendNode2=node2;this.setObjectStrokeWidth(el,el.visProp['strokeWidth']);}
JXG.SVGRenderer.prototype.updateAngle=function(el){this.remove(el.rendNode1);this.remove(el.rendNode2);this.drawAngle(el);if(!el.visProp['visible']){el.hideElement();}
return;};JXG.SVGRenderer.prototype.drawImage=function(el){var imageBase64='data:image/png;base64,'+el.imageBase64String;var node=this.createPrimitive('image',el.id);node.setAttributeNS(this.xlinkNamespace,'xlink:href',imageBase64);this.appendChildPrimitive(node,el.displayLevel);el.rendNode=node;this.updateImage(el);}
JXG.SVGRenderer.prototype.transformImage=function(el,t){var node=el.rendNode;var str=node.getAttributeNS(null,'transform');str+=' '+this.joinTransforms(el,t);node.setAttributeNS(null,'transform',str);}
JXG.SVGRenderer.prototype.joinTransforms=function(el,t){var str='';for(var i=0;i<t.length;i++){var s=t[i].matrix[1][1]+','+t[i].matrix[2][1]+','+t[i].matrix[1][2]+','+t[i].matrix[2][2]+','+t[i].matrix[1][0]+','+t[i].matrix[2][0];str+='matrix('+s+') ';}
return str;}
JXG.SVGRenderer.prototype.transformImageParent=function(el,m){if(m!=null){var s=m[1][1]+','+m[2][1]+','+m[1][2]+','+m[2][2]+','+m[1][0]+','+m[2][0];var str='matrix('+s+')';}else{var str='';}
el.rendNode.setAttributeNS(null,'transform',str);}
JXG.SVGRenderer.prototype.removeGrid=function(board){board.hasGrid=false;var c=this.grid;while(c.childNodes.length>0){c.removeChild(c.firstChild);}}
JXG.SVGRenderer.prototype.setObjectDash=function(el){if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode2;}
else{node=el.rendNode;}
if(el.visProp['dash']>0){var dashStyle=el.visProp['dash'];node.setAttributeNS(null,'stroke-dasharray',this.dashArray[dashStyle-1]);}
else{if(node.hasAttributeNS(null,'stroke-dasharray')){node.removeAttributeNS(null,'stroke-dasharray');}}}}
JXG.SVGRenderer.prototype.setObjectStrokeColor=function(el,color,opacity){if(opacity==undefined){opacity=1;}
var c,o;if(typeof opacity=='function'){o=opacity();}else{o=opacity;}
o=(o>0)?o:0;if(typeof color=='function'){c=color();}else{c=color;}
if(el.elementClass!=JXG.OBJECT_CLASS_POINT){var node=el.rendNode;if(el.type==JXG.OBJECT_TYPE_TEXT){node.style.color=c;}
else if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode2;node.setAttributeNS(null,'stroke',c);node.setAttributeNS(null,'stroke-opacity',o);}
else{node.setAttributeNS(null,'stroke',c);node.setAttributeNS(null,'stroke-opacity',o);}
if(el.type==JXG.OBJECT_TYPE_ARROW){el.rendNodeTriangle.setAttributeNS(null,'stroke',c);el.rendNodeTriangle.setAttributeNS(null,'stroke-opacity',o);el.rendNodeTriangle.setAttributeNS(null,'fill',c);el.rendNodeTriangle.setAttributeNS(null,'fill-opacity',o);}
if(el.type==JXG.OBJECT_TYPE_ARC){if(el.visProp['firstArrow']){el.rendNodeTriangleStart.setAttributeNS(null,'stroke',c);el.rendNodeTriangleStart.setAttributeNS(null,'stroke-opacity',o);el.rendNodeTriangleStart.setAttributeNS(null,'fill',c);el.rendNodeTriangleStart.setAttributeNS(null,'fill-opacity',o);}
if(el.visProp['lastArrow']){el.rendNodeTriangleEnd.setAttributeNS(null,'stroke',c);el.rendNodeTriangleEnd.setAttributeNS(null,'stroke-opacity',o);el.rendNodeTriangleEnd.setAttributeNS(null,'fill',c);el.rendNodeTriangleEnd.setAttributeNS(null,'fill-opacity',o);}}
else if(el.type==JXG.OBJECT_TYPE_LINE){if(!el.visProp['straightFirst']&&el.visProp['firstArrow']){el.rendNodeTriangleStart.setAttributeNS(null,'stroke',c);el.rendNodeTriangleStart.setAttributeNS(null,'stroke-opacity',o);el.rendNodeTriangleStart.setAttributeNS(null,'fill',c);el.rendNodeTriangleStart.setAttributeNS(null,'fill-opacity',o);}
if(!el.visProp['straightLast']&&el.visProp['lastArrow']){el.rendNodeTriangleEnd.setAttributeNS(null,'stroke',c);el.rendNodeTriangleEnd.setAttributeNS(null,'stroke-opacity',o);el.rendNodeTriangleEnd.setAttributeNS(null,'fill',c);el.rendNodeTriangleEnd.setAttributeNS(null,'fill-opacity',o);}}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.setAttributeNS(null,'stroke',c);node.setAttributeNS(null,'stroke-opacity',o);}
else{var node=el.rendNodeX1;node.setAttributeNS(null,'stroke',c);node.setAttributeNS(null,'stroke-opacity',o);node=el.rendNodeX2;node.setAttributeNS(null,'stroke',c);node.setAttributeNS(null,'stroke-opacity',o);}}};JXG.SVGRenderer.prototype.setObjectFillColor=function(el,color,opacity){if(opacity==undefined){opacity=1;}
var c,o;if(typeof opacity=='function'){o=opacity();}else{o=opacity;}
o=(o>0)?o:0;if(typeof color=='function'){c=color();}else{c=color;}
if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ARC){var node=el.rendNodeFill;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);}
else if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode1;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);}
else{var node=el.rendNode;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);}
else{var node=el.rendNodeX1;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);node=el.rendNodeX2;node.setAttributeNS(null,'fill',c);node.setAttributeNS(null,'fill-opacity',o);}}};JXG.SVGRenderer.prototype.hide=function(el){if(JXG.IsPoint(el)){if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";}
else{var node=el.rendNodeX1;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";node=el.rendNodeX2;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";}}
else if(el.type==JXG.OBJECT_TYPE_ARC){var node=el.rendNode;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";node=el.rendNodeFill;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";}
else if(el.type==JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode1;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";node=el.rendNode2;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";}
else{var node=el.rendNode;node.setAttributeNS(null,'display','none');node.style.visibility="hidden";}}
JXG.SVGRenderer.prototype.show=function(el){if(JXG.IsPoint(el)){if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";}
else{var node=el.rendNodeX1;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";node=el.rendNodeX2;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";}}
else if(el.type==JXG.OBJECT_TYPE_ARC){var node=el.rendNode;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";node=el.rendNodeFill;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";}
else if(el.type==JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode1;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";node=el.rendNode2;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";}
else{var node=el.rendNode;node.setAttributeNS(null,'display','inline');node.style.visibility="inherit";}}
JXG.SVGRenderer.prototype.remove=function(shape){shape.parentNode.removeChild(shape);}
JXG.SVGRenderer.prototype.suspendRedraw=function(){if(true){this.suspendHandle=this.svgRoot.suspendRedraw(10000);}}
JXG.SVGRenderer.prototype.unsuspendRedraw=function(){if(true){this.svgRoot.unsuspendRedraw(this.suspendHandle);this.svgRoot.forceRedraw();}}
JXG.SVGRenderer.prototype.setStrokeProp=function(node,visProp){if(visProp['strokeColor']!=null){node.setAttributeNS(null,'stroke',visProp['strokeColor']);}
if(visProp['strokeOpacity']!=null){node.setAttributeNS(null,'stroke-opacity',visProp['strokeOpacity']);}
if(visProp['strokeWidth']!=null){node.setAttributeNS(null,'stroke-width',visProp['strokeWidth']);}}
JXG.SVGRenderer.prototype.setFillProp=function(node,visProp){if(visProp['fillColor']!=null){node.setAttributeNS(null,'fill',visProp['fillColor']);}
if(visProp['fillOpacity']!=null){node.setAttributeNS(null,'fill-opacity',visProp['fillOpacity']);}}
JXG.SVGRenderer.prototype.setDashStyle=function(node,visProp){if(visProp['dash']>0){var dashStyle=visProp['dash'];node.setAttributeNS(null,'stroke-dasharray',this.dashArray[dashStyle-1]);}}
JXG.SVGRenderer.prototype.createPrimitive=function(type,id){var node=this.container.ownerDocument.createElementNS(this.svgNamespace,type);node.setAttributeNS(null,'id',id);node.style.position='absolute';return node;}
JXG.SVGRenderer.prototype.createArrowHead=function(el,idAppendix){var id=el.id+'Triangle';if(idAppendix!=null){id+=idAppendix;}
var node2=this.createPrimitive('marker',id);node2.setAttributeNS(null,'viewBox','0 0 10 6');node2.setAttributeNS(null,'refY','3');node2.setAttributeNS(null,'markerUnits','strokeWidth');node2.setAttributeNS(null,'markerHeight','6');node2.setAttributeNS(null,'markerWidth','6');node2.setAttributeNS(null,'orient','auto');node2.setAttributeNS(null,'stroke',el.visProp['strokeColor']);node2.setAttributeNS(null,'stroke-opacity',el.visProp['strokeOpacity']);node2.setAttributeNS(null,'fill',el.visProp['strokeColor']);node2.setAttributeNS(null,'fill-opacity',el.visProp['strokeOpacity']);var node3=this.container.ownerDocument.createElementNS(this.svgNamespace,'path');if(idAppendix=='End'){node2.setAttributeNS(null,'refX','0');node3.setAttributeNS(null,'d','M 0 3 L 10 6 L 10 0 z');}else{node2.setAttributeNS(null,'refX','10');node3.setAttributeNS(null,'d','M 0 0 L 10 3 L 0 6 z');}
node2.appendChild(node3);return node2;};JXG.SVGRenderer.prototype.makeArrow=function(node,el,idAppendix){var node2=this.createArrowHead(el,idAppendix);this.defs.appendChild(node2);node.setAttributeNS(null,'marker-end','url(#'+el.id+'Triangle)');el.rendNodeTriangle=node2;};JXG.SVGRenderer.prototype.makeArrows=function(el){if(el.visProp['firstArrow']){var node2=el.rendNodeTriangleStart;if(node2==null){node2=this.createArrowHead(el,'End');this.defs.appendChild(node2);el.rendNodeTriangleStart=node2;el.rendNode.setAttributeNS(null,'marker-start','url(#'+el.id+'TriangleEnd)');}}
else{var node2=el.rendNodeTriangleStart;if(node2!=null){this.remove(node2);}}
if(el.visProp['lastArrow']){var node2=el.rendNodeTriangleEnd;if(node2==null){node2=this.createArrowHead(el,'Start');this.defs.appendChild(node2);el.rendNodeTriangleEnd=node2;el.rendNode.setAttributeNS(null,'marker-end','url(#'+el.id+'TriangleStart)');}}
else{var node2=el.rendNodeTriangleEnd;if(node2!=null){this.remove(node2);}}};JXG.SVGRenderer.prototype.updateLinePrimitive=function(node,p1x,p1y,p2x,p2y){node.setAttributeNS(null,'x1',p1x);node.setAttributeNS(null,'y1',p1y);node.setAttributeNS(null,'x2',p2x);node.setAttributeNS(null,'y2',p2y);};JXG.SVGRenderer.prototype.updateCirclePrimitive=function(node,x,y,r){node.setAttributeNS(null,'cx',(x));node.setAttributeNS(null,'cy',(y));node.setAttributeNS(null,'r',(r));};JXG.SVGRenderer.prototype.updateEllipsePrimitive=function(node,x,y,rx,ry){node.setAttributeNS(null,'cx',(x));node.setAttributeNS(null,'cy',(y));node.setAttributeNS(null,'rx',(rx));node.setAttributeNS(null,'ry',(ry));};JXG.SVGRenderer.prototype.updateRectPrimitive=function(node,x,y,w,h){node.setAttributeNS(null,'x',(x));node.setAttributeNS(null,'y',(y));node.setAttributeNS(null,'width',(w));node.setAttributeNS(null,'height',(h));};JXG.SVGRenderer.prototype.updatePathPrimitive=function(node,pointString){node.setAttributeNS(null,'d',pointString);node.setAttributeNS(null,'stroke-linecap','round');node.setAttributeNS(null,'stroke-linejoin','round');};JXG.SVGRenderer.prototype.updatePathStringPrimitive=function(el){if(el.numberPoints<=0){return'';}
var j=0;var screenCoords=el.points[j].scrCoords;while((isNaN(screenCoords[1])||isNaN(screenCoords[2]))&&(j<el.numberPoints-1)){j++;screenCoords=el.points[j].scrCoords;}
if(j>=el.numberPoints){return'';}
var pStr='M '+screenCoords[1]+' '+screenCoords[2];for(var i=j+1;i<el.numberPoints;i++){var screenCoords=el.points[i].scrCoords;if(!isNaN(screenCoords[1])&&!isNaN(screenCoords[2])){pStr+=' L '+screenCoords[1]+' '+screenCoords[2];}}
return pStr;};JXG.SVGRenderer.prototype.updatePolygonePrimitive=function(node,pointString){node.setAttributeNS(null,'points',pointString);};JXG.SVGRenderer.prototype.appendChildPrimitive=function(node,level){switch(level){case'images':this.images.appendChild(node);break;case'grid':this.grid.appendChild(node);break;case'angles':this.angles.appendChild(node);break;case'sectors':this.sectors.appendChild(node);break;case'polygone':this.polygone.appendChild(node);break;case'curves':this.curves.appendChild(node);break;case'circles':this.circles.appendChild(node);break;case'lines':this.lines.appendChild(node);break;case'arcs':this.arcs.appendChild(node);break;case'points':this.points.appendChild(node);break;}};JXG.SVGRenderer.prototype.setPropertyPrimitive=function(node,key,val){if(key=='stroked'){return;}
node.setAttributeNS(null,key,val);};JXG.VMLRenderer=function(container){this.constructor();this.container=container;this.container.style.overflow='hidden';this.container.onselectstart=function(){return false;};container.ownerDocument.namespaces.add("v","urn:schemas-microsoft-com:vml");var style=container.ownerDocument.createStyleSheet();style.addRule('v\\:*',"behavior: url(#default#VML);");this.dashArray=['Solid','1 1','ShortDash','Dash','LongDash','ShortDashDot','LongDashDot'];};JXG.VMLRenderer.prototype=new JXG.AbstractRenderer;JXG.VMLRenderer.prototype.displayCopyright=function(str,fontsize){var node=this.createPrimitive('textbox','licenseText');node.style.left=20;node.style.top=(2);node.style.fontSize=(fontsize);node.style.color='#356AA0';node.style.fontFamily='Arial,Helvetica,sans-serif';node.setAttribute('opacity','30%');node.style.filter='alpha(opacity = 30)';var t=document.createTextNode(str);node.appendChild(t);this.appendChildPrimitive(node,'images');};JXG.VMLRenderer.prototype.drawAxis=function(el){var node;node=this.container.ownerDocument.createElement('v:line');node.style.position='absolute';if(el.point1.coords.scrCoords[1]==el.point2.coords.scrCoords[1]){node.setAttribute('from',(el.board.origin.scrCoords[1])+'px,'+(el.board.canvasHeight)+'px');node.setAttribute('to',(el.board.origin.scrCoords[1])+'px,'+'0px');}
else{node.setAttribute('from','0px,'+(el.board.origin.scrCoords[2])+'px');node.setAttribute('to',(el.board.canvasWidth)+'px,'+(el.board.origin.scrCoords[2])+'px');}
this.setStrokeProp(node,el.visProp);node.style.zIndex="4";node.setAttribute('id',el.id);el.rendNode=node;var nodeStroke=this.container.ownerDocument.createElement('v:stroke');nodeStroke.setAttribute('endarrow','block');nodeStroke.setAttribute('endarrowlength','long');node.appendChild(nodeStroke);this.updateAxisTicks(el,0);this.container.appendChild(node);}
JXG.VMLRenderer.prototype.updateAxis=function(el){var node=$(el.id);if(el.point1.coords.scrCoords[1]==el.point2.coords.scrCoords[1]){node.setAttribute('from',(el.board.origin.scrCoords[1])+'px,'+(el.board.canvasHeight)+'px');node.setAttribute('to',(el.board.origin.scrCoords[1])+'px,'+'0px');}
else{node.setAttribute('from','0px,'+(el.board.origin.scrCoords[2])+'px');node.setAttribute('to',(el.board.canvasWidth)+'px,'+(el.board.origin.scrCoords[2])+'px');}
this.setStrokeProp(node,el.visProp);for(var i=0;i<el.ticks.length;i++){var c=el.ticks[i];var tick=$(el.id+'tick'+i);tick.setAttribute('from',c.scrCoords[1]+'px,'+c.scrCoords[2]+'px');if(el.point1.coords.scrCoords[1]==el.point2.coords.scrCoords[1]){tick.setAttribute('to',(c.scrCoords[1]-el.r)+'px,'+(c.scrCoords[2])+'px');}
else{tick.setAttribute('to',(c.scrCoords[1])+'px,'+(c.scrCoords[2]+el.r)+'px');}
tick.setAttribute('stroked','true');tick.setAttribute('strokecolor',el.visProp['strokeColor'],1);tick.setAttribute('strokeweight',el.visProp['strokeWidth']);}}
JXG.VMLRenderer.prototype.drawArc=function(el){var radius=el.getRadius();var p={};p.coords=new JXG.Coords(JXG.COORDS_BY_USER,[el.midpoint.coords.usrCoords[1],el.board.origin.scrCoords[2]/(el.board.unitY*el.board.zoomY)],el.board);var angle2=el.board.algebra.trueAngle(el.point2,el.midpoint,p);var angle1=el.board.algebra.trueAngle(el.point3,el.midpoint,p);if(angle2<angle1){angle1-=360;}
var node=this.createPrimitive('arc',el.id);node.setAttribute('filled','false');this.setStrokeProp(node,el.visProp);node.style.left=(el.midpoint.coords.scrCoords[1]-Math.round(radius*el.board.unitX*el.board.zoomX))+'px';node.style.top=(el.midpoint.coords.scrCoords[2]-Math.round(radius*el.board.unitY*el.board.zoomY))+'px';node.style.width=(Math.round(radius*el.board.unitX*el.board.zoomX)*2)+'px';node.style.height=(Math.round(radius*el.board.unitY*el.board.zoomY)*2)+'px';node.setAttribute('startangle',angle1);node.setAttribute('endangle',angle2);var nodeStroke=this.container.ownerDocument.createElement('v:stroke');if(el.visProp['lastArrow']){nodeStroke.setAttribute('endarrow','block');nodeStroke.setAttribute('endarrowlength','long');}
if(el.visProp['firstArrow']){nodeStroke.setAttribute('startarrow','block');nodeStroke.setAttribute('startarrowlength','long');}
nodeStroke.setAttribute('id',el.id+'stroke');var tmp=el.visProp['dash'];nodeStroke.setAttribute('dashstyle',this.dashArray[tmp]);node.appendChild(nodeStroke);var node2=this.createPrimitive('shape',el.id+'_fill');node2.setAttribute('filled','true');node2.setAttribute('fillcolor',el.visProp['fillColor']);node2.setAttribute('stroked','false');var x=Math.round(radius*el.board.unitX*el.board.zoomX);var y=Math.round(radius*el.board.unitY*el.board.zoomY);node2.style.width=x;node2.style.height=y;node2.setAttribute('coordsize',x+','+y);var nodePath=this.container.ownerDocument.createElement('v:path');nodePath.setAttribute('id',el.id+'path');var p4coords=el.board.algebra.projectPointToCircle(el.point3,el);var pathString='m '+el.midpoint.coords.scrCoords[1]+','+el.midpoint.coords.scrCoords[2]+' l ';pathString+=el.point2.coords.scrCoords[1]+','+el.point2.coords.scrCoords[2]+' at ';pathString+=(el.midpoint.coords.scrCoords[1]-x)+','+(el.midpoint.coords.scrCoords[2]-y)+',';pathString+=(el.midpoint.coords.scrCoords[1]+x)+','+(el.midpoint.coords.scrCoords[2]+y);pathString+=' '+el.point2.coords.scrCoords[1]+','+el.point2.coords.scrCoords[2];pathString+=', '+p4coords.scrCoords[1]+','+p4coords.scrCoords[2]+' l ';pathString+=el.midpoint.coords.scrCoords[1]+','+el.midpoint.coords.scrCoords[2]+' x e';nodePath.setAttribute('v',pathString);node2.appendChild(nodePath);var nodeFill=this.container.ownerDocument.createElement('v:fill');nodeFill.setAttribute('id',el.id+'_fillnode');nodeFill.setAttribute('opacity',(el.visProp['fillOpacity']*100)+'%');node2.appendChild(nodeFill);this.appendChildPrimitive(node,'lines');this.appendChildPrimitive(node2,'angles');el.rendNode=node;el.rendNodeFill=node2;if(el.visProp['draft']){this.setDraft(el);}}
JXG.VMLRenderer.prototype.drawAngle=function(el){var node=this.container.ownerDocument.createElement('v:shape');node.style.position='absolute';node.setAttribute('filled','true');node.setAttribute('fillcolor',el.visProp['fillColor']);node.setAttribute('stroked','false');node.style.zIndex="2";node.setAttribute('id',el.id+'_1');var x=Math.round(el.radius*el.board.unitX*el.board.zoomX);var y=Math.round(el.radius*el.board.unitY*el.board.zoomY);node.style.width=x;node.style.height=y;node.setAttribute('coordsize',x+','+y);var circle={};circle.midpoint=el.point2;circle.getRadius=function(){return el.radius;}
var projectedP1=el.board.algebra.projectPointToCircle(el.point1,circle);var projectedP3=el.board.algebra.projectPointToCircle(el.point3,circle);var nodePath=this.container.ownerDocument.createElement('v:path');nodePath.setAttribute('id',el.id+"_path");var pathString='m '+el.point2.coords.scrCoords[1]+','+el.point2.coords.scrCoords[2]+' l ';pathString+=projectedP1.scrCoords[1]+','+projectedP1.scrCoords[2]+' at ';pathString+=(el.point2.coords.scrCoords[1]-x)+','+(el.point2.coords.scrCoords[2]-y)+',';pathString+=(el.point2.coords.scrCoords[1]+x)+','+(el.point2.coords.scrCoords[2]+y);pathString+=' '+projectedP1.scrCoords[1]+','+projectedP1.scrCoords[2];pathString+=', '+projectedP3.scrCoords[1]+','+projectedP3.scrCoords[2]+' l ';pathString+=el.point2.coords.scrCoords[1]+','+el.point2.coords.scrCoords[2]+' x e';nodePath.setAttribute('v',pathString);node.appendChild(nodePath);var nodeFill=this.container.ownerDocument.createElement('v:fill');nodeFill.setAttribute('opacity',el.visProp['fillOpacity']*10+'%');nodeFill.setAttribute('id',el.id+'_fillnode');node.appendChild(nodeFill);var p={};p.coords=new JXG.Coords(JXG.COORDS_BY_USER,[el.point2.coords.usrCoords[1],el.board.origin.scrCoords[2]/(el.board.unitY*el.board.zoomY)],el.board);var angle2=el.board.algebra.trueAngle(el.point1,el.point2,p);var angle1=el.board.algebra.trueAngle(el.point3,el.point2,p);if(angle2<angle1){angle1-=360;}
var node2=this.container.ownerDocument.createElement('v:arc');node2.style.position='absolute';node2.style.left=(el.point2.coords.scrCoords[1]-Math.round(el.radius*el.board.unitX*el.board.zoomX))+'px';node2.style.top=(el.point2.coords.scrCoords[2]-Math.round(el.radius*el.board.unitY*el.board.zoomY))+'px';node2.style.width=(Math.round(el.radius*el.board.unitX*el.board.zoomX)*2)+'px';node2.style.height=(Math.round(el.radius*el.board.unitY*el.board.zoomY)*2)+'px';node2.setAttribute('startangle',angle1);node2.setAttribute('endangle',angle2);node2.setAttribute('stroked','true');node2.setAttribute('strokecolor',el.visProp['strokeColor']);node2.setAttribute('strokeweight',el.visProp['strokeWidth']);node2.setAttribute('filled','false');node2.style.zIndex="4";node2.setAttribute('id',el.id+"_2");this.container.appendChild(node);this.container.appendChild(node2);el.rendNode1=node;el.rendNode2=node2;if(!el.visProp['visible']){el.hideElement(el);}}
JXG.VMLRenderer.prototype.updateAngle=function(el){this.remove(el.rendNode1);this.remove(el.rendNode2);this.drawAngle(el);return;}
JXG.VMLRenderer.prototype.drawImage=function(el){var imageBase64='data:image/png;base64,'+el.imageBase64String;var node=this.container.ownerDocument.createElement('img');node.style.position='absolute';node.setAttribute('id',el.id);node.setAttribute('src',imageBase64);this.container.appendChild(node);this.appendChildPrimitive(node,el.displayLevel);node.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand')";el.rendNode=node;this.updateImage(el);}
JXG.VMLRenderer.prototype.transformImage=function(el,t){var node=el.rendNode;var m=this.joinTransforms(el,t);node.style.left=(el.coords.scrCoords[1]+m[1][0])+'px';node.style.top=(el.coords.scrCoords[2]-el.size[1]+m[2][0])+'px';node.filters.item(0).M11=m[1][1];node.filters.item(0).M12=m[1][2];node.filters.item(0).M21=m[2][1];node.filters.item(0).M22=m[2][2];}
JXG.VMLRenderer.prototype.joinTransforms=function(el,t){var m=[[1,0,0],[0,1,0],[0,0,1]];for(var i=0;i<t.length;i++){m=el.board.algebra.matMatMult(t[i].matrix,m);}
return m;}
JXG.VMLRenderer.prototype.transformImageParent=function(el,m){};JXG.VMLRenderer.prototype.removeGrid=function(board){board.hasGrid=false;for(var i=0;i<=this.gridXsize;i++){var c=$('gridx'+i);while(c.childNodes.length>0){c.removeChild(c.firstChild);}
c.remove();}
for(var i=0;i<=this.gridYsize;i++){var c=$('gridy'+i);while(c.childNodes.length>0){c.removeChild(c.firstChild);}
c.remove();}}
JXG.VMLRenderer.prototype.hide=function(el){if(!JXG.IsPoint(el)){if(el.type!=JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode;node.style.visibility="hidden";if(el.type==JXG.OBJECT_TYPE_ARC){node=el.rendNodeFill;node.style.visibility="hidden";}}
else{var node=el.rendNode1;node.style.visibility="hidden";node=el.rendNode2;node.style.visibility="hidden";}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.style.visibility="hidden";}
else{var node=el.rendNodeX1;node.style.visibility="hidden";var node=el.rendNodeX2;node.style.visibility="hidden";}}}
JXG.VMLRenderer.prototype.show=function(el){if(!JXG.IsPoint(el)){if(el.type!=JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode;node.style.visibility="inherit";if(el.type==JXG.OBJECT_TYPE_ARC){node=el.rendNodeFill;node.style.visibility="inherit";}}
else{var node=el.rendNode1;node.style.visibility="inherit";node=el.rendNode2;node.style.visibility="inherit";}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.style.visibility="inherit";}
else{var node=el.rendNodeX1;node.style.visibility="inherit";var node=el.rendNodeX2;node.style.visibility="inherit";}}}
JXG.VMLRenderer.prototype.setObjectDash=function(el){if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode2;var tmp=el.visProp['dash'];node.setAttribute('dashstyle',this.dashArray[tmp]);}
else{var node=$(el.id+'stroke');if(node){var tmp=el.visProp['dash'];node.setAttribute('dashstyle',this.dashArray[tmp]);}}}}
JXG.VMLRenderer.prototype.setObjectStrokeColor=function(el,color,opacity){var c,o;if(typeof color=='function'){c=color();}else{c=color;}
if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ANGLE){var node=el.rendNode2;node.setAttribute('stroked','true');node.setAttribute('strokecolor',c);}
else if(el.type==JXG.OBJECT_TYPE_TEXT){el.rendNode.style.color=c;}
else{var node=el.rendNode;node.setAttribute('stroked','true');node.setAttribute('strokecolor',c);}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;node.setAttribute('stroked','true');node.setAttribute('strokecolor',c);}
else{var node=el.rendNodeX1;node.setAttribute('stroked','true');node.setAttribute('strokecolor',c);var node=el.rendNodeX2;node.setAttribute('stroked','true');node.setAttribute('strokecolor',c);}}}
JXG.VMLRenderer.prototype.setObjectFillColor=function(el,color,opacity){var node;var c,o;if(typeof opacity=='function'){o=opacity();}else{o=opacity;}
o=(o>0)?o:0;if(typeof color=='function'){c=color();}else{c=color;}
if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ARC){node=el.rendNodeFill;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}}
else if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode1;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}}
else{node=el.rendNode;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}}}
else{if(el.visProp['style']>=3&&el.visProp['style']<=9){var node=el.rendNode;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}}
else{var node=el.rendNodeX1;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}
var node=el.rendNodeX2;if(c=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',c);}}}
if(el.type==JXG.OBJECT_TYPE_POLYGON||el.type==JXG.OBJECT_TYPE_CIRCLE||el.type==JXG.OBJECT_TYPE_ARC||el.type==JXG.OBJECT_TYPE_ANGLE||el.type==JXG.OBJECT_TYPE_CURVE){var nodeFill=$(el.id+'_fillnode');if(o!=undefined)nodeFill.setAttribute('opacity',(o*100)+'%');}}
JXG.VMLRenderer.prototype.remove=function(node){node.removeNode(true);}
JXG.VMLRenderer.prototype.suspendRedraw=function(){};JXG.VMLRenderer.prototype.unsuspendRedraw=function(){};JXG.VMLRenderer.prototype.setStrokeProp=function(node,visProp){if(visProp['strokeColor']=='none'){node.setAttribute('stroked','false');}
else{node.setAttribute('stroked','true');var props=['strokeColor','strokeWidth'];var vmlprops=['strokecolor','strokeweight'];this.setAttributes(node,props,vmlprops,visProp);}};JXG.VMLRenderer.prototype.setFillProp=function(node,visProp){if(visProp['fillColor']==null||visProp['fillColor']=='none'){node.setAttribute('filled','false');}
else{node.setAttribute('filled','true');node.setAttribute('fillcolor',visProp['fillColor']);}
var nodeFill=this.container.ownerDocument.createElement('v:fill');nodeFill.setAttribute('id',node.id+'_fillnode');nodeFill.setAttribute('opacity',(visProp['fillOpacity']*100)+'%');node.appendChild(nodeFill);};JXG.VMLRenderer.prototype.setAttributes=function(node,props,vmlprops,visProp){var val;for(var i=0;i<props.length;i++){var p=props[i];if(visProp[p]!=null){if(typeof visProp[p]=='function'){val=visProp[p]();val=(val>0)?val:0;}else{val=visProp[p];}
node.setAttribute(vmlprops[i],val);}}};JXG.VMLRenderer.prototype.setDashStyle=function(node,visProp){if(visProp['dash']>=0){var node2=this.container.ownerDocument.createElement('v:stroke');node2.setAttribute('id',node.id+'stroke');node2.setAttribute('dashstyle',this.dashArray[visProp['dash']]);node.appendChild(node2);}};JXG.VMLRenderer.prototype.createPrimitive=function(type,id){var node;if(type=='circle'||type=='ellipse'){node=this.container.ownerDocument.createElement('v:oval');}else if(type=='polygon'||type=='path'){node=this.container.ownerDocument.createElement('v:polyline');}else{node=this.container.ownerDocument.createElement('v:'+type);}
node.style.position='absolute';node.setAttribute('id',id);return node;};JXG.VMLRenderer.prototype.makeArrow=function(node,el,idAppendix){var nodeStroke=this.container.ownerDocument.createElement('v:stroke');nodeStroke.setAttribute('endarrow','block');nodeStroke.setAttribute('endarrowlength','long');node.appendChild(nodeStroke);};JXG.VMLRenderer.prototype.makeArrows=function(el){if(el.visProp['firstArrow']){var nodeStroke=el.rendNodeStroke;if(nodeStroke==null){nodeStroke=this.container.ownerDocument.createElement('v:stroke');nodeStroke.setAttribute('id',el.id+"stroke");nodeStroke.setAttribute('startarrow','block');nodeStroke.setAttribute('startarrowlength','long');el.rendNode.appendChild(nodeStroke);el.rendNodeStroke=nodeStroke;}}
else{var nodeStroke=el.rendNodeStroke;if(nodeStroke!=null){nodeStroke.setAttribute('startarrow','none');}}
if(el.visProp['lastArrow']){var nodeStroke=el.rendNodeStroke;if(nodeStroke==null){nodeStroke=this.container.ownerDocument.createElement('v:stroke');el.rendNode.appendChild(nodeStroke);el.rendNodeStroke=nodeStroke;}
nodeStroke.setAttribute('id',el.id+"stroke");nodeStroke.setAttribute('endarrow','block');nodeStroke.setAttribute('endarrowlength','long');}
else{var nodeStroke=el.rendNodeStroke;if(nodeStroke!=null){nodeStroke.setAttribute('endarrow','none');}}};JXG.VMLRenderer.prototype.updateLinePrimitive=function(node,p1x,p1y,p2x,p2y){node.setAttribute('from',[p1x,p1y].join(','));node.setAttribute('to',[p2x,p2y].join(','));};JXG.VMLRenderer.prototype.updateCirclePrimitive=function(node,x,y,r){node.style.left=(x-r)+'px';node.style.top=(y-r)+'px';node.style.width=(r*2)+'px';node.style.height=(r*2)+'px';};JXG.VMLRenderer.prototype.updateRectPrimitive=function(node,x,y,w,h){node.style.left=(x)+'px';node.style.top=(y)+'px';node.style.width=(w)+'px';node.style.height=(h)+'px';};JXG.VMLRenderer.prototype.updateEllipsePrimitive=function(node,x,y,rx,ry){node.style.left=(x-rx)+'px';node.style.top=(y-ry)+'px';node.style.width=(rx*2)+'px';node.style.height=(ry*2)+'px';};JXG.VMLRenderer.prototype.updatePathPrimitive=function(node,pointString){node.points.value=pointString;};JXG.VMLRenderer.prototype.updatePathStringPrimitive=function(el){var pStr='';var scr;var i=0;var n=el.numberPoints%8;if(n>0){do
{scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}}
while(--n);}
n=parseInt(el.numberPoints/8);if(n>0){do
{scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}
scr=el.points[i++].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pStr+=scr[1]+','+scr[2]+' ';}}
while(--n);}
return pStr;};JXG.VMLRenderer.prototype.updatePathStringPrimitiveOld=function(el){var pointString='';for(var i=0;i<el.numberPoints;i++){var scr=el.points[i].scrCoords;if(!isNaN(scr[1])&&!isNaN(scr[2])){pointString+=scr[1]+','+scr[2]+' ';}}
return pointString;};JXG.VMLRenderer.prototype.updatePolygonePrimitive=function(node,pointString){node.points.value=pointString;};JXG.VMLRenderer.prototype.appendChildPrimitive=function(node,level){switch(level){case'images':node.style.zIndex="1";break;case'grid':node.style.zIndex="1";break;case'angles':node.style.zIndex="2";break;case'sectors':node.style.zIndex="2";break;case'polygone':node.style.zIndex="2";break;case'curves':node.style.zIndex="2";break;case'circles':node.style.zIndex="3";break;case'lines':node.style.zIndex="4";break;case'arcs':node.style.zIndex="4";break;case'points':node.style.zIndex="5";break;}
this.container.appendChild(node);};JXG.VMLRenderer.prototype.setPropertyPrimitive=function(node,key,val){var keyVml='';switch(key){case'stroke':keyVml='strokecolor';break;case'stroke-width':keyVml='strokeweight';break;case'stroke-dasharray':keyVml='dashstyle';break;}
if(key=='stroke-dasharray'){var node2=this.container.ownerDocument.createElement('v:stroke');node2.setAttribute('id',node.id+'stroke');node2.setAttribute('dashstyle','Dash');node.appendChild(node2);}else{if(keyVml!=''){var v;if(typeof val=='function'){v=val();}else{v=val;}
node.setAttribute(keyVml,v);}}};