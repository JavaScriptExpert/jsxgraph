<html>
<head>
   <title>JSXGraph example</title>
   <link rel="stylesheet" type="text/css" href="../distrib/jsxgraph.css" />
<!--<script type="text/javascript" src="../distrib/jquery.min.js"></script>-->
<script type="text/javascript" src="../distrib/prototype.js"></script>
<script type="text/javascript" src="../src/loadjsxgraph.js"></script>
</head>
<body>
<!-- Drawing area -->
<div id="box" class="jxgbox" style="width:600px; height:600px; overflow:hidden; /*position:absolute; top:0px; left:0px;*/"></div>
<!-- Drawing area -->
<div id="debug" style="display:block;"></div>

<script type="text/javascript">
/* <![CDATA[ */
var brd = JXG.JSXGraph.initBoard('box', {originX: 300, originY: 300, grid:true, unitX: 100, unitY: 100});
HSV2RGB = function(H,S,V) {
    var R,G,B, f,i,hTemp, p,q,t;
    if (s==0) {
        if (isNaN(H)) {
            R = V;
            G = V;
            B = V;
        } else {
            return '#000000';
        }
    } else {
        if (H>=360) {
            hTemp = 0.0;
        } else {
            hTemp = H;
        }
        hTemp = hTemp / 60;     // h is now IN [0,6)
        i = Math.floor(hTemp);        // largest integer <= h
        f = hTemp - i;                  // fractional part of h
        p = V * (1.0 - S);
        q = V * (1.0 - (S * f));
        t = V * (1.0 - (S * (1.0 - f)));
        switch (i) {
            case 0: R = V; G = t;  B = p; break;
            case 1: R = q; G = V;  B = p; break;
            case 2: R = p; G = V;  B = t; break;
            case 3: R = p; G = q;  B = V; break;
            case 4: R = t; G = p;  B = V; break;
            case 5: R = V; G = p;  B = q; break;
        }
    }
    R = Math.round(R*255).toString(16); R = (R.length==0)?'00':((R.length==1)?'0'+R:R);
    G = Math.round(G*255).toString(16); G = (G.length==0)?'00':((G.length==1)?'0'+G:G);
    B = Math.round(B*255).toString(16); B = (B.length==0)?'00':((B.length==1)?'0'+B:B);
    return '#'+R+G+B; 
}
solveQ2 = function(x1,x2,x3,off) {
    var a, b, c, d;
    a = 0.5;
    b = -(x1+x2+x3);
    c = x1*x1+x2*x2+x3*x3-0.5*(x1+x2+x3)*(x1+x2+x3)-off;
    d = b*b-4*a*c;
    if (Math.abs(d)<0.00000001) d = 0.0;
    $('debug').innerHTML += d+' ';
    return [(-b+Math.sqrt(d))/(2.0*a),(-b-Math.sqrt(d))/(2.0*a)];
}   
    
b0 = -0.5;
r1 = 1.0;
b1 = 1.0/r1;
r2 = (2.0-r1);
b2 = 1.0/r2;

p0 = brd.createElement('point',[0,0],{name:''});
p1 = brd.createElement('point',[2.0-r1,0],{name:''});
p2 = brd.createElement('point',[-r1,0],{name:''});

c0 = brd.createElement('circle',[p0,Math.abs(1.0/b0)]);
c1 = brd.createElement('circle',[p1,Math.abs(1/b1)]);
c2 = brd.createElement('circle',[p2,Math.abs(1/b2)]);
c0.curvature = b0;
c1.curvature = b1;
c2.curvature = b2;

x0 = c0.midpoint.X();
x1 = c1.midpoint.X();
x2 = c2.midpoint.X();
y0 = c0.midpoint.Y();
y1 = c1.midpoint.Y();
y2 = c2.midpoint.Y();

b3 = solveQ2(b0,b1,b2,0);
bx3 = solveQ2(b0*x0,b1*x1,b2*x2,2);
by3 = solveQ2(b0*y0,b1*y1,b2*y2,2);

p3 = brd.createElement('point',[bx3[0]/b3[0],by3[0]/b3[0]],{name:''});
c3 = brd.createElement('circle',[p3,Math.abs(1.0/b3[0])]);
c3.curvature = b3[0];

/*
p4 = brd.createElement('point',[bx3[1]/b3[1],by3[1]/b3[1]],{name:''});
c4 = brd.createElement('circle',[p4,Math.abs(1.0/b3[1])]);
c4.curvature = b3[1];
*/
newCirc = function(circ0,circ1,circ2,nr) {
    var b0,b1,b2,x0,x1,x2,y0,y1,y3,  b3,b3x,b3y, p,c;
    b0 = circ0.curvature;
    b1 = circ1.curvature;
    b2 = circ2.curvature;

    x0 = circ0.midpoint.X();
    x1 = circ1.midpoint.X();
    x2 = circ2.midpoint.X();
    
    y0 = circ0.midpoint.Y();
    y1 = circ1.midpoint.Y();
    y2 = circ2.midpoint.Y();
    
    b3 = solveQ2(b0,b1,b2,0);
    bx3 = solveQ2(b0*x0,b1*x1,b2*x2,2);
    by3 = solveQ2(b0*y0,b1*y1,b2*y2,2);

    if (nr==1) {
        p = brd.createElement('point',[bx3[1]/b3[1],by3[1]/b3[1]],{name:''});
        c = brd.createElement('circle',[p,Math.abs(1.0/b3[1])]);
        c.curvature = b3[1];
    } else {
        p = brd.createElement('point',[bx3[0]/b3[0],by3[0]/b3[0]],{name:''});
        c = brd.createElement('circle',[p,Math.abs(1.0/b3[0])]);
        c.curvature = b3[0];
    }
    return c;
}

//-------------------------------------------------------
/*
c4 = newCirc(c0,c1,c3);
c5 = newCirc(c0,c1,c4);
c6 = newCirc(c0,c1,c5);
c7 = newCirc(c0,c4,c5);
*/

c8 = newCirc(c0,c2,c3,1);


/* ]]> */
</script>
</body>
</html>
